;/*FB_PKG_DELIM*/

__d("IGDUncaughtErrorState.react",["FBLogger","PolarisHttp500UnexpectedErrorPage.react","cr:8915","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useEffect;function k(a){if(b("cr:8915")!=null&&a!=null&&a instanceof b("cr:8915").ReStoreDbVersionChange){c("FBLogger")("igd_web").info(a);return}c("FBLogger")("igd_web").catching(a).mustfix("Uncaught Error while loading chat: %s",a.toString())}function a(a){var b=d("react-compiler-runtime").c(7),e=a.description,f=a.error,g=a.header;a=a.onPress;var h,l;b[0]!==f?(h=function(){k(f)},l=[f],b[0]=f,b[1]=h,b[2]=l):(h=b[1],l=b[2]);j(h,l);h=e!=null?e:void 0;l=g!=null?g:void 0;b[3]!==a||b[4]!==h||b[5]!==l?(e=i.jsx(c("PolarisHttp500UnexpectedErrorPage.react"),{description:h,header:l,onClick:a}),b[3]=a,b[4]=h,b[5]=l,b[6]=e):e=b[6];return e}g["default"]=a}),98);
__d("IGDInboxErrorState.react",["IGDUncaughtErrorState.react","cr:9977","react","react-compiler-runtime","useCurrentDisplayMode"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;function a(a){var e=d("react-compiler-runtime").c(10);a=a.error;var f;f=a;f=f;var g=c("useCurrentDisplayMode")(),h;e[0]!==a||e[1]!==g?(h=b("cr:9977")==null?void 0:b("cr:9977")(a,g),e[0]=a,e[1]=g,e[2]=h):h=e[2];g=h;h=g;if(h!=null){g=(g=h.action)==null?void 0:g.onPress;var j;e[3]!==h.body||e[4]!==h.headline||e[5]!==f||e[6]!==g?(j=i.jsx(c("IGDUncaughtErrorState.react"),{description:h.body,error:f,header:h.headline,onPress:g}),e[3]=h.body,e[4]=h.headline,e[5]=f,e[6]=g,e[7]=j):j=e[7];return j}else{e[8]!==a?(h=i.jsx(c("IGDUncaughtErrorState.react"),{error:a}),e[8]=a,e[9]=h):h=e[9];return h}}g["default"]=a}),98);
__d("LSPlatformArmadilloUtils",["MAWMIC","MAWMICSchema","Promise","cr:6998","cr:7349","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("MAWThreadConsistencyLogger").__setRef("LSPlatformArmadilloUtils"),k=(h=b("cr:6998"))!=null?h:b("cr:7349"),l=[];function a(a){l.push(a)}function e(){k==null?void 0:k.completeSync();void j.load().then(function(a){return a.startMAWThreadConsistencyLogger()});if(l.length===0){k==null?void 0:k.maybeEndOccamadilloThreadMapping();return}c("promiseDone")((i||(i=b("Promise"))).allSettled(l.map(function(a){return a()})),function(){return k==null?void 0:k.maybeEndOccamadilloThreadMapping()})}function f(){d("MAWMIC").addPoint("ls_init_end")}function m(){d("MAWMIC").addPoint("ls_init_start")}function n(){d("MAWMIC").addPoint("ls_sync_start")}function o(){d("MAWMIC").addPoint(d("MAWMICSchema").POINTS.ls_sync_end)}function p(a){d("MAWMIC").fail("init_sync_failure",a)}g.executeOnThreadMappingEnd=a;g.occamadilloInitEnd=e;g.reportInitEnd=f;g.reportInitStart=m;g.reportSyncStart=n;g.reportSyncEnd=o;g.reportInitSyncFailure=p}),98);
__d("LSPlatformClientSingleton",[],(function(a,b,c,d,e,f){"use strict";var g={contents:void 0};function a(a){g.contents=a}f.saveInstance=a}),66);
__d("isRegisterArmadilloOnIgEnabled",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("26380")===!0}g["default"]=a}),98);
__d("maybeSetupMAWMainThreadLogger",["MessengerLogHistory","cr:6999","cr:7350","isArmadillo","isRegisterArmadilloOnIgEnabled"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MessengerLogHistory").getInstance("client_init"),i=(a=b("cr:6999"))!=null?a:b("cr:7350");e=function(){i!=null&&(c("isArmadillo")()||c("isRegisterArmadilloOnIgEnabled")())&&(h.debug("Starting MAW main thread logger setup..."),i.setupMainWaLogger(),h.debug("Starting MAW main thread logger setup success"))};g.maybeSetupMAWMainThreadLogger=e}),98);
__d("LSPlatformClientInstances",["ExecutionEnvironment","FBLogger","LSLocalize","LSPlatformArmadilloUtils","LSPlatformClientSingleton","LSPlatformLsInitLog","LSSuspense","MAWLoggerUtils","MAWMIC","MessengerLogHistory","PromiseAnnotate","asyncToGeneratorRuntime","cr:19622","getErrorSafe","maybeSetupMAWMainThreadLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;b("LSLocalize");d("MAWLoggerUtils").initMessengerWebLogging();var k=d("MessengerLogHistory").getInstance("client_init"),l=(j||(j=c("LSSuspense"))).makeCollection(),m=!1;function a(a,e,f){d("MAWMIC").startMAWMICFlow();m||(k.debug("[Occamadillo] Beginning hardcoded init sync"),m=!0,d("maybeSetupMAWMainThreadLogger").maybeSetupMAWMainThreadLogger());d("LSPlatformArmadilloUtils").reportInitStart();var g=function(a){a=c("getErrorSafe")(a);k.debug("Initializing LSPlatformClient failed");d("LSPlatformLsInitLog").fail("client_setup_failure",a);d("MAWMIC").fail("client_setup_failure",a);c("FBLogger")("messenger_web").catching(a).warn("[LS] LSPlatformClient initialization failure");throw a};return(j||(j=c("LSSuspense"))).getFromCollection(l,a,function(){return(h||(h=d("PromiseAnnotate"))).setDisplayName(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("LSPlatformLsInitLog").addAnnotations({bool:{canUseDOM:(i||(i=c("ExecutionEnvironment"))).canUseDOM,fromReact:f==null?void 0:f.fromReact},string:{configAppId:a.appId,configPlatformName:a.platformName}});k.debug("Messenger loading UI suspending");try{var h=b("cr:19622")!=null?yield b("cr:19622").maybeEvaluateInitSyncEagerly(a):!1;if(!(i||(i=c("ExecutionEnvironment"))).isInBrowser)return yield a.getDb();h=e(a,{didEvaluateInitSyncEagerly:h}).then(function(a){d("LSPlatformLsInitLog").addPoint("start_client");return a.start().then(function(){k.debug("Initializing LSPlatformClient success");d("LSPlatformClientSingleton").saveInstance(a);d("LSPlatformArmadilloUtils").reportInitEnd();return a.db})});return yield h}catch(a){g(a)}finally{k.debug("Messenger loading UI unsuspending")}})(),"InitLSPlatformClient")})}e={getOrInit:a};g["default"]=e}),98);
__d("LSPlatformClientProviderAddons.react",["CometPlaceholder.react","cr:6495","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(){return i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"LSPlatformClientProviderAddons",children:b("cr:6495")!=null&&i.jsx(b("cr:6495"),{})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSPlatformErrorsCatcher.react",["MetaConfig","cr:7070","react"],(function(a,b,c,d,e,f,g){"use strict";var h;h||(h=d("react"));e=h;var i=e.useEffect,j=e.useState;function a(a){var d=a.children;a=a.fallback;var e=j(null),f=e[0],g=e[1];i(function(){var a=b("cr:7070")&&b("cr:7070").subscribe(function(a){g(a)});return function(){a&&a()}},[]);e=(e=b("cr:7070")==null?void 0:b("cr:7070").lastError())!=null?e:f;if(c("MetaConfig")._("66")&&e!=null&&a!=null)return a(e);else return d}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWCondSetup.react",["cr:3921","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=h||d("react");f=c("gkx")("20836")?a.Fragment:(e=b("cr:3921"))!=null?e:a.Fragment;d=f;g["default"]=d}),98);
__d("MAWSetupWrapperOnce.react",["CometPlaceholder.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext,k=i.createContext(!1);function a(a){var b=a.children;a=a.setupComponent;var d=j(k);return d?b:i.jsxs(k.Provider,{value:!0,children:[b,i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MAWSetupWrapperOnce",children:a})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("MAWCondWrapper.react",["MAWCondSetup.react","MAWSetupWrapperOnce.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){a=a.children;return i.jsx(c("MAWSetupWrapperOnce.react"),{setupComponent:i.jsx(c("MAWCondSetup.react"),{}),children:a})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSPlatformClientProvider.react",["CometDOMOnlyBoundary.react","CometPlaceholder.react","LSPlatformClientInstances","LSPlatformClientProviderAddons.react","LSPlatformErrorsCatcher.react","LSSuspense","MAWCondWrapper.react","ReStoreProvider.react","gkx","qex","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=j||d("react");function l(a,b){a=(h||(h=c("LSSuspense"))).getOrSuspend(a);return c("LSPlatformClientInstances").getOrInit(a,b,{fromReact:!0})}function m(a){var b=a.children,c=a.config;a=a.loadLSPlatformClient;c=l(c,a);return c!=null?k.jsx((i||(i=d("ReStoreProvider.react"))).ReStoreProvider,{db:c,children:b}):b}m.displayName=m.name+" [from "+f.id+"]";function a(a){var b=a.children,d=a.config,e=a.errorFallback,f=a.loadLSPlatformClient;a=a.placeholder;e=k.jsx(c("LSPlatformErrorsCatcher.react"),{fallback:e,children:k.jsx(c("MAWCondWrapper.react"),{children:k.jsx(c("CometPlaceholder.react"),{fallback:a,name:"LSPlatformClientProvider.ClientProvider",children:k.jsxs(m,{config:d,loadLSPlatformClient:f,children:[k.jsx(c("LSPlatformClientProviderAddons.react"),{}),k.jsx(c("CometPlaceholder.react"),{fallback:a,name:"LSPlatformClientProvider.UISuspense",children:b})]})})})});return c("gkx")("12254")&&!c("qex")._("3809")?k.jsx(c("CometDOMOnlyBoundary.react"),{children:e}):e}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSPlatformClientProviderWithDeferredLoadingStrategy.react",["LSPlatformClientProvider.react","LSPlatformLsInitLog","asyncToGeneratorRuntime","cr:2542","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function j(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){d("LSPlatformLsInitLog").addPoint("load_ls_platform_client");var e=(yield b("cr:2542").load());d("LSPlatformLsInitLog").addPoint("load_ls_platform_client_loaded");return e.make(a,c)});return k.apply(this,arguments)}function a(a){var b=a.children,d=a.config,e=a.errorFallback;a=a.placeholder;return i.jsx(c("LSPlatformClientProvider.react"),{config:d,errorFallback:e,loadLSPlatformClient:j,placeholder:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSCometSSRDatabase",["LSJSInMemoryStorage","LSMetadata"],(function(a,b,c,d,e,f,g){"use strict";a=c("LSJSInMemoryStorage")(d("LSMetadata").schema);g["default"]=a}),98);
__d("LSClearEpochBeforeResumeSync",["Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return a.runInTransaction(function(a){var c;return(c=d("ReQL")).toArrayAsync(c.mergeJoin(c.fromTableAscending(a.sync_groups),c.fromTableAscending(a.network_requests).getKeyRange(""))).then(function(c){return(h||(h=b("Promise"))).all(c.map(function(b){b=b[1];return a.network_requests.put({epochId:void 0,failureCount:b.failureCount,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs,lastSentTimestampMs:b.lastSentTimestampMs,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,networkTaskIdentifier:b.networkTaskIdentifier,syncDatabaseId:b.syncDatabaseId,taskQueueName:b.taskQueueName})}))}).then(function(){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.network_requests).filter(function(a){return a.taskQueueName!==""})).then(function(c){return(h||(h=b("Promise"))).all(c.map(function(b){return a.network_requests.put({epochId:void 0,failureCount:b.failureCount,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs,lastSentTimestampMs:b.lastSentTimestampMs,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,networkTaskIdentifier:b.networkTaskIdentifier,syncDatabaseId:b.syncDatabaseId,taskQueueName:b.taskQueueName})}))})})},"readwrite","ui",void 0,f.id+":17").then(function(){return(h||(h=b("Promise"))).resolve()})}g.call=a}),98);
__d("LSDatabaseAfterInitSyncSingleton",["Deferred","PromiseAnnotate"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new(c("Deferred"))();a=function(a){void a.then(function(a){return i.resolve(a)})};b=(h||(h=d("PromiseAnnotate"))).setDisplayName(i.getPromise(),"LSDatabaseSingletonAfterInitSync");e=function(){return i.isSettled()};g.resolveInitSync=a;g.LSDatabaseAfterInitSyncSingleton=b;g.isInitSyncResolved=e}),98);
__d("LSPlatformGraphQLTransport",["FBLogger","I64","LSDynamicDependencies","LSProgramTarget","MessengerLogHistory","Promise","asyncToGeneratorRuntime","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j="LSPlatformGraphQLTransport.ServerError";function a(a,b,c,d,e){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,k){var l=d("MessengerLogHistory").getInstance("client_sync"),m=null;try{m=(yield k(a,e,g,(i||(i=d("I64"))).to_int32(f)))}catch(a){k=c("FBLogger")("messenger_web");a instanceof Error&&(l.error("Error sending Graphql Request. Type: "+(i||(i=d("I64"))).to_string(f)+" Message: "+(a.message!=null?a.message:"None")),k=k.catching(a),k.debug("Relay or Graphql Server error in LSPlatformGraphqlTransport"));throw k.mustfixThrow(j)}a=c("nullthrows")(m);e=a.dependencies;g=a.experiments;l=a.payload;var n=a.target;f=c("nullthrows")(l);k=e==null?(h||(h=b("Promise"))).resolve():d("LSDynamicDependencies").downloadRelayDependencies(e);m=Array.from(c("LSProgramTarget").members()).find(function(a){return c("LSProgramTarget").getName(a)===n});return[k,f,g,m]});return k.apply(this,arguments)}g.ServerError=j;g.publish=a}),98);
__d("LSPlatformHardcodedInitSync",["CurrentMessengerUser","FBLogger","I64","IGDWebUtils","LSDatabaseAfterInitSyncSingleton","LSDatabaseProviderType","LSDict","LSIntEnum","LSJson","LSPlatformArmadilloUtils","LSPlatformGraphQLTransport","LSPlatformLsInitLog","MWPBumpEntityKey","MetaConfig","Promise","QuickPerformanceLogger","ReQL","asyncToGeneratorRuntime","getErrorSafe","gkx","isArmadillo","isInstamadillo","isRegisterArmadilloOnIgEnabled","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=c("isArmadillo")()||c("isRegisterArmadilloOnIgEnabled")()&&!c("isInstamadillo")(),m=!d("CurrentMessengerUser").isWorkUser()&&!d("IGDWebUtils").isOnInstagramWeb(),n=[1,l?95:null,m?104:null].filter(Boolean);function o(a){return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){return(k||(k=b("Promise"))).all(n.map(function(b){return a.network_requests.put({epochId:void 0,failureCount:(i||(i=d("I64"))).zero,lastDelayedRequestTimestampMs:void 0,lastSentTimestampMs:i.zero,lastSyncRequestTimestampMs:i.zero,networkTaskIdentifier:void 0,syncDatabaseId:(j||(j=d("LSIntEnum"))).ofNumber(b),taskQueueName:""})}))});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":62").then(function(){return(k||(k=b("Promise"))).resolve()})}function p(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange("",(j||(j=d("LSIntEnum"))).ofNumber(b)))}function q(a){return a.runInTransaction(function(a){return(k||(k=b("Promise"))).all(n.map(function(c){return p(a,c).then(function(c){return c!=null?a.network_requests.put({epochId:(i||(i=d("I64"))).zero,failureCount:c.failureCount,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs,lastSentTimestampMs:c.lastSentTimestampMs,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,networkTaskIdentifier:c.networkTaskIdentifier,syncDatabaseId:c.syncDatabaseId,taskQueueName:c.taskQueueName}):(k||(k=b("Promise"))).resolve()})})).then(function(){})},"readwrite","ui",void 0,f.id+":97")}function r(a){if(d("LSDatabaseProviderType").isProviderPersisted(a)&&c("MetaConfig")._("76"))return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield p(a,1));b!=null&&(yield a.network_requests.put({epochId:void 0,failureCount:b.failureCount,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs,lastSentTimestampMs:b.lastSentTimestampMs,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,networkTaskIdentifier:b.networkTaskIdentifier,syncDatabaseId:b.syncDatabaseId,taskQueueName:b.taskQueueName}))});return function(b){return a.apply(this,arguments)}}(),"readwrite","ui",void 0,f.id+":130");else return(k||(k=b("Promise"))).resolve()}function s(a){d("CurrentMessengerUser").isWorkUser()&&(h||(h=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(1036588047,"310"),a)}function t(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.sync_groups).getKeyRange((j||(j=d("LSIntEnum"))).ofNumber(b)))}function u(a,b,e,f){return new(c("LSDict"))().set("database",(j||(j=d("LSIntEnum"))).ofNumber(a)).set("epoch_id",(i||(i=d("I64"))).zero).set("last_applied_cursor",e).set("sync_params",f!=null?f:"{}").set("version",i.of_string(b))}function v(a){var b=0,c=0,e=function(e){c++;c===a&&d("LSPlatformLsInitLog").addPoint("gql_fetch_end");b===0&&d("LSPlatformLsInitLog").addPoint("gql_deps_start");return e.then(function(){b===0&&(d("LSPlatformLsInitLog").addPoint("ls_sync_execute_start"),d("LSPlatformLsInitLog").LsSync.markStart()),b++,b===a&&d("LSPlatformLsInitLog").addPoint("gql_deps_end")})};return e}var w=function(){return[(k||(k=b("Promise"))).resolve(),"",void 0,void 0]};function a(a,b,c,d){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){try{var i=d("CurrentMessengerUser").isWorkUser();yield q(f);var n=[1,l?95:void 0,m?104:void 0];n=(yield (k||(k=b("Promise"))).all(n.map(function(a){return a!=null?t(f,a):void 0})));var p=n[0],x=n[1];n=n[2];p=p==null?void 0:p.currentCursor;x=x==null?void 0:x.currentCursor;n=n==null?void 0:n.currentCursor;var y=u(1,a.schemaVersion,p,a.syncParams.mailbox),z=u(95,a.schemaVersion,x,a.syncParams.e2ee),A=u(104,a.schemaVersion,n,a.syncParams.communityExclusive),B={string:{mailboxSync:p!=null?"resume":"init"}};i&&(h||(h=c("QuickPerformanceLogger"))).markerAnnotate(c("qpl")._(1036588047,"310"),B);d("LSPlatformLsInitLog").addPoint("ls_sync_start",B);d("LSPlatformArmadilloUtils").reportSyncStart();d("LSPlatformLsInitLog").addPoint("gql_fetch_start");s("start_contact");s("start_mailbox");var C=v(1+(l?1:0)+(m?1:0));i=d("LSPlatformGraphQLTransport").publish(g,0,p!=null?(j||(j=d("LSIntEnum"))).ofNumber(2):(j||(j=d("LSIntEnum"))).ofNumber(1),d("LSJson").stringify(y),a.executeGraphQLLightSpeedRequest).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){s("mailbox_synced");d("LSPlatformLsInitLog").addPoint("gql_mailbox_fetch_end");yield C(a[0]);return a});return function(b){return a.apply(this,arguments)}}())["catch"](function(a){var b;d("LSPlatformArmadilloUtils").reportInitSyncFailure(a);d("LSPlatformLsInitLog").addPoint("gql_mailbox_fetch_failed",{string:{gql_mailbox_fetch_fail_reason:(b=a.message)!=null?b:"unknown"}});c("FBLogger")("messenger_web").catching(a).mustfix("Failed to sync mailbox");return w()});B=l?d("LSPlatformGraphQLTransport").publish(g,2,x!=null?(j||(j=d("LSIntEnum"))).ofNumber(2):(j||(j=d("LSIntEnum"))).ofNumber(1),d("LSJson").stringify(z),a.executeGraphQLLightSpeedRequest).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("LSPlatformLsInitLog").addPoint("gql_e2ee_fetch_end");yield C(a[0]);return a});return function(b){return a.apply(this,arguments)}}())["catch"](function(a){var b;d("LSPlatformArmadilloUtils").reportInitSyncFailure(a);d("LSPlatformLsInitLog").addPoint("gql_e2ee_fetch_failed",{string:{gql_e2ee_fetch_fail_reason:(b=a.message)!=null?b:"unknown"}});c("FBLogger")("messenger_web").catching(a).mustfix("Failed to sync e2ee mailbox");return w()}):(k||(k=b("Promise"))).resolve(w());y=m?d("LSPlatformGraphQLTransport").publish(g,3,n!=null?(j||(j=d("LSIntEnum"))).ofNumber(2):(j||(j=d("LSIntEnum"))).ofNumber(1),d("LSJson").stringify(A),a.executeGraphQLLightSpeedRequest).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){d("LSPlatformLsInitLog").addPoint("gql_cm_fetch_end");yield C(a[0]);return a});return function(b){return a.apply(this,arguments)}}())["catch"](function(a){var b;d("LSPlatformArmadilloUtils").reportInitSyncFailure(a);d("LSPlatformLsInitLog").addPoint("gql_cm_fetch_failed",{string:{gql_cm_fetch_fail_reason:(b=a.message)!=null?b:"unknown"}});c("FBLogger")("messenger_web").catching(a).mustfix("Failed to sync Community Exclusive mailbox");return w()}):(k||(k=b("Promise"))).resolve(w());if(c("gkx")("10695"))yield (k||(k=b("Promise"))).all([B,i,y].map(function(a){return a.then(function(a){a[0];var b=a[1],c=a[2];a=a[3];if(b==="")return;return e({experiments:c,priority:"ui",syncScript:b,target:a})})}));else{x=(yield (k||(k=b("Promise"))).all([i,B,y]));for(z of x){z[0];g=z[1];n=z[2];A=z[3];if(g==="")continue;yield e({experiments:n,priority:"ui",syncScript:g,target:A})}}p!=null&&(yield r(f));d("LSPlatformLsInitLog").LsSync.markEnd();s("sync_completed");d("LSPlatformLsInitLog").addPoint("ls_sync_execute_end");d("LSPlatformArmadilloUtils").reportSyncEnd();d("LSPlatformLsInitLog").addPoint("ls_sync_end");l&&d("LSPlatformArmadilloUtils").occamadilloInitEnd();d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw_graphql","init_sync.success");d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw_ls","init_sync.success");d("LSDatabaseAfterInitSyncSingleton").resolveInitSync(k.resolve(f))}catch(b){a=c("getErrorSafe")(b);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("mw_ls","init_sync.fail");s("sync_failed");d("LSPlatformLsInitLog").fail("init_sync_failure");try{d("LSPlatformArmadilloUtils").reportInitSyncFailure(a)}catch(a){}c("FBLogger")("messenger_web").catching(a).mustfix("Encountered an error while performining preloaded init sync request via graphql");return o(f)}});return x.apply(this,arguments)}g.sendHardcodedInitSync=a}),98);
__d("LSPlatformSyncSystemMaybeDeferred",["cr:2049","cr:6963"],(function(a,b,c,d,e,f,g){"use strict";c=(a=b("cr:2049"))!=null?a:b("cr:6963");d=c;g["default"]=d}),98);
__d("LSPlatformClientInit",["LSClearEpochBeforeResumeSync","LSDataTraceFlushDeferred","LSDatabaseAfterInitSyncSingleton","LSDeleteAllAndInsertConnectivityStatusStoredProcedure","LSFactory","LSIntEnum","LSInternetConnectionState","LSPlatformHardcodedInitSync","LSPlatformLsInitLog","LSPlatformRealtimeTransport","LSPlatformSyncSystemMaybeDeferred","LSPlatformTaskSystemTransport","MWPlatformTaskSystem","MessengerLogHistory","Promise","asyncToGeneratorRuntime","cr:3411","cr:7705","emptyFunction","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=d("MessengerLogHistory").getInstance("client_init");function k(a){var d=c("emptyFunction");b("cr:7705")!=null&&c("gkx")("23914")&&(d=b("cr:7705").listenForChangesToBackupState(a));return function(){d&&d()}}function l(a,b){var e=b==="Connected"?(i||(i=d("LSIntEnum"))).ofNumber(c("LSInternetConnectionState").CONNECTED):(i||(i=d("LSIntEnum"))).ofNumber(c("LSInternetConnectionState").NOT_CONNECTED);j.debug("Platform client sync connection status: ",b);c("promiseDone")(a.runInTransaction(function(a){return c("LSDeleteAllAndInsertConnectivityStatusStoredProcedure")(c("LSFactory")(a),{internetConnectionState:e})},"readwrite",void 0,void 0,f.id+":76"),function(){j.debug("Platform client sync connection status set successfully")},function(a){j.error("Platform client sync connection status set failed: "+(a==null?void 0:a.message));throw a})}function a(a,b,c,d,e,f){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,i,m){var n;j.debug("Platform client sync starting...");(n=d("LSPlatformLsInitLog")).addPoint("onstart_callback");g();n.addPoint("onstart_callback_end");j.debug("Getting datascript evaluator...");n.addPoint("ds_eval_registration");g=(yield e.getEval());j.debug("Getting datascript evaluator success");var o;try{o=b("cr:3411")!=null?b("cr:3411").registerEval(g)()(a):g()(a)}catch(b){c("recoverableViolation")("fail to register datascriptEvaluator","ls_web_init",{error:b}),o=g()(a)}d("LSPlatformLsInitLog").addPoint("ds_eval_registration_end");j.debug("Clearing epoch before resume sync...");m.didEvaluateInitSyncEagerly||(yield d("LSClearEpochBeforeResumeSync").call(a),j.debug("Clearing epoch before resume sync success"),d("LSPlatformLsInitLog").addPoint("create_client_end"),e.sendHardcodedInitSync&&(j.debug("Starting hard-coded init sync..."),yield d("LSPlatformHardcodedInitSync").sendHardcodedInitSync(e,o,a,f),j.debug("Starting hard-coded init sync success")));d("LSDatabaseAfterInitSyncSingleton").resolveInitSync((h||(h=b("Promise"))).resolve(a));j.debug("Starting realtime transport");n=(yield e.realtimeUnderylingTransport());var p=d("LSPlatformRealtimeTransport").LSPlatformRealtimeTransport(n,e.appId,f);j.debug("Starting task system");var q=new(c("MWPlatformTaskSystem"))(a,new(c("LSPlatformTaskSystemTransport"))(a,p,o,e.schemaVersion));j.debug("Starting sync system");var r=null;c("promiseDone")(c("LSPlatformSyncSystemMaybeDeferred")(),function(b){r=b(a,p,o,e.schemaVersion,f,e.executeGraphQLLightSpeedRequest)});j.debug("Starting backup state listeners");var s=k(a),t;j.debug("Watching for expired traces");c("promiseDone")(d("LSDataTraceFlushDeferred").watchForExpiredTraces(a).then(function(a){t=a}));j.debug("Subscribing to mqtt sync status change events");p.onConnectionStatusChange(function(b){l(a,b)});j.debug("Platform client sync starting sucess");d("LSPlatformLsInitLog").endSuccess();return{cleanup:function(){var b;j.debug("Platform client sync cleaning up");i(a);q==null?void 0:q.cleanup();(b=r)==null?void 0:b.cleanup();p.cleanup();s();t==null?void 0:t()},db:a}});return m.apply(this,arguments)}g.init=a}),98);
__d("LSPlatformClient",["ExecutionEnvironment","FBLogger","LSCometSSRDatabase","LSDatabaseProviderType","LSPlatformClientInit","LSPlatformDeviceId","LSPlatformLsInitLog","MAWMIC","MAWMICSchema","Promise","asyncToGeneratorRuntime","cr:10018","emptyFunction","getErrorSafe","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("emptyFunction").thatReturns((i||(i=b("Promise"))).resolve());function k(a,e,f){var g,h=function(){var h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=d("LSPlatformDeviceId").getDeviceIdForProviderType("ephemeral");g=(yield d("LSPlatformClientInit").init(a,e,b,c("emptyFunction"),c("emptyFunction"),f))});return function(){return h.apply(this,arguments)}}();return{cleanup:function(){var a;(a=g)==null?void 0:a.cleanup()},db:a,start:h}}function l(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f){if(b("cr:10018")==null)throw c("FBLogger")("messenger_web").mustfixThrow("LSPlatformClientWithLock is null for PDB enabled");e=(yield b("cr:10018").make(a,e,f));e.isTabWithoutClient()===!0&&(d("MAWMIC").addPoint("ls_init_end"),d("MAWMIC").addPoint(d("MAWMICSchema").POINTS.thread_mapping_end),d("MAWMIC").addBoolAnnotation("LsInitSkipped",!0),d("LSPlatformLsInitLog").addPoint("no_ls_sync"),d("LSPlatformLsInitLog").endSuccess());return{cleanup:c("emptyFunction"),db:a,start:j}});return m.apply(this,arguments)}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){d("LSPlatformLsInitLog").addPoint("make_client");if((h||(h=c("ExecutionEnvironment"))).canUseDOM||c("qex")._("3809")){d("LSPlatformLsInitLog").addPoint("create_client_get_db");var f=(yield a.getDb());d("LSPlatformLsInitLog").addPoint("create_client_start");if(d("LSDatabaseProviderType").isProviderPersisted(f)&&b("cr:10018")!==null)try{return l(f,a,e)}catch(a){d("LSPlatformLsInitLog").addAnnotations({string:{client_for_pdb_error:c("getErrorSafe")(a).message}});d("LSPlatformLsInitLog").fail("client_for_pdb_error");throw a}return k(f,a,e)}return{cleanup:c("emptyFunction"),db:c("LSCometSSRDatabase"),start:j}});return n.apply(this,arguments)}g.make=a}),98);
__d("LSPlatformClientProviderWithImmediateLoadingStrategy.react",["LSPlatformClient","LSPlatformClientProvider.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=a.children,e=a.config,f=a.errorFallback;a=a.placeholder;return i.jsx(c("LSPlatformClientProvider.react"),{config:e,errorFallback:f,loadLSPlatformClient:d("LSPlatformClient").make,placeholder:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSPlatformGraphQLLightspeedRequestForIGDQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"deviceId"},{defaultValue:null,kind:"LocalArgument",name:"requestId"},{defaultValue:null,kind:"LocalArgument",name:"requestPayload"},{defaultValue:null,kind:"LocalArgument",name:"requestType"}],b=[{alias:null,args:[{kind:"Variable",name:"device_id",variableName:"deviceId"},{kind:"Variable",name:"request_id",variableName:"requestId"},{kind:"Variable",name:"request_payload",variableName:"requestPayload"},{kind:"Variable",name:"request_type",variableName:"requestType"}],concreteType:"LightspeedWebResponse",kind:"LinkedField",name:"lightspeed_web_request_for_igd",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"payload",storageKey:null},{alias:null,args:null,concreteType:"LightspeedWebRequestDependency",kind:"LinkedField",name:"dependencies",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experiments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"target",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"LSPlatformGraphQLLightspeedRequestForIGDQuery",selections:b,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"LSPlatformGraphQLLightspeedRequestForIGDQuery",selections:b},params:{id:"29212911238354531",metadata:{},name:"LSPlatformGraphQLLightspeedRequestForIGDQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("LSPlatformGraphQLLightspeedRequestForIGD",["CometRelay","LSPlatformGraphQLLightspeedRequestForIGDQuery.graphql","XPlatRelayEnvironment"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,c,e,f){return d("CometRelay").fetchQuery(d("XPlatRelayEnvironment").getRelayEnvironment(),h!==void 0?h:h=b("LSPlatformGraphQLLightspeedRequestForIGDQuery.graphql"),{deviceId:a,requestId:c,requestPayload:e,requestType:f}).toPromise().then(function(a){return a==null?void 0:a.lightspeed_web_request_for_igd})}g["default"]=a}),98);
__d("LSPlatformInstagramConfig",["CurrentAppID","IGDOverLSMqttChannel","LSDatabaseSingleton","LSDatascriptEvaluatorMaybeDeferred","LSPlatformGraphQLLightspeedRequestForIGD","LSPlatformMessengerSyncParams","LSPlatformMqttRealtimeTransport","LSSuspense","LSVersion","Promise","getMWLSRegion"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;f=d("CurrentAppID").getAppID();var k=c("getMWLSRegion")();f=f==null?"1217981644879628":f;function a(){return(j||(j=d("LSDatabaseSingleton"))).LSDatabaseSingleton}function l(a,b){return c("LSPlatformMqttRealtimeTransport")(c("LSVersion"),b,{getInstance:d("IGDOverLSMqttChannel").getInstance,shutdownAndClear:d("IGDOverLSMqttChannel").shutdownAndClear})}function e(){return c("LSDatascriptEvaluatorMaybeDeferred")()}f={appId:f,executeGraphQLLightSpeedRequest:c("LSPlatformGraphQLLightspeedRequestForIGD"),getDb:a,getEval:e,platformName:"Instagram",realtimeUnderylingTransport:function(){return(i||(i=b("Promise"))).resolve(l)},region:k,schemaVersion:c("LSVersion"),sendHardcodedInitSync:!0,syncParams:c("LSPlatformMessengerSyncParams")};a=(h||(h=c("LSSuspense"))).makeWithValue(f);g.configEagerlyLoaded=a}),98);
__d("IGDPageSetup.react",["CometErrorBoundary.react","CometPlaceholder.react","CurrentUser","I64","IGDRouteProvider.react","LSPlatformClientProviderWithDeferredLoadingStrategy.react","LSPlatformClientProviderWithImmediateLoadingStrategy.react","LSPlatformInstagramConfig","MWLSThreadDisplayContext","MWPActor.react","cr:497","cr:7347","deferredLoadComponent","react","react-compiler-runtime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react")),k=h.Fragment,l=(e=b("cr:497"))!=null?e:b("cr:7347"),m=c("deferredLoadComponent")(c("requireDeferred")("IGDInboxErrorState.react").__setRef("IGDPageSetup.react")),n=function(a){return a?void 0:function(a){return j.jsx(m,{error:a})}},o=(i||(i=d("I64"))).of_string(c("CurrentUser").getEIMU());function a(a){var b=d("react-compiler-runtime").c(15),e=a.children,f=a.disableRouteProvider,g=a.placeholder,h=a.shouldUseDeferredLoadingStrategy;a=a.threadDisplayType;f=f===void 0?!1:f;g=g===void 0?null:g;h=h===void 0?!1:h;var i=h?c("LSPlatformClientProviderWithDeferredLoadingStrategy.react"):c("LSPlatformClientProviderWithImmediateLoadingStrategy.react");f=f?k:d("IGDRouteProvider.react").IGDRouteContextProvider;var m;b[0]!==h?(m=n(h),b[0]=h,b[1]=m):m=b[1];b[2]!==e?(h=l==null?e:j.jsx(l,{children:e}),b[2]=e,b[3]=h):h=b[3];b[4]!==h||b[5]!==a?(e=j.jsx(d("MWLSThreadDisplayContext").MWLSThreadDisplayContextProvider,{value:a,children:h}),b[4]=h,b[5]=a,b[6]=e):e=b[6];b[7]!==f||b[8]!==e?(h=j.jsx(d("MWPActor.react").MWPActorProvider,{actorId:o,children:j.jsx(f,{children:e})}),b[7]=f,b[8]=e,b[9]=h):h=b[9];b[10]!==i||b[11]!==g||b[12]!==m||b[13]!==h?(a=j.jsx(c("CometErrorBoundary.react"),{fallback:void 0,children:j.jsx(c("CometPlaceholder.react"),{fallback:null,children:j.jsx(i,{config:d("LSPlatformInstagramConfig").configEagerlyLoaded,errorFallback:m,placeholder:g,children:h})})}),b[10]=i,b[11]=g,b[12]=m,b[13]=h,b[14]=a):a=b[14];return a}g["default"]=a}),98);
__d("IGDSVideoChatFilled24Icon.react",["IGDSSVGIconBase.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M21.259 5.935q-.401.404-.877.88a2.998 2.998 0 0 0-.88 2.121v6.18a3 3 0 0 0 .878 2.121l.879.881A1.653 1.653 0 0 0 24 16.953V7.101a1.653 1.653 0 0 0-2.742-1.166Zm-7.075-3.408H3.818A3.823 3.823 0 0 0-.001 6.345v11.364a3.823 3.823 0 0 0 3.819 3.818h10.366a3.823 3.823 0 0 0 3.818-3.818V6.345a3.823 3.823 0 0 0-3.818-3.818Z",fillRule:"evenodd"}),b[0]=e):e=b[0];b[1]!==a?(e=i.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:e})),b[1]=a,b[2]=e):e=b[2];return e}b=i.memo(a);g["default"]=b}),98);
__d("MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9685249484907022"}),null);
__d("MessengerCreateVideoMeetupLinkMutation.graphql",["MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"CreateVideoMeetupLinkResponsePayload",kind:"LinkedField",name:"create_video_meetup_link",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerCallInviteLink",kind:"LinkedField",name:"meetup_link",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link_hash",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_audio_only",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"MessengerCreateVideoMeetupLinkMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"MessengerCreateVideoMeetupLinkMutation",selections:c},params:{id:b("MessengerCreateVideoMeetupLinkMutation_facebookRelayOperation"),metadata:{},name:"MessengerCreateVideoMeetupLinkMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("MessengerCreateVideoMeetupLinkMutation",["MessengerCreateVideoMeetupLinkMutation.graphql","Promise","cr:1012418","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,d,e){return new(i||(i=b("Promise")))(function(f,g){var i;b("cr:1012418").commitMutation(a,{mutation:h!==void 0?h:h=b("MessengerCreateVideoMeetupLinkMutation.graphql"),onCompleted:function(a){var b,c,d;b=a==null?void 0:(b=a.create_video_meetup_link)==null?void 0:(b=b.meetup_link)==null?void 0:b.is_audio_only;c=a==null?void 0:(c=a.create_video_meetup_link)==null?void 0:(c=c.meetup_link)==null?void 0:c.link_url;d=a==null?void 0:(d=a.create_video_meetup_link)==null?void 0:(d=d.meetup_link)==null?void 0:d.link_hash;a=a==null?void 0:(a=a.create_video_meetup_link)==null?void 0:(a=a.meetup_link)==null?void 0:a.id;return c!=null&&d!=null&&b!=null?f({isAudioOnly:b,linkHash:d,linkId:a,linkUrl:c}):g({error:"Failed to create linkurl."})},onError:function(a){g(a)},optimisticUpdater:null,variables:{input:{client_mutation_id:"",funnel_session_id:e,link_options:{availability_settings_options:(d==null?void 0:d.linkSurface)==="MESSENGER_V2"?{join_permission:d==null?void 0:d.joinPermission,visibility_mode:(i=d==null?void 0:d.visibilityMode)!=null?i:"NONE"}:void 0,chat_mode:(i=d==null?void 0:d.chatMode)!=null?i:null,is_audio_only:(i=d==null?void 0:d.isAudioOnly)!=null?i:null,is_live_enabled:(i=d==null?void 0:d.isLiveEnabled)!=null?i:null,is_room_join_requestable:(i=d==null?void 0:d.joinRequestable)!=null?i:null,link_surface:(i=d==null?void 0:d.linkSurface)!=null?i:c("gkx")("20836")?"WORKPLACE":void 0,revocation_behavior:(i=d==null?void 0:d.revocationBehavior)!=null?i:null,should_allow_anonymous_guests:(i=d==null?void 0:d.allowAnonymousGuests)!=null?i:!0,supports_pages:(i=d==null?void 0:d.supportsPages)!=null?i:!1,supports_profile_plus:(i=d==null?void 0:d.supportsProfilePlus)!=null?i:!1,visibility_mode:(d==null?void 0:d.linkSurface)==="MESSENGER_V2"?void 0:(i=d==null?void 0:d.visibilityMode)!=null?i:"NONE"}}}})})}g["default"]=a}),98);
__d("RoomsLinkUtils",["ConstUriUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=d("ConstUriUtils").getUri(a);var b=a==null?void 0:a.getDomain();a=a==null?void 0:(a=a.stripTrailingSlash())==null?void 0:a.getPath();if(a==null)return null;if(b==="msngr.com")return a.substring(1);var c=/^\/v(id)?\//;if(b==="m.me"&&c.test(a))return a.replace(c,"");b=/^\/groupcall\/LINK:/;return b.test(a)?a.replace(b,""):null}g.getRoomsLinkHash=a}),98);
__d("VideoChatLinksUserActionsMultiplexLogger",["cr:1443591"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:1443591")}),98);
__d("XGroupCallControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/groupcall/{?call_context}/",Object.freeze({users_to_ring:[],has_video:!0,initialize_video:!0,auto_join:!1,use_joining_context:!1,has_seen_interstitial:!1,use_dapp:!1,is_e2ee_mandated:!1,use_www:!1}),void 0);b=a;g["default"]=b}),98);
__d("ZenonCallIdentifiersUtil",["Random"],(function(a,b,c,d,e,f,g){"use strict";function a(){return String(d("Random").uint32()+1)}g.generateZenonClientSessionID=a}),98);
__d("randomZenonNonce",["Random"],(function(a,b,c,d,e,f,g){"use strict";var h=2,i=6,j=36,k=2176782336;function a(){var a="";for(var b=0;b<h;b++){var c=Math.floor(d("Random").random()*k).toString(j);while(c.length<i)c="0"+c;a+=c}return a}g["default"]=a}),98);
__d("ZenonPreCallHookBuilderHelper",["ConstUriUtils","FBLogger","MessengerCreateVideoMeetupLinkMutation","Promise","RoomsLinkUtils","VideoChatLinksUserActionsMultiplexLogger","XGroupCallControllerRouteBuilder","ZenonActorHooks","ZenonCallIdentifiersUtil","ZenonCallWindowErrors","ZenonPeerID","ZenonSignalingProtocol","asyncToGeneratorRuntime","gkx","nullthrows","randomZenonNonce"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a===null)throw new(d("ZenonCallWindowErrors").UninitializedError)();var e=a.callInviteModel;a=a.callWindowController;var f=e.getCurrentInvite();if(f===null)throw new(d("ZenonCallWindowErrors").InviteNotFoundError)();if(f.type!=="ringing"||f.context.type!=="thread")throw new(d("ZenonCallWindowErrors").CannotAcceptInviteError)();var g=c("randomZenonNonce")(),h=f.context.thread;a=a.initCall({context:{controllerParams:f.controllerParams,intent:"accept invite"},hideE2eeAttributions:b,isE2eeMandated:f.isE2eeMandated,joinContext:{thread:h!=null?h:{id:"0",type:2},type:"thread"},mediaType:f.requestingVideo?"video":"audio",nonce:g,representedID:f.receiverUserId});b=a[0];h=a[1];e.accept(g,{isPopupBlocked:b===null});yield h});return i.apply(this,arguments)}function e(a,b,c,d,e,f){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g,h){h===void 0&&(h={allowAnonymousGuests:!c("gkx")("20836")});if(a===null)throw new(d("ZenonCallWindowErrors").UninitializedError)();p(g,e,f).setEvent("meetup_attempt_create_meetup").log();try{a=(yield c("MessengerCreateVideoMeetupLinkMutation")(b,h,g));b=a.linkUrl;if(b!=null){p(g,e,f).setEvent("meetup_create_success").setVideoCallLinkURLRaw(b).log();return b}else p(g,e,f).setEvent("meetup_create_failed").log();return b}catch(a){p(g,e,f).setEvent("meetup_create_failed").log();p(g,e,f).setEvent("error").setErrorType("LinkCreationError "+a.name).setErrorDetails(a.description).log();throw a}});return j.apply(this,arguments)}function f(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.actorID,f=a.callback_users,g=a.context,i=a.forceSkipChildLobby;i=i===void 0?!1:i;var j=a.funnelSessionID;j=j===void 0?null:j;var k=a.hasVideo;k=k===void 0?!0:k;var l=a.linkUrl,m=a.referrerContext;m=m===void 0?null:m;var p=a.skipLinkUrlRewrite;p=p===void 0?!1:p;var q=a.startCallImmediately;q=q===void 0?!1:q;a=a.trigger;if(g===null)throw new(d("ZenonCallWindowErrors").UninitializedError)();var r=g.callWindowController;g=g.incomingRingSDK;var s=c("randomZenonNonce")(),t=d("ZenonCallIdentifiersUtil").generateZenonClientSessionID(),u=l;if(!p){p=(p=d("ConstUriUtils").getUri(l))==null?void 0:p.getQueryParam("funnel_session_id");l=n(l);u=o(l,q?s:null,f,p!=null?String(p):j,i,m,e,a,k)}if(u==null)return(h||(h=b("Promise"))).reject("An invalid URI was provided");l=r.initCall({context:{existingCall:null,intent:"start or join",invitees:[],signalingID:t},joinContext:{linkUrl:u,type:"link"},mediaType:"video",nonce:s,representedID:d("ZenonActorHooks").ZenonActor.getID()});q=l[0];f=l[1];g.startCallIntent(s,{callTrigger:a!=null?a:"meetup_join",isE2eeMandated:!1,isPopupBlocked:q===null,isVideo:k,peerID:d("ZenonPeerID").ZenonMWPeerID,protocol:c("ZenonSignalingProtocol").MW,signalingID:t});yield f});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var e=b.existingCall,f=b.extra,g=b.hideE2eeAttributions,h=b.invitees,i=b.isE2eeMandated,j=b.mediaType,k=b.representedID,l=b.thread;b=b.trigger;if(a===null)throw new(d("ZenonCallWindowErrors").UninitializedError)();var m=a.callWindowController;a=a.incomingRingSDK;var n=d("ZenonCallIdentifiersUtil").generateZenonClientSessionID(),o=c("randomZenonNonce")();m=m.initCall({context:{existingCall:e,intent:"start or join",invitees:h,signalingID:n},extra:f,hideE2eeAttributions:g,isE2eeMandated:i,joinContext:{thread:l,type:"thread"},mediaType:j,nonce:o,representedID:k!=null?k:d("ZenonActorHooks").ZenonActor.getID()});e=m[0];h=m[1];a.startCallIntent(o,{callTrigger:b,isE2eeMandated:i!=null?i:!1,isPopupBlocked:e===null,isVideo:j==="video",peerID:l.type===1?l.id:d("ZenonPeerID").ZenonMWPeerID,protocol:c("ZenonSignalingProtocol").MW,signalingID:n});yield h});return m.apply(this,arguments)}function n(a){var b=d("RoomsLinkUtils").getRoomsLinkHash(a);b==null&&c("FBLogger")("rtc_www").mustfix('Could not extract LinkHash from Video Chat Link. Link = "%s"',a);return b}function o(a,b,d,e,f,g,h,i,j){if(a==null)return"";a={call_context:"LINK:"+a,call_trigger:i!=null?i:"",has_video:j,users_to_ring:d!=null?d:[]};b!=null&&(a.nonce=b);e!=null&&(a.funnel_session_id=e);f===!0&&(a.auto_join=!0);g!=null&&(a.referrer_context=g);h!=null&&(a.av=h);return c("nullthrows")(c("XGroupCallControllerRouteBuilder").buildUri(a).getQualifiedUri()).toString()}function p(a,b,d){return new(c("VideoChatLinksUserActionsMultiplexLogger"))().setFunnelSessionIDRaw(a).setSurface(b).setComponent(d)}g.acceptCall=a;g.createMeetup=e;g.joinMeetup=f;g.startCall=l}),98);
__d("useZenonCallInvite",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect,j=b.useState;function a(a){var b=j(function(){return a?a.getCurrentInvite():null}),c=b[0],d=b[1];i(function(){if(a){var b=a.addListener("callInvite",d);return function(){b.remove()}}else d(null)},[a]);return c}g["default"]=a}),98);
__d("ZenonPreCallHookBuilder",["CometRelay","FBLogger","Promise","ZenonPreCallHookBuilderHelper","err","gkx","promiseDone","react","useZenonCallInvite"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k=j.useCallback,l=j.useContext,m=j.useDebugValue,n=j.useEffect,o=6e4;function a(a){function b(b){var c=l(a);return k(function(){return d("ZenonPreCallHookBuilderHelper").acceptCall(c,b)},[c,b])}return b}function e(a){function b(){var b=l(a);b=c("useZenonCallInvite")(b?b.callInviteModel:null);m(b);return b}return b}function f(a,b){return function(d,e,f){function g(){var g=l(a),h=d(),i=e(),j=f(),m=b();return k(function(a){if(!c("gkx")("24231"))return;var b=a.existingCall,d=a.thread;if(!g||!g.incomingRingSDK.isCallSupported({threadType:d.type,type:"thread"}))j(a);else switch(d.type){case 1:c("promiseDone")(m(babelHelpers["extends"]({},a,{invitees:[d.id]})));break;case 15:if(d.secureOneToOneThreadPeerId==null)throw c("err")("secureOneToOneThreadPeerId should be defined when starting a call from a secure 1:1 thread");c("promiseDone")(m(babelHelpers["extends"]({},a,{invitees:[d.secureOneToOneThreadPeerId]})));break;case 2:case 16:b===null||b.call_state==="NO_ONGOING_CALL"?h(a,function(b){c("promiseDone")(m(babelHelpers["extends"]({},a,{invitees:b})))}):c("gkx")("13856")?i(a,function(){c("promiseDone")(m(babelHelpers["extends"]({},a,{invitees:[]})))}):c("promiseDone")(m(babelHelpers["extends"]({},a,{invitees:[]})));break;default:c("FBLogger")("rtc_www").blameToPreviousFrame().mustfix("Attempted to start RTC call for unsupported thread type %d",d.type)}},[g,h,j,m,i])}return g}}function p(a,b){function c(){var c=l(a),d=b();n(function(){if(c&&d&&d.type==="ringing"){var a=window.setTimeout(function(){c.callInviteModel.decline("NoAnswerTimeout")},o);return function(){window.clearTimeout(a)}}},[c,d])}return c}function q(a){function e(){var e=l(a);return k(function(a){var f=a.existingCall,g=a.extra,i=a.hideE2eeAttributions,j=a.invitees,k=a.isE2eeMandated,l=a.mediaType,m=a.representedID,n=a.thread;a=a.trigger;return!c("gkx")("24231")?(h||(h=b("Promise"))).resolve():d("ZenonPreCallHookBuilderHelper").startCall(e,{existingCall:f,extra:g,hideE2eeAttributions:i,invitees:j,isE2eeMandated:k,mediaType:l,representedID:m,thread:n,trigger:a})},[e])}return e}function r(a){function e(){var e=l(a),f=d("CometRelay").useRelayEnvironment();return k(function(a,g,i,j){return!c("gkx")("24231")?(h||(h=b("Promise"))).resolve(null):d("ZenonPreCallHookBuilderHelper").createMeetup(e,f,a,g,i,j)},[e,f])}return e}function s(a){function e(){var e=l(a);return k(function(a,f){f===void 0&&(f={});if(!c("gkx")("24231"))return(h||(h=b("Promise"))).resolve();f=(f=f)!=null?f:{};var g=f.actorID,i=f.callbackUsers,j=f.mediaType,k=f.referrerContext,l=f.startCallImmediately;f=f.trigger;return d("ZenonPreCallHookBuilderHelper").joinMeetup({actorID:g,callback_users:i,context:e,forceSkipChildLobby:!1,hasVideo:j!=null?j==="video":!0,linkUrl:a,referrerContext:k,startCallImmediately:l,trigger:f})},[e])}return e}g.createAcceptCallCallbackHook=a;g.createCallInviteHook=e;g.createInviteAndStartCallCallbackHookFactory=f;g.createNoAnswerTimeoutHook=p;g.createStartCallCallbackHook=q;g.createCreateMeetupCallbackHook=r;g.createJoinMeetupCallbackHook=s}),98);
__d("IGWebPreCallHooks",["IGWebPreCallContext","ZenonPreCallHookBuilder"],(function(a,b,c,d,e,f,g){"use strict";a=d("ZenonPreCallHookBuilder").createAcceptCallCallbackHook(c("IGWebPreCallContext"));b=d("ZenonPreCallHookBuilder").createCallInviteHook(c("IGWebPreCallContext"));e=d("ZenonPreCallHookBuilder").createStartCallCallbackHook(c("IGWebPreCallContext"));g.useAcceptCallCallback=a;g.useCallInvite=b;g.useStartCallCallback=e}),98);
__d("LSBeginHandlingSyncForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(e){return b.sequence([function(d){return b.db.table(1).fetch([[[a[0]]]]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[0]=void 0:(d=a.item,c[9]=new b.Map(),c[9].set("group_id",d.groupId),c[9].set("current_cursor",d.currentCursor),c[9].set("sync_status",d.syncStatus),c[9].set("sync_params",d.syncParams),c[9].set("send_sync_params",d.sendSyncParams),c[9].set("min_time_to_sync_timestamp_ms",d.minTimeToSyncTimestampMs),c[9].set("can_ignore_timestamp",d.canIgnoreTimestamp),c[9].set("sync_channel",d.syncChannel),c[9].set("last_sync_request_timestamp_ms",d.lastSyncRequestTimestampMs),c[0]=c[9])})},function(d){return c[0]?c[2]=!1:c[2]=!0,c[2]?b.resolve((d=[a[0],void 0,b.i64.cast([0,4]),void 0,!1],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=d[3],c[7]=d[4],d)):b.sequence([function(a){return c[9]=c[0].get("group_id"),b.filter(b.db.table(3).fetch(),function(a){return b.i64.neq(a.epochId,void 0)&&b.i64.eq(a.syncDatabaseId,c[9])}).next().then(function(a,b){b=a.done;a=a.value;return b?c[10]=!1:(a.item,c[10]=!0)})},function(d){return c[10]?b.resolve((c[17]=c[0].get("group_id"),d=[c[17],void 0,b.i64.cast([0,4]),void 0,!1],c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=d[3],c[16]=d[4],d)):b.sequence([function(d){return c[17]=b.i64.of_float(Date.now()),c[18]=c[0].get("min_time_to_sync_timestamp_ms"),c[19]=c[0].get("last_sync_request_timestamp_ms"),c[20]=c[0].get("can_ignore_timestamp"),c[20]&&a[1]||b.i64.ge(c[17],c[18])?b.sequence([function(d){return a[1]?b.resolve(c[28]=b.i64.cast([0,0])):b.sequence([function(a){return c[29]=c[0].get("group_id"),b.db.table(3).fetch([[["",c[29]]]]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[30]=b.i64.cast([0,0]):(d=a.item,c[30]=d.failureCount)})},function(a){return c[32]=b.i64.mul(b.i64.sub(b.i64.lsl_(b.i64.cast([0,1]),b.i64.to_int32(b.i64.lt(b.i64.cast([0,15]),c[30])?b.i64.cast([0,15]):c[30])),b.i64.cast([0,1])),b.i64.cast([0,500])),c[33]=b.i64.sub(b.i64.add(c[19]==null?b.i64.cast([0,0]):c[19],b.i64.lt(c[32],b.i64.cast([0,3e4]))?c[32]:b.i64.cast([0,3e4])),c[17]),c[28]=b.i64.gt(c[33],b.i64.cast([0,0]))?c[33]:b.i64.cast([0,0])}])},function(a){return c[21]=c[28]}]):b.resolve(c[21]=b.i64.sub(c[18],c[17]))},function(a){return c[22]=c[0].get("group_id"),b.i64.gt(c[21],b.i64.cast([0,0]))?b.sequence([function(a){return c[28]=b.i64.of_float(Date.now()),b.forEach(b.filter(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[22])}),function(a){var b=a.update;a.item;return b({lastDelayedRequestTimestampMs:c[28]})})},function(a){return a=[c[22],c[21],b.i64.cast([0,3]),void 0,!1],c[23]=a[0],c[24]=a[1],c[25]=a[2],c[26]=a[3],c[27]=a[4],a}]):b.sequence([function(a){return c[28]=b.i64.of_float(Date.now()),b.forEach(b.db.table(1).fetch([[[c[22]]]]),function(a){var b=a.update;a.item;return b({lastSyncRequestTimestampMs:c[28]})})},function(a){return c[29]=b.i64.of_float(Date.now()),b.forEach(b.filter(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[22])}),function(a){var b=a.update;a.item;return b({lastSyncRequestTimestampMs:c[29]})})},function(a){return c[30]=c[0].get("group_id"),c[31]=b.i64.of_float(Date.now()),c[32]=b.i64.random(),c[45]=b.i64.and_(b.i64.or_(b.i64.lsl_(c[31],b.i64.to_int32(b.i64.cast([0,22]))),b.i64.and_(c[32],b.i64.cast([0,4194303]))),b.i64.cast([2147483647,4294967295])),b.db.table(3).fetch([[["",c[30]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?b.db.table(3).add({syncDatabaseId:c[30],taskQueueName:"",failureCount:b.i64.cast([0,0]),lastSentTimestampMs:b.i64.cast([0,0]),lastSyncRequestTimestampMs:b.i64.cast([0,0]),epochId:c[45]}):(a.item,b.forEach(b.db.table(3).fetch([[["",c[30]]]]),function(a){var b=a.update;a.item;return b({epochId:c[45]})}))})},function(a){return c[34]=c[0].get("group_id"),b.db.table(3).fetch([[["",c[34]]]]).next().then(function(a,d){var e=a.done;a=a.value;return e?c[35]=b.i64.cast([0,0]):(d=a.item,c[35]=d.failureCount)})},function(a){return c[37]=c[0].get("send_sync_params"),c[38]=c[0].get("sync_params"),c[39]=c[0].get("current_cursor"),c[40]=new b.Map(),c[40].set("database",c[34]),c[40].set("version",b.i64.cast([-1,4294967295])),c[40].set("epoch_id",c[45]),c[40].set("last_applied_cursor",c[39]),c[40].set("sync_params",c[37]?c[38]:void 0),c[40].set("failure_count",b.i64.gt(c[35],b.i64.cast([0,0]))?c[35]:void 0),c[41]=c[0].get("current_cursor"),void 0===c[41]?c[42]=b.i64.cast([0,1]):c[42]=b.i64.cast([0,2]),c[43]=new b.Map(),c[43].set("type",c[42]),c[43].set("request_payload",c[40]),c[44]=c[0].get("sync_channel"),a=[c[30],void 0,b.i64.cast([0,1]),c[43],b.i64.eq(c[44],b.i64.cast([0,2]))],c[23]=a[0],c[24]=a[1],c[25]=a[2],c[26]=a[3],c[27]=a[4],a}])},function(a){return a=[c[23],c[24],c[25],c[26],c[27]],c[12]=a[0],c[13]=a[1],c[14]=a[2],c[15]=a[3],c[16]=a[4],a}])},function(a){return a=[c[12],c[13],c[14],c[15],c[16]],c[3]=a[0],c[4]=a[1],c[5]=a[2],c[6]=a[3],c[7]=a[4],a}])},function(a){return c[8]=new b.Map(),c[8].set("sync_group_id",c[3]),c[8].set("next_sync_ms",c[4]),c[8].set("work_item_type",c[5]),c[8].set("network_payload",c[6]),c[8].set("skip_realtime_gateway",c[7]),d[0]=c[8]}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreBeginHandlingSyncForSyncGroupStoredProcedure";a.__tables__=["sync_groups","network_requests"];e.exports=a}),null);
__d("LSBeginHandlingSync",["LSBeginHandlingSyncForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.createArray(),c.forEach(c.db.table(1).fetch(),function(e){var f=e.item;return c.sequence([function(e){return c.storedProcedure(b("LSBeginHandlingSyncForSyncGroup"),f.groupId,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSCoreBeginHandlingSyncStoredProcedure";a.__tables__=["sync_groups"];e.exports=a}),null);
__d("LSBeginHandlingSyncForSyncGroupStoredProcedure",["LSBeginHandlingSyncForSyncGroup","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSBeginHandlingSyncForSyncGroup"),e.syncGroupId,e.ignoreSoftDelay);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSBeginHandlingSyncStoredProcedure",["LSBeginHandlingSync","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSBeginHandlingSync"),e.ignoreSoftDelay);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSCheckThreadConsistency",["LSIssueNewFireAndForgetTask","LSIssueNewTask","gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(f){return c("gkx")("15730")?(e[0]=new d.Map(),e[0].set("threads",a[0]),e[0].set("metadata",a[1]),e[1]=d.toJSON(e[0]),d.storedProcedure(b("LSIssueNewFireAndForgetTask"),"fire_forget",d.i64.cast([0,18]),e[1])):(e[0]=new d.Map(),e[0].set("threads",a[0]),e[0].set("metadata",a[1]),e[1]=d.toJSON(e[0]),d.storedProcedure(b("LSIssueNewTask"),"check-thread-consistency",d.i64.cast([0,160019]),e[1],void 0,void 0,d.i64.cast([0,0]),d.i64.cast([0,0]),void 0,void 0,d.i64.cast([0,0]),d.i64.cast([0,0])))},function(a){return d.resolve(f)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxCheckThreadConsistencyStoredProcedure";a.__tables__=[];d=a;g["default"]=d}),98);
__d("LSCheckThreadConsistencyStoredProcedure",["LSCheckThreadConsistency","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSCheckThreadConsistency"),e.threads,e.metadata);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSPlatformEvaluateInitSyncEagerly",["ExecutionEnvironment","LSClearEpochBeforeResumeSync","LSDatabaseProviderType","LSPlatformDeviceId","LSPlatformHardcodedInitSync","LSPlatformLsInitLog","asyncToGeneratorRuntime","cr:3411","qex","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){d("LSPlatformLsInitLog").addPoint("ds_eval_registration");e=(yield e());var f;try{f=b("cr:3411")!=null?b("cr:3411").registerEval(e)()(a):e()(a)}catch(b){c("recoverableViolation")("fail to register datascriptEvaluator","ls_web_init",{error:b}),f=e()(a)}d("LSPlatformLsInitLog").addPoint("ds_eval_registration_end");return f});return function(b,c){return a.apply(this,arguments)}}();function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!(h||(h=c("ExecutionEnvironment"))).canUseDOM&&!c("qex")._("3809"))return!1;if(!a.sendHardcodedInitSync)return!1;var b=a.eagerEvaluatorForInitSync;if(b==null)return!1;var e=(yield a.getDb());if(d("LSDatabaseProviderType").isProviderPersisted(e))return!1;d("LSPlatformLsInitLog").addPoint("evaluate_init_sync_start");var f=d("LSPlatformDeviceId").getDeviceIdForProviderType("ephemeral");b=(yield i(e,b));yield d("LSClearEpochBeforeResumeSync").call(e);yield d("LSPlatformHardcodedInitSync").sendHardcodedInitSync(a,b,e,f);d("LSPlatformLsInitLog").addPoint("evaluate_init_sync_end");return!0});return j.apply(this,arguments)}g.getDatascriptEvaluator=i;g.maybeEvaluateInitSyncEagerly=a}),98);
__d("LSPlatformLogTooManyPendingTasksForS337085.react",["FBLogger","MWPBumpEntityKey","ReQL","clearTimeout","gkx","justknobx","promiseDone","react","setTimeout","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");var j=b.useEffect,k=b.useRef,l=c("justknobx")._("1134"),m=c("justknobx")._("1135"),n=c("gkx")("24156");function a(){var a=(h||(h=c("useReStore")))(),b=k(null),e=k(!1);j(function(){var f=a.tables.pending_tasks.subscribe(function(){c("promiseDone")(d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.tables.pending_tasks).take(l)),function(a){var f=a.length;if(f===l){if(b.current!=null)return;b.current=c("setTimeout")(function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_tasks","tasks_table_above_threshold"),e.current=!0,n&&c("FBLogger")("lsplatform_tasks","tasks_table_above_threshold").warn("pending tasks table is above threshold. It has %s tasks after %s ms",f,m)},m)}else c("clearTimeout")(b.current),e.current&&n&&c("FBLogger")("lsplatform_tasks","tasks_table_cleared").warn("pending tasks table is now cleared"),e.current=!1})});return function(){f()}},[a]);return null}g["default"]=a}),98);
__d("LSPlatformSyncSystem",["FBLogger","I64","LSBeginHandlingSyncForSyncGroupStoredProcedure","LSBeginHandlingSyncStoredProcedure","LSDatabaseProviderType","LSFactory","LSIntEnum","LSJson","LSMailboxInitialSyncCursor","LSPlatformGraphQLTransport","LSPlatformRealtimeTransport","LSPlatformRequestId","LSPlatformRequestScheduler","LSPlatformServerResponseHandler","LSShape","LSVec","MWPBumpEntityKey","MessengerLogHistory","Promise","ReQL","asyncToGeneratorRuntime","gkx","promiseDone","qex","recoverableViolation","throttle"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,e,g,k,l,m){var n=d("MessengerLogHistory").getInstance("client_sync"),o=new(c("LSPlatformServerResponseHandler"))(g),p=d("LSDatabaseProviderType").isProviderPersisted(a),q=function(c){return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.network_requests).getKeyRange("",c)));b!=null&&(yield a.network_requests.put({epochId:void 0,failureCount:(i||(i=d("I64"))).add(b.failureCount,i.one),lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs,lastSentTimestampMs:b.lastSentTimestampMs,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,networkTaskIdentifier:b.networkTaskIdentifier,syncDatabaseId:b.syncDatabaseId,taskQueueName:b.taskQueueName}))});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":76")},r=new(c("LSPlatformRequestScheduler"))(),s=function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(f,n){n=d("LSShape").toRecord(n);var q=d("LSShape").toRecord(n.request_payload);n=n.type;var r=c("LSPlatformRequestId").generate(),s=d("LSJson").stringify(d("LSShape").ofRecord({database:q.database,epoch_id:q.epoch_id,failure_count:q.failure_count,last_applied_cursor:q.last_applied_cursor,sync_params:q.sync_params,version:(i||(i=d("I64"))).of_string(k)})),t=(i||(i=d("I64"))).equal(f.sync_group_id,(j||(j=d("LSIntEnum"))).ofNumber(1))&&c("gkx")("26386")===!0;if(!t&&f.skip_realtime_gateway){t=(yield d("LSPlatformGraphQLTransport").publish(l,r,n,s,m));var u=t[0],v=t[1],w=t[2];t=t[3];w={experiments:w,syncScript:v,target:t};return p?o.maybeEvalInOrderReceived(u,w):g(w)}else{v=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.sync_groups).getKeyRange(f.sync_group_id)));t=v!=null?v.syncChannel:d("LSMailboxInitialSyncCursor").syncChannel;v!=null&&(j||(j=d("LSIntEnum"))).toNumber(v.syncChannel)!==(i||(i=d("I64"))).to_int32(d("LSMailboxInitialSyncCursor").syncChannel)&&e.logEvent("Sync channel mismatch between "+(j||(j=d("LSIntEnum"))).toNumber(v.syncChannel)+" and "+(i||(i=d("I64"))).to_int32(d("LSMailboxInitialSyncCursor").syncChannel));u=c("qex")._("789");if(v!=null&&u!=null&&u!=="default"){w=(j||(j=d("LSIntEnum"))).unwrapIntEnum(n);if(1===w||2===w||5===w){f=u+"."+(j||(j=d("LSIntEnum"))).toNumber(t)+"."+j.toNumber(n)+"."+j.toNumber(v.groupId);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("messenger.lightspeed",f)}}w=(i||(i=d("I64"))).to_int32(q.database);return e.publish({databaseType:w,payload:s,queueName:void 0,requestId:r,syncChannel:t,type_:n}).then(function(){return(h||(h=b("Promise"))).resolve()})}});return function(a,b){return f.apply(this,arguments)}}(),t=function e(g){var k=function(b){return a.runInTransaction(function(a){return c("LSBeginHandlingSyncForSyncGroupStoredProcedure")(c("LSFactory")(a),{ignoreSoftDelay:!1,syncGroupId:b})},"readwrite",void 0,void 0,f.id+":216").then(function(a){return e(a[0])})},l=function(a,b){r.schedule(function(){c("promiseDone")(k(a))},(i||(i=d("I64"))).to_string(a),i.to_float(b))},m=d("LSShape").toRecord(g);g=m.work_item_type;if((i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(1))||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(5))){var o=c("qex")._("789");if(o!=null&&o!=="default"){var p=o+"."+(j||(j=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",p)}var t=m.network_payload;if(t!=null)return s(m,t)["catch"](function(a){if(o!=null&&o!=="default"){var b=o+"."+(j||(j=d("LSIntEnum"))).toNumber(d("LSMailboxInitialSyncCursor").syncChannel);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",b+".exception");a.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout?d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",b+".exception.timeout"):a.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected&&d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync",b+".exception.notconnected")}if(a.message===d("LSPlatformGraphQLTransport").ServerError)d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_graphql_error");else if(a.RE_EXN_ID===d("LSPlatformRealtimeTransport").Timeout||a.RE_EXN_ID===d("LSPlatformRealtimeTransport").NotConnected)d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_timeout_or_disc"),n.debug("Publish timed out");else{d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_other_error");if(a instanceof Error)c("FBLogger")("messenger_web").catching(a).mustfix("Encountered an JS error while publishing a LS sync request");else{b="";try{b=JSON.stringify(a)}catch(a){}c("FBLogger")("messenger_web").mustfix("Encountered an JS error while publishing a LS sync request %s",b)}}d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","handleSyncFailure."+(j||(j=d("LSIntEnum"))).toNumber(d("LSShape").toRecord(t).type)+"."+j.toNumber(m.sync_group_id));return q(m.sync_group_id).then(function(){return k(m.sync_group_id)})});else{c("recoverableViolation")("Expected networkpayload for sync request but didn't get any","ls_web_init");return(h||(h=b("Promise"))).resolve()}}if(!(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(3)))if((i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(4))||!(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(2)))return(h||(h=b("Promise"))).resolve();else{c("recoverableViolation")("Native handling for sync group not implemented yet","ls_web_init");return(h||(h=b("Promise"))).resolve()}p=m.next_sync_ms;if(p!=null){l(m.sync_group_id,p);return(h||(h=b("Promise"))).resolve()}else{c("recoverableViolation")("Expected delay for delayed sync request but didn't get any","ls_web_init");return(h||(h=b("Promise"))).resolve()}},u=function(a){return(h||(h=b("Promise"))).all(c("LSVec").toArray(a[0]).map(function(a){return t(a)}))},v=function(){c("promiseDone")(a.runInTransaction(function(a){return c("LSBeginHandlingSyncStoredProcedure")(c("LSFactory")(a),{ignoreSoftDelay:!1})},"readwrite",void 0,void 0,f.id+":397").then(u))},w=c("throttle")(v,500);v=function(){return d("ReQL").fromTableAscending(a.tables.sync_groups).subscribe(function(){return w()})};var x=function(){return e.subscribeToNonTaskResponses(function(a,b){var e=b.ex,f=b.payload;e={experiments:e,sp:b.sp,syncScript:f,target:b.target};c("promiseDone")(p?o.maybeEvalInOrderReceived(a,e):c("gkx")("10470")?o.maybeEvalInOrderReceived(a,e):g(e),function(){return w()},function(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","handle_sync_response_failure");if(a instanceof Error)c("FBLogger")("messenger_web").catching(a).mustfix("JS error encountered handling response from MQTT (pdb=%s): %s",p,a.message);else{var b="";try{b=JSON.stringify(a)}catch(a){}c("FBLogger")("messenger_web").mustfix("JS error encountered handling response from MQTT (pdb=%s): %s",p,b)}})})},y=function(){return e.onReconnect(function(){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform_sync","resume_sync_reconnect"),n.debug("Sync System reconnecting"),c("promiseDone")(a.runInTransaction(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e){var f;f=(yield (f=d("ReQL")).toArrayAsync(f.mergeJoin(f.fromTableAscending(a.tables.sync_groups),f.fromTableAscending(a.tables.network_requests).getKeyRange(""))));yield (h||(h=b("Promise"))).all(f.map(function(a){a=a[1];return e.network_requests.put({epochId:void 0,failureCount:a.failureCount,lastDelayedRequestTimestampMs:a.lastDelayedRequestTimestampMs,lastSentTimestampMs:a.lastSentTimestampMs,lastSyncRequestTimestampMs:a.lastSyncRequestTimestampMs,networkTaskIdentifier:a.networkTaskIdentifier,syncDatabaseId:a.syncDatabaseId,taskQueueName:a.taskQueueName})}));return c("LSBeginHandlingSyncStoredProcedure")(c("LSFactory")(e),{ignoreSoftDelay:!1})});return function(a){return e.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":492").then(u))})},z=v(),A=x(),B=y();w();return{cleanup:function(){z(),B(),A()}}}g["default"]=a}),98);
__d("MAWBridgeInitOfflineQueueSyncCompleteHandler",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("MessengerLogHistory").__setRef("MAWBridgeInitOfflineQueueSyncCompleteHandler");function a(){h.onReady(function(a){a=a.getInstance("maw_setup");a.debug("Init Offline Queue Sync Complete")})}g.call=a}),98);
__d("MAWThreadConsistencyLogger",["FBLogger","I64","LSAuthorityLevel","LSCheckThreadConsistencyStoredProcedure","LSDatabaseSingleton","LSFactory","LSMessagingThreadTypeUtil","LSShape","LSVec","ODS","Promise","ReQL","WAArrayZip","asyncToGeneratorRuntime","clearInterval","gkx","justknobx","promiseDone","qex","setInterval"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=20,m=c("justknobx")._("3207"),n=!c("gkx")("5457"),o=!1,p=null;function a(){if(o||n)return;o=!0;c("clearInterval")(p);p=c("setInterval")(function(){if(document.visibilityState!=="visible")return;c("promiseDone")(q())},m*1e3)}function q(){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton);c("promiseDone")(a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){(k||(k=d("ODS"))).bumpEntityKey(3185,"maw_tc_metric","initiate_snapshot");var e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.threads.index("lastActivityTimestampMs")).filter(s).take(l)));if(e.length===0){(k||(k=d("ODS"))).bumpEntityKey(3185,"maw_tc_metric","no_e2ee_threads_fetched_on_client");return}var f;c("qex")._("18")?f=(yield (h||(h=b("Promise"))).all(e.map(function(b){return d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.messages.index("messageDisplayOrderOfflineThreadingId")).getKeyRange(b.threadKey))}))):f=(yield (h||(h=b("Promise"))).all(e.map(function(b){return d("ReQL").firstAsync(d("ReQL").fromTableDescending(a.messages.index("messageDisplayOrder")).getKeyRange(b.threadKey))})));e=d("WAArrayZip").zip(e,f).map(function(a){var b=a[0];a=a[1];return d("LSShape").ofRecord({is_last_activity_optimistic:t(a),last_activity_timestamp_ms:b.lastActivityTimestampMs,last_read_timestamp_ms:b.lastReadWatermarkTimestampMs,thread_key:b.threadKey})});return c("LSCheckThreadConsistencyStoredProcedure")(c("LSFactory")(a),{metadata:d("LSShape").ofRecord({client_snapshot_timestamp_ms:(j||(j=d("I64"))).of_float(Date.now()),session_timestamp_ms:j.of_int32(Math.round(window.performance.now()))}),threads:c("LSVec").ofArray(e)})});return function(b){return a.apply(this,arguments)}}(),"readonly",void 0,void 0,f.id+":59"),function(){return(k||(k=d("ODS"))).bumpEntityKey(3185,"maw_tc_metric","send_snapshot")},function(a){c("FBLogger")("maw_tc_metric").catching(a).warn("failed to send tc metric snapshot")})});return r.apply(this,arguments)}function s(a){return d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)&&a.folderName==="inbox"&&(j||(j=d("I64"))).to_int32(a.authorityLevel)>=c("LSAuthorityLevel").AUTHORITATIVE}function t(a){return a==null?!1:(j||(j=d("I64"))).to_int32(a.authorityLevel)<c("LSAuthorityLevel").AUTHORITATIVE}g.startMAWThreadConsistencyLogger=a;g.MAWThreadConsistencyLoggerTakeSnapshot=q}),98);
__d("XPolarisCallControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/call/",Object.freeze({has_video:!0,is_e2ee_mandated:!1,hide_e2ee_attributions:!1,users_to_ring:[]}),void 0);b=a;g["default"]=b}),98);
__d("PolarisCallNavigator",["PolarisAPIHelpers","PolarisCallGatingHelpers","PolarisNavigationUtils","XPolarisCallControllerRouteBuilder"],(function(a,b,c,d,e,f,g){"use strict";var h="https://call.instagram.com";function a(a,b,e){e===void 0&&(e=null);e=e===""?null:e;var f;d("PolarisCallGatingHelpers").isCallsPathMigrationEnabled()?e!=null?f=c("XPolarisCallControllerRouteBuilder").buildURL({has_video:b,ig_thread_id:a,server_info_data:e}):f=c("XPolarisCallControllerRouteBuilder").buildURL({has_video:b,ig_thread_id:a}):f=d("PolarisAPIHelpers").appendQueryParameters(h,{has_video:b,ig_thread_id:a,server_info_data:e});d("PolarisNavigationUtils").openURLWithFullPageReload(f,{openInNewTab:!0})}g.launchCall=a}),98);
__d("RealtimeNexusSessionDataTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({MESSENGER_CP:0,NON_MESSENGER_CP:1,MESSENGER_MQTT:2,NON_MESSENGER_MQTT:3});d=a({ACTIVE:1,IDLE:2,OFFLINE:3});f=a({MQTT:1,SESSION_MESSAGE_HANDLER:2,PRESENCE_HANDLER:3,RTC_SESSION_MESSAGE_HANDLER:4,WWW:5,PRESENCE_STREAM_CONTROLLER:6,RPSIGNALING:7,DGW:8});b=a({FbId:"fbId",IgId:"igId"});e.exports={BuddyListSessionType:c,PresenceAvailability:d,SessionOwnerId$Types:b,SessionType:f}}),null);
__d("VideoChatLinksUserActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:VideoChatLinksUserActionsLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,{},a);return this};c.setCallEndReason=function(a){this.$1.call_end_reason=a;return this};c.setCallID=function(a){this.$1.call_id=a;return this};c.setCameraEnabled=function(a){this.$1.camera_enabled=a;return this};c.setClientAppVersion=function(a){this.$1.client_app_version=a;return this};c.setClientLockStatus=function(a){this.$1.client_lock_status=a;return this};c.setClientMonoTimeMs=function(a){this.$1.client_mono_time_ms=a;return this};c.setClienttime=function(a){this.$1.clienttime=a;return this};c.setComponent=function(a){this.$1.component=a;return this};c.setConferenceNameRaw=function(a){this.$1.conference_name_raw=a;return this};c.setCreationAction=function(a){this.$1.creation_action=a;return this};c.setErrorDetails=function(a){this.$1.error_details=a;return this};c.setErrorType=function(a){this.$1.error_type=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setEventDetails=function(a){this.$1.event_details=b("GeneratedLoggerUtils").serializeMap(a);return this};c.setEventFireTimestamp=function(a){this.$1.event_fire_timestamp=a;return this};c.setEventFireTimestampOnClient=function(a){this.$1.event_fire_timestamp_on_client=a;return this};c.setExceptionObject=function(a){this.$1.exception_object=a;return this};c.setExperimentsEnabled=function(a){this.$1.experiments_enabled=b("GeneratedLoggerUtils").serializeMap(a);return this};c.setFalcoBatchSequence=function(a){this.$1.falco_batch_sequence=a;return this};c.setFunnelSessionIDRaw=function(a){this.$1.funnel_session_id_raw=a;return this};c.setGroupID=function(a){this.$1.group_id=a;return this};c.setGroupSize=function(a){this.$1.group_size=a;return this};c.setGuestUserID=function(a){this.$1.guest_user_id=a;return this};c.setKickedUserID=function(a){this.$1.kicked_user_id=a;return this};c.setLinkShareTo=function(a){this.$1.link_share_to=a;return this};c.setLocalCallID=function(a){this.$1.local_call_id=a;return this};c.setMediaDevices=function(a){this.$1.media_devices=a;return this};c.setMicrophoneEnabled=function(a){this.$1.microphone_enabled=a;return this};c.setOpenLinkFrom=function(a){this.$1.open_link_from=a;return this};c.setOpenLinkFromAppVersion=function(a){this.$1.open_link_from_app_version=a;return this};c.setReason=function(a){this.$1.reason=a;return this};c.setReferralSurface=function(a){this.$1.referral_surface=a;return this};c.setRoomIDRaw=function(a){this.$1.room_id_raw=a;return this};c.setServerInfoData=function(a){this.$1.server_info_data=a;return this};c.setSource=function(a){this.$1.source=a;return this};c.setStatus=function(a){this.$1.status=a;return this};c.setSurface=function(a){this.$1.surface=a;return this};c.setTargetedUserIds=function(a){this.$1.targeted_user_ids=b("GeneratedLoggerUtils").serializeVector(a);return this};c.setThreadSyncRoomData=function(a){this.$1.thread_sync_room_data=b("GeneratedLoggerUtils").serializeMap(a);return this};c.setThreadType=function(a){this.$1.thread_type=a;return this};c.setUserIdsToBeRemoved=function(a){this.$1.user_ids_to_be_removed=b("GeneratedLoggerUtils").serializeVector(a);return this};c.setVideoCallLinkHashRaw=function(a){this.$1.video_call_link_hash_raw=a;return this};c.setVideoCallLinkIDRaw=function(a){this.$1.video_call_link_id_raw=a;return this};c.setVideoCallLinkIdentifierRaw=function(a){this.$1.video_call_link_identifier_raw=a;return this};c.setVideoCallLinkURLRaw=function(a){this.$1.video_call_link_url_raw=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,{},a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={call_end_reason:!0,call_id:!0,camera_enabled:!0,client_app_version:!0,client_lock_status:!0,client_mono_time_ms:!0,clienttime:!0,component:!0,conference_name_raw:!0,creation_action:!0,error_details:!0,error_type:!0,event:!0,event_details:!0,event_fire_timestamp:!0,event_fire_timestamp_on_client:!0,exception_object:!0,experiments_enabled:!0,falco_batch_sequence:!0,funnel_session_id_raw:!0,group_id:!0,group_size:!0,guest_user_id:!0,kicked_user_id:!0,link_share_to:!0,local_call_id:!0,media_devices:!0,microphone_enabled:!0,open_link_from:!0,open_link_from_app_version:!0,reason:!0,referral_surface:!0,room_id_raw:!0,server_info_data:!0,source:!0,status:!0,surface:!0,targeted_user_ids:!0,thread_sync_room_data:!0,thread_type:!0,user_ids_to_be_removed:!0,video_call_link_hash_raw:!0,video_call_link_id_raw:!0,video_call_link_identifier_raw:!0,video_call_link_url_raw:!0};f["default"]=a}),66);
__d("getRequestConstUri",["ConstUriUtils","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("ConstUriUtils").getUri(window.location.href);if(a==null)throw c("unrecoverableViolation")("Cannot create ConstUriImpl of current request","comet_infra");return a}g["default"]=a}),98);
__d("useIsIGDDisappearingMessagesEnabledForThread",["DisappearingMessagesMode","I64","ReQL","ReQLSuspense","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){var b=d("react-compiler-runtime").c(6),e=(i||(i=c("useReStore")))(),g;b[0]!==e.tables.ig_thread_info||b[1]!==a?(g=function(){return d("ReQL").fromTableAscending(e.tables.ig_thread_info,["igDmSettingsMode","igThreadId"]).getKeyRange(a).take(1)},b[0]=e.tables.ig_thread_info,b[1]=a,b[2]=g):g=b[2];var j;b[3]!==e||b[4]!==a?(j=[e,a],b[3]=e,b[4]=a,b[5]=j):j=b[5];b=d("ReQLSuspense").useFirst(g,j,f.id+":25");j=(h||(h=d("I64"))).to_int32((g=b==null?void 0:b.igDmSettingsMode)!=null?g:(h||(h=d("I64"))).zero);return j===c("DisappearingMessagesMode").ON}g["default"]=a}),98);
__d("useIGDIsE2EECallingEnabled",["IGDInstamadilloUtils","MWLSThread","react-compiler-runtime","useIsIGDDisappearingMessagesEnabledForThread"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("react-compiler-runtime").c(2),e=c("useIsIGDDisappearingMessagesEnabledForThread")(a);a=d("MWLSThread").useThread(a);var f;b[0]!==a?(f=d("IGDInstamadilloUtils").isInstamadilloCutover(a),b[0]=a,b[1]=f):f=b[1];a=f;return e||a}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("EBSMProperties",[],(function(a,b,c,d,e,f){"use strict";a=["encrypted_backups_virtual_devices","secure_encrypted_backups_recovery_code_status","device_metadata","secure_encrypted_backups_epochs","secure_encrypted_backups_client_state","encrypted_backups","experiences_shared_state","auto_restore_opt_out"];b=new Set(["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"]);c={dbVersion:5,mandatoryTables:b,persistedTables:new Set(a),persistedTablesArray:a};d=c;f["default"]=d}),66);
__d("IndexedDbPolyfills",[],(function(a,b,c,d,e,f){"use strict";var g=function(){function a(){this.$1=new Map()}var b=a.prototype;b.emit=function(a){var b=this.$1.get(a);for(var c=arguments.length,d=new Array(c>1?c-1:0),e=1;e<c;e++)d[e-1]=arguments[e];if(b!==void 0)for(var f of b)f.apply(void 0,d);var g=this["on"+a];g!=null&&g.apply(void 0,d)};b.addEventListener=function(a,b,c){var d=this;c===void 0&&(c={});c=c;c=c.signal;var e=this.$1.get(a);e===void 0&&(e=new Set(),this.$1.set(a,e));e.add(b);c!=null&&(c.onabort=function(){d.removeEventListener(a,b)})};b.removeEventListener=function(a,b){a=this.$1.get(a);if(a===void 0)return;a["delete"](b)};return a}();a=function(){return function(a,b){a=this.openCursor(a!=null?a:null);var c=[],d=new g();a.onsuccess=function(a){a=a.target.result;if(a!=null&&(b===void 0||c.length<b))c.push(a.value),a["continue"]();else{d.result=c;d.onsuccess==null?void 0:d.onsuccess({target:{readyState:"done",result:c}});return}};a.onerror=function(a){d.onerror==null?void 0:d.onerror(a)};return d}};b=typeof window!=="undefined"?window:self;typeof b.IDBObjectStore!=="undefined"&&b.IDBObjectStore.prototype.getAll===void 0&&(b.IDBObjectStore.prototype.getAll=a());f.IDBRequest=g;f.getAll=a}),66);
__d("LSAppendDataTraceAddonStoredProcedure",["LSAppendDataTraceAddon","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSAppendDataTraceAddon"),e.dataTraceId,e.checkPointId,e.syncChannel,e.errorMessage,e.tags);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSBitOffset",["I64","LSBitFlag"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("LSBitFlag").set((h||(h=d("I64"))).lsl_(h.one,h.to_int32(a)),b)}function b(a,b){return d("LSBitFlag").clear((h||(h=d("I64"))).lsl_(h.one,h.to_int32(a)),b)}g.set=a;g.clear=b;g.empty=(h||(h=d("I64"))).zero}),98);
__d("LSContactBitOffset",["I64","LSBitFlag","LSBitOffset"],(function(a,b,c,d,e,f,g){"use strict";var h;c=["capabilities","capabilities2"];function a(a,b){return i(a,b,!1)}function i(a,b,c){var e=b.capabilities,f=b.capabilities2;if(a>=64){return f==null?c:d("LSBitFlag").has((h||(h=d("I64"))).lsl_(h.one,a-64),(f=b.capabilities2)!=null?f:d("LSBitOffset").empty)}return e==null?c:d("LSBitFlag").has((h||(h=d("I64"))).lsl_(h.one,a),(f=b.capabilities)!=null?f:d("LSBitOffset").empty)}function b(a,b){return d("LSBitFlag").has((h||(h=d("I64"))).lsl_(h.one,a-64),b!=null?b:d("LSBitOffset").empty)}g.contactCapabilityFields=c;g.has=a;g.hasWithDefault=i;g.contactCapabilitiesHas=b}),98);
__d("LSContactBlockedByViewerStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({UNBLOCKED:0,MESSAGE_BLOCKED:1,FULLY_BLOCKED:2});f["default"]=a}),66);
__d("LSContactTypeExact",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,FB_USER:1,MESSENGER_ONLY:2,DEACTIVATED_ALLOWED_ON_MESSENGER:3,MESSENGER_KID:4,FB_PAGE:5,FB_PAGE_PERSONA:6,IG_USER:7,MESSENGER_CALL_GUEST:8,WHATSAPP:9,GUEST_USER:10,IG_BUSINESS_USER:11,IG_CREATOR_USER:12,FB_SINGLE_OWNER_ADDITIONAL_PROFILE:13,PROXY_OCULUS_USER:14,WORK_VC_ENDPOINT:15,GENERATIVE_AI_BOT:16,COMMUNITY_CHAT:17,INTEROP_3P_USER:18,FB_ONLY_NOT_ALLOWED_ON_MESSENGER:19,MESSENGER_ONLY_NOT_ALLOWED_ON_FB:20,ADDITIONAL_PROFILE_PLUS:21,MESSENGER_SPECTRA:22,GROUP_ANONYMOUS_PROFILE:50,USER_FOR_SUPPORT:51});f["default"]=a}),66);
__d("LSMailboxTaskCompletionApiOnTaskInsertion",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.islc(b.db.table(232).fetch(),0,b.i64.to_float(b.i64.cast([0,1]))),function(c){c=c.item;return b.db.table(233).add({taskId:a[0],notificationScopeKey:c.notificationScopeKey,notificationName:c.notificationName})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSCoreMailboxTaskCompletionApiOnTaskInsertionStoredProcedure";a.__tables__=["mailbox_task_completion_notification_context","mailbox_task_completion_api_tasks"];e.exports=a}),null);
__d("LSMailboxType",[],(function(a,b,c,d,e,f){a=Object.freeze({MESSENGER:0,COMMUNITIES:1,TINCAN:1024,TAM:4096});f["default"]=a}),66);
__d("LSMessagingThreadAttributionType",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,UNKNOWN_TEST:1,UNKNOWN_FAILURE_RETRY:2,MESSENGER_INBOX:65536,MESSENGER_INBOX_IN_THREAD:65537,MESSENGER_INBOX_THREAD_LIST:65538,MESSENGER_INBOX_NESTED_FOLDER:65539,MESSENGER_INBOX_RECENT_THREADS:65540,MESSENGER_INBOX_REMAINING_THREADS:65541,MESSENGER_INBOX_MESSAGE_SEARCH:65542,MESSENGER_INBOX_IMAGE_SENDING:65543,MESSENGER_INBOX_FORWARD:65544,MESSENGER_INBOX_ARCHIVED_THREADS:65545,MESSENGER_INBOX_PENDING_REQUESTS:65546,MESSENGER_INBOX_ACTIVE_CONTACTS:65547,MESSENGER_INBOX_THREAD_BANNER_BOTTOM_SHEET:65548,MESSENGER_INBOX_PEOPLE_YOU_MAY_KNOW:65549,MESSENGER_INBOX_HOLIDAY_CARD_SHARE_SHEET:65550,MESSENGER_INBOX_HOLIDAY_CARD_SHARE_SHEET_QP:65551,MESSENGER_INBOX_META_AI_FAB:65552,MESSENGER_INBOX_META_AI_LONG_PRESS_MENU:65553,MESSENGER_INBOX_PINNED_THREAD:65554,MESSENGER_INBOX_PEOPLE_YOU_MAY_MESSAGE:65555,MESSENGER_UNIVERSAL_SEARCH:131072,MESSENGER_UNIVERSAL_SEARCH_NULL_STATE:131073,MESSENGER_UNIVERSAL_SEARCH_KEY_PRESSED:131074,MESSENGER_UNIVERSAL_SEARCH_MESSAGE_SEARCH:131075,MESSENGER_UNIVERSAL_SEARCH_ADVANCED_CONTENT_SEARCH:131076,MESSENGER_UNIVERSAL_SEARCH_AI_PROMPT:131077,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD:131078,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_AIRPLANE_SEND:131079,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_KEYBOARD_SEND:131080,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_DONUT:131081,MESSENGER_UNIVERSAL_SEARCH_AI_NULLSTATE_DONUT:131082,MESSENGER_UNIVERSAL_SEARCH_AI_NULLSTATE_AIRPLANE_SEND:131083,MESSENGER_UNIVERSAL_SEARCH_META_AI_SEARCH_RESULT:131084,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_SNIPPET:131085,MESSENGER_UNIVERSAL_SEARCH_AI_TYPEAHEAD_KEYBOARD_SEND_SNIPPET:131086,MESSENGER_UNIVERSAL_SEARCH_SERP_SNIPPET:131087,MESSENGER_UNIVERSAL_SEARCH_SERP_SNIPPET_PILL:131088,MESSENGER_UNIVERSAL_SEARCH_AI_DISCOVERY_MODULE:131089,MESSENGER_UNIVERSAL_SEARCH_KEY_PRESSED_WITH_SNIPPET:131090,MONTAGE_AND_ACTIVE_NOW:196608,MONTAGE_AND_ACTIVE_NOW_MONTAGE_INBOX_UNIT:196609,MONTAGE_AND_ACTIVE_NOW_ACTIVE_NOW:196610,MONTAGE_AND_ACTIVE_NOW_INBOX_COMPOSER:196611,MONTAGE_AND_ACTIVE_NOW_ACTIVE_AND_HAS_STORY:196612,MONTAGE_AND_ACTIVE_NOW_CUSTOM_STATUS:196613,MONTAGE_AND_ACTIVE_NOW_NOTES:196614,MONTAGE_AND_ACTIVE_NOW_SEE_ALL_ACTIVE:196615,MONTAGE_AND_ACTIVE_NOW_AN_TRAY_STORY_REPLY:196616,MESSENGER_ACTIVE_NOW_FRIENDS_TAB:262144,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_FRIENDS_TAB:262145,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_PLACE_HOLDER:262146,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_RECENT_ACTIVE:262147,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_RECENT_ACTIVE_AND_STORY:262148,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_CONTENT_DISCOVERY:262149,MESSENGER_ACTIVE_NOW_FRIENDS_TAB_META_AI_FAB:262150,MESSENGER_PENDING_REQUESTS:327680,MESSENGER_PENDING_REQUESTS_INBOX_THREAD_LIST:327681,MESSENGER_PENDING_REQUESTS_PENDING_REQUESTS_PAGE:327682,MESSENGER_BROADCAST_FLOW:393216,MESSENGER_BROADCAST_FLOW_FROM_MESSENGER:393217,MESSENGER_BROADCAST_FLOW_FROM_FB:393218,MESSENGER_BROADCAST_FLOW_FROM_EXTERNAL:393219,MESSENGER_BROADCAST_FLOW_FROM_FB__NEWSFEED_SHARESHEET:393220,MESSENGER_BROADCAST_FLOW_FROM_FB__NEWSFEED_GOODWILL_COMPOSER:393221,MESSENGER_BROADCAST_FLOW_FROM_FB__SHORTS_VIEWER:393222,MESSENGER_BROADCAST_FLOW_FORWARD_GUTTER:393223,MESSENGER_BROADCAST_FLOW_FORWARD_LONGCLICK:393224,MESSENGER_BROADCAST_FLOW_MESSENGER_PHOTO_VIEW:393225,MESSENGER_OMNIPICKER:458752,MESSENGER_OMNIPICKER_NULL_STATE:458753,MESSENGER_OMNIPICKER_KEY_PRESSED:458754,MESSENGER_NOTIFICATION:524288,MESSENGER_NOTIFICATION_IN_THREAD_REPLY:524289,MESSENGER_NOTIFICATION_LONGPRESS_REPLY:524290,MESSENGER_NOTIFICATION_LONGPRESS_REACTION:524291,CLICK_TO_MESSENGER_AD:589824,CLICK_TO_MESSENGER_AD_FROM_NEWSFEED:589825,CLICK_TO_MESSENGER_AD_SEND_MESSAGE_CTA:589826,CLICK_TO_MESSENGER_AD_VIEW_AND_MESSAGE:589827,CLICK_TO_MESSENGER_AD_SEND_MESSAGE_CTA__NEWSFEED_CTM_ADS_CTA:589828,CLICK_TO_MESSENGER_AD_FROM_NEWSFEED_OPTIMISTIC_LTV:589829,CLICK_TO_MESSENGER_AD_FROM_NEWSFEED_LEAD_GEN:589830,PAYMENTS:655360,PAYMENTS_BUBBLE_CLICK:655361,RTC:720896,RTC_VOIP_INCALL:720897,RTC_DRAWER_PROMOTION:720898,FB_PAGE:786432,FB_PAGE_ABOUT_CARD:786433,FB_PAGE_PROFILE_HEADER_MESSAGE_BUTTON:786434,FB_PAGE_PROFILE_FOOTER_MESSAGE_BUTTON:786435,FB_PAGE_PROFILE_MORE_DRAWER:786436,FB_PAGE_RESPONSIVENESS_CONTEXT_CARD:786437,FB_PAGE_PYMM_RHC:786439,FB_PAGE_PAGES_HOME_FRIENDS_DIALOG:786440,FB_PAGE_PAGES_PRIVATE_REPLY:786441,FB_PROFILE:851968,FB_PROFILE_TIMELINE_MESSAGE_BUTTON:851969,FB_PROFILE_FACEBOOK_PROFILE:851970,FB_PROFILE_MESSAGE_BUTTON:851971,FB_PROFILE_MESSAGE_BUTTON_BLOKS_URL:851972,FB_PROFILE_PROFILE_HEADER_COMPOSER:851973,FB_PROFILE_MUTUAL_FRIENDS_DIALOG:851974,FB_PROFILE_DIRECTORY_MESSENGER_MESSAGE_BLOKS_URL:851975,FB_SEARCH:917504,FB_SEARCH_CONTEXTUAL_PROFILE_ACTION_BAR_FROM_SEARCH:917505,FB_SEARCH_SEARCH_MESSAGE_BUTTON:917506,FB_SEARCH_FB_MESSAGE_SEARCH_RESULTS:917507,FB_SEARCH_HIGH_CONFIDENCE_CARD:917508,FB_SEARCH_MENTIONS:917509,FB_SEARCH_NULLSTATE_CTA:917510,FB_SEARCH_NULL_STATE:917511,FB_SEARCH_TYPEAHEAD:917512,FB_SEARCH_TYPEAHEAD_AIRPLANE_SEND:917513,FB_SEARCH_TYPEAHEAD_KEYBOARD_SEND:917514,FB_SEARCH_TYPEAHEAD_DONUT:917515,FB_SEARCH_NULL_STATE_DONUT:917516,FB_SEARCH_NULL_STATE_AIRPLANE_SEND:917517,FB_SEARCH_NULL_STATE_KEYBOARD_SEND:917518,FB_SEARCH_SERP_PROMPT_SUGGESTIONS:917519,FB_SEARCH_AI_DISCOVERY_MODULE:917520,FB_SEARCH_TYPEAHEAD_AI_SHORTCUT:917521,CRYPTO:983040,MESSENGER_MONTAGE_COMPOSER:1048576,MESSENGER_MONTAGE_COMPOSER_FRIENDS_TAB:1048577,MESSENGER_MONTAGE_COMPOSER_FRIENDS_TAB_STORY_AND_ACTIVE_NOW:1048578,MESSENGER_MONTAGE_REPLY:1114112,MESSENGER_MONTAGE_REPLY_INBOX_THREAD_LIST_PROFILE:1114113,MESSENGER_MONTAGE_REPLY_REPLY_CONTEXT:1114114,MESSENGER_MONTAGE_REPLY_THREAD_NAV_BAR:1114115,MESSENGER_MONTAGE_REPLY_INBOX_THREAD_LIST_PROFILE_AUTHOR_PROFILE:1114116,MESSENGER_MONTAGE_REPLY_REPLY_CONTEXT_AUTHOR_PROFILE:1114117,MESSENGER_MONTAGE_REPLY_THREAD_NAV_BAR_AUTHOR_PROFILE:1114118,MESSENGER_MONTAGE_REPLY_ONE_TO_ONE_CHAT_THREAD_STORY_BUBBLE:1114119,MESSENGER_THREAD_MEMBERS_LIST:1179648,MARKETPLACE:1245184,MARKETPLACE_ACTIVITY_BANNER:1245185,MARKETPLACE_SEND_MESSAGE:1245186,MARKETPLACE_GEN_AI_ACCORDION_META_AI_PILL:1245187,MARKETPLACE_GEN_AI_ACCORDION_FOLLOW_UP_QUESTION:1245188,MARKETPLACE_GEN_AI_PRICE_CHECK_META_AI_PILL:1245189,MARKETPLACE_GEN_AI_PRICE_CHECK_FOLLOW_UP_QUESTION:1245190,MARKETPLACE_META_AI_PILLS_MODULE_META_AI_PILL_GENERIC:1245191,MARKETPLACE_META_AI_PILLS_MODULE_META_AI_PILL_WITH_PROMPT:1245192,MARKETPLACE_GEN_AI_ENRICHED_DESCRIPTION_META_AI_PILL_GENERIC:1245193,MARKETPLACE_GEN_AI_ENRICHED_DESCRIPTION_META_AI_PILL_WITH_PROMPT:1245194,FB_STORY:1310720,FB_STORY_VIEWER_SHEET_MENU:1310721,FB_STORY_VIEWER_SHEET_ROW:1310722,FB_STORY_STORIES_JEWEL_NOTIFICATION:1310723,FB_STORY_STORIES_PUSH_NOTIFICATION:1310724,FB_STORY_STORIES_VIEWER_CONSUMER_REPLY:1310725,FB_STORY_STORIES_VIEWER_CONSUMER_ARTIFACT:1310726,FB_STORY_STORIES_PAGE_STORY_CONVERSATIONS:1310727,FB_STORY_SOCIAL_CONTEXT_CONVERSATIONS:1310728,FB_STORY_MENTIONS:1310729,FB_STORY_SELF_STORY_SEND:1310730,FB_STORY_SHARESHEET:1310731,FB_STORY_NOTES:1310732,FB_STORY_TRY_META_AI_STICKER:1310733,FB_STORY_CHALLENGES_NOMINATION:1310734,WORKSPEED:1376256,WORKSPEED_COMPOSER_LIKE_BUTTON:1376257,WORKSPEED_COMPOSER_GIF_PICKER:1376258,MDOTME:1441792,MDOTME_ORGANIC_POST:1441793,MDOTME_MARKETING_EMAIL:1441794,MDOTME_MBS_OFFSITE_EMAIL:1441795,CUSTOMER_CHAT_PLUGIN:1507328,CUSTOMER_CHAT_PLUGIN_MOBILE_REDIRECT:1507329,CUSTOMER_CHAT_PLUGIN_UPGRADE_FLOW:1507330,CUSTOMER_CHAT_PLUGIN_RE_ENGAGEMENT:1507331,FB_FEED:1572864,FB_FEED_ORGANIC_POST:1572865,FB_FEED_ORGANIC_POST_VIEW_AND_MESSAGE:1572866,FB_FEED_QUESTION_TRIGGERED_CONVO:1572867,FB_FEED_DYNAMIC_HOVER_CARD:1572868,FB_FEED_ORGANIC_POST__NEWSFEED_PAGE_POST_CTA:1572869,FB_FEED_ORGANIC_POST__NEWSFEED_BUMPER_SMCTA:1572870,FB_FEED_BCF_OPEN_CHAT_BUTTON:1572871,FB_FEED_REACTORS_LIST_MESSAGE_BUTTON:1572872,FB_FEED_REPLY_TO_AUTHOR:1572873,FB_FEED_UFI_SEND_SUGGESTIONS:1572874,FB_FEED_BCF:1572875,FB_FEED_COMMUNITY_CHATS_FEED_POST:1572876,FB_FEED_SOCIAL_CONNECTIONS_QP:1572877,FB_FEED_META_AI_DEEP_DIVES:1572878,FB_FEED_META_AI_SHARE_SHEET:1572879,FB_FEED_META_AI_TRENDING_DISCOVER_UNIT:1572880,FB_FEED_META_AI_POST_DEEPDIVE_PILL:1572881,FB_FEED_META_AI_EDUCATIONAL_QP:1572882,FB_FEED_META_AI_ENTITY_SUMMARIZATION_DISCOVER_UNIT:1572883,FB_FEED_META_AI_COMMENTS_SUMMARY:1572884,FB_FEED_META_AI_FAB:1572885,FB_FEED_META_AI_ADS_CAMPAIGN:1572886,FB_FEED_META_AI_ANSWERSHEET:1572887,FB_FEED_META_AI_BOOKMARK:1572888,FB_FEED_META_AI_FAB_COMMENTS_SUMMARY:1572889,FB_FEED_META_AI_FAB_CONTEXTUAL:1572890,FB_FEED_FEED_POLL:1572891,FB_FEED_BIZ_VOICE_AGENT:1572892,FB_NOTIFICATION:1638400,FB_NOTIFICATION_JEWEL_NOTIF:1638401,FB_NOTIFICATION_PUSH_NOTIF:1638402,FB_EVENT:1703936,FB_EVENT_MESSAGE_HOST:1703937,FB_EVENT_SHARE_CLASS_MATERIALS:1703938,SUPPORT_RESOURCES:1769472,SUPPORT_RESOURCES_FRX_ACTION:1769473,LEAD_GEN_MESSAGING:1835008,LEAD_GEN_MESSAGING_PRE_SUBMISSION:1835009,LEAD_GEN_MESSAGING_POST_SUBMISSION:1835010,LEAD_GEN_MESSAGING_CROSS_CHANNEL_VERTICAL_PRESENT_ANDROID:1835011,LEAD_GEN_MESSAGING_CROSS_CHANNEL_HSCROLL_ANDROID:1835012,MESSENGER_GRAPH:1900544,MESSENGER_GRAPH_SELECT_CONTACT:1900545,MESSENGER_CHAT:1966080,MESSENGER_CHAT_FROM_JEWEL__THREAD_LIST:1966081,MESSENGER_CHAT_IN_THREAD:1966082,MESSENGER_CHAT_FORWARD:1966083,MESSENGER_CHAT_NOTE_POPOVER:1966084,MESSENGER_ARCHIVED_THREADS:2031616,MESSENGER_ARCHIVED_THREADS_ARCHIVED_THREADS_FOLDER:2031617,JEWEL:2097152,JEWEL_THREAD_LIST:2097153,JEWEL_SEARCH:2097154,JEWEL_NEW_MESSAGE:2097155,JEWEL_NESTED_FOLDER:2097156,CHATHEADS:2162688,CHATHEADS_RECENT_THREADS:2162689,CHATHEADS_OVERFLOW:2162690,CHATHEADS_NEW_MESSAGE:2162691,SIDEBAR:2228224,SIDEBAR_CONTACTS_LIST:2228225,SIDEBAR_CONTACTS_SEARCH:2228226,SIDEBAR_CONTACTS_GROUPS:2228227,SIDEBAR_CONTACTS_COMMUNITY_CHATS:2228228,MESSENGER_COMMUNITY_MESSAGING:2293760,MESSENGER_COMMUNITY_MESSAGING_COMMUNITY_CHANNEL:2293761,MESSENGER_COMMUNITY_MESSAGING_FULLSCREEN_CHAT:2293762,MESSENGER_COMMUNITY_MESSAGING_CHANNEL_CREATION_NOTIFICATION:2293763,MESSENGER_COMMUNITY_MESSAGING_FRIEND_JOINED_COMMUNITY_CHAT_NOTIFICATION:2293764,MESSENGER_COMMUNITY_MESSAGING_COMMUNITY_FRIENDS_DIALOG:2293765,FB_PLATFORM_LOGIN:2359296,FB_PLATFORM_LOGIN_LOGIN_CONNECT_WITH_MESSENGER:2359297,CONTACT_MANAGER:2424832,CONTACT_MANAGER_CONTACT_SHARE:2424833,CONTACT_MANAGER_PEOPLE_TAB_CONTACT_LIST:2424834,CONTACT_MANAGER_PEOPLE_TAB_CONTACT_SEARCH:2424835,CONTACT_MANAGER_ICON_CONTACT_LIST:2424836,CONTACT_MANAGER_ICON_CONTACT_SEARCH:2424837,MESSAGING_INBOX_IN_BLUE:2490368,MESSAGING_INBOX_IN_BLUE_THREAD_LIST:2490369,MESSAGING_INBOX_IN_BLUE_PEOPLE_PICKER:2490370,MESSAGING_INBOX_IN_BLUE_INBOX_ICON:2490371,MESSAGING_INBOX_IN_BLUE_SWIPE_FROM_RIGHT:2490372,MESSAGING_INBOX_IN_BLUE_MIB_NOTIFICATION:2490373,MESSAGING_INBOX_IN_BLUE_ACTIVE_NOW:2490374,MESSAGING_INBOX_IN_BLUE_SUGGESTED_CHATS:2490375,MESSAGING_INBOX_IN_BLUE_CHAT_PREVIEW_BANNER:2490376,MESSAGING_INBOX_IN_BLUE_THREAD_VIEW_CORE_NULL_STATE:2490377,MESSAGING_INBOX_IN_BLUE_MESSAGE_REQUESTS:2490378,MESSAGING_INBOX_IN_BLUE_SPAM:2490379,MESSAGING_INBOX_IN_BLUE_FB_GROUPS:2490380,MESSAGING_INBOX_IN_BLUE_MESSENGER_PEEK_STATE_BUTTON:2490381,MESSAGING_INBOX_IN_BLUE_MESSENGER_PEEK_STATE_TOOLTIP:2490382,MESSAGING_INBOX_IN_BLUE_BROADCAST_FLOW:2490383,MESSAGING_INBOX_IN_BLUE_THREAD_VIEW_HEADER:2490384,MESSAGING_INBOX_IN_BLUE_PRIVACY_SETTINGS:2490385,MESSAGING_INBOX_IN_BLUE_ARCHIVED_CHATS:2490386,MESSAGING_INBOX_IN_BLUE_UNIVERSAL_SEARCH:2490387,MESSAGING_INBOX_IN_BLUE_INBOX_SEARCH_BAR:2490388,MIB_NOTIFICATION:2555904,MIB_NOTIFICATION_PUSH_NOTIFICATION:2555905,MIB_NOTIFICATION_JEWEL_NOTIFICATION:2555906,MIB_NOTIFICATION_DIRECT_PUSH_NOTIF:2555907,MIB_NOTIFICATION_DIRECT_JEWEL_NOTIF:2555908,MESSENGER_RESTRICTED_ACCOUNTS:2621440,ARMADILLO_CUTOVER_THREAD_LINKING_MESSAGE:2686976,CALLS_TAB:2752512,MINI_SHOP_VIEW_MENU_BUTTON:2818048,SHARESHEET:2883584,SHARESHEET_GENERALIZED_BROADCAST_FLOW:2883585,SHARESHEET_OFF_PLATFORM_SHARING_H_SCROLL:2883586,SHARESHEET_BROADCAST_CHANNEL:2883587,UFI:2949120,UFI_GENERALIZED_BROADCAST_FLOW:2949121,CHATHEAD_CLICK_COLLAPSED:3014656,TIMELINE_MESSAGE_BUTTON:3080192,DIRECT_REPLY_INTENT:3145728,FB_GROUPS:3211264,FB_GROUPS_INBOX:3211265,FB_GROUPS_PICKER_EXISTING_CHAT:3211266,FB_GROUPS_PICKER_JOIN_CHAT:3211267,FB_GROUPS_MEMBER_LIST:3211268,FB_GROUPS_INLINE_COMPOSER:3211269,FB_GROUPS_SCOPED_SEARCH:3211270,FB_GROUPS_UNJOINED_MALL_HEADER:3211271,FB_GROUPS_DISCOVER_FEED_UNIT:3211272,FB_GROUPS_ANSWER_AGENT_CONTEXTUAL_PROFILE:3211273,FB_GROUPS_ANSWER_AGENT_FOLLOWUP_SECTION:3211274,FB_GROUPS_NOTIFICATION_MESSAGING_IN_BLUE_DIRECT_MESSAGE:3211275,FB_GROUPS_UGC:3211276,FB_GROUPS_UGC_POST:3211277,FB_GROUPS_UGC_MALL_PLINK:3211278,FB_GROUPS_UGC_MALL_NUX:3211279,FB_GROUPS_UGC_ADMIN_TESTING:3211280,FB_GROUPS_UGC_INTRO_POST:3211281,FB_GROUPS_UGC_QP:3211282,FB_GROUPS_UGC_DEEP_DIVE_GET_ANSWER_PILL:3211283,FB_GROUPS_UGC_DEEP_DIVE_PILL:3211284,FB_GROUPS_UGC_FAB:3211285,FB_GROUPS_UGC_REMINDER_NOTIF:3211286,FB_GROUPS_UGC_COMMENT_RESPONSE_UPSELL:3211287,FB_GROUPS_UGC_CONTEXTUAL_PROFILE:3211288,FB_GROUPS_UGC_DEEP_DIVE_ASK_SOMETHING_ELSE:3211289,FB_GROUPS_UGC_CONTEXTUAL_CARD_ASK_SOMETHING_ELSE:3211290,DEVICES:3276800,DEVICES_STELLA:3276801,FB_WELLBEING:3342336,FB_WELLBEING_INCALL_UNBLOCKING_NOTIFICATION:3342337,MESSENGER_DEEP_LINKING:3407872,READ_ONLY_CUTOVER_THREAD:3473408,READ_ONLY_CUTOVER_THREAD_ARMADILLO_THREAD:3473409,READ_ONLY_CUTOVER_THREAD_THREAD_DETAIL:3473410,ARMADILLO_THREAD:3538944,ARMADILLO_THREAD_READ_ONLY_CUTOVER_THREAD:3538945,ARMADILLO_THREAD_EXTERNAL_LINK:3538946,FB_SHORTS:3604480,FB_SHORTS_PROFILE:3604481,FB_SHORTS_REACTORS_LIST_MESSAGE_BUTTON:3604482,SEND_PLUGIN:3670016,SEND_AS_MESSAGE_FROM_NT:3735552,MESSENGER_PUBLIC_CHATS_MESSAGING:3801088,MESSENGER_GROWTH:3866624,MESSENGER_GROWTH_NOTIFICATIONS_ENTRYPOINT:3866625,MESSENGER_GROWTH_MESSAGE_REQUEST_JEWEL:3866626,MESSENGER_GROWTH_FRIENDLY_FEED_ACTIVE_NOW:3866627,FRIENDS_HOME:3932160,FRIENDS_HOME_ACTIVE_NOW:3932161,FRIENDS_HOME_MESSAGE_NEW_FRIENDS:3932162,FRIENDS_HOME_POST_ACCEPT_MESSAGING:3932163,FRIENDS_HOME_SENDER_POST_ACCEPT_WAVE:3932164,EXTERNAL_LINK_XMA:3997696,EXTERNAL_LINK_XMA_FROM_COMPOSER:3997697,EXTERNAL_LINK_XMA_FROM_DEEP_LINKING:3997698,EXTERNAL_LINK_XMA_FROM_SHARE_EXTENSION:3997699,FB_NOTIFICATIONS:4063232,QUICK_PROMOTION:4128768,QUICK_PROMOTION_CTA:4128769,QUICK_PROMOTION_INTERSTITIAL:4128770,QUICK_PROMOTION_TOP_BANNER:4128771,FBM_IN_APP_NOTIFS:4194304,CREATOR_SUPPORT:4259840,CREATOR_SUPPORT_MESSENGER_TOAST:4259841,FB_INSTANT_GAME:4325376,COMMUNITY_CHATS_IN_FEED:4390912,COMMUNITY_CHATS_IN_FEED_PERMALINK:4390913,UNIFIED_BUSINESS_INBOX:4456448,ROLLCALL:4521984,HIGHLIGHTS_TAB:4587520,HIGHLIGHTS_TAB_FEED_INLINE:4587521,HIGHLIGHTS_TAB_MEDIA_VIEWER:4587522,HIGHLIGHTS_TAB_THREAD_VIEW:4587523,HIGHLIGHTS_TAB_FEED_INLINE_CONNECTED_CHAT:4587524,HIGHLIGHTS_TAB_FEED_INLINE_LOCAL_EVENT:4587525,HIGHLIGHTS_TAB_FEED_INLINE_FRIENDS_UPDATE:4587526,HIGHLIGHTS_TAB_FEED_INLINE_BIRTHDAY:4587527,HIGHLIGHTS_TAB_MEDIA_VIEWER_CONNECTED_CHAT:4587528,HIGHLIGHTS_TAB_MEDIA_VIEWER_FRIENDS_UPDATE:4587529,HIGHLIGHTS_TAB_THREAD_VIEW_CONNECTED_CHAT:4587530,HIGHLIGHTS_TAB_THREAD_VIEW_LOCAL_EVENT:4587531,HIGHLIGHTS_TAB_THREAD_VIEW_FRIENDS_UPDATE:4587532,HIGHLIGHTS_TAB_THREAD_VIEW_BIRTHDAY:4587533,HIGHLIGHTS_TAB_THREAD_VIEW_NOTE:4587534,HIGHLIGHTS_TAB_FEED_INLINE_NOTE:4587535,HIGHLIGHTS_TAB_CONNECTED_BROADCAST_CHANNEL_SHARE_SHEET:4587536,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_BIRTHDAY:4587537,HIGHLIGHTS_TAB_SHARE_SHEET_HOLIDAY_CARD:4587538,HIGHLIGHTS_TAB_META_AI_BIRTHDAY:4587539,HIGHLIGHTS_TAB_QUICK_REACT_CONNECTED_CHAT:4587540,HIGHLIGHTS_TAB_QUICK_REACT_LOCAL_EVENT:4587541,HIGHLIGHTS_TAB_QUICK_REACT_FRIENDS_UPDATE:4587542,HIGHLIGHTS_TAB_QUICK_REACT_BIRTHDAY:4587543,HIGHLIGHTS_TAB_QUICK_REACT_STORIES:4587544,HIGHLIGHTS_TAB_QUICK_REACT_NOTE:4587545,HIGHLIGHTS_TAB_QUICK_REACT_LIFE_EVENT:4587546,HIGHLIGHTS_TAB_META_AI_FAB:4587547,HIGHLIGHTS_TAB_FEED_INLINE_CHAT_WITH_FRIENDS:4587548,HIGHLIGHTS_TAB_THREAD_VIEW_CHAT_WITH_FRIENDS:4587549,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_LOCAL_EVENT:4587550,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_FRIENDS_UPDATE:4587551,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_NOTE:4587552,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_CHAT_WITH_FRIENDS:4587553,HIGHLIGHTS_TAB_FB_POST_MEMORIES_SHARE_SHEET:4587554,HIGHLIGHTS_TAB_FEED_INLINE_FB_POST_MEMORIES:4587555,HIGHLIGHTS_TAB_THREAD_VIEW_FB_POST_MEMORIES:4587556,HIGHLIGHTS_TAB_QUICK_REACT_FB_POST_MEMORIES:4587557,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER_FB_POST_MEMORIES:4587558,MARKETPLACE_INBOX:4653056,ONE_TAP_MESSAGE_QUICK_SHARE:4718592,HIGHLIGHTS_TAB_STORIES_TRAY:4784128,FB_BIRTHDAY_CENTER:4849664,MESSENGER_SIRIKIT:4915200,MESSENGER_SIRIKIT_CALLKIT_QUICK_REPLY:4915201,MESSENGER_SIRIKIT_VOICE_COMMAND:4915202,CLICK_TO_SUBSCRIBE_AD:4980736,HIGHLIGHTS_TAB_SMART_REPLY_DRAWER:5046272,FB_UNIVERSAL_SEARCH:5111808,FB_UNIVERSAL_SEARCH_NULL_STATE_SUGGESTED:5111809,FB_UNIVERSAL_SEARCH_NULL_STATE_RECENT:5111810,FB_UNIVERSAL_SEARCH_QUERY_RESULTS:5111811,FBLITE_MESSAGING:5177344,FBLITE_MESSAGING_FROM_EXTERNAL:5177345,FBLITE_MESSAGING_FORWARD_FROM_BROADCAST_FLOW:5177346,FBLITE_MESSAGING_IN_THREAD:5177349,FBLITE_MESSAGING_ACTIVE_NOW:5177352,FBLITE_MESSAGING_ARCHIVED_CHATS:5177353,FBLITE_MESSAGING_SPAM:5177354,FBLITE_MESSAGING_MESSAGE_REQUESTS:5177355,FBLITE_MESSAGING_MARKETPLACE:5177356,FBLITE_MESSAGING_THREAD_MEMBERS_LIST:5177357,FBLITE_MESSAGING_READONLY_VERSION_OF_CUTOVER_THREAD:5177358,FBLITE_MESSAGING_QP:5177359,FBLITE_MESSAGING_META_AI_PROFILE_SHARE:5177360,FBLITE_MESSAGING_IMAGE_VIEWER_REPLY_COMPOSER:5177361,FBLITE_MESSAGING_META_AI_BOOKMARK:5177362,FBLITE_MESSAGING_NOTIFICATION:5242880,FBLITE_MESSAGING_NOTIFICATION_IN_THREAD_REPLY:5242881,FBLITE_MESSAGING_NOTIFICATION_DIRECT_REPLY:5242882,FBLITE_INBOX:5308416,FBLITE_INBOX_UNIVERSAL_SEARCH:5308417,FBLITE_INBOX_PEOPLE_PICKER:5308418,FBLITE_INBOX_RECENT_THREADS:5308419,FBLITE_INBOX_REMAINING_THREADS:5308420,FBLITE_INBOX_INBOX_FOLLOWUP:5308421,FBLITE_INBOX_THREAD_WITH_DRAFT_MESSAGE:5308422,FBLITE_INBOX_META_AI_FAB:5308423,SHARED_ALBUM:5373952,QUICK_REPLIES:5439488,QUICK_REPLIES_TRAY:5439489,MESSENGER_CTA_AFTER_CALL_ENDS:5505024,MESSENGER_CONVERSATION_SHORTCUT:5570560,CC_ADMIN_SEND_MESSAGE_HINT_CARD:5636096,CC_MEMBER_SEND_MESSAGE_HINT_CARD:5701632,MSGR_AVATAR_DETAILS:5767168,PRIVATE_SHARING_FORWARD_SUPER_SHARE_SHEET:5832704,MEMORIES:5898240,META_AI_TAB:5963776,MEMORIES_NOTIFICATION:6029312,MEMORIES_QUICK_PROMOTION:6094848,MEMORIES_HIGHLIGHTS_TAB:6160384,MEMORIES_LIST:6225920,MSGR_PYMK_LIST_SCREEN:6291456,INSTAGRAM_WEB_SENDS:6356992,AI_SUGGESTED_PROMPT_TRAY:6422528,AI_SUGGESTED_PROMPT_ICEBREAKER:6488064,COMMUNITY_INVITE:6553600,COMMUNITY_CHAT_INVITE:6619136,AI_DISCOVERY_BOTTOM_SHEET:6684672,IN_THREAD_INVITE_MODEL:6750208,SUPPORT_FOLDER:6815744,MARKETPLACE_PDP:6881280,QR_CODE:6946816,WRITE_WITH_AI:7012352,AI_HOME_CHAT_WITH_AI:7077888,AI_HOME_INBOX_QP:7143424,AI_AGENT_MESSAGE_SHARE:7208960,AI_HOME_FROM_THREAD:7274496,AI_HOME_FROM_THREAD_DETAIL:7274497,AI_HOME_FROM_THREAD_HEADER:7274498,AI_HOME_FROM_THREAD_META_AI_THREAD_DETAIL:7274499,AI_HOME_FROM_THREAD_META_AI_THREAD_HEADER:7274500,AI_HOME_FROM_FOLDER_LIST:7340032,AI_HOME_FROM_FB_BOOKMARK:7405568,FB_FANDOM:7471104,AI_HOME_INBOX_RETENTION_QP:7536640,MEMORIES_INBOX_TRAY:7602176,MESSENGER_VOICEMAIL:7667712,AI_UGC_FB_FEED_QP:7733248,MESSENGER_INBOX_IP_QP:7798784,COMMUNITY_GROUP_CHAT_UPGRADES_INVITE:7864320,MESSENGER_SECRET_CONVERSATIONS:7929856,MESSENGER_SECRET_CONVERSATIONS_SECRET_CONVERSATIONS_FOLDER:7929857,CROSS_CUSTOMER_SUPPORT:7995392,CROSS_CUSTOMER_SUPPORT_FB_HELP_CENTER_META_AI_CARD:7995393,AI_LOOKUP:8060928,PINNED_MESSAGES_THREAD_DETAILS:8126464,CM_MEMBER_REPORTS_BLOKS:8192e3,MEMORIES_TEMPLATE:8257536,FB_TREP_UGC_CREATION:8323072,MESSENGER_STORIES_TAB:8388608,MESSENGER_STORIES_TAB_META_AI_FAB:8388609,META_AI_ENTITY_DETECTION:8454144,AI_HOME_FROM_AI_STUDIO_TAB:8519680,QR_CODE_LINK:8585216,META_AI_PROMPT_SHEET:8650752,UGC_BOT_IMMERSIVE_THREAD:8716288,UGC_BOT_IMMERSIVE_THREAD_AI_STUDIO_TAB:8716289,UGC_BOT_IMMERSIVE_THREAD_INBOX:8716290,UGC_BOT_IMMERSIVE_THREAD_AI_HOME:8716291,IGD_WEB_CHAT_TAB:8781824,IGD_WEB_CHAT_TAB_IN_THREAD:8781825,IGD_WEB_CHAT_TAB_NOTIFICATION:8781826,FB_PYMK_FEED_MESSAGE_BUTTON:8847360,MSGR_UGC_IMMERSIVE_THREAD:8912896,MSGR_UGC_IMMERSIVE_THREAD_AI_STUDIO_TAB:8912897,MSGR_UGC_IMMERSIVE_THREAD_LEFT_NAV_AI_STUDIO_TAB:8912898,MSGR_UGC_IMMERSIVE_THREAD_MORE_MENU_AI_STUDIO_TAB:8912899,MSGR_UGC_IMMERSIVE_THREAD_AI_STUDIO_TAB_AI_HOME:8912900,MSGR_UGC_IMMERSIVE_THREAD_COMPOSER_AI_HOME:8912901,MSGR_UGC_IMMERSIVE_THREAD_INBOX:8912902,MSGR_UGC_IMMERSIVE_THREAD_ACTIVE_NOW:8912903,MSGR_UGC_IMMERSIVE_THREAD_META_AI_HEADER_AI_HOME:8912904,MSGR_UGC_IMMERSIVE_THREAD_UGC_HEADER_AI_HOME:8912905,MSGR_UGC_IMMERSIVE_THREAD_THREAD_DETAIL_AI_HOME:8912906,MSGR_UGC_IMMERSIVE_THREAD_META_AI_THREAD_DETAIL_AI_HOME:8912907,MSGR_UGC_IMMERSIVE_THREAD_DEEPLINK:8912908,MSGR_UGC_IMMERSIVE_THREAD_NOTIFICATION:8912909,MSGR_UGC_IMMERSIVE_THREAD_AI_CREATION:8912910,MSGR_UGC_IMMERSIVE_THREAD_LEFT_NAV_AI_STUDIO_TAB_AI_HOME:8912911,MSGR_UGC_IMMERSIVE_THREAD_MORE_MENU_AI_STUDIO_TAB_AI_HOME:8912912,AI_THREAD_FROM_FF_THREAD:8978432,AI_THREAD_FROM_FF_THREAD_FF_THREAD_VIEW_META_AI_TASK:8978433,PHONE_NUMBER_MESSAGES:9043968,FUNDRAISER_SUPPORTERS_LIST:9109504,META_AI_SUMMARY:9175040,META_AI_SUMMARY_IN_THREAD:9175041,MESSENGER_NOTES:9240576,MESSENGER_NOTES_SELF_CONSUMPTION_DETAILS_LIST:9240577,MESSENGER_NOTES_NOTE_PROMPT_CONSUMPTION:9240578,MESSENGER_NOTES_NOTE_PROMPT_RESPONSE_CONSUMPTION:9240579,POKES_PLUS:9306112,POKES_PLUS_POKE_PLUS_DASHBOARD:9306113,STORIES_ATTRIBUTION:9371648,STORIES_ATTRIBUTION_STACKED_STORIES:9371649,ARMADILLO_CUTOVER_THREAD_BANNER:9437184,DMA_MSPLIT_FALLBACK_THREAD_NAVIGATION:9502720});f["default"]=a}),66);
__d("LocalStorageWrapper",["CurrentMessengerUser","WAResultOrError","isQuotaExceededError","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("PersistedQueue").__setRef("LocalStorageWrapper");function i(a){var b=null;try{b=window.localStorage;if(b!=null&&typeof b.setItem==="function"&&typeof b.removeItem==="function"){var c="__test__"+Date.now();b.setItem(c,"");b.removeItem(c)}else return null}catch(c){if(d("isQuotaExceededError").isStorageQuotaExceededError(b,c)===!1){a("Failed to get localstorage");return null}}return b}function a(a){try{a=i(a);return a!=null}catch(a){return!1}}function j(a){try{var b=0,c={};for(var d in a){if(!Object.prototype.hasOwnProperty.call(a,d))continue;var e=(a[d].length+d.length)*2;b+=e;e/1024>1e3&&(c[d.substr(0,50)]=(e/1024).toFixed(2))}c.total=(b/1024).toFixed(2);return JSON.stringify(c)}catch(a){return"Can't calculate localStorage"}}function b(a,b,c,e,f){if(a==null)return d("WAResultOrError").makeError("null-storage");try{f!==void 0?k(a,b,c,f):a.setItem(b,c)}catch(f){if(d("CurrentMessengerUser").isEmployee()){var g=j(a);h.onReady(function(a){a=a.isQueueActivateExperiment().toString();e(f+" - Storage quota exceeded while setting "+b+":"+c+", queueActivateExp:"+a+" "+g)})}else e(f+" - Storage quota exceeded while setting "+b+":"+c);return d("WAResultOrError").makeError("quota-exceeded")}return d("WAResultOrError").makeResult()}function k(a,b,c,d){try{a.setItem(b,c)}catch(e){d(e),a.setItem(b,c)}}function e(a,b,c){a==null?c("not storage found"):a.removeItem(b)}function f(a,b,c){if(a==null){c("not storage found");return null}else return a.getItem(b)}g.getStorage=i;g.isLocalStorageAvailable=a;g.setItemGuarded=b;g.removeItemGuarded=e;g.getItemGuarded=f}),98);
__d("MAWCryptoConsts",[],(function(a,b,c,d,e,f){"use strict";a=60*60;b=24*a;c=32;d=new Uint8Array(0).buffer;e=128;a=256;var g=12,h=1,i=2,j=2,k=4;b=b*30*6;var l=3,m="AES-GCM",n="HKDF",o="SHA-256";f.HKDF_SEED_LENGTH_IN_BYTES=c;f.HKDF_INFO=d;f.AES_GCM_TAG_LENGTH=e;f.AES_GCM_KEY_LENGTH=a;f.AES_GCM_IV_LENGTH_IN_BYTES=g;f.VERSION=h;f.CIPHER_ID=i;f.ADDITIONAL_DATA_LENGTH_IN_BYTES=j;f.EXTRA_ADDITIONAL_DATA_LENGTH_IN_BYTES=k;f.ENC_KEY_TTL=b;f.MAX_KEYCHAIN_SETUP_RETRIES=l;f.AES_GCM=m;f.HKDF=n;f.SHA256=o}),66);
__d("MAWKeychainUtil",[],(function(a,b,c,d,e,f){"use strict";function a(a){return self.crypto.getRandomValues(new Uint8Array(a))}function b(a){var b=a.reduce(function(a,b){return a+b.byteLength},0),c=new Uint8Array(b);a.reduce(function(a,b){c.set(new Uint8Array(b),a);return a+b.byteLength},0);return c.buffer}function c(a,b){return new Uint8Array([a,b]).buffer}function d(a){var b=a.length;if(b>0&&b%2===0&&/^[\da-f]+$/gi.test(a)){var c=[];for(var d=0,b=b/2;d<b;++d){var e=parseInt(a.substring(d*2,d*2+2),16);c.push(e)}return new Uint8Array(c)}else return null}f.getBufferWithRandomValuesFromLength=a;f.mergeBuffers=b;f.makeAAD=c;f.fromHexString=d}),66);
__d("MAWSubtleCrypto",[],(function(a,b,c,d,e,f){a=self.crypto;b=a&&(a.subtle||a.webkitSubtle||a.subtle);f.MAWSubtleCrypto=b}),66);
__d("MAWWebInitDataHelpers",["FBLogger","MessengerWebInitData"],(function(a,b,c,d,e,f,g){"use strict";function a(){return 2}function b(a){switch(a){case 2:return[c("MessengerWebInitData").accountKeyV2];case 1:return[c("MessengerWebInitData").accountKey].concat((a=c("MessengerWebInitData").additionalAccountKeysV1)!=null?a:[]);default:throw c("FBLogger")("messenger_web").mustfixThrow("Invalid format version, should never happen.")}}g.getLastAccountKeyFormatVersion=a;g.getAccountKeysString=b}),98);
__d("MAWKeychainCrypto",["FBLogger","MAWCryptoConsts","MAWKeychainUtil","MAWSubtleCrypto","MAWWebInitDataHelpers","Promise","WABase64","asyncToGeneratorRuntime","memoizeOneWithArgs"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("MAWKeychainUtil").makeAAD(d("MAWCryptoConsts").VERSION,d("MAWCryptoConsts").CIPHER_ID);function a(a,b,e){var f=d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").AES_GCM_IV_LENGTH_IN_BYTES),g=e?e:i;return d("MAWSubtleCrypto").MAWSubtleCrypto.encrypt({additionalData:g,iv:new Uint8Array(f),name:d("MAWCryptoConsts").AES_GCM,tagLength:d("MAWCryptoConsts").AES_GCM_TAG_LENGTH},a,b).then(function(a){a=d("MAWKeychainUtil").mergeBuffers([g,f,a]);return d("WABase64").encodeB64(a)})["catch"](function(b){throw c("FBLogger")("messenger_web").catching(b).mustfixThrow("Failed to encryptDataToStringBuffer",typeof a,a.constructor.name)})}function e(a,b){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c;b=new Uint8Array(d("WABase64").decodeB64(b));var e=b.subarray(0,(c=d("MAWCryptoConsts")).ADDITIONAL_DATA_LENGTH_IN_BYTES),f=b.subarray(c.ADDITIONAL_DATA_LENGTH_IN_BYTES,c.AES_GCM_IV_LENGTH_IN_BYTES+c.ADDITIONAL_DATA_LENGTH_IN_BYTES);b=b.subarray(c.AES_GCM_IV_LENGTH_IN_BYTES+c.ADDITIONAL_DATA_LENGTH_IN_BYTES);e=(yield d("MAWSubtleCrypto").MAWSubtleCrypto.decrypt({additionalData:e,iv:f,name:c.AES_GCM,tagLength:c.AES_GCM_TAG_LENGTH},a,b));return e});return j.apply(this,arguments)}function k(a){a=d("MAWWebInitDataHelpers").getAccountKeysString(a);return a.map(function(a){var b=d("MAWKeychainUtil").fromHexString(a);if(b==null)throw c("FBLogger")("messenger_web").mustfixThrow("Invalid value for account key. Is empty="+String(a.length===0)+";");return b.buffer})}function l(a){return(h||(h=b("Promise"))).all(k(a).map(function(a){return d("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",a,{name:d("MAWCryptoConsts").AES_GCM},!1,["encrypt","decrypt"])}))}function f(){return d("WABase64").encodeB64(d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES))}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WABase64").decodeB64(a);try{a=(yield d("MAWSubtleCrypto").MAWSubtleCrypto.importKey("raw",a,{name:d("MAWCryptoConsts").HKDF},!1,["deriveKey"]));return a}catch(a){c("FBLogger")("messenger_web").catching(a).mustfix("Failed to importBrowserEncryptionKey");throw a}});return n.apply(this,arguments)}function o(){return d("MAWKeychainUtil").getBufferWithRandomValuesFromLength(d("MAWCryptoConsts").HKDF_SEED_LENGTH_IN_BYTES)}function p(a,b){var c;return d("MAWSubtleCrypto").MAWSubtleCrypto.deriveKey({hash:{name:(c=d("MAWCryptoConsts")).SHA256},info:c.HKDF_INFO,name:c.HKDF,salt:b},a,{length:c.AES_GCM_KEY_LENGTH,name:c.AES_GCM},!0,["encrypt","decrypt"]).then(function(a){return d("MAWSubtleCrypto").MAWSubtleCrypto.exportKey("raw",a)})}function q(a){var b=a.slice(0,d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES);b=new DataView(b).getUint8(0);if(b===0){var c,e=a.slice((c=d("MAWCryptoConsts")).ADDITIONAL_DATA_LENGTH_IN_BYTES,c.ADDITIONAL_DATA_LENGTH_IN_BYTES*2);return{aadLengthInBytes:c.ADDITIONAL_DATA_LENGTH_IN_BYTES*2+c.EXTRA_ADDITIONAL_DATA_LENGTH_IN_BYTES,keyVersion:new DataView(e).getUint8(0),originRandomisedVersion:new DataView(a).getUint32(c.ADDITIONAL_DATA_LENGTH_IN_BYTES*2,!0)}}return{aadLengthInBytes:d("MAWCryptoConsts").ADDITIONAL_DATA_LENGTH_IN_BYTES,keyVersion:b}}function r(a){return q(a)}var s=c("memoizeOneWithArgs")(function(a){return l(a)});function t(a){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("WABase64").decodeB64(a);a=(yield d("MAWSubtleCrypto").MAWSubtleCrypto.digest(d("MAWCryptoConsts").SHA256,a));return d("WABase64").encodeB64(a)});return u.apply(this,arguments)}g.ADDITIONAL_DATA=i;g.encryptDataToStringBuffer=a;g.decryptDataToArrayBuffer=e;g.getAccountKeysBuffers=k;g.genAccountKeys=l;g.genBrowserEncryptionKeyString=f;g.importBrowserEncryptionKey=m;g.genDatabaseEncryptionSeed=o;g.genDatabaseEncryptionKey=p;g.getKeyVersionFromCipherData=q;g.getKeyVersionFromCipherDataString=r;g.getAccountKeys=s;g.generateHashString=t}),98);
__d("MAWEARGenNewKeychainCryptoKey",["FBLogger","MAWCryptoConsts","MAWKeychainCrypto","MAWWebInitDataHelpers","MessengerWebInitData","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a,b=d("MAWWebInitDataHelpers").getLastAccountKeyFormatVersion(),e=(yield (a=d("MAWKeychainCrypto")).getAccountKeys(b))[0],f=a.genBrowserEncryptionKeyString(),g=a.genDatabaseEncryptionSeed();e=(yield a.encryptDataToStringBuffer(e,g));g=d("WATimeUtils").castToUnixTime(d("WATimeUtils").unixTime()+d("MAWCryptoConsts").ENC_KEY_TTL);return{accountKeyString:yield a.generateHashString(d("MAWWebInitDataHelpers").getAccountKeysString(b)[0]),appIdOrigin:c("MessengerWebInitData").appId,expiration:g,formatVersion:b,key:f,seed:e,userKeyBaseString:yield a.generateHashString(c("MessengerWebInitData").userKeyBase)}}catch(a){throw c("FBLogger")("messenger_web").catching(a).mustfixThrow("Failed to generateNewKey")}});return h.apply(this,arguments)}g["default"]=a}),98);
__d("MAWEARKeychainDecryptionError",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.name="MAWEARKeychainDecryptionError";c.message=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f["default"]=a}),66);
__d("MAWWorkerSetupArgs",[],(function(a,b,c,d,e,f){"use strict";var g=null;function a(a){g=a}function b(){return g}function c(){g=null}f.setWorkerSetupArgs=a;f.getWorkerSetupArgs=b;f.resetWorkerSetupArgs=c}),66);
__d("MAWGenKeychainCryptoKeyWithVersion",["ExecutionEnvironment","FBLogger","MAWCurrentUser","MAWEARKeychainDecryptionError","MAWKeychainCrypto","MAWWebInitDataHelpers","MAWWorkerSetupArgs","MessengerWebInitData","Promise","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,c,d,e,f,g){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j,k,l){g===void 0&&(g=1);try{var m=(yield d("MAWKeychainCrypto").getAccountKeys(g));a=(yield (i||(i=b("Promise"))).all([d("MAWKeychainCrypto").importBrowserEncryptionKey(a),i.all(m.map(function(a){return d("MAWKeychainCrypto").decryptDataToArrayBuffer(a,e)["catch"](function(){return null})}))]));var n=a[0];m=a[1];a=(yield i.all(m.filter(Boolean).map(function(a){return d("MAWKeychainCrypto").genDatabaseEncryptionKey(n,a)["catch"](function(){return null})})));m=a.filter(Boolean);if(m.length===0)throw new(c("MAWEARKeychainDecryptionError"))("Failed to generate keys from seed");return{keys:m,version:f}}catch(b){a=null;m=null;f=d("MAWWorkerSetupArgs").getWorkerSetupArgs();(h||(h=c("ExecutionEnvironment"))).isInWorker&&f!=null&&(a=f.userKeyBase===c("MessengerWebInitData").userKeyBase,m=f.fbId===d("MAWCurrentUser").getID());f=d("MAWWebInitDataHelpers").getAccountKeysString(g);var o=f&&f[0]!=null?yield d("MAWKeychainCrypto").generateHashString(f[0]):null;c("FBLogger")("messenger_web").catching(b).mustfix("Failed to genKeyWithVersion: accountKeyBackfilled = %s; accountKeyExists = %s; acccountKeyMatches = %s; userKeyBaseBackilled = %s; userKeyBaseExists = %s; userKeyBaseMatches = %s; appIdOrigin = %s; appIdInitData = %s; userIdMatches = %s; isInWorker = %s; userKeyBase_match_between_threads = %s; userId_match_between_threads = %s; formatVersion = %s;",j!=null,f!=null,j===o,k!=null,c("MessengerWebInitData").userKeyBase!=null,k===(yield d("MAWKeychainCrypto").generateHashString(c("MessengerWebInitData").userKeyBase)),l,c("MessengerWebInitData").appId,d("MAWCurrentUser").getID()===String(c("MessengerWebInitData").userId),(h||(h=c("ExecutionEnvironment"))).isInWorker,a,m,g);throw b}});return j.apply(this,arguments)}g["default"]=a}),98);
__d("MAWKeychainNaClCrypto",["MAWKeychainCrypto","WABase64","tweetnacl"],(function(a,b,c,d,e,f,g){"use strict";var h=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this,a)||this;c.name="EARError";c.message=a;return c}return a}(babelHelpers.wrapNativeSuper(Error));function i(a,b,c){c=new Uint8Array(c);var e=d("tweetnacl").randomBytes(d("tweetnacl").secretbox.nonceLength);b=d("tweetnacl").secretbox(b,e,new Uint8Array(a));a=new Uint8Array(c.length+e.length+b.length);a.set(c);a.set(e,c.length);a.set(b,c.length+e.length);return a.buffer}function j(a,b,c){return d("WABase64").encodeB64(i(a,b,c!=null?c:d("MAWKeychainCrypto").ADDITIONAL_DATA))}function k(a,b,c,e,f){b.slice(0,f);var g=b.slice(f,f+d("tweetnacl").secretbox.nonceLength);b=b.slice(f+d("tweetnacl").secretbox.nonceLength);f=d("tweetnacl").secretbox.open(new Uint8Array(b),new Uint8Array(g),new Uint8Array(a));if(f==null)throw new h("decryptTweetNaCl was unable to decrypt an entity. Attempting to use key version : "+(c!=null?c:"non-provided")+". Format version "+(e!=null?e:"unknown")+".");return f}function l(a,b,c,e){return k(a,d("WABase64").decodeB64(b),c,void 0,e)}function a(a,b,c){return j(a,b,c)}function b(a,b,c,d){return l(a,b,c,d)}function c(a,b,c,d,e){return k(a,b,c,d,e)}g.EARDecryptionError=h;g.encryptTweetNaClArrayBuffer=i;g.encryptTweetNaCl=j;g.decryptTweetNaClArrayBuffer=k;g.decryptTweetNaCl=l;g.encrypt=a;g.decrypt=b;g.decryptArrayBuffer=c}),98);
__d("WebStorageLockManager",["FBLogger","LocalStorageWrapper","LockManager","Promise","Run","asyncToGeneratorRuntime","clearInterval","err","promiseDone","setInterval","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){c("FBLogger")("messenger_web").mustfix(a)}function a(a,e){var f="Failed to execute 'request' on 'LockManager'",g="Lock broken by another request with the 'steal' option.",j=function(a,b,c){var d=a.get(b);if(d!=null)return d;d=c();a.set(b,d);return d};try{var k=d("LocalStorageWrapper").getStorage(i),l=function(a,b){d("LocalStorageWrapper").setItemGuarded(k,a,b,i,e==null?void 0:e.onQuotaExceeded)},m=function(a){d("LocalStorageWrapper").removeItemGuarded(k,a,i)},n=function(a){return d("LocalStorageWrapper").getItemGuarded(k,a,i)},o=function(){function a(a,b){this.lockName=a,this.tabId=b,this.lockA=this.lockName+"-a",this.lockB=this.lockName+"-b"}var d=a.prototype;d.run=function(a){return this.$1(a,0)};d.$1=function(a,d){var e=this,f=function(b){return window.requestAnimationFrame(function(){return e.$1(a,d+1).then(b)})},g=function(a){return n(a)==null};l(this.lockA,this.tabId);return new(h||(h=b("Promise")))(function(b){var h=function(){try{a(),b()}finally{m(e.lockB),m(e.lockA)}};g(e.lockB)||d>10?(d>10&&c("FBLogger")("messenger_web").warn("web-lock polyfill: Had to steal lock"),l(e.lockB,e.tabId),n(e.lockA)===e.tabId?h():window.requestAnimationFrame(function(){n(e.lockB)===e.tabId?h():f(b)})):f(b)})};return a}(),p=function(){function a(b){this.tabId=b,this.lock=new o(a.tabsKey,b),c("promiseDone")(this.$1()),this.$2(),this.keepOnlyTabs(function(b){return a.isAlive(b)})}a.isAlive=function(b){b=n(a.$3(b));return b==null?!1:Date.now()-parseFloat(b)<1e3};var e=a.prototype;e.keepOnlyTabs=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield this.lock.run(function(){var c;c=JSON.parse((c=n(a.tabsKey))!=null?c:"[]").filter(b);c.length>0?l(a.tabsKey,JSON.stringify(c)):m(a.tabsKey)})});function d(a){return c.apply(this,arguments)}return d}();e.$2=function(){var b=a.$3(this.tabId);l(b,Date.now().toString());var e=c("setInterval")(function(){l(b,Date.now().toString())},500);d("Run").onUnload(function(){c("clearInterval")(e),m(b)})};e.$1=function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=this;yield this.lock.run(function(){var c;c=JSON.parse((c=n(a.tabsKey))!=null?c:"[]");l(a.tabsKey,JSON.stringify([].concat(c,[b.tabId])))});d("Run").onUnload(function(){return c("promiseDone")(b.keepOnlyTabs(function(a){return a!==b.tabId}))})});function f(){return e.apply(this,arguments)}return f}();a.$3=function(a){return"$navigator.heartbeat-"+a};return a}();p.tabsKey="$navigator.heartbeat-tabs";var q=function(){function a(b,e){var f=this;this.requests=new Map();this.name=b;this.tabId=e;this.queueKey=a.storagePrefix+"-"+b+"-q";this.currentOwnerKey=a.storagePrefix+"-"+b+"-o";this.lock=new o(a.storagePrefix+"-"+b,this.tabId);d("Run").onUnload(function(){c("promiseDone")(f.keepOnlyRequests(function(a){return(a==null?void 0:a.t)!==f.tabId}))})}var e=a.prototype;e.enqueue=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,d,a){var e=this,f=c("uuidv4")().toString(),g={t:this.tabId,u:f},h=function(){b(null),e.markRequestReleased(f)},i=function(){b(f),e.markRequestReleased(f)};this.requests.set(f,[function(){return b(f)},function(){d(),e.markRequestReleased(f)}]);if((a==null?void 0:a.signal)!=null){a.signal.onabort=function(){c("promiseDone")(e.keepOnlyRequests(function(a){return(a==null?void 0:a.u)!==f})),i()};if(a.signal.aborted)return i()}yield this.lock.run(function(){var b=e.getOwner();(a==null?void 0:a.steal)===!0&&e.$1(b==null?void 0:b.u);if(b==null||(a==null?void 0:a.steal)===!0||!p.isAlive(b.t))e.$2(e.currentOwnerKey,babelHelpers["extends"]({},g,{},(a==null?void 0:a.steal)===!0?{s:!0}:{})),e.$3(f);else if((a==null?void 0:a.ifAvailable)!==!0){b=e.getQueue();b.push(g);e.$2(e.queueKey,b)}else h()})});function d(b,c,d){return a.apply(this,arguments)}return d}();e.dequeue=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=this,d,e=null;yield this.lock.run(function(){var d=c.getOwner();if((d==null?void 0:d.t)!==c.tabId||(d==null?void 0:d.u)!==b)return;d=c.getQueue();d=a.getNextOwner(d);var f=d[0];d=d[1];e=f;c.$2(c.currentOwnerKey,f);c.$2(c.queueKey,d)});this.$3((d=e)==null?void 0:d.u)});function d(a){return c.apply(this,arguments)}return d}();e.storageChangedOnOtherTab=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=this;a==="o"&&(yield this.lock.run(function(){var a=c.getOwner();if(a==null)return;c.$3(a==null?void 0:a.u);if(a.s===!0){a=b==null?void 0:b.oldValue;if(a!=null){a=JSON.parse(a);a.t===c.tabId&&c.$1(a.u)}}}))});function c(b,c){return a.apply(this,arguments)}return c}();e.getQueue=function(){var a;return(a=this.$4(this.queueKey))!=null?a:[]};e.getOwner=function(){return this.$4(this.currentOwnerKey)};a.getQueueNameAndStorageType=function(b){if(!b.startsWith(a.storagePrefix))return null;var d=b.slice(a.storagePrefix.length+1,b.length-2),e=b.charAt(b.length-1);switch(e){case"q":case"o":case"a":case"b":break;default:throw c("err")("Queue was stored with a suffix other than q or o. This is either a bug in the web lock api polyfill code, or it means that something overwrote localStorage with a weird key. Key: "+b)}return[d,e]};a.getNextOwner=function(a){for(var b=0;b<a.length;b+=1)if(p.isAlive(a[b].t))return[a[b],a.slice(b+1)];return[null,[]]};e.$4=function(a){a=n(a);return a!=null?JSON.parse(a):null};e.$2=function(a,b){b=b==null||Array.isArray(b)&&b.length===0?null:JSON.stringify(b);b==null?m(a):l(a,b)};e.keepOnlyRequests=function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=this;yield this.lock.run(function(){var d=c.getOwner(),e=c.getQueue().filter(b);if(b(d))c.$2(c.queueKey,e);else{d=a.getNextOwner(e);e=d[0];d=d[1];c.$2(c.currentOwnerKey,e);c.$2(c.queueKey,d)}})});function d(a){return c.apply(this,arguments)}return d}();e.markRequestReleased=function(a){a!=null&&this.requests["delete"](a)};e.$3=function(a){if(a!=null){a=this.requests.get(a);if(a!=null){a=a[0];a()}}};e.$1=function(a){if(a!=null){a=this.requests.get(a);if(a!=null){a[0];a=a[1];a()}}};return a}();q.storagePrefix="$navigator.locks";var r=function(){function a(a){this.$1=new Map(),this.storage=d("LocalStorageWrapper").getStorage(i),this.tabId=a,new p(this.tabId),c("promiseDone")(this.$2()),this.$3()}var e=a.prototype;e.request=function(){var a=this;for(var e=arguments.length,i=new Array(e),j=0;j<e;j++)i[j]=arguments[j];return new(h||(h=b("Promise")))(function(e,j){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var k,l=i[0],e=i.length===3?i[1]:null,m=i.length===2?i[1]:i[2];if(l.startsWith("-"))throw new DOMException("Names cannot start with '-'.",f);if((e==null?void 0:e.ifAvailable)===!0&&(e==null?void 0:e.signal)!=null)throw new DOMException("The 'signal' and 'ifAvailable' options cannot be used together.",f);var n=a.$4(l),o=(yield new(h||(h=b("Promise")))(function(a){c("promiseDone")(n.enqueue(a,function(){j(new DOMException(g,f))},e))}));if((e==null?void 0:(k=e.signal)==null?void 0:k.aborted)===!0)throw new DOMException("The request was aborted.",f);try{yield m(o!=null?{mode:(k=e==null?void 0:e.mode)!=null?k:d("LockManager").LockMode.Exclusive,name:l}:null)}finally{o!=null&&(yield n.dequeue(o)),n.markRequestReleased(o)}})(),e,j)})};e.query=function(){var a=[],c=[];for(var e of this.$5())if(e!=null){var f={mode:d("LockManager").LockMode.Exclusive,name:e.name};if(e.getOwner()!=null)a.push(f);else for(var g of e.getQueue())c.push(f)}return(h||(h=b("Promise"))).resolve({held:a,pending:c})};e.$4=function(a){var b=this;return j(this.$1,a,function(){return new q(a,b.tabId)})};e.$3=function(){var a=this;window.addEventListener("storage",function(b){var d=b.key;if(b.storageArea!==a.storage||d==null)return;d=q.getQueueNameAndStorageType(d);if(d==null)return;var e=d[0];d=d[1];c("promiseDone")((e=a.$4(e))==null?void 0:e.storageChangedOnOtherTab(d,b))})};e.$2=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield (h||(h=b("Promise"))).all(this.$5().map(function(a){return a==null?void 0:a.keepOnlyRequests(function(a){return a==null?!1:p.isAlive(a.t)})}))});function c(){return a.apply(this,arguments)}return c}();e.$5=function(){var a=this;return k==null?[]:Object.keys(k).map(function(b){b=q.getQueueNameAndStorageType(b);if(b==null)return;b=b[0];return a.$4(b)})};return a}();return new r(a)}catch(a){return null}}g.make=a}),98);
__d("mergeDeepInto",["invariant","mergeHelpers"],(function(a,b,c,d,e,f,g){"use strict";var h=(c=b("mergeHelpers")).ArrayStrategies,i=c.checkArrayStrategy,j=c.checkMergeArrayArgs,k=c.checkMergeLevel,l=c.checkMergeObjectArgs,m=c.isTerminal,n=c.normalizeMergeArg,o=function(a,b,c,d){l(a,b);k(d);var e=b?Object.keys(b):[];for(var f=0;f<e.length;f++){var g=e[f];q(a,b,g,c,d)}},p=function(a,b,c,d){j(a,b);k(d);if(c===h.Concat)a.push.apply(a,b);else{var e=Math.max(a.length,b.length);for(var f=0;f<e;f++)q(a,b,f,c,d)}},q=function(a,b,c,d,e){var f=b[c];b=Object.prototype.hasOwnProperty.call(b,c);var i=b&&m(f),j=b&&Array.isArray(f),k=b&&!j&&!j,l=a[c],n=Object.prototype.hasOwnProperty.call(a,c),q=n&&m(l),r=n&&Array.isArray(l),s=n&&!r&&!r;q?i?a[c]=f:j?(a[c]=[],p(a[c],f,d,e+1)):k?(a[c]={},o(a[c],f,d,e+1)):b||(a[c]=l):r?i?a[c]=f:j?(d&&h[d]||g(0,5117),d===h.Clobber&&(l.length=0),p(l,f,d,e+1)):k&&(a[c]={},o(a[c],f,d,e+1)):s?i?a[c]=f:j?(a[c]=[],p(a[c],f,d,e+1)):k&&o(l,f,d,e+1):n||(i?a[c]=f:j?(a[c]=[],p(a[c],f,d,e+1)):k&&(a[c]={},o(a[c],f,d,e+1)))};function a(a,b,c){b=n(b);i(c);o(a,b,c,0)}f["default"]=a}),66);
__d("MWPreloadableQueries",["I64","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;b=function(a,b){return d("ReQL").fromTableAscending(a.tables.thread_nullstate).getKeyRange(b)};c=function(a,b){return d("ReQL").fromTableAscending(a.tables.thread_nullstate_ctas.index("threadKeyCtaId")).getKeyRange(b)};e=function(a,b){return d("ReQL").fromTableAscending(a.tables.cutover_threads).getKeyRange(b)};f=function(a,b){return d("ReQL").fromTableAscending(a.tables.community_folders).getKeyRange(b)};var i=function(a,b){return d("ReQL").fromTableAscending(a.tables.thread_proactive_warning_settings).getKeyRange(b)},j=function(a,b){return d("ReQL").fromTableAscending(a.tables.in_thread_banner).getKeyRange(b)};function a(a,b){return d("ReQL").fromTableAscending(a.tables.media_staging).filter(function(a){return!a.isSent&&(h||(h=d("I64"))).equal(a.threadKey,b)})}g.threadNullStateQuery=b;g.threadNullStateCtaQuery=c;g.getCutoverThreadByThreadKey=e;g.getCommunityFolderQuery=f;g.getProactiveWarningsForThreadQuery=i;g.getThreadBannerQuery=j;g.getMediaStagingQuery=a}),98);
__d("mergeDeep",["mergeDeepInto","mergeHelpers"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d){var e;a=(e=c("mergeHelpers")).normalizeMergeArg(a);b=e.normalizeMergeArg(b);e.checkMergeObjectArgs(a,b);e.checkArrayStrategy(d);e={};c("mergeDeepInto")(e,a,d);c("mergeDeepInto")(e,b,d);return e}g["default"]=a}),98);
__d("MAWThreadMappingQPL",["I64","JSResourceForInteraction","LSIntEnum","MAWLoggerUtils","MAWMiActMappingTableAPI","MAWQplProxy","MAWThreadMappingState","QPLUserFlow","Random","ReQL","WAJids","asyncToGeneratorRuntime","promiseDone","qpl","sendToSentQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=new Map(),k=new Set();function a(a){k.add(a)}function l(a,b){var c=a.actState;a=a.miState;return!k.has(b)?!1:c===d("MAWThreadMappingState").ActState.READY&&a===d("MAWThreadMappingState").MiState.OPTIMISTIC}var m=c("JSResourceForInteraction")("MAWWaitForBackendSetup").__setRef("MAWThreadMappingQPL"),n=c("qpl")._(1056836502,"2778"),o=c("qpl")._(25313175,"1551"),p=null;function e(a){return d("MAWLoggerUtils").getInstanceKeyFromId(a)}function q(a){return d("MAWLoggerUtils").getInstanceKeyFromId((h||(h=d("I64"))).to_string(a)+d("Random").random().toString())}function f(a,b,c){var e=j.get((h||(h=d("I64"))).to_string(a.jid));if(e!=null){t("continue_thread_mapping_after_tpq",e);c!=null&&v({bool:babelHelpers["extends"]({},c)},e);j["delete"]((h||(h=d("I64"))).to_string(a.jid));return e}e=(e=a.instanceKey)!=null?e:q(a.fbid);c=c!=null?c:{};var f=c.hasMappingRowAlready,g=c.hasPlaceholderRowInserted,i=c.isExistingRowPlaceholder;c=c.isExpectedThreadMissingInLsdb;var k=a.jid;r({hasMappingRowAlready:f,hasPlaceholderRowInserted:g,instanceKey:e,isExistingRowPlaceholder:i,isExpectedThreadMissingInLsdb:c,jid:a.isGroupThread?d("WAJids").toGroupJid((h||(h=d("I64"))).to_string(k)):d("WAJids").toMsgrUserJid((h||(h=d("I64"))).to_string(k)),threadKey:a.fbid,trigger:b});return e}function r(a){var b=a.instanceKey,e=a.s2sInstanceKey,f=babelHelpers.objectWithoutPropertiesLoose(a,["instanceKey","s2sInstanceKey"]);p=e;d("sendToSentQPLLogger").markSendToSentPoint(e,"thread_mapping_start",void 0,{string:{thread_state:a.threadState}});c("QPLUserFlow").start(n,{annotations:G(f),instanceKey:b});c("promiseDone")(m.load(),function(a){a=a.runAfterBackendSetup;a(function(){return t("maw_backend_available",b)},"bulkCreateOrUpdateThread")})}function s(a){var b=a.instanceKey;a.s2sInstanceKey;a=babelHelpers.objectWithoutPropertiesLoose(a,["instanceKey","s2sInstanceKey"]);d("MAWQplProxy").startQplUserFlow(n,G(a),{providedInstanceKey:b})}function t(a,b){c("QPLUserFlow").addPoint(n,a,{instanceKey:b}),p!=null&&c("QPLUserFlow").addPoint(o,"thread_mapping_"+a,{instanceKey:p})}function u(a,b){t("handle_existing_thread_fail",a);var c=b==null?"no_thread":"not_authoritative";b=b==null?void 0:(i||(i=d("LSIntEnum"))).toNumber(b.authorityLevel);v({"int":{insufficientAuthorityLevel:b},string:{handleExistingThreadFailReason:c}},a)}function v(a,b){c("QPLUserFlow").addAnnotations(n,a,{instanceKey:b})}var w=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){var e=a+"_start";a=a+"_end";c("QPLUserFlow").addPoint(n,e,{instanceKey:b});e=(yield d());c("QPLUserFlow").addPoint(n,a,{instanceKey:b});return e});return function(b,c,d){return a.apply(this,arguments)}}(),x=function(a,b,c){return b==null?c():w(a,b,c)};function y(a,b){v({bool:{isResultVerified:!0},string:{finalActState:b.actState.toString(),finalMiState:b.miState.toString()}},a),d("sendToSentQPLLogger").markSendToSentPoint(p,"thread_mapping_end"),d("MAWThreadMappingState").isReady(b)||l(b,a)?c("QPLUserFlow").endSuccess(n,{instanceKey:a}):B("thread_state_not_ready",a)}function z(a){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,c=a.instanceKey,e=a.intJid,f=a.tables;a=a.threadKey;if(a==null&&e==null){B("no_thread_key_nor_jid",c);return}e=(yield H(f,{intJid:e,threadKey:a}));b=(b=e==null?void 0:e.serverThreadKey)!=null?b:a;a=b==null?null:yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(f.threads).getKeyRange(b));y(c,yield d("MAWThreadMappingState").getMappingStateForDbRows(a,e))});return A.apply(this,arguments)}function B(a,b){d("sendToSentQPLLogger").markSendToSentPoint(p,"thread_mapping_fail",void 0,{string:{threadMappingFailReason:a}}),c("QPLUserFlow").endFailure(n,a,{instanceKey:b})}function C(a,b){d("sendToSentQPLLogger").markSendToSentPoint(p,"thread_mapping_fail",void 0,{string:{threadMappingFailReason:a.message}}),c("QPLUserFlow").endFailure(n,"error_thrown",{annotations:{string:{errorMessage:a.message}},instanceKey:b})}function D(a,b,c){d("MAWQplProxy").sendQPLFailThroughBridge(n,a,c,b)}function E(a,b){t(a,b),c("QPLUserFlow").endCancel(n,{instanceKey:b})}function F(a,b){d("MAWQplProxy").sendQPLCancelThroughBridge(n,{string:{cancelInWorkerReason:a}},b)}function G(a){var b=a.hasMappingRowAlready,c=a.hasPlaceholderRowInserted,e=a.isExistingRowPlaceholder,f=a.isExpectedThreadMissingInLsdb,g=a.jid,i=a.threadKey,j=a.threadState;a=a.trigger;return{bool:{hasMappingRowAlready:b,hasPlaceholderRowInserted:c,isExistingRowPlaceholder:e,isExpectedThreadMissingInLsdb:f},string:{initJid:g,initThreadKey:i==null?null:(h||(h=d("I64"))).to_string(i),initThreadState:j==null?void 0:j.toString(),trigger:a}}}function H(a,b){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=b.intJid;b=b.threadKey;b=(yield d("MAWMiActMappingTableAPI").getMappingRowForThreadKey(a,b));return b!=null?b:d("MAWMiActMappingTableAPI").getMappingRowForIntJid(a,c)});return I.apply(this,arguments)}g.pendingThreadCreationOnServer=j;g.allowToSkipUpgradingOptimisticThreadInMI=a;g.getInstanceKeyForJidInWorker=e;g.getInstanceKeyForThreadKey=q;g.startOrContinueForMiActMappingParams=f;g.start=r;g.startInWorker=s;g.addPoint=t;g.handleExistingThreadFail=u;g.addAnnotations=v;g.measurePerformance=w;g.measurePerformanceForNullableInstanceKey=x;g.endForThreadState=y;g.end=z;g.endFailure=B;g.endFailureError=C;g.endFailureInWorker=D;g.endCancel=E;g.endCancelInWorker=F}),98);
__d("MAWThreadMappingState",["I64","LSAuthorityLevel","LSIntEnum","MAWJids","MAWMiActMappingTableAPI","MAWThreadMappingQPL","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k={MISSING:"MISSING",OPTIMISTIC:"OPTIMISTIC",PARTIAL:"PARTIAL",READY:"READY"},l={IN_PROGRESS:"IN_PROGRESS",MISSING:"MISSING",READY:"READY"};function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){b=(yield d("MAWMiActMappingTableAPI").getMappingRowForChatJid(a,b));if(b==null)return{mappingState:{actState:l.MISSING,miState:k.MISSING},threadKey:null};a=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(b.serverThreadKey)));return{mappingState:q(a,b),threadKey:b.serverThreadKey}});return n.apply(this,arguments)}function a(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield m(a,b));b=a.mappingState;return b});return o.apply(this,arguments)}function e(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=(yield (j||(j=b("Promise"))).all([d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.threads).getKeyRange(c)),d("MAWMiActMappingTableAPI").getMappingRowForThreadKey(a,c)]));c=a[0];a=a[1];return q(c,a)});return p.apply(this,arguments)}function q(a,b){return{actState:r(b),miState:s(a)}}function f(a){return a.miState===k.READY&&a.actState===l.READY}function r(a){return a==null?l.MISSING:v(a.clientThreadPk)?l.IN_PROGRESS:l.READY}function s(a){if(a==null)return k.MISSING;a=(h||(h=d("LSIntEnum"))).toNumber(a.authorityLevel);if(a===c("LSAuthorityLevel").AUTHORITATIVE)return k.READY;return a===c("LSAuthorityLevel").OPTIMISTIC?k.OPTIMISTIC:k.PARTIAL}function t(a,b,c){return u.apply(this,arguments)}function u(){u=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){yield a.mi_act_mapping_table.put({clientThreadPk:(i||(i=d("I64"))).neg(b),jid:c,serverThreadKey:b})});return u.apply(this,arguments)}function v(a){return(i||(i=d("I64"))).lt(a,i.zero)}function w(a,b,c){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=b.jid;b=b.threadKey;c===void 0&&(c=null);yield y(a,{intJid:d("MAWJids").convertChatJidToIntJid(e),threadKey:b},c)});return x.apply(this,arguments)}function y(a,b,c){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=b.intJid;b=b.threadKey;c===void 0&&(c=null);c!=null&&d("MAWThreadMappingQPL").addPoint("insert_mapping_row",c);yield a.mi_act_mapping_table.put({clientThreadPk:e,jid:e,serverThreadKey:b})});return z.apply(this,arguments)}function A(a,b){return m(a,b).then(function(a){var b=a.mappingState;a=a.threadKey;return b.miState===k.MISSING?null:a})}g.MiState=k;g.ActState=l;g.genMappingStateAndThreadKeyFromJid=m;g.genMappingStateFromJid=a;g.genMappingState=e;g.getMappingStateForDbRows=q;g.isReady=f;g.getActState=r;g.getMiState=s;g.markActThreadMappingAsInProgress=t;g.markActThreadMappingAsCompletedForJid=w;g.markActThreadMappingAsCompleted=y;g.getThreadKeyIfMiThreadNotMissing=A}),98);
__d("MAWTimeUtils",["FBLogger","I64","WATimeUtils"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a){return(h||(h=d("I64"))).of_float(a*1e3)}function j(a){a=Number(a);return a<=d("WATimeUtils").MAX_INT&&a!==-1e3&&a!==0}function a(a){if(j(a)){Number(a)!==-1&&c("FBLogger")("messenger_web").mustfix("Invalid timestamp supplied to millisTimeToTimestamp: %s",Number(a));return i(a)}return(h||(h=d("I64"))).of_float(a)}function b(a,b){var c=Date.now();c=c-b*24*60*60*1e3;b=d("WATimeUtils").castMilliSecondsToUnixTime(c);return a>=b}function e(a){if(a==null)return;if(j(a)){Number(a)!==-1&&c("FBLogger")("messenger_web").mustfix("Invalid timestamp supplied to ensureValidMillisTime: %s",Number(a));return d("WATimeUtils").castToMillisTime(a*1e3)}return a}f=(h||(h=d("I64"))).of_string("9999999999999");var k=Number.MAX_VALUE;g.toTimestamp=i;g.millisTimeToTimestamp=a;g.isTimestampNewerThanXDays=b;g.ensureValidMillisTime=e;g.MAX_TIMESTAMP_MS=f;g.MAX_TIMESTAMP=k;g.MIN_TIMESTAMP_MS=h.zero}),98);
__d("MWBroadcastChannelPolyfill",["FBLogger","LocalStorageWrapper","MessengerLogHistory","Random","recoverableViolation","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=d("MessengerLogHistory").getInstance("client_init");function a(a){h.debug("[MWBroadcastChannelPolyfill] "+a)}function i(a){c("FBLogger")("messenger_web").mustfix(a)}var j={},k=d("LocalStorageWrapper").getStorage(a);function b(a){var b="$BroadcastChannel$"+a+"$",e=!1,f=function(a){if(a.storageArea!==k)return;var c=a.newValue;if(c==null||c==="")return;if(((a=a.key)==null?void 0:a.substring(0,b.length))!==b)return;var d=JSON.parse(c);(a=j[b])==null?void 0:a.forEach(function(a){a({data:d})})};window.addEventListener("storage",f);return{addEventListener:function(a,c){j[b]=j[b]||new Set(),j[b].add(c)},close:function(){if(e)return;e=!0;j={};window.removeEventListener("storage",f)},postMessage:function(a){if(e){c("recoverableViolation")("Broadcast channel is closed","ls_web_init");return}a=JSON.stringify(a);var f=b+String(Date.now())+"$"+String(c("Random").uint32());d("LocalStorageWrapper").setItemGuarded(k,f,a,i);c("setTimeout")(function(){d("LocalStorageWrapper").removeItemGuarded(k,f,i)},500)},removeEventListener:function(a,c){(a=j[b])==null?void 0:a["delete"](c)}}}g["default"]=b}),98);
__d("MWBroadcastChannel",["MWBroadcastChannelPolyfill"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return self.BroadcastChannel!=null?new self.BroadcastChannel(a):c("MWBroadcastChannelPolyfill")(a)}g.MWBroadcastChannel=a}),98);
__d("MWEARKeychainV3Errors",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.name="EARKeychainNotFoundError";c.message=b;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.EARKeychainNotFoundError=a}),66);
__d("MWLSContactTypeExactUtils",["I64","LSContactTypeExact","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){if((h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactTypeExact").IG_USER))||(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactTypeExact").IG_BUSINESS_USER)))return!0;else return(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSContactTypeExact").IG_CREATOR_USER))}g.isIgContact=a}),98);
__d("MWLSDatabaseNames",[],(function(a,b,c,d,e,f){"use strict";a="LightSpeed";b=a+"V3";f.name=a;f.lightspeedPrefix=b}),66);
__d("MWLSIndexedDBName",["MAWCurrentUser","MWLSDatabaseNames"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("MAWCurrentUser").getID();return d("MWLSDatabaseNames").lightspeedPrefix+a}g.dbName=a}),98);
__d("MWLocalStorageErrorHandler",["cr:3449"],(function(a,b,c,d,e,f,g){"use strict";function a(){b("cr:3449")&&b("cr:3449").clearLocalStorageBigValues()}g.onQuotaExceeded=a}),98);
__d("ReStoreLocalStorageQuotaExceed",["FBLogger","recoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h="Failed to execute 'setItem' on 'Storage'",i="ReStoreLocalStorageQuotaExceed";function j(){try{var a=window.localStorage,b=[],d=[];if(a!=null&&a.length!==0)for(var e in a){b.length===0&&d.length===0&&(e.includes("falco_queue_log")&&d.push(e));if(!Object.prototype.hasOwnProperty.call(a,e))continue;var f=((a[e]||"").length+e.length)*2;f/1024>2e3&&b.push(e)}c("FBLogger")("messenger_web").mustfix(h+": QuotaExceeded - trying to clean up %s or %s",b.join(","),d.join(","));return b.length!==0?b:d}catch(a){c("FBLogger")("messenger_web").mustfix("Error getting local storage big values for cleanup.");return[]}}function a(){try{var a=window.localStorage,b=j();b.forEach(function(b){a.removeItem(b)})}catch(a){c("recoverableViolation")("Couldn't remove vals from localStorage","maw_db",a)}}b=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;b=h+": "+b+"; Keys to delete: "+j().join(",");c=a.call(this,b)||this;c.message=b;c.name=i;return c}return b}(babelHelpers.wrapNativeSuper(Error));g.ERROR_NAME=i;g.getLocalStorageValuesToRemoveOnExceed=j;g.clearLocalStorageBigValues=a;g.ReStoreLocalStorageQuotaExceed=b}),98);
__d("ReStoreTabNotifier",["CurrentMessengerUser","FBLogger","MWBroadcastChannel","MWLSIndexedDBName"],(function(a,b,c,d,e,f,g){"use strict";var h=d("CurrentMessengerUser").getIDorEIMU();function a(a){var b=d("MWBroadcastChannel").MWBroadcastChannel(a==="restore-table-"+h+"-"+d("MWLSIndexedDBName").dbName()?"mwChat-"+h:a);function e(a,d){try{b.postMessage([a,d])}catch(a){c("FBLogger")("messenger_web").catching(a).warn("Failed to broadcast changes")}}function f(a,c){b.addEventListener("message",function(b){b=b.data;var d=b[0];d===a&&c(b[1])})}return{onEventReceive:f,postMessage:e}}g["default"]=a}),98);
__d("cometIsMimeTypeForMedia",["FBLogger","UFICommentFileInputAcceptValues"],(function(a,b,c,d,e,f,g){"use strict";var h={file:null,photo:null,video:null},i={"image/gif":"video","image/webp":"video"};function j(a){return a.split(",").map(function(a){return a.trim()}).map(function(a){return a.replace(/\/\*$/,"/")})}function k(a,b,d){h[a]==null&&(h[a]=j(d));d=h[a];if(d==null)throw c("FBLogger")("ufi2").mustfixThrow("CometIsMimeTypeForMedia prefixes can't be null");var e=i[b];return e!=null?e===a:d.some(function(a){return b.startsWith(a)})}function a(a){return k("photo",a,d("UFICommentFileInputAcceptValues").photos)}function b(a){return k("video",a,d("UFICommentFileInputAcceptValues").videos)}function e(a){return k("file",a,d("UFICommentFileInputAcceptValues").files)}g.mimeTypeAcceptStringToArray=j;g.isMimeTypeForPhoto=a;g.isMimeTypeForVideo=b;g.isMimeTypeForFile=e}),98);
__d("promiseFromRequest",[],(function(a,b,c,d,e,f){"use strict";function a(a){return new self.Promise(function(b,c){a.onsuccess=function(a){b(a.target.result)},a.onerror=function(a){c(a)}})}f["default"]=a}),66);/*FB_PKG_DELIM*/
__d("CacheStorage",["ErrorGuard","ExecutionEnvironment","WebStorage","cr:6943","cr:8958","emptyFunction","err"],(function(a,b,c,d,e,f,g){var h,i,j,k="_@_",l="3b",m="CacheStorageVersion",n={length:0,getItem:a=c("emptyFunction"),setItem:a,clear:a,removeItem:a,key:a};d=function(){function a(a){this._store=a}var b=a.prototype;b.getStore=function(){return this._store};b.keys=function(){var a=[];for(var b=0;b<this._store.length;b++){var c=this._store.key(b);c!=null&&a.push(c)}return a};b.get=function(a){return this._store.getItem(a)};b.set=function(a,b){this._store.setItem(a,b)};b.remove=function(a){this._store.removeItem(a)};b.clear=function(){this._store.clear()};b.clearWithPrefix=function(a){a=a||"";var b=this.keys();for(var c=0;c<b.length;c++){var d=b[c];d!=null&&d.startsWith(a)&&this.remove(d)}};return a}();e=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b;return a.call(this,(b=(h||(h=c("WebStorage"))).getLocalStorage())!=null?b:n)||this}b.available=function(){return!!(h||(h=c("WebStorage"))).getLocalStorage()};return b}(d);g=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b;return a.call(this,(b=(h||(h=c("WebStorage"))).getSessionStorage())!=null?b:n)||this}b.available=function(){return!!(h||(h=c("WebStorage"))).getSessionStorage()};return b}(d);var o=function(){function a(){this._store={}}var b=a.prototype;b.getStore=function(){return this._store};b.keys=function(){return Object.keys(this._store)};b.get=function(a){return this._store[a]===void 0?null:this._store[a]};b.set=function(a,b){this._store[a]=b};b.remove=function(a){a in this._store&&delete this._store[a]};b.clear=function(){this._store={}};b.clearWithPrefix=function(a){a=a||"";var b=this.keys();for(var c=0;c<b.length;c++){var d=b[c];d.startsWith(a)&&this.remove(d)}};a.available=function(){return!0};return a}(),p={memory:o,localstorage:e,sessionstorage:g};a=function(){function a(a,d){this._changeCallbacks=[];this._key_prefix="_cs_";this._exception=null;d&&(this._key_prefix=d);a==="AUTO"||!a?d="memory":d=a;d&&(!p[d]||!p[d].available()?((i||(i=c("ExecutionEnvironment"))).canUseDOM,this._backend=new o()):this._backend=new p[d]());a=this.useBrowserStorage();a&&b("cr:6943").listen(window,"storage",this._onBrowserValueChanged.bind(this));d=a?this._backend.getStore().getItem(m):this._backend.getStore()[m];d!==l&&this.clearOwnKeys()}var d=a.prototype;d.useBrowserStorage=function(){return this._backend.getStore()===(h||(h=c("WebStorage"))).getLocalStorage()||this._backend.getStore()===(h||(h=c("WebStorage"))).getSessionStorage()};d.addValueChangeCallback=function(a){var b=this;this._changeCallbacks.push(a);return{remove:function(){b._changeCallbacks.slice(b._changeCallbacks.indexOf(a),1)}}};d._onBrowserValueChanged=function(a){this._changeCallbacks&&String(a.key).startsWith(this._key_prefix)&&this._changeCallbacks.forEach(function(b){b(a.key,a.oldValue,a.newValue)})};d.keys=function(){var a=this,b=[];(j||(j=c("ErrorGuard"))).guard(function(){if(a._backend){var c=a._backend.keys(),d=a._key_prefix.length;for(var e=0;e<c.length;e++)c[e].substr(0,d)==a._key_prefix&&b.push(c[e].substr(d))}},{name:"CacheStorage"})();return b};d.set=function(d,e,f){if(this._backend){if(this.useBrowserStorage()&&a._persistentWritesDisabled){this._exception=c("err")("writes disabled");return!1}var g;typeof e==="string"?g=k+e:!f?(g={__t:Date.now(),__v:e},g=b("cr:8958").stringify(g)):g=b("cr:8958").stringify(e);f=this._backend;e=this._key_prefix+d;d=!0;var h=null;while(d)try{h=null,f.set(e,g),d=!1}catch(a){h=a;var i=f.keys().length;this._evictCacheEntries();d=f.keys().length<i}if(h!==null){this._exception=h;return!1}else{this._exception=null;return!0}}this._exception=c("err")("no back end");return!1};d.getLastSetExceptionMessage=function(){return this._exception?this._exception.message:null};d.getLastSetException=function(){return this._exception};d.getStorageKeyCount=function(){var a=this._backend;return a?a.keys().length:0};d._evictCacheEntries=function(){var c=[],d=this._backend;d.keys().forEach(function(e){if(e===m)return;var g=d.get(e);if(g===void 0){d.remove(e);return}if(a._hasMagicPrefix(g))return;try{g=b("cr:8958").parse(g,f.id)}catch(a){d.remove(e);return}g&&g.__t!==void 0&&g.__v!==void 0&&c.push([e,g.__t])});c.sort(function(a,b){return a[1]-b[1]});for(var e=0;e<Math.ceil(c.length/2);e++)d.remove(c[e][0])};d.get=function(d,e){var g;if(this._backend){(j||(j=c("ErrorGuard"))).applyWithGuard(function(){g=this._backend.get(this._key_prefix+d)},this,[],{onError:function(){g=null},name:"CacheStorage:get"});if(g!=null)if(a._hasMagicPrefix(g))g=g.substr(k.length);else try{g=b("cr:8958").parse(g,f.id),g&&g.__t!==void 0&&g.__v!==void 0&&(g=g.__v)}catch(a){g=void 0}else g=void 0}g===void 0&&e!==void 0&&(g=e,this.set(d,g));return g};d.remove=function(a){this._backend&&(j||(j=c("ErrorGuard"))).applyWithGuard(this._backend.remove,this._backend,[this._key_prefix+a],{name:"CacheStorage:remove"})};d._setVersion=function(){var a=this;(j||(j=c("ErrorGuard"))).applyWithGuard(function(){a.useBrowserStorage()?a._backend.getStore().setItem(m,l):a._backend.getStore()[m]=l},this,[],{name:"CacheStorage:setVersion"})};d.clear=function(){this._backend&&((j||(j=c("ErrorGuard"))).applyWithGuard(this._backend.clear,this._backend,[],{name:"CacheStorage:clear"}),this._setVersion())};d.clearOwnKeys=function(){this._backend&&((j||(j=c("ErrorGuard"))).applyWithGuard(this._backend.clearWithPrefix,this._backend,[this._key_prefix],{name:"CacheStorage:clearOwnKeys"}),this._setVersion())};a.getAllStorageTypes=function(){return Object.keys(p)};a._hasMagicPrefix=function(a){return a.substr(0,k.length)===k};a.disablePersistentWrites=function(){a._persistentWritesDisabled=!0};return a}();a._persistentWritesDisabled=!1;f.exports=a}),34);
__d("CrossWindowEventEmitter",["CacheStorage","EventEmitter","cr:8958"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(d,a);function d(d){var e;e=a.call(this)||this;e.$CrossWindowEventEmitter$p_2=d;e.$CrossWindowEventEmitter$p_1=new(c("CacheStorage"))("localstorage",d+":");e.$CrossWindowEventEmitter$p_1.addValueChangeCallback(function(c,d,f){d=c.split(":")[1];try{c=b("cr:8958").parse(f)}catch(a){c=void 0}if(c&&c.__v){(f=a.prototype.emit).call.apply(f,[babelHelpers.assertThisInitialized(e),d].concat(c.__v))}});return e}var e=d.prototype;e.emit=function(b){var c;for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];this.emitRemote.apply(this,[b].concat(e));(c=a.prototype.emit).call.apply(c,[this,b].concat(e))};e.emitRemote=function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];this.$CrossWindowEventEmitter$p_1.set(a,c)};return d}(c("EventEmitter"));g["default"]=a}),98);
__d("EventListenerImplForCacheStorage",["CometEventListener"],(function(a,b,c,d,e,f){"use strict";f["default"]=b("CometEventListener")}),66);
__d("IrisSubscribeCheckerUtils",[],(function(a,b,c,d,e,f){"use strict";function a(){if(typeof window!=="undefined"){var a;a=(a=window.location)==null?void 0:a.hostname;if(a==="m.facebook.com"||a==="mobile.facebook.com"||a==="mtouch.facebook.com")return!1}return!0}f.getIrisSubscribeCheckerInitialRunningState=a}),66);
__d("MqttEnvWebSocket",[],(function(a,b,c,d,e,f){"use strict";function a(a){return new WebSocket(a)}f.createWebSocket=a}),66);
__d("MqttEnv",["MqttEnvWebSocket","clearTimeout","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";b=Object.freeze({mqtt_waterfall_log_client_sampling:1,mqtt_ws_polling_enabled:3,mqtt_lp_use_fetch:9,mqtt_fast_lp:11,mqtt_lp_no_delay:12,mqtt_enable_publish_over_polling:13,mqttweb_global_connection_counter:15});e=function(){var a=b.prototype;a.random=function(){return this.$1!=null?this.$1():Math.random()};a.isUserLoggedInNow=function(){return this.$2!=null?this.$2():!0};a.setIsUserLoggedInNow=function(a){this.$2=a};a.clearTimeout=function(a){if(this.$3!=null){this.$3(a);return}c("clearTimeout")(a)};a.setTimeout=function(a,b){for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];return this.$4!=null?this.$4.apply(null,arguments):c("setTimeout").apply(null,arguments)};a.getLoggerInstance=function(){return this.$5!=null?this.$5():h.getInstance()};a.genGk=function(a){return this.$6!=null?this.$6(a):!1};a.createSocket=function(a,b){return this.$7!=null?this.$7(a,b):d("MqttEnvWebSocket").createWebSocket(a)};a.scheduleCallback=function(a){return this.$8!=null?this.$8(a):a()};a.scheduleLoggingCallback=function(a){return this.$9!=null?this.$9(a):a()};a.configRead=function(a,b){return this.$10!=null?this.$10(a,b):b};a.configWrite=function(a,b){this.$11!=null&&this.$11(a,b)};function b(){this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=null,this.$9=null,this.$10=null,this.$11=null}a.initialize=function(a,b,c,d,e,f,g,h,i,j,k){this.$1=a,this.$2=b,this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$7=g,this.$8=h,this.$9=i,this.$10=j,this.$11=k};return b}();var h=function(){function a(){}a.getInstance=function(){return new a()};var b=a.prototype;b.setAppId=function(a){};b.eventLogConnect=function(a){};b.eventLogPull=function(a){};b.eventLogPullFinish=function(a){};b.eventLogDisconnect=function(a){};b.eventLogOutgoingPublish=function(a){};b.eventLogIncomingPublish=function(a){};b.eventLogPublishTimeout=function(a){};b.eventLogMiscellaneousError=function(a){};b.logIfLoggedOut=function(){};b.logError=function(a){};b.logErrorWarn=function(a){};b.logWarn=function(a){};b.debugTrace=function(a){};b.bumpCounter=function(a){};b.getBrowserConnectivity=function(){return!0};return a}(),i=new e();function a(a){i.setIsUserLoggedInNow(a)}g.MqttGkNames=b;g.Env=i;g.setIsUserLoggedInNow=a}),98);
__d("IrisSubscribeChecker",["IrisSubscribeCheckerUtils","MqttEnv"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=d("MqttEnv").Env.getLoggerInstance(),this.$2=null,this.$3=!1,this.$4=!1,this.$5=!1,this.$6=d("IrisSubscribeCheckerUtils").getIrisSubscribeCheckerInitialRunningState(),this.$7=0,this.$8=a}var b=a.prototype;b.start=function(){this.$6=!0};b.stop=function(){this.$6=!1,this.$9()};b.onConnectAttempt=function(){};b.onConnectFailure=function(){this.$9()};b.onConnected=function(){var a=this;this.$7++;this.$9();this.$3=!1;this.$4=!1;this.$5=!1;this.$6&&(this.$2=d("MqttEnv").Env.setTimeout(function(){a.$10()},8e3))};b.onConnectSuccess=function(){};b.onConnectionLost=function(){this.$9()};b.onConnectionDisconnect=function(){};b.onSubscribe=function(a){a==="/t_ms"&&(this.$3=!0)};b.onUnsubscribe=function(a){};b.onPublish=function(a){(a==="/messenger_sync_get_diffs"||a==="/messenger_sync_create_queue")&&(this.$4=!0,this.$3&&(this.$5=!0,this.$9()))};b.onMessage=function(a){};b.onWSFatal=function(){};b.$9=function(){this.$2&&(d("MqttEnv").Env.clearTimeout(this.$2),this.$2=null)};b.$10=function(){if(this.$4===!1){var a=this.$7==1?"no_iris_session_initialConnect":"no_iris_session";this.$1.bumpCounter(a);this.$8()?this.$1.bumpCounter(a+".withProvider"):this.$1.bumpCounter(a+".withoutProvider");this.$3===!0?this.$1.bumpCounter(a+".withTopicSubscribe"):this.$1.bumpCounter(a+".withoutTopicSubscribe")}this.$3===!1&&this.$1.bumpCounter("no_iris_topic_subscribe");this.$3===!0&&this.$4===!0&&this.$5===!1&&this.$1.bumpCounter("session_before_topic_subscribe")};return a}();g["default"]=a}),98);
__d("MqttGlobalStreamCounter",["CrossWindowEventEmitter","MqttEnv","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){var a=this;this.isTabClosed=!1;this.otherTabs=new Map();this.thisTab={totalConnectionStreams:0};this.broadcastChannel=new(c("CrossWindowEventEmitter"))("MqttGlobalStreamCounter");this.broadcastChannel.addListener("count-updated",function(b){b=JSON.parse(String(b));var c=!1;a.otherTabs.has(b.key)||(c=!0);b.event==="DELETE"?a.otherTabs["delete"](b.key):b.event==="UPDATE"&&b.value!=null&&(a.otherTabs.set(b.key,b.value),c&&a.$1())});this.tabID=c("uuidv4")()}var b=a.prototype;b.streamRequested=function(){this.thisTab.totalConnectionStreams++,this.$1()};b.streamClosed=function(){this.thisTab.totalConnectionStreams>0&&(this.thisTab.totalConnectionStreams--,this.$1())};b.tabClosed=function(){if(this.isTabClosed)return;this.isTabClosed=!0;var a={key:this.tabID,event:"DELETE"};this.broadcastChannel.emitRemote("count-updated",JSON.stringify(a))};b.getGlobalState=function(){var a={totalConnectionStreams:this.thisTab.totalConnectionStreams};this.otherTabs.forEach(function(b){a.totalConnectionStreams+=b.totalConnectionStreams});return a};b.$1=function(){var a={key:this.tabID,event:"UPDATE",value:this.thisTab};this.broadcastChannel.emitRemote("count-updated",JSON.stringify(a))};b.isEnabled=function(){return!0};return a}();var h=d("MqttEnv").Env.genGk(d("MqttEnv").MqttGkNames.mqttweb_global_connection_counter)?new a():{streamRequested:function(){},streamClosed:function(){},tabClosed:function(){},getGlobalState:function(){return{totalConnectionStreams:-1}},isEnabled:function(){return!1}};b=function(){return h};g.getInstance=b}),98);
__d("MqttAnalyticsHook",["MqttEnv","MqttGlobalStreamCounter"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=d("MqttEnv").Env.getLoggerInstance(),this.$2=d("MqttGlobalStreamCounter").getInstance(),this.$3=0,this.$4=0,this.$5=0,this.$6=0,this.$1.bumpCounter("session_start"),d("MqttEnv").Env.isUserLoggedInNow()||this.$1.bumpCounter("session_start.logout")}var b=a.prototype;b.onConnectAttempt=function(){this.$1.bumpCounter("ws_connect_attempt"),this.$2.streamRequested()};b.onConnectFailure=function(){this.$4++,this.$1.bumpCounter("ws_connect_failure"),this.$1.debugTrace("connect","Connect failed existing streams count "+this.$2.getGlobalState().totalConnectionStreams),this.$2.streamClosed()};b.onConnected=function(){this.$1.bumpCounter("ws_connect_connected")};b.onConnectSuccess=function(){this.$3===0&&this.$1.bumpCounter("ws_connect_first_success"),this.$3++,this.$1.bumpCounter("ws_connect_success")};b.onConnectionLost=function(){this.$1.bumpCounter("ws_disconnect")};b.onConnectionDisconnect=function(){this.$2.streamClosed()};b.onSubscribe=function(a){};b.onUnsubscribe=function(a){};b.onPublish=function(a){this.$1.bumpCounter("ws_publish."+a)};b.onMessage=function(a){this.$1.bumpCounter("message_arrived."+a)};b.onWSFatal=function(){this.$1.bumpCounter("ws_fatal")};b.onPollRequestSent=function(){this.$1.bumpCounter("polling_request_send"),this.$2.streamRequested()};b.onPollRequestSuccess=function(){this.$1.bumpCounter("polling_request_succeed"),this.$5===0&&this.$1.bumpCounter("polling_first_success"),this.$5++};b.onPollResponse=function(a){this.$1.bumpCounter("lp.message_arrived."+a)};b.onPollFinish=function(){this.$1.bumpCounter("polling_request_finish"),this.$2.streamRequested()};b.onPollRequestFailed=function(a){this.$1.bumpCounter("polling_request_failed"),this.$1.bumpCounter("polling_request_failed_"+a),this.$6++,this.$1.debugTrace("PollRequest","Request failed existing streams count "+this.$2.getGlobalState().totalConnectionStreams),this.$2.streamClosed()};b.onPollShutdownAbort=function(){this.$2.streamClosed()};b.onTabClose=function(){this.$2.tabClosed()};return a}();g["default"]=a}),98);
__d("MqttConnectionHookCollection",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.addHook=function(a){this.$1.add(a)};b.removeHook=function(a){this.$1["delete"](a)};b.onConnectAttempt=function(){this.$1.forEach(function(a){a.onConnectAttempt==null?void 0:a.onConnectAttempt()})};b.onConnectFailure=function(){this.$1.forEach(function(a){a.onConnectFailure==null?void 0:a.onConnectFailure()})};b.onConnected=function(){this.$1.forEach(function(a){a.onConnected==null?void 0:a.onConnected()})};b.onConnectSuccess=function(){this.$1.forEach(function(a){a.onConnectSuccess==null?void 0:a.onConnectSuccess()})};b.onConnectionLost=function(){this.$1.forEach(function(a){a.onConnectionLost==null?void 0:a.onConnectionLost()})};b.onConnectionDisconnect=function(){this.$1.forEach(function(a){a.onConnectionDisconnect==null?void 0:a.onConnectionDisconnect()})};b.onSubscribe=function(a){this.$1.forEach(function(b){b.onSubscribe==null?void 0:b.onSubscribe(a)})};b.onUnsubscribe=function(a){this.$1.forEach(function(b){b.onUnsubscribe==null?void 0:b.onUnsubscribe(a)})};b.onPublish=function(a){this.$1.forEach(function(b){b.onPublish==null?void 0:b.onPublish(a)})};b.onMessage=function(a){this.$1.forEach(function(b){b.onMessage==null?void 0:b.onMessage(a)})};b.onWSFatal=function(){this.$1.forEach(function(a){a.onWSFatal==null?void 0:a.onWSFatal()})};return a}();f["default"]=a}),66);
__d("MqttProtocolUtils",["MqttEnv"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){if(a==null)return b;var c=new Uint8Array(a.length+b.length);c.set(a);c.set(b,a.length);return c}function b(a,b){b=b;var c=0,d=1,e;do{if(b===a.length)return null;e=a[b++];c+=(e&127)*d;d*=128}while((e&128)!==0);return{offset:b,value:c}}function c(a){a=a;var b=new Array(1);for(var c=0;c<4;c++){var d=a%128;a>>=7;if(a>0)b[c]=d|128;else{b[c]=d;break}}return b}function h(a,b,c){c=c;b[c++]=a>>8;b[c++]=a%256;return c}function e(a,b){return 256*a[b]+a[b+1]}function f(a){var b=0;for(var c=0,d=a.length;c<d;c++){var e=a.charCodeAt(c);e<128?b+=1:e<2048?b+=2:e>=55296&&e<=56319?(b+=4,c++):b+=3}return b}function i(a,b,c,d){d=h(b,c,d);j(a,c,d);return d+b}function j(a,b,c){c=c;for(var d=0,e=a.length;d<e;d++){var f=a.charCodeAt(d);f<128?b[c++]=f:f<2048?(b[c++]=192|f>>6,b[c++]=128|f&63):f<55296||f>=57344?(b[c++]=224|f>>12,b[c++]=128|f>>6&63,b[c++]=128|f&63):(f=65536+((f&1023)<<10|a.charCodeAt(++d)&1023),b[c++]=240|f>>18,b[c++]=128|f>>12&63,b[c++]=128|f>>6&63,b[c++]=128|f&63)}}function k(a,b,c){var d=[],e=b,f=0;while(e<b+c){var g=a[e++];if(g<128)d[f++]=String.fromCharCode(g);else if(g>191&&g<224){var h=a[e++];d[f++]=String.fromCharCode((g&31)<<6|h&63)}else if(g>239&&g<365){h=a[e++];var i=a[e++],j=a[e++];h=((g&7)<<18|(h&63)<<12|(i&63)<<6|j&63)-65536;d[f++]=String.fromCharCode(55296+(h>>10));d[f++]=String.fromCharCode(56320+(h&1023))}else{i=a[e++];j=a[e++];d[f++]=String.fromCharCode((g&15)<<12|(i&63)<<6|j&63)}}return d.join("")}var l=function(){function a(a,b,c,d){this.$1=a,this.$2=b,this.$5=c,this.$6=d,this.$4=!1}var b=a.prototype;b.$7=function(){var a=this;this.$4?(this.$4=!1,this.$5(),this.$3=d("MqttEnv").Env.setTimeout(function(){a.$7()},this.$2()*1e3)):this.$6()};b.reset=function(){var a=this;this.$4=!0;this.$3&&(d("MqttEnv").Env.clearTimeout(this.$3),this.$3=null);var b=this.$1()*1e3;b>0&&(this.$3=d("MqttEnv").Env.setTimeout(function(){a.$7()},b))};b.cancel=function(){this.$3&&(d("MqttEnv").Env.clearTimeout(this.$3),this.$3=null)};return a}();g.UTF8Length=f;g.convertStringToUTF8=j;g.concatBuffers=a;g.decodeMultiByteInt=b;g.convertUTF8ToString=k;g.encodeMultiByteInt=c;g.writeUInt16BE=h;g.readUInt16BE=e;g.writeString=i;g.Pinger=l}),98);
__d("MqttUtils",["MqttEnv"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h(a,"sid",b.toString())}function b(a,b){var c=a;b.forEach(function(a,b){c=h(c,b,a)});return c}function h(a,b,c){if(a.indexOf("?")>0)return a+"&"+b+"="+c;else return a+"?"+b+"="+c}function c(){return Math.floor(d("MqttEnv").Env.random()*Number.MAX_SAFE_INTEGER)}function i(a,b,c){var e=arguments.length>1?a.then(b,c):a;e.then(null,function(a){d("MqttEnv").Env.setTimeout(function(){if(a instanceof Error)throw a;else throw new Error("promiseDone")},0)})}function e(a,b,c,e){var f=!1;d("MqttEnv").Env.setTimeout(function(){f||(f=!0,c(new Error("promise timeout")))},e);i(a,function(a){f||(f=!0,b(a))},function(a){f||(f=!0,c(a))})}function f(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=0;return a.replace(/%s/g,function(){return String(c[e++])})}g.endpointWithSessionId=a;g.endpointWithExtraParameters=b;g.endpointWithExtraParameter=h;g.generateSessionId=c;g.promiseDone=i;g.promiseDoneWithTimeout=e;g.sprintf=f}),98);
__d("MqttProtocolCodec",["MqttProtocolUtils","MqttUtils","err"],(function(a,b,c,d,e,f,g){"use strict";var h=Object.freeze({CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14}),i=[0,6,77,81,73,115,100,112,3];function j(a,b){b=b;var e=b,f=a[b],g=f>>4;b+=1;var i=d("MqttProtocolUtils").decodeMultiByteInt(a,b);if(i==null)return{position:e,wireMessage:null};b=i.offset;i=b+i.value;if(i>a.length)return{position:e,wireMessage:null};var j;switch(g){case h.CONNACK:e=a[b++];e=!!(e&1);var o=a[b++];j=new m(e,o);break;case h.PUBLISH:e=f&15;o=e>>1&3;f=d("MqttProtocolUtils").readUInt16BE(a,b);b+=2;var r=d("MqttProtocolUtils").convertUTF8ToString(a,b,f);b+=f;f=null;o===1&&(f=d("MqttProtocolUtils").readUInt16BE(a,b),b+=2);var s=p.createWithBytes(a.subarray(b,i)),t=(e&1)===1;e=(e&8)===8;j=new q(r,s,o,f,t,e);break;case h.PINGREQ:j=new k("PINGREQ");break;case h.PINGRESP:j=new k("PINGRESP");break;case h.PUBACK:case h.UNSUBACK:r=d("MqttProtocolUtils").readUInt16BE(a,b);j=new n(g===h.PUBACK?"PUBACK":"UNSUBACK",r);break;case h.SUBACK:s=d("MqttProtocolUtils").readUInt16BE(a,b);b+=2;o=a.subarray(b,i);j=new l(s,o);break;default:throw c("err")(d("MqttUtils").sprintf("Invalid MQTT message type %s.",g))}return{position:i,wireMessage:j}}function a(a){var b=[],c=0;while(c<a.length){var d=j(a,c),e=d.wireMessage;c=d.position;if(e)b.push(e);else break}d=null;c<a.length&&(d=a.subarray(c));return{messages:b,remaining:d}}b=function(){function a(a){this.messageType=h[a]}var b=a.prototype;b.encode=function(){throw new TypeError("Cannot abstract class WireMessage")};return a}();var k=function(b){babelHelpers.inheritsLoose(a,b);function a(a){return b.call(this,a)||this}var c=a.prototype;c.encode=function(){var a=new ArrayBuffer(2),b=new Uint8Array(a);b[0]=(this.messageType&15)<<4;return a};return a}(b);e=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"DISCONNECT")||this}var c=b.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=new ArrayBuffer(2),c=new Uint8Array(b);c[0]=a;c.set(d("MqttProtocolUtils").encodeMultiByteInt(0),1);return b};return b}(b);var l=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"SUBACK")||this;d.messageIdentifier=a;d.returnCode=c;return d}return a}(b),m=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"CONNACK")||this;d.sessionPresent=a;d.returnCode=c;return d}return a}(b),n=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.messageIdentifier=c;return a}var c=a.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=2,c=d("MqttProtocolUtils").encodeMultiByteInt(b),e=c.length+1;b=new ArrayBuffer(b+e);var f=new Uint8Array(b);f[0]=a;f.set(c,1);e=d("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,f,e);return b};return a}(b);f=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this,"CONNECT")||this;d.clientId=b;d.connectOptions=c;return d}var c=b.prototype;c.encode=function(){var a,b=(this.messageType&15)<<4,c=i.length+3;c+=(a=d("MqttProtocolUtils")).UTF8Length(this.clientId)+2;c+=a.UTF8Length(this.connectOptions.userName)+2;var e=a.encodeMultiByteInt(c);c=new ArrayBuffer(1+e.length+c);var f=new Uint8Array(c);f[0]=b;b=1;f.set(e,1);b+=e.length;f.set(i,b);b+=i.length;e=2|128;f[b++]=e;b=a.writeUInt16BE(this.connectOptions.getKeepAliveIntervalSeconds(),f,b);b=a.writeString(this.clientId,a.UTF8Length(this.clientId),f,b);b=a.writeString(this.connectOptions.userName,a.UTF8Length(this.connectOptions.userName),f,b);return c};return b}(b);var o=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,e,f){var g;g=b.call(this,a)||this;g.topic=c;if(e<0&&e>1||e===1&&f==null)throw new TypeError(d("MqttUtils").sprintf("Argument Invalid. qos: %s messageType: %s.",e,a));g.qos=e;g.messageIdentifier=f;return g}var c=a.prototype;c.encode=function(){var a=(this.messageType&15)<<4;a|=2;var b=d("MqttProtocolUtils").UTF8Length(this.topic),c=2+b+2;this.messageType===h.SUBSCRIBE&&(c+=1);var e=d("MqttProtocolUtils").encodeMultiByteInt(c);c=new ArrayBuffer(1+e.length+c);var f=new Uint8Array(c);f[0]=a;a=1;f.set(e,1);a+=e.length;this.messageIdentifier!=null&&(a=d("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,f,a));a=d("MqttProtocolUtils").writeString(this.topic,b,f,a);this.messageType===h.SUBSCRIBE&&this.qos!=null&&(f[a++]=this.qos);return c};return a}(b),p=function(){function a(a,b){this.payloadString=a,this.payloadBytes=b}a.createWithString=function(b){var c=new Uint8Array(new ArrayBuffer(d("MqttProtocolUtils").UTF8Length(b)));d("MqttProtocolUtils").convertStringToUTF8(b,c,0);return new a(b,c)};a.createWithBytes=function(b){var c=d("MqttProtocolUtils").convertUTF8ToString(b,0,b.length);return new a(c,b)};var b=a.prototype;b.string=function(){return this.payloadString};b.bytes=function(){return this.payloadBytes};return a}(),q=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,d,e,f,g){var h;h=b.call(this,"PUBLISH")||this;h.topic=a;h.payloadMessage=c;h.qos=d;h.messageIdentifier=e;h.retained=f!=null?f:!1;h.duplicate=g!=null?g:!1;if(h.qos===1&&h.messageIdentifier==null)throw new TypeError("Argument Invalid. messageIdentifier: null and qos: 1");return h}var c=a.prototype;c.encode=function(){var a=(this.messageType&15)<<4;this.duplicate&&(a|=8);a=a|=this.qos<<1;this.retained&&a!=1;var b=d("MqttProtocolUtils").UTF8Length(this.topic),c=b+2,e=this.qos===0?0:2;c+=e;e=this.payloadMessage.bytes();c+=e.byteLength;var f=d("MqttProtocolUtils").encodeMultiByteInt(c);c=new ArrayBuffer(1+f.length+c);var g=new Uint8Array(c);g[0]=a;g.set(f,1);a=1+f.length;a=d("MqttProtocolUtils").writeString(this.topic,b,g,a);this.qos!==0&&this.messageIdentifier!=null&&(a=d("MqttProtocolUtils").writeUInt16BE(this.messageIdentifier,g,a));g.set(e,a);return c};return a}(b),r=p.createWithString,s=p.createWithBytes;b={Base:b,ConnAck:m,Connect:f,Disconnect:e,Ping:k,PubAckUnsubAck:n,Publish:q,Subscription:o};g.MESSAGE_TYPE=h;g.decodeMessage=j;g.decodeByteMessages=a;g.Message=p;g.createMessageWithString=r;g.createMessageWithBytes=s;g.WireMessage=b}),98);
__d("MqttTypes",[],(function(a,b,c,d,e,f){"use strict";a=function(a,b,c){this.errorCode=a,this.errorName=b,this.errorMessage=c};b=Object.freeze({APP_DISCONNECT:new a(7,"APP_DISCONNECT","Disconnect initiated by app"),BROWSER_CLOSE:new a(11,"BROWSER_CLOSE","Browser closed"),CONNACK_FAILURE:new a(5,"CONNACK_FAILURE","Connection failure due to connack"),CONNECT_TIMEOUT:new a(4,"CONNECT_TIMEOUT","Connect timed out"),INVALID_DATA_TYPE:new a(3,"INVALID_DATA_TYPE","Received non-arraybuffer from socket."),PING_TIMEOUT:new a(6,"PING_TIMEOUT","Ping timeout"),RECONNECT:new a(10,"RECONNECT","Reconnecting"),SERVER_DISCONNECT:new a(8,"SERVER_DISCONNECT","Disconnect message sent my server"),SOCKET_CLOSE:new a(9,"SOCKET_CLOSE","Socket connection closed"),SOCKET_ERROR:new a(1,"SOCKET_ERROR","Socket error"),SOCKET_MESSAGE:new a(2,"SOCKET_MESSAGE","Unable to parse invalid socket message")});c=function(a,b){this.mqttError=a,this.connAck=b};d=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){d===void 0&&(d=null);c=a.call(this,c)||this;c.isRecoverable=b;c.originalError=d;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.MqttError=a;f.MqttErrors=b;f.ConnectFailure=c;f.MqttChannelError=d}),66);
__d("MqttProtocolClient",["ErrorSerializer","MqttEnv","MqttProtocolCodec","MqttProtocolUtils","MqttTypes","err","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";var h=20,i=6e4;a=function(){function a(a){var b=this;this.$12=function(a,c,e){c===void 0&&(c=null);b.$9.bumpCounter("protocol.debug.disconnect.internal."+a.errorName);b.$9.bumpCounter("protocol.debug.disconnect.internal");var f=b.$5,g=b.$2,h=g.onConnectFailure,i=g.onConnectionLost;b.setConnected(!1);b.$14();f?d("MqttEnv").Env.scheduleCallback(function(){i(a,c)}):d("MqttEnv").Env.scheduleCallback(function(){h(b.$11,new(d("MqttTypes").ConnectFailure)(a,e!=null?e:-1),c)})};this.$13=function(a){var c=b.$6;if(c==null){b.$9.bumpCounter("protocol.socket_send.failed.socket_null.<message type>");return 0}if(c.readyState!==c.OPEN){b.$9.bumpCounter("protocol.socket_send.failed.socket_not_open.<message type>");return 0}a=a.encode();var d=a.byteLength;c.send(a);return d};this.$3=a;this.$2={getKeepAliveIntervalSeconds:function(){return 10},getKeepAliveTimeoutSeconds:function(){return 10},ignoreSubProtocol:!1,mqttVersion:3,onConnectFailure:function(a,b,c){},onConnection:function(){},onConnectionLost:function(a,b){},onConnectSuccess:function(a){},onMessageArrived:function(a,b,c){},onMessageDelivered:function(a){},userName:""};this.$1="mqttwsclient";this.$4=0;this.$5=!1;this.$9=d("MqttEnv").Env.getLoggerInstance();this.$11=0}var b=a.prototype;b.connect=function(a){var b=this;if(this.$5)throw c("err")("Invalid state: connect - already connected");this.$2=a;this.setConnected(!1);this.$7!=null&&(d("MqttEnv").Env.clearTimeout(this.$7),this.$7=null);this.$7=d("MqttEnv").Env.setTimeout(function(){b.$9.bumpCounter("protocol.error.connect.timeout"),b.$12(d("MqttTypes").MqttErrors.CONNECT_TIMEOUT)},h*1e3);this.$6=d("MqttEnv").Env.createSocket(this.$3);this.$6.binaryType="arraybuffer";this.$6.onopen=function(){b.setConnected(!0),b.$9.debugTrace("Socket-Open","MQTTProtocolClient Socket Open"),b.$11=b.$13(new(d("MqttProtocolCodec").WireMessage.Connect)(b.$1,a)),a.onConnection()};this.$6.onmessage=function(a){a=a.data;if(!(a instanceof ArrayBuffer)){b.$9.bumpCounter("protocol.error.onmessage.type");b.$12(d("MqttTypes").MqttErrors.INVALID_DATA_TYPE);return}try{a=new Uint8Array(a);b.$10!=null&&(a=d("MqttProtocolUtils").concatBuffers(b.$10,a),b.$9.bumpCounter("protocol.debug.usingMessagesBuffer"),delete b.$10,b.$10=null);a=d("MqttProtocolCodec").decodeByteMessages(a);var c=a.messages;b.$10=a.remaining;for(a=0;a<c.length;a++)b.handleMessage(c[a])}catch(a){b.$10=null,b.$9.logError(a,d("MqttTypes").MqttErrors.SOCKET_MESSAGE.errorMessage),b.$9.bumpCounter("protocol.error.onmessage.parse"),b.$12(d("MqttTypes").MqttErrors.SOCKET_MESSAGE,a.message)}};this.$6.onerror=function(a){b.$9.bumpCounter("protocol.error.socket");b.$9.debugTrace("Socket-Error","MQTTProtocolClient Socket Error");a=typeof a==="object"&&a!=null&&"error"in a&&!("message"in a)?a.error:a;b.$12(d("MqttTypes").MqttErrors.SOCKET_ERROR,c("ErrorSerializer").toReadableMessage(c("getErrorSafe")(a)))};this.$6.onclose=function(a){b.$9.bumpCounter("protocol.socket.close"),a.wasClean||b.$9.debugTrace("Socket-Unclean-Close","MQTTProtocolClient error code: "+a.code+" reason: "+a.reason),b.$12(d("MqttTypes").MqttErrors.SOCKET_CLOSE,a.code+" : "+a.reason)};this.$8!=null&&this.$8.cancel();this.$8=new(d("MqttProtocolUtils").Pinger)(a.getKeepAliveIntervalSeconds,a.getKeepAliveTimeoutSeconds,this.$13.bind(this,new(d("MqttProtocolCodec").WireMessage.Ping)("PINGREQ")),function(a,c){return b.$12(d("MqttTypes").MqttErrors.PING_TIMEOUT,a,c)})};b.$14=function(){var a=this;this.setConnected(!1);this.$8!=null&&this.$8.cancel();this.$7!=null&&(d("MqttEnv").Env.clearTimeout(this.$7),this.$7=null);this.$6!=null&&(this.$6.onopen=function(b){a.$9.debugTrace("Socket Open After Teardown","Socket opening after teardown")},this.$6.onmessage=function(a){},this.$6.onerror=function(a){},this.$6.onclose=function(b){a.$9.debugTrace("Socket Close After Teardown","code: "+b.code+", reason: "+b.reason)},this.$6.close(),this.$6=null);this.$2.onConnectSuccess=function(a){};this.$2.onConnectFailure=function(a,b){};this.$2.onConnection=function(){};this.$2.onConnectionLost=function(a){};this.$2.onMessageArrived=function(a,b,c){};this.$2.onMessageDelivered=function(a){}};b.disconnect=function(a){if(this.$6==null||this.$6.readyState!==this.$6.OPEN||!this.$5){this.$14();return}this.$13(new(d("MqttProtocolCodec").WireMessage.Disconnect)());this.$9.bumpCounter("protocol.debug.disconnect");this.$12(a)};b.isConnected=function(){return this.$5};b.setConnected=function(a){this.$5=a};b.subscribe=function(a){if(!this.$5){this.$9.bumpCounter("protocol.error.subscribe.notconnected");throw c("err")("Invalid state: subscribe - not connected")}this.$9.bumpCounter("protocol.subscribe."+a);a=new(d("MqttProtocolCodec").WireMessage.Subscription)("SUBSCRIBE",a,0,this.$15());this.$13(a)};b.unsubscribe=function(a){if(!this.$5){this.$9.bumpCounter("protocol.error.unsubscribe.notconnected");throw c("err")("Invalid state: unsubscribe - not connected")}this.$9.bumpCounter("protocol.unsubscribe."+a);a=new(d("MqttProtocolCodec").WireMessage.Subscription)("UNSUBSCRIBE",a,0,this.$15());this.$13(a)};b.publish=function(a,b,c){return this.$16(a,d("MqttProtocolCodec").createMessageWithString(b),c)};b.publishBinary=function(a,b,c){return this.$16(a,d("MqttProtocolCodec").createMessageWithBytes(b),c)};b.$16=function(a,b,c){this.$5||this.$9.bumpCounter("protocol.error.publish.notconnected");this.$9.bumpCounter("protocol.publish."+a);var e=this.$15();a=new(d("MqttProtocolCodec").WireMessage.Publish)(a,b,c,e);this.$13(a);return e};b.$15=function(){++this.$4===i&&(this.$4=1);return this.$4};b.handleMessage=function(a){var b=this;switch(a.messageType){case d("MqttProtocolCodec").MESSAGE_TYPE.CONNACK:this.$7!=null&&(d("MqttEnv").Env.clearTimeout(this.$7),this.$7=null);if(a instanceof d("MqttProtocolCodec").WireMessage.ConnAck){var e=a;if(e.returnCode!==0){this.$9.bumpCounter("protocol.error.connack.invalidreturncode");this.setConnected(!1);this.$12(d("MqttTypes").MqttErrors.CONNACK_FAILURE,"connack code="+e.returnCode,e.returnCode);return}d("MqttEnv").Env.scheduleCallback(function(){b.$2.onConnectSuccess(b.$11)});this.$8!=null&&this.$8.reset()}break;case d("MqttProtocolCodec").MESSAGE_TYPE.PUBLISH:if(a instanceof d("MqttProtocolCodec").WireMessage.Publish){var f=a;d("MqttEnv").Env.scheduleCallback(function(){b.$2.onMessageArrived(f.topic,f.payloadMessage,f.qos)});e=f.messageIdentifier;this.$9.bumpCounter("protocol.publish.received");if(f.qos===1&&e!=null){e=new(d("MqttProtocolCodec").WireMessage.PubAckUnsubAck)("PUBACK",e);this.$13(e)}}break;case d("MqttProtocolCodec").MESSAGE_TYPE.PUBACK:if(a instanceof d("MqttProtocolCodec").WireMessage.PubAckUnsubAck){e=a;var g=e.messageIdentifier;this.$9.bumpCounter("protocol.puback.received");d("MqttEnv").Env.scheduleCallback(function(){b.$2.onMessageDelivered(g)})}break;case d("MqttProtocolCodec").MESSAGE_TYPE.PINGRESP:this.$8!=null&&this.$8.reset();break;case d("MqttProtocolCodec").MESSAGE_TYPE.DISCONNECT:this.$12(d("MqttTypes").MqttErrors.SERVER_DISCONNECT);break;case d("MqttProtocolCodec").MESSAGE_TYPE.SUBACK:this.$9.bumpCounter("protocol.suback.received");break;case d("MqttProtocolCodec").MESSAGE_TYPE.UNSUBACK:this.$9.bumpCounter("protocol.unsuback.received");break;default:this.$9.logError(c("err")("MqttProtocolClient: Received unhandled message type: "+a.messageType),"Received unhandled message type");this.$9.bumpCounter("protocol.error.handlemessage.unsupportedtype");break}};return a}();g["default"]=a}),98);
__d("MqttPublishListener",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({NOT_CONNECTED:"NOT_CONNECTED",PUBLISH_ERROR:"PUBLISH_ERROR",QUEUED:"QUEUED",SENT:"SENT",ACKED:"ACKED",NOT_ACKED:"NOT_ACKED"});f.MqttPublishEvent=a}),66);
__d("MqttUserNameUtils",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a!=null?a:typeof document==="object"&&document&&document.hasFocus&&document.hasFocus()}function b(){return navigator.userAgent}f.getMqttForegroundStatus=a;f.getUserAgent=b}),66);
__d("MqttUserName",["MqttUserNameUtils"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a,b,c,e,f,g,h,i,j,k,l,m){h===void 0&&(h=null),i===void 0&&(i=""),j===void 0&&(j="websocket"),k===void 0&&(k=null),l===void 0&&(l=null),m===void 0&&(m=null),this.$1=a,this.$2=b,this.$3=c,this.$4=e,this.$5=f,this.$6=g,this.$7=d("MqttUserNameUtils").getMqttForegroundStatus(),this.$8=h,this.$9=i,this.$10=j,this.$11=k,this.$12=l,this.$13=m}var b=a.prototype;b.gen=function(a,b,c,e){e===void 0&&(e=[]);var f=d("MqttUserNameUtils").getMqttForegroundStatus(this.$7);c=c.map(function(a){a={isBase64Publish:!1,messageId:a.messageId,payload:a.payload,qos:a.qos,topic:a.topic};typeof a.payload!=="string"&&(a.payload=btoa(String.fromCharCode.apply(null,a.payload)),a.isBase64Publish=!0);return a});f={a:d("MqttUserNameUtils").getUserAgent(),asi:this.$13,aid:this.$5,aids:this.$12!=null?Object.fromEntries(this.$12):null,chat_on:this.$6,cp:this.$3,ct:this.$10,d:this.$4,dc:"",ecp:this.$2,fg:f,gas:this.$8,mqtt_sid:"",no_auto_fg:!0,p:this.$11,pack:e,php_override:this.$9,pm:c,s:a,st:b,u:this.$1};return JSON.stringify(f)};b.setForegroundState=function(a){this.$7=a};b.setChatVisibility=function(a){this.$6=a};b.getEndpointCapabilities=function(){return this.$2};b.getDeviceId=function(){return this.$4};b.setEndpointCapabilities=function(a){this.$2=a};b.getIsGuestAuthStringPresent=function(){return this.$8!==null};return a}();g["default"]=a}),98);
__d("MqttConnection",["MqttConnectionHookCollection","MqttEnv","MqttProtocolClient","MqttPublishListener","MqttTypes","MqttUserName","MqttUtils","Promise","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i=15,j=15,k=1,l=1,m=64,n="publish",o="subscribe",p="unsubscribe",q=function(a){},r=18e4,s=5*1e3,t=15,u=21;a=function(){function a(){var a=this;this.$38=function(){return a.$20};this.$39=function(){return a.$21};this.$8=!1;this.$10=d("MqttEnv").Env.getLoggerInstance();this.$11="Disconnected";this.$17=new Set();this.$24=new Map();this.$12=0;this.$13=0;this.$14=0;this.$15=0;this.$16=0;this.$8=!1;this.$5="";this.$6=new(c("MqttUserName"))("",0,1,"",0,!0);this.$9=0;this.$18=0;this.$19=!1;this.$7=null;var b=function(){};this.$1=b;this.$2=b;this.$3=b;this.$25=!1;this.$26=!1;this.$27=new(c("MqttConnectionHookCollection"))();this.$4=function(){return[]};this.$20=i;this.$21=j;this.$22=null;this.$23=0}var e=a.prototype;e.run=function(a){var b=this,c=a.endpoint,d=a.extraConnectMessageProvider,e=a.mqttUserName,f=a.onJSError,g=a.onMessageReceived,h=a.onStateChange;a=a.subscribedTopics;if(this.$8){this.$10.debugTrace("run","Run called while in running state.");return}this.$1=h;this.$3=g;this.$5=c;this.$6=e;this.$8=!0;this.$18=Date.now();this.$12=0;this.$13=0;this.$2=f||q;a&&a.forEach(function(a){return b.$17.add(a)});this.$4=d;this.$20=i;this.$21=j;this.$28()};e.shutdown=function(a){this.$29(a),this.$30("shutdown"),this.$8=!1,this.$10.debugTrace("shutdown","Shutdown")};e.subscribe=function(a){this.$17.add(a);this.ensureConnected(o)&&this.$31(a);return!0};e.publish=function(a,b,c,d){return this.$32(a,b,c,d)};e.publishBinary=function(a,b,c,d){return this.$32(a,b,c,d)};e.$32=function(a,e,f,g){var i={reject:function(a){},resolve:function(){}};g!=null&&(i.listener=g);var j=new(h||(h=b("Promise")))(function(a,b){i.resolve=a,i.reject=b}),k=this.ensureConnected(n);!k?(g==null?void 0:g.onEvent(d("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED),i.reject(c("err")("Client disconnected"))):this.$33(a,e,f,i);return j};e.unsubscribe=function(a){this.$17["delete"](a);this.ensureConnected(p)&&this.$34(a);return!0};e.addHook=function(a){this.$27.addHook(a)};e.removeHook=function(a){this.$27.removeHook(a)};e.isRunning=function(){return this.$8};e.getSessionId=function(){return this.$9};e.hasFatal=function(){return this.$25};e.hasConnectSuccess=function(){return this.$26};e.canPublish=function(){return this.ensureConnected("canPublish")};e.ensureConnected=function(a){return!this.$8||this.$7==null||!this.$7.isConnected()?!1:!0};e.connectionState=function(){return this.$11};e.mqttStateFromConnectionState=function(a){switch(a){case"Connecting":case"TransportConnected":return"Connecting";case"Connected":return"Connected";case"Disconnected":return"Disconnected"}throw c("err")("Unknown state "+a)};e.testOnlyGetSubscribedTopics=function(){return this.$17};e.getDisconnectCount=function(){return this.$23};e.$29=function(a){this.$8&&this.$7!=null&&(this.$35("Disconnected"),this.$7!=null&&(this.$7.disconnect(a),this.$27.onConnectionDisconnect()),this.$7=null)};e.$36=function(a){if(this.$11==="Connected"&&a==="Disconnected"&&this.$18===0){this.$18=Date.now();return}if(a==="Connecting"&&this.$18!==0&&!this.$19){this.$10.bumpCounter("protocol.reconnectstarted");this.$19=!0;return}if(a==="Connected"&&this.$18!==0){a=Date.now()-this.$18;switch(Math.floor(a/3e4)){case 0:this.$10.bumpCounter("protocol.reconnectedwithin30s");break;case 1:this.$10.bumpCounter("protocol.reconnectedwithin60s");break;case 2:this.$10.bumpCounter("protocol.reconnectedwithin90s");break;case 3:this.$10.bumpCounter("protocol.reconnectedwithin120s");break;default:this.$10.bumpCounter("protocol.reconnectedmorethan120s");break}this.$18=0;this.$19=!1;return}};e.$35=function(a){a!==this.$11&&(this.$10.debugTrace("MQTTConnection-updateState","State changed to: "+a),this.$36(a),this.$11=a,this.$1(a))};e.$28=function(){var a=this;if(!this.$8)return;this.$11!=="Disconnected"&&this.$10.debugTrace("Reconnect","Current State not disconnected: "+this.$11);this.$35("Connecting");var b=Date.now(),e=this.$10.getBrowserConnectivity();this.$9=d("MqttUtils").generateSessionId();var f=Array.from(this.$17),g=d("MqttUtils").endpointWithSessionId(this.$5,this.$9);g=d("MqttUtils").endpointWithExtraParameter(g,"cid",this.$6.getDeviceId());try{this.$7=new(c("MqttProtocolClient"))(g);var h=this.$37(),i=h.map(function(a){return a.topic});g=this.$6.gen(this.$9,f,h);this.$7!=null&&(this.$13+=1,this.$7.connect({getKeepAliveIntervalSeconds:this.$38,getKeepAliveTimeoutSeconds:this.$39,ignoreSubProtocol:!0,mqttVersion:3,onConnectFailure:function(c,d,g){return a.$40(d,b,a.$18,f,i,e,c,g)},onConnection:function(){return a.$41(h,f)},onConnectionLost:function(b,c){return a.$42(b,c)},onConnectSuccess:function(c){return a.$43(b,a.$18,f,i,e,c)},onMessageArrived:function(b,c,d){return a.$44(b,c,d)},onMessageDelivered:function(b){return a.$45(b)},userName:g}),this.$10.bumpCounter("protocol.connectattempt"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.connectattempt"),this.$27.onConnectAttempt())}catch(a){this.$10.bumpCounter("js_error_in_init_exception"),this.$35("Disconnected"),this.$46(!1,!1,b,this.$18,f,[],e,null,14,"init error - "+a.message),a&&this.$10.logErrorWarn(a,"ws_js_error"),this.$27.onWSFatal(),this.$47(new(d("MqttTypes").MqttChannelError)(!1,"ws_js_error",a),"client_init")}};e.$37=function(){var a=this.$4(),b=65536;return a.map(function(a){a.messageId=b--;return a})};e.$31=function(a){try{if(this.$7!=null){this.$7.subscribe(a);this.$10.debugTrace("#doSubscribe","Subscribing to "+a);this.$27.onSubscribe(a);this.$10.bumpCounter("protocol.subscribe");return!0}}catch(b){this.$10.logError(b,"Exception subscribing"),this.$10.bumpCounter("subscribe_exception."+a),this.$10.bumpCounter("protocol.subscribe.error")}return!1};e.$34=function(a){try{if(this.$7!=null){this.$7.unsubscribe(a);this.$10.debugTrace("#doUnsubscribe","Unsubscribing to "+a);this.$27.onUnsubscribe(a);this.$10.bumpCounter("protocol.unsubscribe");return!0}}catch(b){this.$10.logError(b,"Exception unsubscribing"),this.$10.bumpCounter("unsubscribe_exception."+a),this.$10.bumpCounter("protocol.unsubscribe.error")}return!1};e.$33=function(a,b,c,e){if(this.$7!=null)try{var f;typeof b==="string"?f=this.$7.publish(a,b,c):f=this.$7.publishBinary(a,b,c);this.$10.bumpCounter("protocol.publish");b=f!=null?f:"null";this.$10.debugTrace("#doPublish","publish "+a+" with messageId:"+b+" qos:"+c);this.$27.onPublish(a);(b=e.listener)==null?void 0:b.onEvent(d("MqttPublishListener").MqttPublishEvent.SENT);f!=null?(this.$10.bumpCounter("publish.ack_expected"),this.$24.set(f,e)):e.resolve();return!0}catch(b){this.$10.logError(b,"Exception publishing");this.$10.bumpCounter("publish_exception."+a);e.reject(b);this.$10.bumpCounter("protocol.publish.error");return!1}else return!1};e.$48=function(a){var b=this;a===void 0&&(a=null);if(!this.$8)return;this.$29(d("MqttTypes").MqttErrors.RECONNECT);this.$30("reconnect");this.$49();this.$9=-1;this.$16=0;a=a;a==null&&(a=k*Math.pow(2,this.$12));a=Math.max(a,l);a=Math.min(a,m);a=a*(1e3+d("MqttEnv").Env.random()*200);this.$10.debugTrace("#scheduleReconnect","Reconnect in "+a+" ms");this.$22=d("MqttEnv").Env.setTimeout(function(){b.$28()},a);this.$12+=1};e.$49=function(){var a=Date.now()-this.$16,b=this.$16!==0&&a>s,c=this.$12>t;(b||c)&&(this.$12=0);this.$16!==0&&a<=s&&this.$10.bumpCounter("short_lived_session");c&&this.$10.bumpCounter("connection_attempt_limit")};e.$46=function(a,b,c,d,e,f,g,h,i,j){a?this.$14++:this.$15++;var k=Date.now();this.$10.eventLogConnect({ackReceived:b,attemptNumber:this.$13,connectionState:this.mqttStateFromConnectionState(this.$11),connectionStatus:a,disconnectCount:this.$23,duration:k-c,errorCode:i,errorMessage:j,failTotal:this.$15,hostname:this.$5,messageSizeBytes:h,osConnectivity:g,publishes:f,sessionID:this.$9,subscribedTopics:e,successTotal:this.$14,total_duration:k-d});a&&(this.$13=0)};e.$40=function(a,b,c,d,e,f,g,h){var i=a.mqttError;h=h!=null?i.errorMessage+" - "+h:i.errorMessage;this.$10.debugTrace("connect","Connect failed "+h);this.$10.bumpCounter("protocol.onconnectfailure");this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectfailure");this.$27.onConnectFailure();this.$46(!1,a.connAck!==-1,b,c,d,e,f,g,i.errorCode,h);if(a.connAck!=null){this.$10.bumpCounter("protocol.connect_failure."+a.connAck);if(a.connAck===u){this.$48(r);return}}this.$48()};e.$41=function(a,b){var c=this;this.$10.bumpCounter("protocol.onconnection");this.$10.debugTrace("Connect","Socket established");this.$27.onConnected();this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnection");b.forEach(function(a){c.$27.onSubscribe(a)});a.forEach(function(a){c.$27.onPublish(a.topic)});this.$35("TransportConnected")};e.$43=function(a,b,c,d,e,f){this.$10.bumpCounter("protocol.onconnectsuccess"),this.$10.debugTrace("connect","Connect success"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectsucess"),this.$27.onConnectSuccess(),this.$26=!0,this.$35("Connected"),this.$46(!0,!0,a,b,c,d,e,f),this.$50(c),this.$16=Date.now()};e.$42=function(a,b){this.$10.bumpCounter("protocol.onconnectionlost");this.$23++;if(a.errorCode){b=b!=null?a.errorMessage+" - "+b:a.errorMessage;this.$10.eventLogDisconnect({disconnectCount:this.$23,duration:Date.now()-this.$16,errorCode:a.errorCode,errorMessage:b,sessionID:this.$9})}this.$10.debugTrace("connect","connection lost");this.$27.onConnectionLost();this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectionlost");this.$48()};e.$44=function(a,b,c){this.$10.bumpCounter("protocol.onmessagearrived");this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onmessagearrived");this.$10.debugTrace("onMessageArrived","Message received on "+a);this.$27.onMessage(a);try{this.$3(a,b,c)}catch(b){this.$10.logError(b,"Listener threw error"),this.$10.bumpCounter("listener_error."+a)}};e.$45=function(a){this.$10.bumpCounter("protocol.onmessagedelivered");var b=a!=null?a:"null";this.$10.debugTrace("onMessageDelivered","Delivered Message {ID: "+b+"}");if(a==null)return;b=this.$24.get(a);if(b==null){this.$10.bumpCounter("protocol.message_with_unknown_id");return}this.$24["delete"](a);(a=b.listener)==null?void 0:a.onEvent(d("MqttPublishListener").MqttPublishEvent.ACKED);b.resolve();this.$10.bumpCounter("publish.ack_received")};e.$30=function(a){this.$10.bumpCounter("protocol.fail_all_unacked_publishes."+a),this.$24.forEach(function(b,e,f){(e=b.listener)==null?void 0:e.onEvent(d("MqttPublishListener").MqttPublishEvent.NOT_ACKED);b.reject(c("err")(a))}),this.$24.clear()};e.$50=function(a){var b=this,c=new Set(a);c.forEach(function(a){b.$17.has(a)||b.unsubscribe(a)});a=new Set(this.$17);a.forEach(function(a){c.has(a)||b.subscribe(a)})};e.$47=function(a,b){try{this.$10.bumpCounter("js_error_in_init");this.$10.bumpCounter(b+".error");this.$25=!0;var c=a?a.message:"error";this.$10.debugTrace("onError",b+": "+c);this.$2(a)}catch(a){this.$10.bumpCounter("js_error_in_error_logging"),this.$10.logError(a,"JS error while trying to log previous error")}};e.setRunning_OnlyForTests=function(a){this.$8=a};return a}();g["default"]=a}),98);
__d("MqttWebSocketUtils",[],(function(a,b,c,d,e,f){"use strict";function b(){return"WebSocket"in a&&a.WebSocket!=null&&"CLOSING"in a.WebSocket.prototype}f.hasWSSupport=b}),66);
__d("isFastRefreshEnabledForCurrentDomain",[],(function(a,b,c,d,e,f){"use strict";function a(){return!1}f["default"]=a}),66);
__d("MqttChannel",["ChannelClientID","IrisSubscribeChecker","MetaConfig","MqttAnalyticsHook","MqttConnection","MqttEnv","MqttPublishListener","MqttTypes","MqttUserName","MqttUtils","MqttWebSocketUtils","Promise","Run","err","isFastRefreshEnabledForCurrentDomain","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=29125;a=function(){function a(a){var b=this,e=a.endpoint,f=a.pollingEndpoint,g=a.userFbid,h=a.appId,i=a.initialSubscribedTopics,j=a.capabilities,k=a.clientCapabilities,l=a.chatVisibility;l=l===void 0?!0:l;var m=a.guestAuthString;m=m===void 0?null:m;var n=a.phpOverride;n=n===void 0?"":n;var o=a.clientType;o=o===void 0?"websocket":o;var p=a.deviceId;p=p===void 0?c("ChannelClientID").getID():p;var q=a.pageId;q=q===void 0?null:q;var r=a.assetIds;r=r===void 0?null:r;a=a.appSpecificInfo;a=a===void 0?null:a;this.$11=d("MqttEnv").Env.getLoggerInstance();this.$11.setAppId(h);this.$12=new(c("MqttUserName"))(g,j,k,p,h,l,m,n,o,q,r,a);this.$1=e;this.$2=f;this.$5="Disconnected";this.$7="LPInactive";this.$6="Disconnected";this.$3=[];this.$4=new Set();this.$8=new Map();this.$9=new Map();this.$10=new(c("MqttConnection"))();this.$13=null;this.$16=new(c("MqttAnalyticsHook"))();this.$15=new Map();this.$14=[];if(!d("MqttEnv").Env.isUserLoggedInNow()&&!c("isFastRefreshEnabledForCurrentDomain")()&&(m==null||m=="")){this.$11.bumpCounter("logged_out_init");return}this.$10.addHook(this.$16);this.$10.addHook(new(c("IrisSubscribeChecker"))(function(){return b.$4.size>0}));this.$17(i);this.$18()}var e=a.prototype;e.$17=function(a){var b=this;if(this.$10.isRunning()){this.$19("run","Connection started calling run again");return}if(d("MqttEnv").Env.genGk(d("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled))if(c("MetaConfig")._("15")){this.$19("MqttChannel","Websocket disabled, will do long polling only");return}else if(!d("MqttWebSocketUtils").hasWSSupport()){this.$19("MqttChannel","Websocket Unavailable, will do long polling only");this.$11.bumpCounter("ws_unavailable_polling");return}this.$10.run({endpoint:this.$1,extraConnectMessageProvider:function(){return b.$20()},mqttUserName:this.$12,onJSError:function(a){b.$21(a)},onMessageReceived:function(a,c,d){b.$22(a,c,d)},onStateChange:function(a){b.$23(a)},subscribedTopics:a});this.$24()};e.$24=function(){var a=this;d("Run").onUnload(function(){a.$25(d("MqttTypes").MqttErrors.BROWSER_CLOSE)})};e.shutdown=function(){this.$25(d("MqttTypes").MqttErrors.APP_DISCONNECT)};e.$25=function(a){this.$10&&this.$10.shutdown(a),this.$13&&this.$13.shutdown(),this.$16.onTabClose()};e.publish=function(a,b,c){c===void 0&&(c={qos:1,skipBuffer:!1});return this.$26(a,b,c)};e.publishBinary=function(a,b,c){c===void 0&&(c={qos:1,skipBuffer:!1});return this.$26(a,b,c)};e.$26=function(a,b,c){c===void 0&&(c={qos:1,skipBuffer:!1});var e;c.qos===0?e=this.$27(a,b,c.listener):e=this.$28(a,b,c);d("MqttUtils").promiseDone(e,function(){},function(a){(a=c.listener)==null?void 0:a.onEvent(d("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR)});return e};e.$27=function(a,b,c){return this.$29(a,b,0,c,1,null)};e.$28=function(a,c,e){var f={reject:function(a){},resolve:function(){}},g=new(h||(h=b("Promise")))(function(a,b){f.resolve=a,f.reject=b}),i=d("MqttEnv").Env.random();c={ack:f,attempt:0,options:e,payload:c,publishToken:i,startTime:Date.now(),timeoutId:null,topic:a};if(e.skipBuffer)if(this.$10.connectionState()==="Connecting"){this.$14.push(c);(a=e.listener)==null?void 0:a.onEvent(d("MqttPublishListener").MqttPublishEvent.QUEUED)}else this.$30(c);else{c.timeoutId=this.$31(i);this.$15.set(i,c);(a=e.listener)==null?void 0:a.onEvent(d("MqttPublishListener").MqttPublishEvent.QUEUED);this.$32(c)}return g};e.$30=function(a){a.attempt+=1,d("MqttUtils").promiseDone(this.$29(a.topic,a.payload,a.options.qos,a.options.listener,a.attempt,a.startTime),function(){a.ack.resolve()},function(b){a.ack.reject(b)})};e.$32=function(a){var b=this;a.attempt+=1;d("MqttUtils").promiseDone(this.$29(a.topic,a.payload,a.options.qos,a.options.listener,a.attempt,a.startTime),function(){return b.$33(a)},function(a){})};e.$29=function(a,b,e,f,g,h){var i=this,j,k,l=this.getConnectionState(),m=Date.now();!this.$10.canPublish()&&this.$13&&this.$13.canPublish()?(typeof b==="string"?j=this.$13.publish(a,b,e):j=this.$13.publishBinary(a,b,e),k="lp",f!=null&&(j=j.then(function(){return f.onEvent(d("MqttPublishListener").MqttPublishEvent.SENT)})),this.$11.bumpCounter("try_publish_lp")):(typeof b==="string"?j=this.$10.publish(a,b,e,f):j=this.$10.publishBinary(a,b,e,f),k="ws",this.$11.bumpCounter("try_publish_ws"));c("promiseDone")(j,function(){i.$11.eventLogOutgoingPublish({attempt:g,connectionState:l,disconnectCount:i.$10.getDisconnectCount(),errorMessage:null,firstAttemptStartTime:h,payloadSizeBytes:b.length*2,protocol:k,qos:e,sessionID:i.$10.getSessionId(),success:!0,thisAttemptStartTime:m,topic:a})},function(c){i.$11.eventLogOutgoingPublish({attempt:g,connectionState:l,disconnectCount:i.$10.getDisconnectCount(),errorMessage:c!=null?c.toString():null,firstAttemptStartTime:h,payloadSizeBytes:b.length*2,protocol:k,qos:e,sessionID:i.$10.getSessionId(),success:!1,thisAttemptStartTime:m,topic:a})});return j};e.subscribe=function(a,b){var c=this;this.$10.subscribe(a);var d=this.$8.get(a);!d?(d=[b],this.$8.set(a,d)):d.push(b);return function(){var d=c.$8.get(a)||[];d=d.filter(function(a){return a!==b});c.$8.set(a,d);d.length===0&&c.unsubscribeAll(a)}};e.subscribeBinary=function(a,b){var c=this;this.$10.subscribe(a);var d=this.$9.get(a);!d?(d=[b],this.$9.set(a,d)):d.push(b);return function(){var d=c.$9.get(a)||[];d=d.filter(function(a){return a!==b});c.$9.set(a,d);d.length===0&&c.unsubscribeAll(a)}};e.subscribeChannelEvents=function(a){var b=this;this.$3.push(a);return function(){b.unsubscribeChannelEvents(a)}};e.unsubscribeChannelEvents=function(a){a=this.$3.indexOf(a);a>-1&&this.$3.splice(a,1)};e.registerExtraConnectPayloadProvider=function(a){var b=this;this.$19("MqttChannel","registerExtraConnectPayloadProvider called");this.$4.add(a);if(this.$10.isRunning()){a=a.getPublishMessages();a.forEach(function(a){typeof a.payload==="string"?b.publish(a.topic,a.payload,{qos:a.qos,skipBuffer:!0}):b.publishBinary(a.topic,a.payload,{qos:a.qos,skipBuffer:!0})})}};e.unregisterExtraConnectPayloadProvider=function(a){this.$4["delete"](a)};e.unsubscribeAll=function(a){this.$10.unsubscribe(a),this.$8["delete"](a),this.$9["delete"](a)};e.getConnectionState=function(){return this.$5};e.getLongPollingStatus=function(){return this.$7};e.getEndpoint=function(){return this.$1};e.addHook=function(a){this.$10.addHook(a)};e.removeHook=function(a){this.$10.removeHook(a)};e.testOnlyMessageReceived=function(a,b){this.$22(a,b,-1)};e.$34=function(a){var b=this.$15.get(a);b!=null&&b.timeoutId!=null&&d("MqttEnv").Env.clearTimeout(b.timeoutId);this.$15["delete"](a)};e.$31=function(a){var b=this;return d("MqttEnv").Env.setTimeout(function(a){var d=b.$15.get(a);if(!d)return;var e=d.topic;b.$11.bumpCounter("publish_timeout."+e);b.$11.debugTrace("publish_timeout","Timeout publishing topic: "+e+" publishToken: "+a);b.$34(a);d.ack.reject(c("err")("Publish Timed Out"))},i,a)};e.$33=function(a){var b=a.publishToken,c=this.$15.get(b);if(!c)return;this.$34(b);a.ack.resolve();this.$11.debugTrace("publish_success","Topic: "+a.topic+" publishToken: "+a.publishToken);this.$11.bumpCounter("publish_success."+a.topic)};e.$22=function(a,b,c){var d=this.$8.get(a);this.$11.eventLogIncomingPublish({connectionState:this.getConnectionState(),disconnectCount:this.$10.getDisconnectCount(),payloadSizeBytes:b.payloadString.length*2,qos:c,sessionID:this.$10.getSessionId(),topic:a});if(!d)this.$11.debugTrace("_onMessageReceived",a+" being dropped, no listeners");else for(d of d)try{d(b.payloadString)}catch(a){this.$11.logError(a,"Listener exception"),this.$11.bumpCounter("listener_error")}d=this.$9.get(a);this.$11.eventLogIncomingPublish({connectionState:this.getConnectionState(),disconnectCount:this.$10.getDisconnectCount(),payloadSizeBytes:b.payloadBytes.length,qos:c,sessionID:this.$10.getSessionId(),topic:a});if(!d)this.$11.debugTrace("_onMessageReceived",a+" being dropped, no binary listeners");else for(c of d)try{c(b.payloadBytes)}catch(a){this.$11.logError(a,"Binary Listener exception"),this.$11.bumpCounter("listener_error")}};e.$21=function(a){if(d("MqttEnv").Env.genGk(d("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)){a.isRecoverable?this.$11.bumpCounter("recoverable_error_skipped"):this.$11.bumpCounter("unrecoverable_error_skipped");return}a.isRecoverable?this.$11.bumpCounter("recoverable_error_not_skipped"):this.$11.bumpCounter("unrecoverable_error_not_skipped");this.$35(a)};e.$36=function(a){this.$35(a)};e.$35=function(a){for(var b of this.$3)b.onJSError&&b.onJSError(a)};e.$37=function(){var a=this;this.$14.forEach(function(b){a.$30(b),a.$11.bumpCounter("publish_from_temp_buffer."+b.topic)});this.$14=[];this.$15.forEach(function(b,c,d){a.$32(b),a.$11.bumpCounter("publish_from_buffer."+b.topic)})};e.$23=function(a){a==="Connecting"?(this.$14.forEach(function(a){a.ack.reject(c("err")("Client Reconnecting - "+a.topic))}),this.$14=[]):a==="TransportConnected"&&this.$37(),this.$19("_changeState","Connection state = "+a),this.$38(a,this.$7)};e.$39=function(a,b){this.$13&&this.$13.canPublish()&&this.$37(),this.$19("_changeLPStatus","LP status = "+a+", LP Request status = "+b),this.$38(this.$6,a)};e.$38=function(a,b){var c=this.$10.mqttStateFromConnectionState(a);this.$13&&this.$13.canPublish()&&(c="Connected");this.$6=a;(c!==this.$5||b!=this.$7)&&(this.$5=c,this.$7=b,this.$40(c))};e.$40=function(a){for(var b of this.$3)b.onMQTTStateChanged(a)};e.$20=function(){var a=this,b=[];this.$4.forEach(function(c){try{c=c.getPublishMessages();Array.prototype.push.apply(b,c)}catch(b){a.$11.logError(b,"ConnectPayload provider exception"),a.$11.bumpCounter("connectPayloadProvider_error")}});return b};e.$18=function(){var a=this;d("MqttEnv").Env.genGk(d("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled)&&this.$2&&this.$2!=""&&c("requireDeferred")("MqttLongPollingRunner").__setRef("MqttChannel").onReady(function(b){b=new b(a.$2,a.$12,a.$10.hasFatal(),a.$10.hasConnectSuccess(),function(b,c,d){return a.$22(b,c,d)},function(){var b=Array.from(a.$8.keys()),c=Array.from(a.$9.keys());return Array.from(new Set(b.concat(c)))},function(){return a.$20()},function(b){a.$36(b)},function(b,c){a.$39(b,c)});b.start();a.$10.addHook(b);b.addHook(a.$16);a.$13=b;a.$11.debugTrace("MqttChannel","longPollingRunner loaded")})};e.$19=function(a,b){this.$11.debugTrace(a,"Mqtt channel: "+b)};e.setForegroundState=function(a){this.$12&&this.$12.setForegroundState(a)};e.setChatVisibility=function(a){this.$12&&this.$12.setChatVisibility(a)};e.getEndpointCapabilities=function(){return this.$12.getEndpointCapabilities()};e.setEndpointCapabilities=function(a){this.$12.setEndpointCapabilities(a)};e.getConnection_OnlyForTests=function(){return this.$10};return a}();g["default"]=a}),98);
__d("MqttConfig",["MqttWebConfig"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("MqttWebConfig")}),98);
__d("MqttEnvConfigStorage",["WebStorage"],(function(a,b,c,d,e,f,g){var h,i="mqtt:";function a(a,b){var d=(h||(h=c("WebStorage"))).getLocalStorage();if(d){d=d.getItem(i+a);if(d!=null)return d}return b}function b(a,b){var d=(h||(h=c("WebStorage"))).getLocalStorage();d&&(b==null?d.removeItem(i+a):(h||(h=c("WebStorage"))).setItemGuarded(d,i+a,b))}g.configRead=a;g.configWrite=b}),98);
__d("MqttUnifiedClientConnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744057");b=d("FalcoLoggerInternal").create("mqtt_unified_client_connect",a);e=b;g["default"]=e}),98);
__d("MqttUnifiedClientDisconnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744058");b=d("FalcoLoggerInternal").create("mqtt_unified_client_disconnect",a);e=b;g["default"]=e}),98);
__d("MqttUnifiedClientIncomingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744059");b=d("FalcoLoggerInternal").create("mqtt_unified_client_incoming_publish",a);e=b;g["default"]=e}),98);
__d("MqttUnifiedClientOutgoingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744060");b=d("FalcoLoggerInternal").create("mqtt_unified_client_outgoing_publish",a);e=b;g["default"]=e}),98);
__d("MqttWsClientTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:MqttWsClientLoggerConfig")}),null);
__d("MqttLogger",["ChannelClientID","FBLogger","LogHistory","MetaConfig","MqttEnv","MqttGlobalStreamCounter","MqttUnifiedClientConnectFalcoEvent","MqttUnifiedClientDisconnectFalcoEvent","MqttUnifiedClientIncomingPublishFalcoEvent","MqttUnifiedClientOutgoingPublishFalcoEvent","MqttWsClientTypedLoggerLite","NetworkStatus","ODS","Random"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("MetaConfig")._("99"),j="mqtt_client",k=100,l="WEBSOCKET",m=typeof window!=="undefined"?window:self,n=null,o={CLIENT_ERROR:"mqtt_client_error",CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish",PUBLISH_TIMEOUT:"mqtt_qos1_publish_timeout",SOCKET_DISCONNECT:"mqtt_protocol_error"},p={CONNECT:"connect",DISCONNECT:"disconnect",INCOMING_PUBLISH:"incoming_publish",OUTGOING_PUBLISH:"outgoing_publish"};a=function(){a.getInstance=function(b){n||(n=new a(b));return n};function a(a){this.$1=d("LogHistory").getInstance(j),this.$2=0,this.$3=Date.now(),this.$4=c("ChannelClientID").getID(),this.$7(),this.$5=d("MqttGlobalStreamCounter").getInstance(),this.$5.isEnabled()||(this.$5=null),this.$6=a}var b=a.prototype;b.setAppId=function(a){this.$2===0&&(this.$2=a)};b.eventLogConnect=function(a){var b=a.ackReceived,d=a.attemptNumber,e=a.connectionState,f=a.connectionStatus,g=a.disconnectCount,h=a.duration,i=a.errorMessage,j=a.failTotal,k=a.hostname,m=a.messageSizeBytes,n=a.osConnectivity,q=a.sessionID,r=a.successTotal;a=a.total_duration;var s=f?"success":"failed";this.bumpCounter(o.CONNECT+"."+s);s=r/(r+j);r=n&&this.getBrowserConnectivity();var t={acked:b,attempt_number:d.toString(),client_type:l,connection_state:e,disconnect_count:g.toString(),duration:h.toString(),error:i,event_type:p.CONNECT,extra_data:{connect_success_rate:s.toString(),device_id:this.$4,hostname:k,connectionStatus:f.toString(),exposure:(j=this.$6)!=null?j:""},os_connectivity:r,payload_size:m==null?void 0:m.toString(),session_id:q.toString(),total_duration:a.toString(),ws_count:(n=this.$5)==null?void 0:n.getGlobalState().totalConnectionStreams.toString()};this.$8(function(){c("MqttUnifiedClientConnectFalcoEvent").log(function(){return t})})};b.eventLogPull=function(a){var b=a.duration,c=a.errorMessage,e=a.hostname,f=a.pullEventName,g=a.sessionID;a=a.status;a={connection_status:a,device_id:this.$4,duration:b,error_message:c,hostname:e,href:m.location.hostname,logged_in:d("MqttEnv").Env.isUserLoggedInNow(),session_id:g};this.$9(f,a)};b.eventLogPullFinish=function(a){var b=a.duration,c=a.errorMessage,e=a.publishReceived,f=a.publishSent,g=a.pullEventName;a=a.sessionID;b={device_id:this.$4,duration:b,error_message:c,href:m.location.hostname,logged_in:d("MqttEnv").Env.isUserLoggedInNow(),publish_received:e,publish_sent:f,session_id:a};this.$9(g,b)};b.eventLogDisconnect=function(a){var b=a.disconnectCount,d=a.duration,e=a.errorMessage;a=a.sessionID;this.bumpCounter(o.DISCONNECT);var f={client_type:l,connection_state:"Disconnected",disconnect_count:b.toString(),duration:d.toString(),error:e,event_type:p.DISCONNECT,extra_data:{device_id:this.$4,exposure:(b=this.$6)!=null?b:""},os_connectivity:this.getBrowserConnectivity(),session_id:a.toString(),ws_count:(d=this.$5)==null?void 0:d.getGlobalState().totalConnectionStreams.toString()};this.$8(function(){c("MqttUnifiedClientDisconnectFalcoEvent").log(function(){return f})})};b.eventLogOutgoingPublish=function(a){var b=a.attempt,d=a.connectionState,e=a.disconnectCount,f=a.errorMessage,g=a.firstAttemptStartTime,h=a.payloadSizeBytes,i=a.protocol,j=a.qos,k=a.sessionID,m=a.success,n=a.thisAttemptStartTime;a=a.topic;this.bumpCounter(o.PUBLISH+"."+a);var q=Date.now(),r={acked:j===1?m:null,attempt_number:b.toString(),client_type:l,connection_state:d,disconnect_count:e.toString(),duration:(q-n).toString(),error:f,event_type:p.OUTGOING_PUBLISH,extra_data:{device_id:this.$4,protocol:i},os_connectivity:this.getBrowserConnectivity(),payload_size:h.toString(),qos:j.toString(),session_id:k.toString(),topic:a,total_duration:g!=null?(q-g).toString():null};this.$8(function(){c("MqttUnifiedClientIncomingPublishFalcoEvent").log(function(){return r})})};b.eventLogIncomingPublish=function(a){var b=a.connectionState,d=a.disconnectCount,e=a.payloadSizeBytes,f=a.qos,g=a.sessionID;a=a.topic;var h={client_type:l,connection_state:b,disconnect_count:d.toString(),event_type:p.INCOMING_PUBLISH,extra_data:{device_id:this.$4},os_connectivity:this.getBrowserConnectivity(),payload_size:e.toString(),qos:f.toString(),session_id:g.toString(),topic:a};b=a=="/webrtc"||a=="/rtc_multi";this.$10(function(){c("MqttUnifiedClientOutgoingPublishFalcoEvent").log(function(){return h})},50,b)};b.logError=function(a,b){d("MqttEnv").Env.scheduleLoggingCallback(function(){try{c("FBLogger")(j).catching(a).mustfix(b)}catch(a){}})};b.logErrorWarn=function(a,b){d("MqttEnv").Env.scheduleLoggingCallback(function(){try{c("FBLogger")(j).catching(a).warn(b)}catch(a){}})};b.logWarn=function(a,b){var c=this;d("MqttEnv").Env.scheduleLoggingCallback(function(){try{c.$1.warn(a,b)}catch(a){}})};b.debugTrace=function(a,b){var c=this;d("MqttEnv").Env.scheduleLoggingCallback(function(){try{c.$1.debug(a,b)}catch(a){}})};b.bumpCounter=function(a){var b=this;if(!d("Random").coinflip(k))return;d("MqttEnv").Env.scheduleLoggingCallback(function(){b.$2!==0&&(h||(h=d("ODS"))).bumpEntityKey(2966,"mqtt_ws_client",b.$2+"."+a,k),(h||(h=d("ODS"))).bumpEntityKey(2966,"mqtt_ws_client",a,k)})};b.$9=function(a,b,e){var f=this;d("MqttEnv").Env.scheduleLoggingCallback(function(){b.event_type=a;b.app_id=f.$2;b.online=f.$11();var d=JSON.stringify(b);f.$1.log(a,d,{weight:e});a!==o.DISCONNECT&&c("MqttWsClientTypedLoggerLite").log(b)})};b.$10=function(a,b,c){i&&b!==0?c=c||d("Random").coinflip(b):c=!0;c&&d("MqttEnv").Env.scheduleCallback(a)};b.$8=function(a){this.$10(a,0,!1)};b.$11=function(){return m.navigator&&m.navigator.onLine!==void 0?m.navigator.onLine:!1};b.getBrowserConnectivity=function(){return c("NetworkStatus").isOnline()};b.$7=function(){var a=this;if(m.navigator&&m.navigator.onLine!==void 0){var b=function(b){b=b.online;b||a.bumpCounter("browser_disconnect")};c("NetworkStatus").onChange(b)}};return a}();g["default"]=a}),98);
__d("MqttEnvGk",["MqttEnv","MqttLogger","gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case d("MqttEnv").MqttGkNames.mqtt_waterfall_log_client_sampling:return c("gkx")("21119");case d("MqttEnv").MqttGkNames.mqtt_ws_polling_enabled:return!0;case d("MqttEnv").MqttGkNames.mqtt_lp_use_fetch:return c("gkx")("21120");case d("MqttEnv").MqttGkNames.mqtt_fast_lp:return c("gkx")("21121");case d("MqttEnv").MqttGkNames.mqtt_lp_no_delay:return c("gkx")("21122");case d("MqttEnv").MqttGkNames.mqtt_enable_publish_over_polling:return c("gkx")("21123");case d("MqttEnv").MqttGkNames.mqttweb_global_connection_counter:return c("gkx")("21124");default:c("MqttLogger").getInstance().logError(new Error("unknown gk"),"Unknown GK value "+a);return!1}}g["default"]=a}),98);
__d("MqttEnvInitializer",["CurrentMessengerUser","MqttEnv","MqttEnvConfigStorage","MqttEnvGk","MqttLogger","Random","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";function a(a){d("MqttEnv").Env.initialize(c("Random").random,d("CurrentMessengerUser").isLoggedInNow,c("clearTimeout"),c("setTimeoutAcrossTransitions"),function(){return c("MqttLogger").getInstance()},c("MqttEnvGk"),a!=null?a:null,null,null,d("MqttEnvConfigStorage").configRead,d("MqttEnvConfigStorage").configWrite)}b={genGk:c("MqttEnvGk"),initialize:a};g["default"]=b}),98);
__d("FBMqttChannel",["MqttChannel","MqttConfig","MqttEnvInitializer"],(function(a,b,c,d,e,f,g){"use strict";c("MqttEnvInitializer").initialize();b=new(c("MqttChannel"))({appId:(a=c("MqttConfig")).appID,capabilities:a.capabilities,chatVisibility:!1,clientCapabilities:a.clientCapabilities,endpoint:a.endpoint,initialSubscribedTopics:a.subscribedTopics,phpOverride:a.hostNameOverride,pollingEndpoint:a.pollingEndpoint,userFbid:a.fbid});g["default"]=b}),98);/*FB_PKG_DELIM*/
/**
 *
 * This file is generated from fbsource. Please do not modify it directly.
 *
 *
 * @nolint
 * @generated
 * @nopackage
 * @fullSyntaxTransform
 * @preserve-whitespace
 */__d("ls_voprf_utils_v2",["Promise"],(function $module_ls_voprf_utils_v2(global,require,requireDynamic,requireLazy,module,exports){var _require_closure_Promise;


var Module=function(){
var _scriptDir=typeof document!=='undefined'&&document.currentScript?document.currentScript.src:undefined;

return(
function(moduleArg){if(moduleArg===void 0){moduleArg={};}

var Module=moduleArg;var readyPromiseResolve,readyPromiseReject;Module["ready"]=new(_require_closure_Promise||(_require_closure_Promise=require("Promise")))(function(resolve,reject){readyPromiseResolve=resolve;readyPromiseReject=reject;});["_main","getExceptionMessage","___get_exception_message","_free","_memory","_curve_create","_curve_free","_curve_init_ristretto","_get_curve_element_bytes","_get_curve_scalar_bytes","_kdf_create","_kdf_free","_kdf_init_naor_reingold","_sodiumInit","_voprf_create","_voprf_free","_voprf_init_exp_twohashdh","_blind","_verifiable_unblind","_voprf_client_finalize","_voprf_setup","_voprf_evaluate","_voprf_server_finalize","_get_voprf_final_evaluation_bytes","___indirect_function_table","__embind_initialize_bindings","_fflush","___start_em_asm","___stop_em_asm","onRuntimeInitialized"].forEach(function(prop){if(!Object.getOwnPropertyDescriptor(Module["ready"],prop)){Object.defineProperty(Module["ready"],prop,{get:function get(){return abort("You are getting "+prop+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js");},set:function set(){return abort("You are setting "+prop+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js");}});}});var moduleOverrides=Object.assign({},Module);var arguments_=[];var thisProgram="./this.program";var quit_=function quit_(status,toThrow){throw toThrow;};var ENVIRONMENT_IS_WEB=true;var ENVIRONMENT_IS_WORKER=false;var ENVIRONMENT_IS_NODE=false;var ENVIRONMENT_IS_SHELL=false;if(Module["ENVIRONMENT"]){throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");}var scriptDirectory="";function locateFile(path){if(Module["locateFile"]){return Module["locateFile"](path,scriptDirectory);}return scriptDirectory+path;}var read_,readAsync,readBinary,setWindowTitle;if(ENVIRONMENT_IS_SHELL){if(typeof process=="object"&&typeof require==="function"||typeof window=="object"||typeof importScripts=="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");if(typeof read!="undefined"){read_=read;}readBinary=function readBinary(f){if(typeof readbuffer=="function"){return new Uint8Array(readbuffer(f));}var data=read(f,"binary");assert(typeof data=="object");return data;};readAsync=function readAsync(f,onload,onerror){setTimeout(function(){return onload(readBinary(f));});};if(typeof clearTimeout=="undefined"){globalThis.clearTimeout=function(id){};}if(typeof setTimeout=="undefined"){globalThis.setTimeout=function(f){return typeof f=="function"?f():abort();};}if(typeof scriptArgs!="undefined"){arguments_=scriptArgs;}else if(typeof arguments!="undefined"){arguments_=arguments;}if(typeof quit=="function"){quit_=function quit_(status,toThrow){setTimeout(function(){if(!(toThrow instanceof ExitStatus)){var toLog=toThrow;if(toThrow&&typeof toThrow=="object"&&toThrow.stack){toLog=[toThrow,toThrow.stack];}err("exiting due to exception: "+toLog);}quit(status);});throw toThrow;};}if(typeof print!="undefined"){if(typeof console=="undefined")console={};console.log=print;console.warn=console.error=typeof printErr!="undefined"?printErr:print;}}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){if(ENVIRONMENT_IS_WORKER){scriptDirectory=self.location.href;}else if(typeof document!="undefined"&&document.currentScript){scriptDirectory=document.currentScript.src;}if(_scriptDir){scriptDirectory=_scriptDir;}if(scriptDirectory.indexOf("blob:")!==0){scriptDirectory=scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1);}else{scriptDirectory="";}if(!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");{read_=function read_(url){var xhr=new XMLHttpRequest();xhr.open("GET",url,false);xhr.send(null);return xhr.responseText;};if(ENVIRONMENT_IS_WORKER){readBinary=function readBinary(url){var xhr=new XMLHttpRequest();xhr.open("GET",url,false);xhr.responseType="arraybuffer";xhr.send(null);return new Uint8Array(xhr.response);};}readAsync=function readAsync(url,onload,onerror){var xhr=new XMLHttpRequest();xhr.open("GET",url,true);xhr.responseType="arraybuffer";xhr.onload=function(){if(xhr.status==200||xhr.status==0&&xhr.response){onload(xhr.response);return;}onerror();};xhr.onerror=onerror;xhr.send(null);};}setWindowTitle=function setWindowTitle(title){return document.title=title;};}else{throw new Error("environment detection error");}var out=Module["print"]||console.log.bind(console);var err=Module["printErr"]||console.error.bind(console);Object.assign(Module,moduleOverrides);moduleOverrides=null;checkIncomingModuleAPI();if(Module["arguments"])arguments_=Module["arguments"];legacyModuleProp("arguments","arguments_");if(Module["thisProgram"])thisProgram=Module["thisProgram"];legacyModuleProp("thisProgram","thisProgram");if(Module["quit"])quit_=Module["quit"];legacyModuleProp("quit","quit_");assert(typeof Module["memoryInitializerPrefixURL"]=="undefined","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["pthreadMainPrefixURL"]=="undefined","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["cdInitializerPrefixURL"]=="undefined","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["filePackagePrefixURL"]=="undefined","Module.filePackagePrefixURL option was removed, use Module.locateFile instead");assert(typeof Module["read"]=="undefined","Module.read option was removed (modify read_ in JS)");assert(typeof Module["readAsync"]=="undefined","Module.readAsync option was removed (modify readAsync in JS)");assert(typeof Module["readBinary"]=="undefined","Module.readBinary option was removed (modify readBinary in JS)");assert(typeof Module["setWindowTitle"]=="undefined","Module.setWindowTitle option was removed (modify setWindowTitle in JS)");assert(typeof Module["TOTAL_MEMORY"]=="undefined","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY");legacyModuleProp("asm","wasmExports");legacyModuleProp("read","read_");legacyModuleProp("readAsync","readAsync");legacyModuleProp("readBinary","readBinary");legacyModuleProp("setWindowTitle","setWindowTitle");assert(!ENVIRONMENT_IS_WORKER,"worker environment detected but not enabled at build time.  Add 'worker' to `-sENVIRONMENT` to enable.");assert(!ENVIRONMENT_IS_NODE,"node environment detected but not enabled at build time.  Add 'node' to `-sENVIRONMENT` to enable.");assert(!ENVIRONMENT_IS_SHELL,"shell environment detected but not enabled at build time.  Add 'shell' to `-sENVIRONMENT` to enable.");var wasmBinary;if(Module["wasmBinary"])wasmBinary=Module["wasmBinary"];legacyModuleProp("wasmBinary","wasmBinary");var noExitRuntime=Module["noExitRuntime"]||true;legacyModuleProp("noExitRuntime","noExitRuntime");if(typeof WebAssembly!="object"){abort("no native wasm support detected");}var wasmMemory;var wasmExports;var ABORT=false;var EXITSTATUS;function assert(condition,text){if(!condition){abort("Assertion failed"+(text?": "+text:""));}}var HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var b=wasmMemory.buffer;Module["HEAP8"]=HEAP8=new Int8Array(b);Module["HEAP16"]=HEAP16=new Int16Array(b);Module["HEAP32"]=HEAP32=new Int32Array(b);Module["HEAPU8"]=HEAPU8=new Uint8Array(b);Module["HEAPU16"]=HEAPU16=new Uint16Array(b);Module["HEAPU32"]=HEAPU32=new Uint32Array(b);Module["HEAPF32"]=HEAPF32=new Float32Array(b);Module["HEAPF64"]=HEAPF64=new Float64Array(b);}assert(!Module["STACK_SIZE"],"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time");assert(typeof Int32Array!="undefined"&&typeof Float64Array!=="undefined"&&Int32Array.prototype.subarray!=undefined&&Int32Array.prototype.set!=undefined,"JS engine does not provide full typed array support");assert(!Module["wasmMemory"],"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally");assert(!Module["INITIAL_MEMORY"],"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");var wasmTable;function writeStackCookie(){var max=_emscripten_stack_get_end2();assert((max&3)==0);if(max==0){max+=4;}HEAPU32[max>>2]=34821223;HEAPU32[max+4>>2]=2310721022;HEAPU32[0>>2]=1668509029;}function checkStackCookie(){if(ABORT)return;var max=_emscripten_stack_get_end2();if(max==0){max+=4;}var cookie1=HEAPU32[max>>2];var cookie2=HEAPU32[max+4>>2];if(cookie1!=34821223||cookie2!=2310721022){abort("Stack overflow! Stack cookie has been overwritten at "+ptrToString(max)+", expected hex dwords 0x89BACDFE and 0x2135467, but received "+ptrToString(cookie2)+" "+ptrToString(cookie1));}if(HEAPU32[0>>2]!=1668509029){abort("Runtime error: The application has corrupted its heap memory area (address zero)!");}}(function(){var h16=new Int16Array(1);var h8=new Int8Array(h16.buffer);h16[0]=25459;if(h8[0]!==115||h8[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)";})();var __ATPRERUN__=[];var __ATINIT__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeKeepaliveCounter=0;function preRun(){if(Module["preRun"]){if(typeof Module["preRun"]=="function")Module["preRun"]=[Module["preRun"]];while(Module["preRun"].length){addOnPreRun(Module["preRun"].shift());}}callRuntimeCallbacks(__ATPRERUN__);}function initRuntime(){assert(!runtimeInitialized);runtimeInitialized=true;checkStackCookie();callRuntimeCallbacks(__ATINIT__);}function postRun(){checkStackCookie();if(Module["postRun"]){if(typeof Module["postRun"]=="function")Module["postRun"]=[Module["postRun"]];while(Module["postRun"].length){addOnPostRun(Module["postRun"].shift());}}callRuntimeCallbacks(__ATPOSTRUN__);}function addOnPreRun(cb){__ATPRERUN__.unshift(cb);}function addOnInit(cb){__ATINIT__.unshift(cb);}function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb);}assert(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;var runDependencyTracking={};function addRunDependency(id){runDependencies++;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies);}if(id){assert(!runDependencyTracking[id]);runDependencyTracking[id]=1;if(runDependencyWatcher===null&&typeof setInterval!="undefined"){runDependencyWatcher=setInterval(function(){if(ABORT){clearInterval(runDependencyWatcher);runDependencyWatcher=null;return;}var shown=false;for(var dep in runDependencyTracking){if(!shown){shown=true;err("still waiting on run dependencies:");}err("dependency: "+dep);}if(shown){err("(end of list)");}},1e4);}}else{err("warning: run dependency added without ID");}}function removeRunDependency(id){runDependencies--;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies);}if(id){assert(runDependencyTracking[id]);delete runDependencyTracking[id];}else{err("warning: run dependency removed without ID");}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null;}if(dependenciesFulfilled){var callback=dependenciesFulfilled;dependenciesFulfilled=null;callback();}}}function abort(what){if(Module["onAbort"]){Module["onAbort"](what);}what="Aborted("+what+")";err(what);ABORT=true;EXITSTATUS=1;var e=new WebAssembly.RuntimeError(what);readyPromiseReject(e);throw e;}var FS={error:function error(){abort("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with -sFORCE_FILESYSTEM");},init:function init(){FS.error();},createDataFile:function createDataFile(){FS.error();},createPreloadedFile:function createPreloadedFile(){FS.error();},createLazyFile:function createLazyFile(){FS.error();},open:function open(){FS.error();},mkdev:function mkdev(){FS.error();},registerDevice:function registerDevice(){FS.error();},analyzePath:function analyzePath(){FS.error();},ErrnoError:function ErrnoError(){FS.error();}};Module["FS_createDataFile"]=FS.createDataFile;Module["FS_createPreloadedFile"]=FS.createPreloadedFile;var dataURIPrefix="data:application/octet-stream;base64,";function isDataURI(filename){return filename.startsWith(dataURIPrefix);}function isFileURI(filename){return filename.startsWith("file://");}function createExportWrapper(name){return function(){assert(runtimeInitialized,"native function `"+name+"` called before runtime initialization");var f=wasmExports[name];assert(f,"exported native function `"+name+"` not found");return f.apply(null,arguments);};}var EmscriptenEH=function(_Error){"use strict";babelHelpers.inheritsLoose(EmscriptenEH,_Error);function EmscriptenEH(){return _Error.apply(this,arguments)||this;}return EmscriptenEH;}(babelHelpers.wrapNativeSuper(Error));var EmscriptenSjLj=function(_EmscriptenEH){"use strict";babelHelpers.inheritsLoose(EmscriptenSjLj,_EmscriptenEH);function EmscriptenSjLj(){return _EmscriptenEH.apply(this,arguments)||this;}return EmscriptenSjLj;}(EmscriptenEH);var CppException=function(_EmscriptenEH2){"use strict";babelHelpers.inheritsLoose(CppException,_EmscriptenEH2);function CppException(excPtr){var _this;_this=_EmscriptenEH2.call(this,excPtr)||this;_this.excPtr=excPtr;var excInfo=getExceptionMessage(excPtr);_this.name=excInfo[0];_this.message=excInfo[1];return _this;}return CppException;}(EmscriptenEH);var wasmBinaryFile;wasmBinaryFile="crypto_utils_v2.wasm";if(!isDataURI(wasmBinaryFile)){wasmBinaryFile=locateFile(wasmBinaryFile);}function getBinarySync(file){if(file==wasmBinaryFile&&wasmBinary){return new Uint8Array(wasmBinary);}if(readBinary){return readBinary(file);}throw"both async and sync fetching of the wasm failed";}function getBinaryPromise(binaryFile){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"){return fetch(binaryFile,{credentials:"same-origin"}).then(function(response){if(!response["ok"]){throw"failed to load wasm binary file at '"+binaryFile+"'";}return response["arrayBuffer"]();})["catch"](function(){return getBinarySync(binaryFile);});}}return(_require_closure_Promise||(_require_closure_Promise=require("Promise"))).resolve().then(function(){return getBinarySync(binaryFile);});}function instantiateArrayBuffer(binaryFile,imports,receiver){return getBinaryPromise(binaryFile).then(function(binary){return WebAssembly.instantiate(binary,imports);}).then(function(instance){return instance;}).then(receiver,function(reason){err("failed to asynchronously prepare wasm: "+reason);if(isFileURI(wasmBinaryFile)){err("warning: Loading from a file URI ("+wasmBinaryFile+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing");}abort(reason);});}function instantiateAsync(binary,binaryFile,imports,callback){if(!binary&&typeof WebAssembly.instantiateStreaming=="function"&&!isDataURI(binaryFile)&&typeof fetch=="function"){return fetch(binaryFile,{credentials:"same-origin"}).then(function(response){var result=WebAssembly.instantiateStreaming(response,imports);return result.then(callback,function(reason){err("wasm streaming compile failed: "+reason);err("falling back to ArrayBuffer instantiation");return instantiateArrayBuffer(binaryFile,imports,callback);});});}return instantiateArrayBuffer(binaryFile,imports,callback);}function createWasm(){var info={"env":wasmImports,"wasi_snapshot_preview1":wasmImports};function receiveInstance(instance,module){var exports=instance.exports;wasmExports=exports;wasmMemory=wasmExports["memory"];Module["wasmMemory"]=wasmMemory;assert(wasmMemory,"memory not found in wasm exports");updateMemoryViews();wasmTable=wasmExports["__indirect_function_table"];assert(wasmTable,"table not found in wasm exports");addOnInit(wasmExports["__wasm_call_ctors"]);removeRunDependency("wasm-instantiate");return exports;}addRunDependency("wasm-instantiate");var trueModule=Module;function receiveInstantiationResult(result){assert(Module===trueModule,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?");trueModule=null;receiveInstance(result["instance"]);}if(Module["instantiateWasm"]){try{return Module["instantiateWasm"](info,receiveInstance);}catch(e){err("Module.instantiateWasm callback failed with error: "+e);readyPromiseReject(e);}}instantiateAsync(wasmBinary,wasmBinaryFile,info,receiveInstantiationResult)["catch"](readyPromiseReject);return{};}function legacyModuleProp(prop,newName,incomming){if(incomming===void 0){incomming=true;}if(!Object.getOwnPropertyDescriptor(Module,prop)){Object.defineProperty(Module,prop,{configurable:true,get:function get(){var extra=incomming?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":"";abort("`Module."+prop+"` has been replaced by `"+newName+"`"+extra);}});}}function ignoredModuleProp(prop){if(Object.getOwnPropertyDescriptor(Module,prop)){abort("`Module."+prop+"` was supplied but `"+prop+"` not included in INCOMING_MODULE_JS_API");}}function isExportedByForceFilesystem(name){return name==="FS_createPath"||name==="FS_createDataFile"||name==="FS_createPreloadedFile"||name==="FS_unlink"||name==="addRunDependency"||name==="FS_createLazyFile"||name==="FS_createDevice"||name==="removeRunDependency";}function missingGlobal(sym,msg){if(typeof globalThis!=="undefined"){Object.defineProperty(globalThis,sym,{configurable:true,get:function get(){warnOnce("`"+sym+"` is not longer defined by emscripten. "+msg);return undefined;}});}}missingGlobal("buffer","Please use HEAP8.buffer or wasmMemory.buffer");function missingLibrarySymbol(sym){if(typeof globalThis!=="undefined"&&!Object.getOwnPropertyDescriptor(globalThis,sym)){Object.defineProperty(globalThis,sym,{configurable:true,get:function get(){var msg="`"+sym+"` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line";var librarySymbol=sym;if(!librarySymbol.startsWith("_")){librarySymbol="$"+sym;}msg+=" (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='"+librarySymbol+"')";if(isExportedByForceFilesystem(sym)){msg+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you";}warnOnce(msg);return undefined;}});}unexportedRuntimeSymbol(sym);}function unexportedRuntimeSymbol(sym){if(!Object.getOwnPropertyDescriptor(Module,sym)){Object.defineProperty(Module,sym,{configurable:true,get:function get(){var msg="'"+sym+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)";if(isExportedByForceFilesystem(sym)){msg+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you";}abort(msg);}});}}var ASM_CONSTS={50356:function _(){return Module.getRandomValue();},50392:function _(){if(Module.getRandomValue===undefined){try{var window_="object"===typeof window?window:self;var crypto_=typeof window_.crypto!=="undefined"?window_.crypto:window_.msCrypto;var randomValuesStandard=function randomValuesStandard(){var buf=new Uint32Array(1);crypto_.getRandomValues(buf);return buf[0]>>>0;};randomValuesStandard();Module.getRandomValue=randomValuesStandard;}catch(e){{throw"No secure random number generator found";}}}}};function ExitStatus(status){this.name="ExitStatus";this.message="Program terminated with exit("+status+")";this.status=status;}var callRuntimeCallbacks=function callRuntimeCallbacks(callbacks){while(callbacks.length>0){callbacks.shift()(Module);}};var withStackSave=function withStackSave(f){var stack=stackSave();var ret=f();stackRestore(stack);return ret;};var UTF8Decoder=typeof TextDecoder!="undefined"?new TextDecoder("utf8"):undefined;var UTF8ArrayToString=function UTF8ArrayToString(heapOrArray,idx,maxBytesToRead){var endIdx=idx+maxBytesToRead;var endPtr=idx;while(heapOrArray[endPtr]&&!(endPtr>=endIdx)){++endPtr;}if(endPtr-idx>16&&heapOrArray.buffer&&UTF8Decoder){return UTF8Decoder.decode(heapOrArray.subarray(idx,endPtr));}var str="";while(idx<endPtr){var u0=heapOrArray[idx++];if(!(u0&128)){str+=String.fromCharCode(u0);continue;}var u1=heapOrArray[idx++]&63;if((u0&224)==192){str+=String.fromCharCode((u0&31)<<6|u1);continue;}var u2=heapOrArray[idx++]&63;if((u0&240)==224){u0=(u0&15)<<12|u1<<6|u2;}else{if((u0&248)!=240)warnOnce("Invalid UTF-8 leading byte "+ptrToString(u0)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!");u0=(u0&7)<<18|u1<<12|u2<<6|heapOrArray[idx++]&63;}if(u0<65536){str+=String.fromCharCode(u0);}else{var ch=u0-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023);}}return str;};var UTF8ToString=function UTF8ToString(ptr,maxBytesToRead){assert(typeof ptr=="number");return ptr?UTF8ArrayToString(HEAPU8,ptr,maxBytesToRead):"";};var getExceptionMessageCommon=function getExceptionMessageCommon(ptr){return withStackSave(function(){var type_addr_addr=stackAlloc(4);var message_addr_addr=stackAlloc(4);___get_exception_message(ptr,type_addr_addr,message_addr_addr);var type_addr=HEAPU32[type_addr_addr>>2];var message_addr=HEAPU32[message_addr_addr>>2];var type=UTF8ToString(type_addr);_free(type_addr);var message;if(message_addr){message=UTF8ToString(message_addr);_free(message_addr);}return[type,message];});};function getExceptionMessage(ptr){return getExceptionMessageCommon(ptr);}Module["getExceptionMessage"]=getExceptionMessage;function getValue(ptr,type){if(type===void 0){type="i8";}if(type.endsWith("*"))type="*";switch(type){case"i1":return HEAP8[ptr>>0];case"i8":return HEAP8[ptr>>0];case"i16":return HEAP16[ptr>>1];case"i32":return HEAP32[ptr>>2];case"i64":abort("to do getValue(i64) use WASM_BIGINT");case"float":return HEAPF32[ptr>>2];case"double":return HEAPF64[ptr>>3];case"*":return HEAPU32[ptr>>2];default:abort("invalid type for getValue: "+type);}}var ptrToString=function ptrToString(ptr){assert(typeof ptr==="number");ptr>>>=0;return"0x"+ptr.toString(16).padStart(8,"0");};var warnOnce=function warnOnce(text){if(!warnOnce.shown)warnOnce.shown={};if(!warnOnce.shown[text]){warnOnce.shown[text]=1;err(text);}};var ___assert_fail=function ___assert_fail(condition,filename,line,func){abort("Assertion failed: "+UTF8ToString(condition)+", at: "+[filename?UTF8ToString(filename):"unknown filename",line,func?UTF8ToString(func):"unknown function"]);};var exceptionCaught=[];var uncaughtExceptionCount=0;function ___cxa_begin_catch(ptr){var info=new ExceptionInfo(ptr);if(!info.get_caught()){info.set_caught(true);uncaughtExceptionCount--;}info.set_rethrown(false);exceptionCaught.push(info);___cxa_increment_exception_refcount(info.excPtr);return info.get_exception_ptr();}var exceptionLast=0;function ExceptionInfo(excPtr){this.excPtr=excPtr;this.ptr=excPtr-24;this.set_type=function(type){HEAPU32[this.ptr+4>>2]=type;};this.get_type=function(){return HEAPU32[this.ptr+4>>2];};this.set_destructor=function(destructor){HEAPU32[this.ptr+8>>2]=destructor;};this.get_destructor=function(){return HEAPU32[this.ptr+8>>2];};this.set_caught=function(caught){caught=caught?1:0;HEAP8[this.ptr+12>>0]=caught;};this.get_caught=function(){return HEAP8[this.ptr+12>>0]!=0;};this.set_rethrown=function(rethrown){rethrown=rethrown?1:0;HEAP8[this.ptr+13>>0]=rethrown;};this.get_rethrown=function(){return HEAP8[this.ptr+13>>0]!=0;};this.init=function(type,destructor){this.set_adjusted_ptr(0);this.set_type(type);this.set_destructor(destructor);};this.set_adjusted_ptr=function(adjustedPtr){HEAPU32[this.ptr+16>>2]=adjustedPtr;};this.get_adjusted_ptr=function(){return HEAPU32[this.ptr+16>>2];};this.get_exception_ptr=function(){var isPointer=___cxa_is_pointer_type(this.get_type());if(isPointer){return HEAPU32[this.excPtr>>2];}var adjusted=this.get_adjusted_ptr();if(adjusted!==0)return adjusted;return this.excPtr;};}function ___resumeException(ptr){if(!exceptionLast){exceptionLast=new CppException(ptr);}throw exceptionLast;}var findMatchingCatch=function findMatchingCatch(args){var thrown=exceptionLast&&exceptionLast.excPtr;if(!thrown){setTempRet0(0);return 0;}var info=new ExceptionInfo(thrown);info.set_adjusted_ptr(thrown);var thrownType=info.get_type();if(!thrownType){setTempRet0(0);return thrown;}for(var arg in args){var caughtType=args[arg];if(caughtType===0||caughtType===thrownType){break;}var adjusted_ptr_addr=info.ptr+16;if(___cxa_can_catch(caughtType,thrownType,adjusted_ptr_addr)){setTempRet0(caughtType);return thrown;}}setTempRet0(thrownType);return thrown;};var ___cxa_find_matching_catch_2=function ___cxa_find_matching_catch_2(){return findMatchingCatch([]);};var ___cxa_find_matching_catch_3=function ___cxa_find_matching_catch_3(arg0){return findMatchingCatch([arg0]);};function __embind_register_bigint(primitiveType,name,size,minRange,maxRange){}function getShiftFromSize(size){switch(size){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+size);}}function embind_init_charCodes(){var codes=new Array(256);for(var i=0;i<256;++i){codes[i]=String.fromCharCode(i);}embind_charCodes=codes;}var embind_charCodes=undefined;function readLatin1String(ptr){var ret="";var c=ptr;while(HEAPU8[c]){ret+=embind_charCodes[HEAPU8[c++]];}return ret;}var awaitingDependencies={};var registeredTypes={};var typeDependencies={};var BindingError=undefined;function throwBindingError(message){throw new BindingError(message);}var InternalError=undefined;function throwInternalError(message){throw new InternalError(message);}function sharedRegisterType(rawType,registeredInstance,options){if(options===void 0){options={};}var name=registeredInstance.name;if(!rawType){throwBindingError("type \""+name+"\" must have a positive integer typeid pointer");}if(Object.prototype.hasOwnProperty.call(registeredTypes,rawType)){if(options.ignoreDuplicateRegistrations){return;}else{throwBindingError("Cannot register type '"+name+"' twice");}}registeredTypes[rawType]=registeredInstance;delete typeDependencies[rawType];if(Object.prototype.hasOwnProperty.call(awaitingDependencies,rawType)){var callbacks=awaitingDependencies[rawType];delete awaitingDependencies[rawType];callbacks.forEach(function(cb){return cb();});}}function registerType(rawType,registeredInstance,options){if(options===void 0){options={};}if(!("argPackAdvance"in registeredInstance)){throw new TypeError("registerType registeredInstance requires argPackAdvance");}return sharedRegisterType(rawType,registeredInstance,options);}function __embind_register_bool(rawType,name,size,trueValue,falseValue){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function fromWireType(wt){return!!wt;},"toWireType":function toWireType(destructors,o){return o?trueValue:falseValue;},"argPackAdvance":8,"readValueFromPointer":function readValueFromPointer(pointer){var heap;if(size===1){heap=HEAP8;}else if(size===2){heap=HEAP16;}else if(size===4){heap=HEAP32;}else{throw new TypeError("Unknown boolean type size: "+name);}return this["fromWireType"](heap[pointer>>shift]);},destructorFunction:null});}function handleAllocatorInit(){Object.assign(HandleAllocator.prototype,{get:function get(id){assert(this.allocated[id]!==undefined,"invalid handle: "+id);return this.allocated[id];},has:function has(id){return this.allocated[id]!==undefined;},allocate:function allocate(handle){var id=this.freelist.pop()||this.allocated.length;this.allocated[id]=handle;return id;},free:function free(id){assert(this.allocated[id]!==undefined);this.allocated[id]=undefined;this.freelist.push(id);}});}function HandleAllocator(){this.allocated=[undefined];this.freelist=[];}var emval_handles=new HandleAllocator();function __emval_decref(handle){if(handle>=emval_handles.reserved&&0===--emval_handles.get(handle).refcount){emval_handles.free(handle);}}function count_emval_handles(){var count=0;for(var i=emval_handles.reserved;i<emval_handles.allocated.length;++i){if(emval_handles.allocated[i]!==undefined){++count;}}return count;}function init_emval(){emval_handles.allocated.push({value:undefined},{value:null},{value:true},{value:false});emval_handles.reserved=emval_handles.allocated.length;Module["count_emval_handles"]=count_emval_handles;}var Emval={toValue:function toValue(handle){if(!handle){throwBindingError("Cannot use deleted val. handle = "+handle);}return emval_handles.get(handle).value;},toHandle:function toHandle(value){switch(value){case undefined:return 1;case null:return 2;case true:return 3;case false:return 4;default:{return emval_handles.allocate({refcount:1,value:value});}}}};function simpleReadValueFromPointer(pointer){return this["fromWireType"](HEAP32[pointer>>2]);}function __embind_register_emval(rawType,name){name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function fromWireType(handle){var rv=Emval.toValue(handle);__emval_decref(handle);return rv;},"toWireType":function toWireType(destructors,value){return Emval.toHandle(value);},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:null});}function embindRepr(v){if(v===null){return"null";}var t=typeof v;if(t==="object"||t==="array"||t==="function"){return v.toString();}else{return""+v;}}function floatReadValueFromPointer(name,shift){switch(shift){case 2:return function(pointer){return this["fromWireType"](HEAPF32[pointer>>2]);};case 3:return function(pointer){return this["fromWireType"](HEAPF64[pointer>>3]);};default:throw new TypeError("Unknown float type: "+name);}}function __embind_register_float(rawType,name,size){var shift=getShiftFromSize(size);name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":function fromWireType(value){return value;},"toWireType":function toWireType(destructors,value){if(typeof value!="number"&&typeof value!="boolean"){throw new TypeError("Cannot convert "+embindRepr(value)+" to "+this.name);}return value;},"argPackAdvance":8,"readValueFromPointer":floatReadValueFromPointer(name,shift),destructorFunction:null});}function integerReadValueFromPointer(name,shift,signed){switch(shift){case 0:return signed?function readS8FromPointer(pointer){return HEAP8[pointer];}:function readU8FromPointer(pointer){return HEAPU8[pointer];};case 1:return signed?function readS16FromPointer(pointer){return HEAP16[pointer>>1];}:function readU16FromPointer(pointer){return HEAPU16[pointer>>1];};case 2:return signed?function readS32FromPointer(pointer){return HEAP32[pointer>>2];}:function readU32FromPointer(pointer){return HEAPU32[pointer>>2];};default:throw new TypeError("Unknown integer type: "+name);}}function __embind_register_integer(primitiveType,name,size,minRange,maxRange){name=readLatin1String(name);if(maxRange===-1){maxRange=4294967295;}var shift=getShiftFromSize(size);var fromWireType=function fromWireType(value){return value;};if(minRange===0){var bitshift=32-8*size;fromWireType=function fromWireType(value){return value<<bitshift>>>bitshift;};}var isUnsignedType=name.includes("unsigned");var checkAssertions=function checkAssertions(value,toTypeName){if(typeof value!="number"&&typeof value!="boolean"){throw new TypeError("Cannot convert \""+embindRepr(value)+"\" to "+toTypeName);}if(value<minRange||value>maxRange){throw new TypeError("Passing a number \""+embindRepr(value)+"\" from JS side to C/C++ side to an argument of type \""+name+"\", which is outside the valid range ["+minRange+", "+maxRange+"]!");}};var toWireType;if(isUnsignedType){toWireType=function toWireType(destructors,value){checkAssertions(value,this.name);return value>>>0;};}else{toWireType=function toWireType(destructors,value){checkAssertions(value,this.name);return value;};}registerType(primitiveType,{name:name,"fromWireType":fromWireType,"toWireType":toWireType,"argPackAdvance":8,"readValueFromPointer":integerReadValueFromPointer(name,shift,minRange!==0),destructorFunction:null});}function __embind_register_memory_view(rawType,dataTypeIndex,name){var typeMapping=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];var TA=typeMapping[dataTypeIndex];function decodeMemoryView(handle){handle=handle>>2;var heap=HEAPU32;var size=heap[handle];var data=heap[handle+1];return new TA(heap.buffer,data,size);}name=readLatin1String(name);registerType(rawType,{name:name,"fromWireType":decodeMemoryView,"argPackAdvance":8,"readValueFromPointer":decodeMemoryView},{ignoreDuplicateRegistrations:true});}var stringToUTF8Array=function stringToUTF8Array(str,heap,outIdx,maxBytesToWrite){assert(typeof str==="string");if(!(maxBytesToWrite>0))return 0;var startIdx=outIdx;var endIdx=outIdx+maxBytesToWrite-1;for(var i=0;i<str.length;++i){var u=str.charCodeAt(i);if(u>=55296&&u<=57343){var u1=str.charCodeAt(++i);u=65536+((u&1023)<<10)|u1&1023;}if(u<=127){if(outIdx>=endIdx)break;heap[outIdx++]=u;}else if(u<=2047){if(outIdx+1>=endIdx)break;heap[outIdx++]=192|u>>6;heap[outIdx++]=128|u&63;}else if(u<=65535){if(outIdx+2>=endIdx)break;heap[outIdx++]=224|u>>12;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63;}else{if(outIdx+3>=endIdx)break;if(u>1114111)warnOnce("Invalid Unicode code point "+ptrToString(u)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF).");heap[outIdx++]=240|u>>18;heap[outIdx++]=128|u>>12&63;heap[outIdx++]=128|u>>6&63;heap[outIdx++]=128|u&63;}}heap[outIdx]=0;return outIdx-startIdx;};var stringToUTF8=function stringToUTF8(str,outPtr,maxBytesToWrite){assert(typeof maxBytesToWrite=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");return stringToUTF8Array(str,HEAPU8,outPtr,maxBytesToWrite);};var lengthBytesUTF8=function lengthBytesUTF8(str){var len=0;for(var i=0;i<str.length;++i){var c=str.charCodeAt(i);if(c<=127){len++;}else if(c<=2047){len+=2;}else if(c>=55296&&c<=57343){len+=4;++i;}else{len+=3;}}return len;};function __embind_register_std_string(rawType,name){name=readLatin1String(name);var stdStringIsUTF8=name==="std::string";registerType(rawType,{name:name,"fromWireType":function fromWireType(value){var length=HEAPU32[value>>2];var payload=value+4;var str;if(stdStringIsUTF8){var decodeStartPtr=payload;for(var i=0;i<=length;++i){var currentBytePtr=payload+i;if(i==length||HEAPU8[currentBytePtr]==0){var maxRead=currentBytePtr-decodeStartPtr;var stringSegment=UTF8ToString(decodeStartPtr,maxRead);if(str===undefined){str=stringSegment;}else{str+=String.fromCharCode(0);str+=stringSegment;}decodeStartPtr=currentBytePtr+1;}}}else{var a=new Array(length);for(var i=0;i<length;++i){a[i]=String.fromCharCode(HEAPU8[payload+i]);}str=a.join("");}_free(value);return str;},"toWireType":function toWireType(destructors,value){if(value instanceof ArrayBuffer){value=new Uint8Array(value);}var length;var valueIsOfTypeString=typeof value=="string";if(!(valueIsOfTypeString||value instanceof Uint8Array||value instanceof Uint8ClampedArray||value instanceof Int8Array)){throwBindingError("Cannot pass non-string to std::string");}if(stdStringIsUTF8&&valueIsOfTypeString){length=lengthBytesUTF8(value);}else{length=value.length;}var base=_malloc(4+length+1);var ptr=base+4;HEAPU32[base>>2]=length;if(stdStringIsUTF8&&valueIsOfTypeString){stringToUTF8(value,ptr,length+1);}else{if(valueIsOfTypeString){for(var i=0;i<length;++i){var charCode=value.charCodeAt(i);if(charCode>255){_free(ptr);throwBindingError("String has UTF-16 code units that do not fit in 8 bits");}HEAPU8[ptr+i]=charCode;}}else{for(var i=0;i<length;++i){HEAPU8[ptr+i]=value[i];}}}if(destructors!==null){destructors.push(_free,base);}return base;},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:function destructorFunction(ptr){_free(ptr);}});}var UTF16Decoder=typeof TextDecoder!="undefined"?new TextDecoder("utf-16le"):undefined;var UTF16ToString=function UTF16ToString(ptr,maxBytesToRead){assert(ptr%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");var endPtr=ptr;var idx=endPtr>>1;var maxIdx=idx+maxBytesToRead/2;while(!(idx>=maxIdx)&&HEAPU16[idx]){++idx;}endPtr=idx<<1;if(endPtr-ptr>32&&UTF16Decoder)return UTF16Decoder.decode(HEAPU8.subarray(ptr,endPtr));var str="";for(var i=0;!(i>=maxBytesToRead/2);++i){var codeUnit=HEAP16[ptr+i*2>>1];if(codeUnit==0)break;str+=String.fromCharCode(codeUnit);}return str;};var stringToUTF16=function stringToUTF16(str,outPtr,maxBytesToWrite){assert(outPtr%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!");assert(typeof maxBytesToWrite=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647;}if(maxBytesToWrite<2)return 0;maxBytesToWrite-=2;var startPtr=outPtr;var numCharsToWrite=maxBytesToWrite<str.length*2?maxBytesToWrite/2:str.length;for(var i=0;i<numCharsToWrite;++i){var codeUnit=str.charCodeAt(i);HEAP16[outPtr>>1]=codeUnit;outPtr+=2;}HEAP16[outPtr>>1]=0;return outPtr-startPtr;};var lengthBytesUTF16=function lengthBytesUTF16(str){return str.length*2;};var UTF32ToString=function UTF32ToString(ptr,maxBytesToRead){assert(ptr%4==0,"Pointer passed to UTF32ToString must be aligned to four bytes!");var i=0;var str="";while(!(i>=maxBytesToRead/4)){var utf32=HEAP32[ptr+i*4>>2];if(utf32==0)break;++i;if(utf32>=65536){var ch=utf32-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023);}else{str+=String.fromCharCode(utf32);}}return str;};var stringToUTF32=function stringToUTF32(str,outPtr,maxBytesToWrite){assert(outPtr%4==0,"Pointer passed to stringToUTF32 must be aligned to four bytes!");assert(typeof maxBytesToWrite=="number","stringToUTF32(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");if(maxBytesToWrite===undefined){maxBytesToWrite=2147483647;}if(maxBytesToWrite<4)return 0;var startPtr=outPtr;var endPtr=startPtr+maxBytesToWrite-4;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343){var trailSurrogate=str.charCodeAt(++i);codeUnit=65536+((codeUnit&1023)<<10)|trailSurrogate&1023;}HEAP32[outPtr>>2]=codeUnit;outPtr+=4;if(outPtr+4>endPtr)break;}HEAP32[outPtr>>2]=0;return outPtr-startPtr;};var lengthBytesUTF32=function lengthBytesUTF32(str){var len=0;for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);if(codeUnit>=55296&&codeUnit<=57343)++i;len+=4;}return len;};var __embind_register_std_wstring=function __embind_register_std_wstring(rawType,charSize,name){name=readLatin1String(name);var decodeString,encodeString,getHeap,lengthBytesUTF,shift;if(charSize===2){decodeString=UTF16ToString;encodeString=stringToUTF16;lengthBytesUTF=lengthBytesUTF16;getHeap=function getHeap(){return HEAPU16;};shift=1;}else if(charSize===4){decodeString=UTF32ToString;encodeString=stringToUTF32;lengthBytesUTF=lengthBytesUTF32;getHeap=function getHeap(){return HEAPU32;};shift=2;}registerType(rawType,{name:name,"fromWireType":function fromWireType(value){var length=HEAPU32[value>>2];var HEAP=getHeap();var str;var decodeStartPtr=value+4;for(var i=0;i<=length;++i){var currentBytePtr=value+4+i*charSize;if(i==length||HEAP[currentBytePtr>>shift]==0){var maxReadBytes=currentBytePtr-decodeStartPtr;var stringSegment=decodeString(decodeStartPtr,maxReadBytes);if(str===undefined){str=stringSegment;}else{str+=String.fromCharCode(0);str+=stringSegment;}decodeStartPtr=currentBytePtr+charSize;}}_free(value);return str;},"toWireType":function toWireType(destructors,value){if(!(typeof value=="string")){throwBindingError("Cannot pass non-string to C++ string type "+name);}var length=lengthBytesUTF(value);var ptr=_malloc(4+length+charSize);HEAPU32[ptr>>2]=length>>shift;encodeString(value,ptr+4,length+charSize);if(destructors!==null){destructors.push(_free,ptr);}return ptr;},"argPackAdvance":8,"readValueFromPointer":simpleReadValueFromPointer,destructorFunction:function destructorFunction(ptr){_free(ptr);}});};function __embind_register_void(rawType,name){name=readLatin1String(name);registerType(rawType,{isVoid:true,name:name,"argPackAdvance":0,"fromWireType":function fromWireType(){return undefined;},"toWireType":function toWireType(destructors,o){return undefined;}});}var _abort=function _abort(){abort("native code called abort()");};var readEmAsmArgsArray=[];var readEmAsmArgs=function readEmAsmArgs(sigPtr,buf){assert(Array.isArray(readEmAsmArgsArray));assert(buf%16==0);readEmAsmArgsArray.length=0;var ch;buf>>=2;while(ch=HEAPU8[sigPtr++]){var chr=String.fromCharCode(ch);var validChars=["d","f","i"];assert(validChars.includes(chr),"Invalid character "+ch+"(\""+chr+"\") in readEmAsmArgs! Use only ["+validChars+"], and do not specify \"v\" for void return argument.");buf+=ch!=105&buf;readEmAsmArgsArray.push(ch==105?HEAP32[buf]:HEAPF64[buf++>>1]);++buf;}return readEmAsmArgsArray;};var runEmAsmFunction=function runEmAsmFunction(code,sigPtr,argbuf){var args=readEmAsmArgs(sigPtr,argbuf);if(!Object.prototype.hasOwnProperty.call(ASM_CONSTS,code))abort("No EM_ASM constant found at address "+code);return ASM_CONSTS[code].apply(null,args);};var _emscripten_asm_const_int=function _emscripten_asm_const_int(code,sigPtr,argbuf){return runEmAsmFunction(code,sigPtr,argbuf);};var getHeapMax=function getHeapMax(){return 1048576;};var _emscripten_get_heap_max=function _emscripten_get_heap_max(){return getHeapMax();};var growMemory=function growMemory(size){var b=wasmMemory.buffer;var pages=size-b.byteLength+65535>>>16;try{wasmMemory.grow(pages);updateMemoryViews();return 1;}catch(e){err("growMemory: Attempted to grow heap from "+b.byteLength+" bytes to "+size+" bytes, but got error: "+e);}};var _emscripten_resize_heap=function _emscripten_resize_heap(requestedSize){var oldSize=HEAPU8.length;requestedSize>>>=0;assert(requestedSize>oldSize);var maxHeapSize=getHeapMax();if(requestedSize>maxHeapSize){err("Cannot enlarge memory, asked to go up to "+requestedSize+" bytes, but the limit is "+maxHeapSize+" bytes!");return false;}var alignUp=function alignUp(x,multiple){return x+(multiple-x%multiple)%multiple;};for(var cutDown=1;cutDown<=4;cutDown*=2){var overGrownHeapSize=oldSize*(1+.2/cutDown);overGrownHeapSize=Math.min(overGrownHeapSize,requestedSize+100663296);var newSize=Math.min(maxHeapSize,alignUp(Math.max(requestedSize,overGrownHeapSize),65536));var replacement=growMemory(newSize);if(replacement){return true;}}err("Failed to grow the heap from "+oldSize+" bytes to "+newSize+" bytes, not enough memory!");return false;};var SYSCALLS={varargs:undefined,get:function get(){assert(SYSCALLS.varargs!=undefined);SYSCALLS.varargs+=4;var ret=HEAP32[SYSCALLS.varargs-4>>2];return ret;},getStr:function getStr(ptr){var ret=UTF8ToString(ptr);return ret;}};var _fd_close=function _fd_close(fd){abort("fd_close called without SYSCALLS_REQUIRE_FILESYSTEM");};function convertI32PairToI53Checked(lo,hi){assert(lo==lo>>>0||lo==(lo|0));assert(hi===(hi|0));return hi+2097152>>>0<4194305-!!lo?(lo>>>0)+hi*4294967296:NaN;}function _fd_seek(fd,offset_low,offset_high,whence,newOffset){var offset=convertI32PairToI53Checked(offset_low,offset_high);return 70;}var printCharBuffers=[null,[],[]];var printChar=function printChar(stream,curr){var buffer=printCharBuffers[stream];assert(buffer);if(curr===0||curr===10){(stream===1?out:err)(UTF8ArrayToString(buffer,0));buffer.length=0;}else{buffer.push(curr);}};var flush_NO_FILESYSTEM=function flush_NO_FILESYSTEM(){_fflush(0);if(printCharBuffers[1].length)printChar(1,10);if(printCharBuffers[2].length)printChar(2,10);};var _fd_write=function _fd_write(fd,iov,iovcnt,pnum){var num=0;for(var i=0;i<iovcnt;i++){var ptr=HEAPU32[iov>>2];var len=HEAPU32[iov+4>>2];iov+=8;for(var j=0;j<len;j++){printChar(fd,HEAPU8[ptr+j]);}num+=len;}HEAPU32[pnum>>2]=num;return 0;};var getWasmTableEntry=function getWasmTableEntry(funcPtr){return wasmTable.get(funcPtr);};var writeArrayToMemory=function writeArrayToMemory(array,buffer){assert(array.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)");HEAP8.set(array,buffer);};embind_init_charCodes();BindingError=Module["BindingError"]=function(_Error2){"use strict";babelHelpers.inheritsLoose(BindingError,_Error2);function BindingError(message){var _this2;_this2=_Error2.call(this,message)||this;_this2.name="BindingError";return _this2;}return BindingError;}(babelHelpers.wrapNativeSuper(Error));InternalError=Module["InternalError"]=function(_Error3){"use strict";babelHelpers.inheritsLoose(InternalError,_Error3);function InternalError(message){var _this3;_this3=_Error3.call(this,message)||this;_this3.name="InternalError";return _this3;}return InternalError;}(babelHelpers.wrapNativeSuper(Error));handleAllocatorInit();init_emval();function checkIncomingModuleAPI(){ignoredModuleProp("fetchSettings");}var wasmImports={__assert_fail:___assert_fail,__cxa_begin_catch:___cxa_begin_catch,__cxa_find_matching_catch_2:___cxa_find_matching_catch_2,__cxa_find_matching_catch_3:___cxa_find_matching_catch_3,__resumeException:___resumeException,_embind_register_bigint:__embind_register_bigint,_embind_register_bool:__embind_register_bool,_embind_register_emval:__embind_register_emval,_embind_register_float:__embind_register_float,_embind_register_integer:__embind_register_integer,_embind_register_memory_view:__embind_register_memory_view,_embind_register_std_string:__embind_register_std_string,_embind_register_std_wstring:__embind_register_std_wstring,_embind_register_void:__embind_register_void,abort:_abort,emscripten_asm_const_int:_emscripten_asm_const_int,emscripten_get_heap_max:_emscripten_get_heap_max,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,invoke_ii:invoke_ii,invoke_iii:invoke_iii,invoke_iiii:invoke_iiii,invoke_v:invoke_v,invoke_vi:invoke_vi,invoke_vii:invoke_vii,invoke_viii:invoke_viii,invoke_viiii:invoke_viiii};var asm=createWasm();var ___wasm_call_ctors=createExportWrapper("__wasm_call_ctors");var _curve_create=Module["_curve_create"]=createExportWrapper("curve_create");var _malloc=Module["_malloc"]=createExportWrapper("malloc");var _curve_free=Module["_curve_free"]=createExportWrapper("curve_free");var _free=Module["_free"]=createExportWrapper("free");var _curve_init_ristretto=Module["_curve_init_ristretto"]=createExportWrapper("curve_init_ristretto");var _get_curve_element_bytes=Module["_get_curve_element_bytes"]=createExportWrapper("get_curve_element_bytes");var _get_curve_scalar_bytes=Module["_get_curve_scalar_bytes"]=createExportWrapper("get_curve_scalar_bytes");var _kdf_create=Module["_kdf_create"]=createExportWrapper("kdf_create");var _kdf_free=Module["_kdf_free"]=createExportWrapper("kdf_free");var _kdf_init_naor_reingold=Module["_kdf_init_naor_reingold"]=createExportWrapper("kdf_init_naor_reingold");var _sodiumInit=Module["_sodiumInit"]=createExportWrapper("sodiumInit");var _voprf_create=Module["_voprf_create"]=createExportWrapper("voprf_create");var _voprf_free=Module["_voprf_free"]=createExportWrapper("voprf_free");var _voprf_init_exp_twohashdh=Module["_voprf_init_exp_twohashdh"]=createExportWrapper("voprf_init_exp_twohashdh");var _blind=Module["_blind"]=createExportWrapper("blind");var _verifiable_unblind=Module["_verifiable_unblind"]=createExportWrapper("verifiable_unblind");var _voprf_client_finalize=Module["_voprf_client_finalize"]=createExportWrapper("voprf_client_finalize");var _voprf_setup=Module["_voprf_setup"]=createExportWrapper("voprf_setup");var _voprf_evaluate=Module["_voprf_evaluate"]=createExportWrapper("voprf_evaluate");var _voprf_server_finalize=Module["_voprf_server_finalize"]=createExportWrapper("voprf_server_finalize");var _get_voprf_final_evaluation_bytes=Module["_get_voprf_final_evaluation_bytes"]=createExportWrapper("get_voprf_final_evaluation_bytes");var ___errno_location=createExportWrapper("__errno_location");var ___getTypeName=createExportWrapper("__getTypeName");var __embind_initialize_bindings=Module["__embind_initialize_bindings"]=createExportWrapper("_embind_initialize_bindings");var _fflush=Module["_fflush"]=createExportWrapper("fflush");var _emscripten_builtin_memalign=createExportWrapper("emscripten_builtin_memalign");var _setThrew=createExportWrapper("setThrew");var setTempRet0=createExportWrapper("setTempRet0");var _emscripten_stack_init2=function _emscripten_stack_init(){return(_emscripten_stack_init2=wasmExports["emscripten_stack_init"])();};var _emscripten_stack_get_free2=function _emscripten_stack_get_free(){return(_emscripten_stack_get_free2=wasmExports["emscripten_stack_get_free"])();};var _emscripten_stack_get_base2=function _emscripten_stack_get_base(){return(_emscripten_stack_get_base2=wasmExports["emscripten_stack_get_base"])();};var _emscripten_stack_get_end2=function _emscripten_stack_get_end(){return(_emscripten_stack_get_end2=wasmExports["emscripten_stack_get_end"])();};var stackSave=createExportWrapper("stackSave");var stackRestore=createExportWrapper("stackRestore");var stackAlloc=createExportWrapper("stackAlloc");var _emscripten_stack_get_current2=function _emscripten_stack_get_current(){return(_emscripten_stack_get_current2=wasmExports["emscripten_stack_get_current"])();};var ___cxa_free_exception=createExportWrapper("__cxa_free_exception");var ___cxa_increment_exception_refcount=createExportWrapper("__cxa_increment_exception_refcount");var ___cxa_decrement_exception_refcount=createExportWrapper("__cxa_decrement_exception_refcount");var ___get_exception_message=Module["___get_exception_message"]=createExportWrapper("__get_exception_message");var ___cxa_can_catch=createExportWrapper("__cxa_can_catch");var ___cxa_is_pointer_type=createExportWrapper("__cxa_is_pointer_type");var dynCall_iiiji=Module["dynCall_iiiji"]=createExportWrapper("dynCall_iiiji");var dynCall_iiij=Module["dynCall_iiij"]=createExportWrapper("dynCall_iiij");var dynCall_iijii=Module["dynCall_iijii"]=createExportWrapper("dynCall_iijii");var dynCall_iiijiji=Module["dynCall_iiijiji"]=createExportWrapper("dynCall_iiijiji");var dynCall_iiijiii=Module["dynCall_iiijiii"]=createExportWrapper("dynCall_iiijiii");var dynCall_jiji=Module["dynCall_jiji"]=createExportWrapper("dynCall_jiji");function invoke_v(index){var sp=stackSave();try{getWasmTableEntry(index)();}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}function invoke_vii(index,a1,a2){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2);}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}function invoke_viiii(index,a1,a2,a3,a4){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2,a3,a4);}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}function invoke_ii(index,a1){var sp=stackSave();try{return getWasmTableEntry(index)(a1);}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}function invoke_iii(index,a1,a2){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2);}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}function invoke_viii(index,a1,a2,a3){var sp=stackSave();try{getWasmTableEntry(index)(a1,a2,a3);}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}function invoke_vi(index,a1){var sp=stackSave();try{getWasmTableEntry(index)(a1);}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}function invoke_iiii(index,a1,a2,a3){var sp=stackSave();try{return getWasmTableEntry(index)(a1,a2,a3);}catch(e){stackRestore(sp);if(!(e instanceof EmscriptenEH))throw e;_setThrew(1,0);}}Module["wasmMemory"]=wasmMemory;Module["getValue"]=getValue;Module["stringToUTF8"]=stringToUTF8;Module["lengthBytesUTF8"]=lengthBytesUTF8;Module["writeArrayToMemory"]=writeArrayToMemory;var missingLibrarySymbols=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertU32PairToI53","zeroMemory","exitJS","isLeapYear","ydayFromDate","arraySum","addDays","setErrNo","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","getHostByName","initRandomFill","randomFill","getCallstack","emscriptenLog","convertPCtoSourceLocation","runMainThreadEmAsm","jstoi_q","jstoi_s","getExecutableName","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","setWasmTableEntry","handleException","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","safeSetTimeout","asmjsMangle","asyncLoad","alignMemory","mmapAlloc","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","getCFunc","ccall","cwrap","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","getEmptyTableSlot","updateTableMap","getFunctionAddress","addFunction","removeFunction","reallyNegative","unSign","strLen","reSign","formatString","intArrayFromString","intArrayToString","AsciiToString","stringToAscii","stringToNewUTF8","stringToUTF8OnStack","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","findCanvasEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","demangle","demangleAll","jsStackTrace","stackTrace","getEnvStrings","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","createDyncallWrapper","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","getPromise","makePromise","idsToPromises","makePromiseCallback","setMainLoop","getSocketFromFD","getSocketAddress","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar","_setNetworkCallback","heapObjectForWebGLType","heapAccessShiftForWebGLHeap","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","__glGenObject","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","SDL_unicode","SDL_ttfContext","SDL_audio","GLFW_Window","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","getTypeName","heap32VectorToArray","requireRegisteredType","init_embind","throwUnboundTypeError","ensureOverloadTable","exposePublicSymbol","replacePublicSymbol","extendError","createNamedFunction","getBasestPointer","registerInheritedInstance","unregisterInheritedInstance","getInheritedInstance","getInheritedInstanceCount","getLiveInheritedInstances","enumReadValueFromPointer","runDestructors","craftInvokerFunction","embind__requireFunction","genericPointerToWireType","constNoSmartPtrRawPointerToWireType","nonConstNoSmartPtrRawPointerToWireType","init_RegisteredPointer","RegisteredPointer","RegisteredPointer_getPointee","RegisteredPointer_destructor","RegisteredPointer_deleteObject","RegisteredPointer_fromWireType","runDestructor","releaseClassHandle","detachFinalizer","attachFinalizer","makeClassHandle","init_ClassHandle","ClassHandle","ClassHandle_isAliasOf","throwInstanceAlreadyDeleted","ClassHandle_clone","ClassHandle_delete","ClassHandle_isDeleted","ClassHandle_deleteLater","flushPendingDeletes","setDelayFunction","RegisteredClass","shallowCopyInternalPointer","downcastPointer","upcastPointer","validateThis","char_0","char_9","makeLegalFunctionName","getStringOrSymbol","craftEmvalAllocator","emval_get_global","emval_lookupTypes","emval_allocateDestructors","emval_addMethodCaller"];missingLibrarySymbols.forEach(missingLibrarySymbol);var unexportedSymbols=["run","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","addRunDependency","removeRunDependency","FS_createFolder","FS_createPath","FS_createDataFile","FS_createLazyFile","FS_createLink","FS_createDevice","FS_unlink","out","err","callMain","abort","keepRuntimeAlive","wasmTable","wasmExports","stackAlloc","stackSave","stackRestore","getTempRet0","setTempRet0","writeStackCookie","checkStackCookie","convertI32PairToI53Checked","ptrToString","getHeapMax","growMemory","ENV","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","ERRNO_CODES","ERRNO_MESSAGES","DNS","Protocols","Sockets","timers","warnOnce","UNWIND_CACHE","readEmAsmArgsArray","readEmAsmArgs","runEmAsmFunction","getWasmTableEntry","handleAllocatorInit","HandleAllocator","freeTableIndexes","functionsInTableMap","setValue","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","UTF8ToString","stringToUTF8Array","UTF16Decoder","UTF16ToString","stringToUTF16","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","JSEvents","specialHTMLTargets","currentFullscreenStrategy","restoreOldWindowedStyle","ExitStatus","flush_NO_FILESYSTEM","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","ExceptionInfo","findMatchingCatch","getExceptionMessageCommon","incrementExceptionRefcount","decrementExceptionRefcount","getExceptionMessage","Browser","wget","SYSCALLS","preloadPlugins","FS_stdin_getChar_buffer","FS","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","emscripten_webgl_power_preferences","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","GLFW","allocateUTF8","allocateUTF8OnStack","InternalError","BindingError","throwInternalError","throwBindingError","registeredTypes","awaitingDependencies","typeDependencies","tupleRegistrations","structRegistrations","sharedRegisterType","whenDependentTypesAreResolved","embind_charCodes","embind_init_charCodes","readLatin1String","UnboundTypeError","PureVirtualError","embindRepr","registeredInstances","registeredPointers","registerType","getShiftFromSize","integerReadValueFromPointer","floatReadValueFromPointer","simpleReadValueFromPointer","finalizationRegistry","detachFinalizer_deps","deletionQueue","delayFunction","emval_handles","emval_symbols","init_emval","count_emval_handles","Emval","emval_newers","emval_methodCallers","emval_registeredMethods"];unexportedSymbols.forEach(unexportedRuntimeSymbol);var calledRun;dependenciesFulfilled=function runCaller(){if(!calledRun)run();if(!calledRun)dependenciesFulfilled=runCaller;};function stackCheckInit(){_emscripten_stack_init2();writeStackCookie();}function run(){if(runDependencies>0){return;}stackCheckInit();preRun();if(runDependencies>0){return;}function doRun(){if(calledRun)return;calledRun=true;Module["calledRun"]=true;if(ABORT)return;initRuntime();readyPromiseResolve(Module);if(Module["onRuntimeInitialized"])Module["onRuntimeInitialized"]();assert(!Module["_main"],'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]');postRun();}if(Module["setStatus"]){Module["setStatus"]("Running...");setTimeout(function(){setTimeout(function(){Module["setStatus"]("");},1);doRun();},1);}else{doRun();}checkStackCookie();}if(Module["preInit"]){if(typeof Module["preInit"]=="function")Module["preInit"]=[Module["preInit"]];while(Module["preInit"].length>0){Module["preInit"].pop()();}}run();


return moduleArg.ready;
});


}();
if(typeof exports==='object'&&typeof module==='object')
module.exports=Module;else
if(typeof define==='function'&&define['amd'])
define([],function(){return Module;});}),null);/*FB_PKG_DELIM*/
__d("PolarisBdChallengeGraphQLEventHandler",["PolarisBaseGraphQLEventHandler","PolarisDirectLogger","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h="17935802131473058";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var e;e=a.call(this)||this;e.$BdChallengeGraphQLEventHandler$p_1=new(d("PolarisDirectLogger").DirectLogger)("BDChallengeGraphQLEventHandler",b);e.$BdChallengeGraphQLEventHandler$p_1.debugTrace("bd_challenge_gql_handler_init");e.$BdChallengeGraphQLEventHandler$p_2=e.getGraphQLSubsciptionPrefix()+h+"/"+JSON.stringify({input_data:{client_subscription_id:c("uuidv4")()}});return e}var e=b.prototype;e.processEventMessage=function(a){a=a.bd_challenge_event;if(a==null){this.$BdChallengeGraphQLEventHandler$p_1.debugTrace("parsed_message_bad_data");return}};e.getSubTopic=function(){return this.$BdChallengeGraphQLEventHandler$p_2};e.getType=function(){return d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.BD_CHALLENGE};return b}(d("PolarisBaseGraphQLEventHandler").BaseGraphQLEventHandler);g.BdChallengeGraphQLEventHandler=a}),98);
__d("PolarisChannelClientID",["uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h=c("uuidv4")();a={getID:function(){return h}};b=a;g["default"]=b}),98);
__d("PolarisDirectBaseSubscription",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c,d){var e=this;this.$5=function(a){e.$4.debugTrace("message_received");var b=e.parsePayload(a);if(b==null)return;if(a.length===0){e.$4.logError("empty_message");return}else a[a.length-1]==="\0"?(b=a.substring(0,a.length-1),e.$4.debugTrace("trimmed_null_char")):b=a;var c={};try{c=JSON.parse(b)}catch(c){typeof c.message==="string"&&c.message.includes("Unexpected token")&&(c.jsonFirstChars=typeof b==="string"?b.substr(0,3):null);e.$4.logError("Cannot parse message "+a,c);return}e.processMessage(c)};this.$1=a;this.$2=b;this.$3=c;this.$4=d;this.$4.debugTrace("ctor")}var b=a.prototype;b.parsePayload=function(a){return a};b.processMessage=function(a){return};b.$6=function(a){var b;return JSON.stringify((b={},b[a]=this.getSubTopics(),b))};b.subscribe=function(){var a=this;if(this.getSubTopics().length<1){this.$4.debugTrace("no_subtopics_to_subscribe");return}this.$4.debugTrace("subscribe_start");this.unsubscribe();this.$3.subscribe(this.$1,this.$5);this.$3.publish(this.$1,this.$6("sub"))["catch"](function(b){return a.$4.logError(b,b==null?void 0:b.message)});this.$4.debugTrace("subscribe_end")};b.unsubscribe=function(){var a=this;if(this.getSubTopics().length<1){this.$4.debugTrace("no_subtopics_to_unsubscribe");return}this.$4.debugTrace("unsubscribe_start");this.$3.publish(this.$1,this.$6("unsub"))["catch"](function(b){return a.$4.logError(b,b==null?void 0:b.message)});this.$3.unsubscribe(this.$1);this.$4.debugTrace("unsubscribe_end")};b.updateSubTopics=function(a){this.$2=a};b.getSubTopics=function(){return this.$2};return a}();f.DirectBaseSubscription=a}),66);
__d("PolarisDirectDeltaHandlers",["invariant","PolarisDirectLogger","memoize"],(function(a,b,c,d,e,f,g,h){"use strict";function a(a){return i(a)}function b(a){return i(a)}function e(a){return i(a)}function i(a){if(a==null)return null;if(typeof a!=="string")return a;var b;a;try{b=j(a)}catch(c){d("PolarisDirectLogger").DirectLogger.logError("DirectDeltaHandlers","parse_delta_item.stringify_ids_error",{errorMessage:c.message}),b=a}try{b=JSON.parse(b)}catch(c){d("PolarisDirectLogger").DirectLogger.logError("DirectDeltaHandlers","parse_delta_item.parse_json_error",{errorMessage:c.message}),b=JSON.parse(a)}return b}function j(a){var b=Array.from(a.matchAll(/(id\":)\s*([0-9]+)/gi)),c=0;return b.reduce(function(a,b){var d=new RegExp(b[0]);d.lastIndex=c;a=a.replace(d,b[1]+' "'+b[2]+'"');c=b.index;return a},a)}function f(a){var b=parseInt(a,10);isNaN(b)&&h(0,61446,a);return isNaN(b)?0:b}var k=function(a,b){var e=this;this.$3=c("memoize")(function(){return[{listeners:{replace:e.$1.onHasSeen},regex:/^\/direct_v2\/threads\/(.+)\/participants\/(.+)\/has_seen$/},{listeners:{add:e.$1.onMakeAdmin,remove:e.$1.onRemoveAdmin},regex:/^\/direct_v2\/threads\/(\d+)\/admin_user_ids\/(\d+)$/},{listeners:{add:e.$1.onIndicateTypingActivity},regex:/^\/direct_v2\/threads\/(.+)\/activity_indicator_id\/(.+)$/},{listeners:{add:e.$1.onUpdateEmoji,remove:e.$1.onRemoveEmoji,replace:e.$1.onUpdateEmoji},regex:/^\/direct_v2\/threads\/(\d+)\/items\/(\d+)\/reactions\/likes\/(\d+)$/},{listeners:{add:e.$1.onNewMessage,remove:e.$1.onRemoveMessage,replace:e.$1.onUpdatedMessage},regex:/^\/direct_v2\/threads\/(.+)\/items\/(\d+)$/},{listeners:{replace:e.$1.onUpdateDMSettings},regex:/^\/direct_v2\/threads\/(.+)\/dm_settings$/},{listeners:{remove:e.$1.onRemoveThread,replace:e.$1.onNewThread},regex:/^\/direct_v2\/inbox\/threads\/(.+)$/},{listeners:{replace:e.$1.onUnseenCountChange},regex:/^\/direct_v2\/inbox\/unseen_count$/}]});this.handleDelta=function(a,b){var c=a.op,d=a.path;a=a.value;e.$2.debugTrace("handle_delta_start",{mutationToken:b,op:c,path:d});for(var f of e.$3()){var g=f.listeners[c];if(g){var h=f.regex.exec(d);h&&(e.$2.debugTrace("handle_delta_match"),g.apply(void 0,[a,b].concat(h.slice(1))))}}e.$2.debugTrace("handle_delta_end")};this.onSeqIdUpdated=function(a){e.$1.onSeqIdUpdated&&e.$1.onSeqIdUpdated(a)};this.onMqttConnectivityChanged=function(a){e.$1.onMqttConnectivityChanged&&e.$1.onMqttConnectivityChanged(a)};this.onIrisConnectivityChanged=function(a,b){e.$1.onIrisConnectivityChanged&&e.$1.onIrisConnectivityChanged(a,b)};this.onResnapshotRequested=function(a){e.$1.onResnapshotRequested&&e.$1.onResnapshotRequested(a)};this.$1=a;this.$2=new(d("PolarisDirectLogger").DirectLogger)("DirectDeltaHandlers",b)};g.parsePartialDeltaEmoji=a;g.parseDMSettings=b;g.parseDeltaItem=e;g.stringifyIds=j;g.parseDeltaNumber=f;g.DirectDeltaHandlers=k}),98);
__d("PolarisPinnedQuestionGraphQLEventHandler",["PolarisBaseGraphQLEventHandler","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h="PINNED_QUESTION",i="18005526940184517";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$PinnedQuestionGraphQLEventHandler$p_1=b;e.$PinnedQuestionGraphQLEventHandler$p_2=e.getGraphQLSubsciptionPrefix()+i+"/"+JSON.stringify({input_data:{broadcast_id:String(d.id),client_subscription_id:c("uuidv4")()}});return e}var e=b.prototype;e.processEventMessage=function(a){a=a.live_active_question_event;if(a==null)return;a={question:a,type:h};this.$PinnedQuestionGraphQLEventHandler$p_1.eventHandler(a)};e.getSubTopic=function(){return this.$PinnedQuestionGraphQLEventHandler$p_2};e.getType=function(){return d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.PINNED_QUESTION};return b}(d("PolarisBaseGraphQLEventHandler").BaseGraphQLEventHandler);g.PinnedQuestionGraphQLEventHandler=a}),98);
__d("PolarisQuestionStatusGraphQLEventHandler",["PolarisBaseGraphQLEventHandler","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h="QUESTION_STATUS",i="18027779584026952";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,d){var e;e=a.call(this)||this;e.$QuestionStatusGraphQLEventHandler$p_1=b;e.$QuestionStatusGraphQLEventHandler$p_2=e.getGraphQLSubsciptionPrefix()+i+"/"+JSON.stringify({input_data:{broadcast_id:String(d.id),client_subscription_id:c("uuidv4")()}});return e}var e=b.prototype;e.processEventMessage=function(a){a=a.live_question_submission_status_event;if(a==null)return;a={status:a,type:h};this.$QuestionStatusGraphQLEventHandler$p_1.eventHandler(a)};e.getSubTopic=function(){return this.$QuestionStatusGraphQLEventHandler$p_2};e.getType=function(){return d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.QUESTION_STATUS};return b}(d("PolarisBaseGraphQLEventHandler").BaseGraphQLEventHandler);g.QuestionStatusGraphQLEventHandler=a}),98);
__d("PolarisWaveGraphQLEventHandler",["PolarisBaseGraphQLEventHandler","PolarisConfig","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h="LIVE_WAVE",i="17882305414154951";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,e){var f;f=a.call(this)||this;f.$WaveGraphQLEventHandler$p_1=b;f.$WaveGraphQLEventHandler$p_2=f.getGraphQLSubsciptionPrefix()+i+"/"+JSON.stringify({input_data:{broadcast_id:String(e.id),client_subscription_id:c("uuidv4")(),receiver_id:d("PolarisConfig").getViewerId()},publish_data:{broadcast_id:String(e.id),receiver_id:d("PolarisConfig").getViewerId(),waver_id:String(e.broadcast_owner)}});return f}var e=b.prototype;e.processEventMessage=function(a){a=a.live_video_wave_event;if(a==null)return;a={type:h,wave:a};this.$WaveGraphQLEventHandler$p_1.eventHandler(a)};e.getSubTopic=function(){return this.$WaveGraphQLEventHandler$p_2};e.getType=function(){return d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.WAVE};return b}(d("PolarisBaseGraphQLEventHandler").BaseGraphQLEventHandler);g.WaveGraphQLEventHandler=a}),98);
__d("PolarisDirectGraphQLSubscription",["PolarisBaseGraphQLEventHandler","PolarisBdChallengeGraphQLEventHandler","PolarisDirectBaseSubscription","PolarisDirectLogger","PolarisPinnedQuestionGraphQLEventHandler","PolarisQuestionStatusGraphQLEventHandler","PolarisWaveGraphQLEventHandler","isStringNullOrEmpty"],(function(a,b,c,d,e,f,g){"use strict";var h="/ig_realtime_sub";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,e){e=new(d("PolarisDirectLogger").DirectLogger)("DirectGraphQLSubscription",e);c=a.call(this,h,[],c,e)||this;c.$DirectGraphQLSubscription$p_2=e;c.$DirectGraphQLSubscription$p_1=b;c.$DirectGraphQLSubscription$p_3=new Map();c.$DirectGraphQLSubscription$p_4();c.getSubTopics();return c}var e=b.prototype;e.$DirectGraphQLSubscription$p_4=function(){for(var a of Object.keys(d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES))d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES[a]!==d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.WAVE&&d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES[a]!==d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.PINNED_QUESTION&&!this.$DirectGraphQLSubscription$p_5(d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES[a])&&this.$DirectGraphQLSubscription$p_2.debugTrace("invalid_handler_type")};e.getSubTopics=function(){var a=[];for(var b of this.$DirectGraphQLSubscription$p_3){b[0];var d=b[1];d=d.getSubTopic();c("isStringNullOrEmpty")(d)||a.push(d)}this.updateSubTopics(a);return a};e.processMessage=function(b){for(var c of this.$DirectGraphQLSubscription$p_3){c[0];var d=c[1];d.processEventMessage(b)}a.prototype.processMessage.call(this,b)};e.enableOrDisableEventHandlerByType=function(a,b){b?this.$DirectGraphQLSubscription$p_5(a)||this.$DirectGraphQLSubscription$p_2.debugTrace("invalid_handler_type"):this.$DirectGraphQLSubscription$p_3["delete"](a);return this};e.$DirectGraphQLSubscription$p_5=function(a){this.$DirectGraphQLSubscription$p_3||(this.$DirectGraphQLSubscription$p_3=new Map());var b=this.$DirectGraphQLSubscription$p_6(a);if(b!=null){this.$DirectGraphQLSubscription$p_3.set(a,b);return!0}return!1};e.$DirectGraphQLSubscription$p_6=function(a){switch(a){case d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.BD_CHALLENGE:return new(d("PolarisBdChallengeGraphQLEventHandler").BdChallengeGraphQLEventHandler)(this.$DirectGraphQLSubscription$p_2.getDebugId());default:return null}};e.enableLiveEventHandler=function(a,b,c){switch(c){case d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.WAVE:this.$DirectGraphQLSubscription$p_3.set(d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.WAVE,new(d("PolarisWaveGraphQLEventHandler").WaveGraphQLEventHandler)(b,a));return this;case d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.PINNED_QUESTION:this.$DirectGraphQLSubscription$p_3.set(d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.PINNED_QUESTION,new(d("PolarisPinnedQuestionGraphQLEventHandler").PinnedQuestionGraphQLEventHandler)(b,a));return this;case d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.QUESTION_STATUS:this.$DirectGraphQLSubscription$p_3.set(d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.QUESTION_STATUS,new(d("PolarisQuestionStatusGraphQLEventHandler").QuestionStatusGraphQLEventHandler)(b,a));return this;default:return this}};e.disableLiveEventHandler=function(a){switch(a){case d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.WAVE:this.$DirectGraphQLSubscription$p_3["delete"](d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.WAVE);return this;case d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.PINNED_QUESTION:this.$DirectGraphQLSubscription$p_3["delete"](d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.PINNED_QUESTION);return this;case d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.QUESTION_STATUS:this.$DirectGraphQLSubscription$p_3["delete"](d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.QUESTION_STATUS);return this;default:return this}};e.unsubscribeGraphQL=function(){this.unsubscribe(),this.enableOrDisableEventHandlerByType(d("PolarisBaseGraphQLEventHandler").GRAPH_QL_EVENT_TYPES.WAVE,!1)};return b}(d("PolarisDirectBaseSubscription").DirectBaseSubscription);g.DirectGraphQLSubscription=a}),98);
__d("PolarisDirectIrisSubscription",["FBLogger","PolarisDirectLogger","isObject"],(function(a,b,c,d,e,f,g){"use strict";var h=1,i=2,j=1e3,k=64e3;a=function(){function a(a,b,e,f){var g=this;this.$7=function(){g.$6.logDirectClientEvent("ig_direct_iris_subscription",d("PolarisDirectLogger").DIRECT_CONTAINER_MODULES.ig_direct_realtime,babelHelpers["extends"]({},g.$2,{action:"attempt",attempt_reason:"mqtt-connected"}));g.$1.onIrisConnectivityChanged("Subscribing");var a=JSON.stringify(g.$2);g.$3.publish("/ig_sub_iris",a)["catch"](function(a){g.$6.logDirectClientEvent("ig_direct_iris_subscription",d("PolarisDirectLogger").DIRECT_CONTAINER_MODULES.ig_direct_realtime,babelHelpers["extends"]({},g.$2,{action:"error",error:JSON.stringify(a)})),g.$1.onIrisConnectivityChanged("Unsubscribed")})};this.$8=function(a){var b;if(typeof a==="string"||a instanceof String)try{b=JSON.parse(a)}catch(a){var e="Could not parse sub iris response $(response)";g.$6.logError(e,a);c("FBLogger")("ig_web").mustfix(e);b=a}else c("isObject")(a)?b=a:(c("FBLogger")("ig_web").mustfix("Unknown sub iris response $(response)"),b={succeeded:!1});if(b.succeeded===!0)g.$6.logDirectClientEvent("ig_direct_iris_subscription",d("PolarisDirectLogger").DIRECT_CONTAINER_MODULES.ig_direct_realtime,babelHelpers["extends"]({},g.$2,{action:"success"})),g.$1.onIrisConnectivityChanged("Subscribed",g.$2.subscription_type);else{g.$6.logDirectClientEvent("ig_direct_iris_subscription",d("PolarisDirectLogger").DIRECT_CONTAINER_MODULES.ig_direct_realtime,babelHelpers["extends"]({},g.$2,{},b,{action:"error"}));g.$1.onIrisConnectivityChanged("Unsubscribed");if(b.error_type===h)g.$1.onResnapshotRequested(g.$2);else if(b.error_type===i){e=g.$4+Math.floor(Math.random()*1e3);window.setTimeout(g.$7,e);g.$4=Math.min(g.$4*2,k)}}};this.$6=new(d("PolarisDirectLogger").DirectLogger)("DirectIrisSubscription",f);this.$6.debugTrace("ctor",b);this.$1=a;this.$2=b;this.$3=e;this.$4=j}var b=a.prototype;b.subscribe=function(){this.$6.debugTrace("subscribe_start"),this.unsubscribe(),this.$3.subscribe("/ig_sub_iris_response",this.$8),this.$7(),this.$6.debugTrace("subscribe_end")};b.unsubscribe=function(){this.$6.debugTrace("unsubscribe_start"),this.$5&&(window.clearTimeout(this.$5),this.$5=null),this.$3.unsubscribe("/ig_sub_iris_response"),this.$1.onIrisConnectivityChanged("Unsubscribed"),this.$6.debugTrace("unsubscribe_end")};return a}();g.DirectIrisSubscription=a}),98);
__d("PolarisDirectSkywalkerSubscription",["PolarisConfig","PolarisDirectBaseSubscription","PolarisDirectLogger","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h="/pubsub";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,e,f){f=new(d("PolarisDirectLogger").DirectLogger)("DirectSkywalkerSubscription",f);e=a.call(this,h,["ig/u/v1/"+c("nullthrows")(d("PolarisConfig").getViewerId())],e,f)||this;e.$DirectSkywalkerSubscription$p_2=f;e.$DirectSkywalkerSubscription$p_1=b;return e}var e=b.prototype;e.parsePayload=function(b){if(b.indexOf("/activity_indicator_id/")===-1){this.$DirectSkywalkerSubscription$p_2.debugTrace("not_activity_indicator_message");return null}return a.prototype.parsePayload.call(this,b)};e.processMessage=function(b){var c=b.data,d=b.event;if(d!=="patch"){this.$DirectSkywalkerSubscription$p_2.debugTrace("skipped_message",{event:d});return}if(!Array.isArray(c)){this.$DirectSkywalkerSubscription$p_2.debugTrace("parsed_message_bad_data",typeof c);return}for(d of c)this.$DirectSkywalkerSubscription$p_1.handleDelta(d,"");a.prototype.processMessage.call(this,b)};return b}(d("PolarisDirectBaseSubscription").DirectBaseSubscription);g.DirectSkywalkerSubscription=a}),98);
__d("PolarisLiveDeltaHandler",[],(function(a,b,c,d,e,f){"use strict";a=function(a){this.eventHandler=a};f["default"]=a}),66);
__d("PolarisMqttEnv",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({messenger_uses_mqtt_rollout:2,mqtt_ep_with_sid:0,mqtt_fast_lp:11,mqtt_lp_use_fetch:9,mqtt_waterfall_log_client_sampling:1,mqtt_ws_forced_polling_only:4,mqtt_ws_polling_enabled:3,mqtt_ws_reconnect_reset:7});b=function(){var a=b.prototype;a.random=function(){return this.$1!=null?this.$1():Math.random()};a.isUserLoggedInNow=function(){return this.$2!=null?this.$2():!0};a.clearTimeout=function(a){if(this.$3!=null){this.$3(a);return}window.clearTimeout(a)};a.setTimeout=function(a,b){for(var c=arguments.length,d=new Array(c>2?c-2:0),e=2;e<c;e++)d[e-2]=arguments[e];return this.$4!=null?this.$4.apply(null,arguments):window.setTimeout.apply(null,arguments)};a.getLoggerInstance=function(){return this.$5!=null?this.$5():g.getInstance()};a.genGk=function(a){return this.$6!=null?this.$6(a):!1};a.createSocket=function(a,b){return this.$7!=null?this.$7(a,b):new WebSocket(a)};a.scheduleCallback=function(a){return this.$8!=null?this.$8(a):a()};a.scheduleLoggingCallback=function(a){return this.$9!=null?this.$9(a):a()};a.configRead=function(a,b){return this.$10!=null?this.$10(a,b):b};a.configWrite=function(a,b){this.$11!=null&&this.$11(a,b)};function b(){this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=null,this.$9=null,this.$10=null,this.$11=null}a.initialize=function(a,b,c,d,e,f,g,h,i,j,k){this.$1=a,this.$2=b,this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$7=g,this.$8=h,this.$9=i,this.$10=j,this.$11=k};return b}();var g=function(){function a(){}a.getInstance=function(){return new a()};var b=a.prototype;b.setAppId=function(a){};b.eventLogConnect=function(a){a.attemptNumber,a.connectionStatus,a.duration,a.errorCode,a.errorMessage,a.failTotal,a.hostname,a.publishes,a.sessionID,a.subscribedTopics,a.successTotal};b.eventLogPull=function(a){a.duration,a.errorMessage,a.hostname,a.pullEventName,a.sessionID,a.status};b.eventLogDisconnect=function(a){a.duration,a.errorCode,a.errorMessage,a.sessionID};b.eventLogPublish=function(a){a.connectionStatus,a.publishStatus,a.sessionID,a.topic};b.eventLogMiscellaneousError=function(a){a.errorMessage};b.logError=function(a,b){};b.logErrorWarn=function(a,b){};b.logWarn=function(a,b){};b.debugTrace=function(a,b){};b.bumpCounter=function(a){};return a}();c={Env:new b(),MqttGkNames:a};f["default"]=c}),66);
__d("PolarisIrisSubscribeChecker",["PolarisMqttEnv"],(function(a,b,c,d,e,f){"use strict";var g=b("PolarisMqttEnv").Env,h=b("PolarisMqttEnv").MqttGkNames;a=function(){function a(a){this.$1=g.getLoggerInstance();this.$2=null;this.$3=!1;this.$4=!1;this.$5=!1;this.$6=!0;this.$7=0;this.$8=a;if(typeof window!=="undefined"){a=window.location.hostname;(a==="m.facebook.com"||a==="mobile.facebook.com"||a==="mtouch.facebook.com")&&(this.$6=!1)}g.genGk(h.messenger_uses_mqtt_rollout)||(this.$6=!1)}var b=a.prototype;b.start=function(){this.$6=!0};b.stop=function(){this.$6=!1,this.$9()};b.onConnectAttempt=function(){};b.onConnectFailure=function(){this.$9()};b.onConnected=function(){var a=this;this.$7++;this.$9();this.$3=!1;this.$4=!1;this.$5=!1;this.$6&&(this.$2=g.setTimeout(function(){a.$10()},8e3))};b.onConnectSuccess=function(){};b.onConnectionLost=function(){this.$9()};b.onSubscribe=function(a){a==="/t_ms"&&(this.$3=!0)};b.onUnsubscribe=function(a){};b.onPublish=function(a){(a==="/messenger_sync_get_diffs"||a==="/messenger_sync_create_queue")&&(this.$4=!0,this.$3&&(this.$5=!0,this.$9()))};b.onMessage=function(a){};b.onWSFatal=function(){};b.$9=function(){this.$2&&(g.clearTimeout(this.$2),this.$2=null)};b.$10=function(){if(this.$4===!1){var a=this.$7===1?"no_iris_session_initialConnect":"no_iris_session";this.$1.bumpCounter(a);this.$1.eventLogMiscellaneousError({errorMessage:a});this.$8()?this.$1.bumpCounter(a+".withProvider"):this.$1.bumpCounter(a+".withoutProvider");this.$3===!0?this.$1.bumpCounter(a+".withTopicSubscribe"):this.$1.bumpCounter(a+".withoutTopicSubscribe")}this.$3===!1&&this.$1.bumpCounter("no_iris_topic_subscribe");this.$3===!0&&this.$4===!0&&this.$5===!1&&this.$1.bumpCounter("session_before_topic_subscribe")};return a}();e.exports=a}),null);
__d("PolarisMqttAnalyticsHook",["InstagramODS","PolarisMqttEnv"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=c("PolarisMqttEnv").Env.getLoggerInstance(),this.$2=0,this.$3=0,this.$4=0,this.$5=0,c("InstagramODS").incr("web.mqtt.session_start"),c("PolarisMqttEnv").Env.isUserLoggedInNow()||c("InstagramODS").incr("web.mqtt.session_start.logout")}var b=a.prototype;b.onConnectAttempt=function(){c("InstagramODS").incr("web.mqtt.ws_connect_attempt")};b.onConnectFailure=function(){this.$3++,c("InstagramODS").incr("web.mqtt.ws_connect_failure")};b.onConnected=function(){c("InstagramODS").incr("web.mqtt.ws_connect_connected")};b.onConnectSuccess=function(){this.$2===0&&c("InstagramODS").incr("web.mqtt.ws_connect_first_success"),this.$2++,c("InstagramODS").incr("web.mqtt.ws_connect_success")};b.onConnectionLost=function(){c("InstagramODS").incr("web.mqtt.ws_disconnect")};b.onSubscribe=function(a){};b.onUnsubscribe=function(a){};b.onPublish=function(a){c("InstagramODS").incr("web.mqtt.ws_publish")};b.onMessage=function(a){c("InstagramODS").incr("web.mqtt.message_arrived")};b.onWSFatal=function(){c("InstagramODS").incr("web.mqtt.ws_fatal")};b.onPollRequestSent=function(){c("InstagramODS").incr("web.mqtt.polling_request_send")};b.onPollRequestSuccess=function(){c("InstagramODS").incr("web.mqtt.polling_request_succeed"),this.$4===0&&c("InstagramODS").incr("web.mqtt.polling_first_success"),this.$4++};b.onPollResponse=function(){c("InstagramODS").incr("web.mqtt.lp.message_arrived")};b.onPollFinish=function(){};b.onPollRequestFailed=function(){c("InstagramODS").incr("web.mqtt.polling_request_failed"),this.$5++};return a}();g["default"]=a}),98);
__d("PolarisMqttConnectionHookCollection",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.addHook=function(a){this.$1.add(a)};b.removeHook=function(a){this.$1["delete"](a)};b.onConnectAttempt=function(){this.$1.forEach(function(a){a.onConnectAttempt()})};b.onConnectFailure=function(){this.$1.forEach(function(a){a.onConnectFailure()})};b.onConnected=function(){this.$1.forEach(function(a){a.onConnected()})};b.onConnectSuccess=function(){this.$1.forEach(function(a){a.onConnectSuccess()})};b.onConnectionLost=function(){this.$1.forEach(function(a){a.onConnectionLost()})};b.onSubscribe=function(a){this.$1.forEach(function(b){b.onSubscribe(a)})};b.onUnsubscribe=function(a){this.$1.forEach(function(b){b.onUnsubscribe(a)})};b.onPublish=function(a){this.$1.forEach(function(b){b.onPublish(a)})};b.onMessage=function(a){this.$1.forEach(function(b){b.onMessage(a)})};b.onWSFatal=function(){this.$1.forEach(function(a){a.onWSFatal()})};return a}();f["default"]=a}),66);
__d("PolarisMqttProtocolUtils",["PolarisMqttEnv"],(function(a,b,c,d,e,f){"use strict";var g=b("PolarisMqttEnv").Env;function a(a,b){if(a==null)return b;var c=new Uint8Array(a.length+b.length);c.set(a);c.set(b,a.length);return c}function c(a,b){b=b;var c=0,d=1,e;do{if(b===a.length)return null;e=a[b++];c+=(e&127)*d;d*=128}while((e&128)!==0);return{offset:b,value:c}}function d(a){a=a;var b=new Array(1);for(var c=0;c<4;c++){var d=a%128;a>>=7;if(a>0)b[c]=d|128;else{b[c]=d;break}}return b}function h(a,b,c){c=c;b[c++]=a>>8;b[c++]=a%256;return c}function f(a,b){return 256*a[b]+a[b+1]}function i(a){var b=0;for(var c=0,d=a.length;c<d;c++){var e=a.charCodeAt(c);e<128?b+=1:e<2048?b+=2:e>=55296&&e<=56319?(b+=4,c++):b+=3}return b}function j(a,b,c,d){d=h(b,c,d);k(a,c,d);return d+b}function k(a,b,c){c=c;for(var d=0,e=a.length;d<e;d++){var f=a.charCodeAt(d);f<128?b[c++]=f:f<2048?(b[c++]=192|f>>6,b[c++]=128|f&63):f<55296||f>=57344?(b[c++]=224|f>>12,b[c++]=128|f>>6&63,b[c++]=128|f&63):(f=65536+((f&1023)<<10|a.charCodeAt(++d)&1023),b[c++]=240|f>>18,b[c++]=128|f>>12&63,b[c++]=128|f>>6&63,b[c++]=128|f&63)}}function l(a,b,c){var d=[],e=b,f=0;while(e<b+c){var g=a[e++];if(g<128)d[f++]=String.fromCharCode(g);else if(g>191&&g<224){var h=a[e++];d[f++]=String.fromCharCode((g&31)<<6|h&63)}else if(g>239&&g<365){h=a[e++];var i=a[e++],j=a[e++];h=((g&7)<<18|(h&63)<<12|(i&63)<<6|j&63)-65536;d[f++]=String.fromCharCode(55296+(h>>10));d[f++]=String.fromCharCode(56320+(h&1023))}else{i=a[e++];j=a[e++];d[f++]=String.fromCharCode((g&15)<<12|(i&63)<<6|j&63)}}return d.join("")}b=function(){function a(a,b,c){this.$1=a*1e3,this.$4=b,this.$5=c,this.$3=!1}var b=a.prototype;b.$6=function(){var a=this;this.$3?(this.$3=!1,this.$4(),this.$2=g.setTimeout(function(){a.$6()},this.$1)):this.$5()};b.reset=function(){var a=this;this.$3=!0;this.$2&&(g.clearTimeout(this.$2),this.$2=null);this.$1>0&&(this.$2=g.setTimeout(function(){a.$6()},this.$1))};b.cancel=function(){this.$2&&(g.clearTimeout(this.$2),this.$2=null)};return a}();e.exports={Pinger:b,UTF8Length:i,concatBuffers:a,convertStringToUTF8:k,convertUTF8ToString:l,decodeMultiByteInt:c,encodeMultiByteInt:d,readUInt16BE:f,writeString:j,writeUInt16BE:h}}),null);
__d("PolarisMqttUtils",["PolarisMqttEnv","err","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h={endpointWithExtraParameter:function(a,b,c){return a.indexOf("?")>0?a+"&"+b+"="+c:a+"?"+b+"="+c},endpointWithExtraParameters:function(a,b){var c=a;b.forEach(function(a,b){c=h.endpointWithExtraParameter(c,b,a)});return c},endpointWithSessionId:function(a,b){return!c("PolarisMqttEnv").Env.genGk(c("PolarisMqttEnv").MqttGkNames.mqtt_ep_with_sid)?a:h.endpointWithExtraParameter(a,"sid",b.toString())},generateSessionId:function(){return Math.floor(c("PolarisMqttEnv").Env.random()*Number.MAX_SAFE_INTEGER)},hasWSSupport:function(){return"WebSocket"in a&&a.WebSocket!==null},promiseDone:function(a,b,d){var e=arguments.length>1?a.then(b,d):a;c("promiseDone")(e.then(null,function(a){c("PolarisMqttEnv").Env.setTimeout(function(){if(a instanceof Error)throw a;else throw c("err")("promiseDone")},0)}))},sprintf:function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=0;return a.replace(/%s/g,function(){return String(c[e++])})}};b=h;g["default"]=b}),98);
__d("PolarisMqttProtocolCodec",["PolarisMqttProtocolUtils","PolarisMqttUtils"],(function(a,b,c,d,e,f){"use strict";var g=(c=b("PolarisMqttProtocolUtils")).UTF8Length,h=c.convertStringToUTF8,i=c.convertUTF8ToString,j=c.decodeMultiByteInt,k=c.encodeMultiByteInt,l=c.readUInt16BE,m=c.writeString,n=c.writeUInt16BE,o=b("PolarisMqttUtils").sprintf,p=Object.freeze({CONNACK:2,CONNECT:1,DISCONNECT:14,PINGREQ:12,PINGRESP:13,PUBACK:4,PUBLISH:3,SUBACK:9,SUBSCRIBE:8,UNSUBACK:11,UNSUBSCRIBE:10}),q=[0,6,77,81,73,115,100,112,3];function r(a,b){b=b;var c=b,d=a[b],e=d>>4;b+=1;var f=j(a,b);if(f==null)return{position:c,wireMessage:null};b=f.offset;f=b+f.value;if(f>a.length)return{position:c,wireMessage:null};var g;switch(e){case p.CONNACK:c=a[b++];c=!!(c&1);var h=a[b++];g=new u(c,h);break;case p.PUBLISH:c=d&15;h=c>>1&3;d=l(a,b);b+=2;var k=i(a,b,d);b+=d;d=null;h===1&&(d=l(a,b),b+=2);var m=w.createWithBytes(a.subarray(b,f)),n=(c&1)===1;c=(c&8)===8;g=new x(k,m,h,d,n,c);break;case p.PINGREQ:g=new s("PINGREQ");break;case p.PINGRESP:g=new s("PINGRESP");break;case p.PUBACK:case p.UNSUBACK:k=l(a,b);g=new v(e===p.PUBACK?"PUBACK":"UNSUBACK",k);break;case p.SUBACK:m=l(a,b);b+=2;h=a.subarray(b,f);g=new t(m,h);break;default:throw new Error(o("Invalid MQTT message type %s.",e))}return{position:f,wireMessage:g}}function a(a){var b=[],c=0;while(c<a.length){var d=r(a,c),e=d.wireMessage;c=d.position;if(e)b.push(e);else break}d=null;c<a.length&&(d=a.subarray(c));return{messages:b,remaining:d}}d=function(){function a(a){this.messageType=p[a]}var b=a.prototype;b.encode=function(){throw new TypeError("Cannot abstract class WireMessage")};return a}();var s=function(b){babelHelpers.inheritsLoose(a,b);function a(a){return b.call(this,a)||this}var c=a.prototype;c.encode=function(){var a=new ArrayBuffer(2),b=new Uint8Array(a);b[0]=(this.messageType&15)<<4;return a};return a}(d);f=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"DISCONNECT")||this}var c=b.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=new ArrayBuffer(2),c=new Uint8Array(b);c[0]=a;c.set(k(0),1);return b};return b}(d);var t=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"SUBACK")||this;d.messageIdentifier=a;d.returnCode=c;return d}return a}(d),u=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"CONNACK")||this;d.sessionPresent=a;d.returnCode=c;return d}return a}(d),v=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.messageIdentifier=c;return a}var c=a.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=2,c=k(b),d=c.length+1;b=new ArrayBuffer(b+d);var e=new Uint8Array(b);e[0]=a;e.set(c,1);d=n(this.messageIdentifier,e,d);return b};return a}(d);c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this,"CONNECT")||this;d.clientId=b;d.connectOptions=c;return d}var c=b.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=q.length+3;b+=g(this.clientId)+2;b+=g(this.connectOptions.userName)+2;var c=k(b);b=new ArrayBuffer(1+c.length+b);var d=new Uint8Array(b);d[0]=a;a=1;d.set(c,1);a+=c.length;d.set(q,a);a+=q.length;c=2|128;d[a++]=c;a=n(this.connectOptions.keepAliveInterval,d,a);a=m(this.clientId,g(this.clientId),d,a);a=m(this.connectOptions.userName,g(this.connectOptions.userName),d,a);return b};return b}(d);b=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d,e){var f;f=a.call(this,b)||this;f.topic=c;if(d<0&&d>1||d===1&&e==null)throw new TypeError(o("Argument Invalid. qos: %s messageType: %s.",d,b));f.qos=d;f.messageIdentifier=e;return f}var c=b.prototype;c.encode=function(){var a=(this.messageType&15)<<4;a|=2;var b=g(this.topic),c=2+b+2;this.messageType===p.SUBSCRIBE&&(c+=1);var d=k(c);c=new ArrayBuffer(1+d.length+c);var e=new Uint8Array(c);e[0]=a;a=1;e.set(d,1);a+=d.length;this.messageIdentifier!=null&&(a=n(this.messageIdentifier,e,a));a=m(this.topic,b,e,a);this.messageType===p.SUBSCRIBE&&this.qos!=null&&(e[a++]=this.qos);return c};return b}(d);var w=function(){function a(a,b){this.payloadString=a,this.payloadBytes=b}a.createWithString=function(b){var c=new Uint8Array(new ArrayBuffer(g(b)));h(b,c,0);return new a(b,c)};a.createWithBytes=function(b){var c=0,d=b.length;while(c<b.length&&b[c]!==123&&b[c]!==91)c++,d--;var e=i(b,c,d);b=b.subarray(c,d);return new a(e,b)};var b=a.prototype;b.string=function(){return this.payloadString};b.bytes=function(){return this.payloadBytes};return a}(),x=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c,d,e,f,g){var h;h=b.call(this,"PUBLISH")||this;h.topic=a;h.payloadMessage=c;h.qos=d;h.messageIdentifier=e;h.retained=f!=null?f:!1;h.duplicate=g!=null?g:!1;if(h.qos===1&&h.messageIdentifier==null)throw new TypeError("Argument Invalid. messageIdentifier: null and qos: 1");return h}var c=a.prototype;c.encode=function(){var a=(this.messageType&15)<<4;this.duplicate&&(a|=8);a=a|=this.qos<<1;this.retained&&(a|=1);var b=g(this.topic),c=b+2;c+=this.messageIdentifier==null?0:2;var d=this.payloadMessage.bytes();c+=d.byteLength;var e=k(c);c=new ArrayBuffer(1+e.length+c);var f=new Uint8Array(c);f[0]=a;f.set(e,1);a=1+e.length;a=m(this.topic,b,f,a);this.messageIdentifier!=null&&(a=n(this.messageIdentifier,f,a));f.set(d,a);return c};return a}(d);e.exports={MESSAGE_TYPE:p,WireMessage:{Base:d,ConnAck:u,Connect:c,Disconnect:f,Ping:s,PubAckUnsubAck:v,Publish:x,Subscription:b},createMessageWithString:w.createWithString,decodeByteMessages:a,decodeMessage:r}}),null);
__d("PolarisMqttTypes",[],(function(a,b,c,d,e,f){"use strict";a=function(a,b){this.errorCode=a,this.errorMessage=b};b=function(a,b){this.mqttError=a,this.connAck=b};c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){d===void 0&&(d=null);c=a.call(this,c)||this;c.isRecoverable=b;c.originalError=d;return c}return b}(babelHelpers.wrapNativeSuper(Error));e.exports={ConnectFailure:b,MqttChannelError:c,MqttError:a}}),null);
__d("PolarisMqttProtocolClient",["PolarisMqttEnv","PolarisMqttProtocolCodec","PolarisMqttProtocolUtils","PolarisMqttTypes"],(function(a,b,c,d,e,f){"use strict";var g=b("PolarisMqttEnv").Env,h=(a=b("PolarisMqttProtocolCodec")).MESSAGE_TYPE,i=a.WireMessage,j=a.createMessageWithString,k=a.decodeByteMessages,l=b("PolarisMqttProtocolUtils").Pinger,m=b("PolarisMqttProtocolUtils").concatBuffers,n=b("PolarisMqttTypes").ConnectFailure;c=b("PolarisMqttTypes").MqttError;var o=30,p=6e4,q={APP_DISCONNECT:new c(7,"Disconnect initiated by app"),CONNACK_FAILURE:new c(5,"Connection failure due to connack"),CONNECT_TIMEOUT:new c(4,"Connect timed out"),INVALID_DATA_TYPE:new c(3,"Received non-arraybuffer from socket."),PING_TIMEOUT:new c(6,"Ping timeout"),SERVER_DISCONNECT:new c(8,"Disconnect message sent my server"),SOCKET_CLOSE:new c(9,"Socket connection closed"),SOCKET_ERROR:new c(1,"Socket error"),SOCKET_MESSAGE:new c(2,"Unable to parse invalid socket message")};d=function(){function a(a){var b=this;this.$11=function(a,c){var d=b.$5,e=b.$2,f=e.onConnectFailure,h=e.onConnectionLost;b.setConnected(!1);d?g.scheduleCallback(function(){h(a)}):g.scheduleCallback(function(){f(new n(a,c!=null?c:-1))});b.$13()};this.$12=function(a){var c=b.$6;if(c==null)return;if(c.readyState!==c.OPEN)return;c.send(a.encode())};this.handleMessage=function(a){switch(a.messageType){case h.CONNACK:b.$7!=null&&(g.clearTimeout(b.$7),b.$7=null);if(a instanceof i.ConnAck){var c=a;if(c.returnCode!==0){b.$9.bumpCounter("protocol.error.connack.invalidreturncode");b.setConnected(!1);b.$11(q.CONNACK_FAILURE,c.returnCode);return}g.scheduleCallback(function(){b.$2.onConnectSuccess()});b.$8!=null&&b.$8.reset()}break;case h.PUBLISH:if(a instanceof i.Publish){var d=a;g.scheduleCallback(function(){b.$2.onMessageArrived(d.topic,d.payloadMessage.payloadString)});c=d.messageIdentifier;b.$9.bumpCounter("protocol.publish.received");if(d.qos===1&&c!=null){c=new i.PubAckUnsubAck("PUBACK",c);b.$12(c)}}break;case h.PUBACK:if(a instanceof i.PubAckUnsubAck){c=a;var e=c.messageIdentifier;b.$9.bumpCounter("protocol.puback.received");g.scheduleCallback(function(){b.$2.onMessageDelivered(e)})}break;case h.PINGRESP:b.$8!=null&&b.$8.reset();break;case h.DISCONNECT:b.$11(q.SERVER_DISCONNECT);break;case h.SUBACK:b.$9.bumpCounter("protocol.suback.received");break;case h.UNSUBACK:b.$9.bumpCounter("protocol.unsuback.received");break;default:b.$9.logError(new Error("MqttProtocolClient: Received unhandled message type: "+a.messageType),"Received unhandled message type");b.$9.bumpCounter("protocol.error.handlemessage.unsupportedtype");break}};this.$3=a;this.$2={ignoreSubProtocol:!1,keepAliveInterval:10,mqttVersion:3,onConnectFailure:function(a){},onConnection:function(){},onConnectionError:function(a){},onConnectionLost:function(a){},onConnectSuccess:function(){},onMessageArrived:function(a,b){},onMessageDelivered:function(a){},userName:""};this.$1="mqttwsclient";this.$4=0;this.$5=!1;this.$9=g.getLoggerInstance()}var b=a.prototype;b.connect=function(a){var b=this;if(this.$5)throw new Error("Invalid state: connect - already connected");this.$2=a;this.setConnected(!1);this.$7!=null&&(g.clearTimeout(this.$7),this.$7=null);this.$7=g.setTimeout(function(){b.$9.bumpCounter("protocol.error.connect.timeout"),b.$11(q.CONNECT_TIMEOUT)},o*1e3);this.$6=g.createSocket(this.$3);this.$6.binaryType="arraybuffer";this.$6.onopen=function(){b.setConnected(!0),b.$12(new i.Connect(b.$1,a)),a.onConnection()};this.$6.onmessage=function(a){a=a.data;if(!(a instanceof ArrayBuffer)){b.$9.bumpCounter("protocol.error.onmessage.type");b.$11(q.INVALID_DATA_TYPE);return}try{a=new Uint8Array(a);b.$10!=null&&(a=m(b.$10,a),b.$9.bumpCounter("protocol.debug.usingMessagesBuffer"),delete b.$10,b.$10=null);a=k(a);var c=a.messages;b.$10=a.remaining;for(a=0;a<c.length;a++)b.handleMessage(c[a])}catch(a){b.$10=null,b.$9.logError(a,q.SOCKET_MESSAGE.errorMessage),b.$9.bumpCounter("protocol.error.onmessage.parse"),b.$11(q.SOCKET_MESSAGE)}};this.$6.onerror=function(a){b.$9.bumpCounter("protocol.error.socket"),b.$11(q.SOCKET_ERROR)};this.$6.onclose=function(a){b.$9.bumpCounter("protocol.socket.close"),b.$11(q.SOCKET_CLOSE)};this.$8!=null&&this.$8.cancel();this.$8=new l(a.keepAliveInterval,this.$12.bind(this,new i.Ping("PINGREQ")),this.$11.bind(this,q.PING_TIMEOUT))};b.$13=function(){this.setConnected(!1),this.$8!=null&&this.$8.cancel(),this.$7!=null&&(g.clearTimeout(this.$7),this.$7=null),this.$6!=null&&(this.$6.onopen=function(a){},this.$6.onmessage=function(a){},this.$6.onerror=function(a){},this.$6.onclose=function(a){},this.$6.readyState===this.$6.OPEN&&this.$6.close(),delete this.$6,this.$6=null),this.$2.onConnectSuccess=function(){},this.$2.onConnectFailure=function(a){},this.$2.onConnection=function(){},this.$2.onConnectionError=function(a){},this.$2.onConnectionLost=function(a){},this.$2.onMessageArrived=function(a,b){},this.$2.onMessageDelivered=function(a){}};b.disconnect=function(){if(this.$6==null||this.$6.readyState!==this.$6.OPEN||!this.$5){this.$13();return}this.$12(new i.Disconnect());this.$9.bumpCounter("protocol.debug.disconnect");this.$11(q.APP_DISCONNECT)};b.isConnected=function(){return this.$5};b.setConnected=function(a){this.$5=a};b.subscribe=function(a){if(!this.$5){this.$9.bumpCounter("protocol.error.subscribe.notconnected");throw new Error("Invalid state: subscribe - not connected")}this.$9.bumpCounter("protocol.subscribe."+a);a=new i.Subscription("SUBSCRIBE",a,0,this.$14());this.$12(a)};b.unsubscribe=function(a){if(!this.$5){this.$9.bumpCounter("protocol.error.unsubscribe.notconnected");throw new Error("Invalid state: unsubscribe - not connected")}this.$9.bumpCounter("protocol.unsubscribe."+a);a=new i.Subscription("UNSUBSCRIBE",a,0,this.$14());this.$12(a)};b.publish=function(a,b,c){this.$5||this.$9.bumpCounter("protocol.error.publish.notconnected");this.$9.bumpCounter("protocol.publish."+a);var d=this.$14();a=new i.Publish(a,j(b),c,d);this.$12(a);return d};b.$14=function(){++this.$4===p&&(this.$4=1);return this.$4};return a}();e.exports=d}),null);
__d("PolarisMqttUserName",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c,d,e,f,g){this.$1=a,this.$2=b,this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$8=g,this.$7=typeof document==="object"&&document&&document.hasFocus()}var b=a.prototype;b.gen=function(a,b,c){c={a:navigator.userAgent,aid:this.$5,asi:void 0,chat_on:this.$6,cp:this.$3,ct:"cookie_auth",d:this.$4,dc:"",ecp:this.$2,fg:this.$7,mqtt_sid:"",no_auto_fg:!0,pm:c,s:a,st:b,u:this.$1};this.$8&&this.$8.appSpecificInfo&&(c.asi=this.$8.appSpecificInfo);return JSON.stringify(c)};b.setForegroundState=function(a){this.$7=a};b.setChatVisibility=function(a){this.$6=a};return a}();f["default"]=a}),66);
__d("PolarisMqttConnection",["InstagramODS","PolarisMqttConnectionHookCollection","PolarisMqttEnv","PolarisMqttProtocolClient","PolarisMqttTypes","PolarisMqttUserName","PolarisMqttUtils","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i=10,j="publish",k="subscribe",l="unsubscribe";function m(a){}var n=18e4,o=5*1e3,p=15,q=21;a=function(){function a(a){this.$8=!1;this.$10=c("PolarisMqttEnv").Env.getLoggerInstance();this.$11="Disconnected";this.$14=new Set();this.$15=new Map();this.$17=0;this.$18=0;this.$12=0;this.$13=0;this.$8=!1;this.$5="";this.$6=new(c("PolarisMqttUserName"))("0",0,1,"",0,!0);this.$9=0;this.$7=null;var b=function(){};this.$1=b;this.$2=b;this.$3=b;this.$19=new(c("PolarisMqttConnectionHookCollection"))();this.$4=function(){return[]};this.$16=a}var d=a.prototype;d.run=function(a){var b=this,c=a.endpoint,d=a.extraConnectMessageProvider,e=a.mqttUserName,f=a.onJSError,g=a.onMessageReceived,h=a.onStateChange;a=a.subscribedTopics;if(this.$8){this.$10.debugTrace("run","Run called while in running state.");return}this.$1=h;this.$3=g;this.$5=c;this.$6=e;this.$8=!0;this.$12=0;this.$2=f||m;a&&a.forEach(function(a){return b.$14.add(a)});this.$4=d;this.$20()};d.shutdown=function(){this.$21(),this.$22("shutdown"),this.$8=!1,this.$10.debugTrace("shutdown","Shutdown")};d.subscribe=function(a){this.$14.add(a);this.ensureConnected(k)&&this.$23(a);return!0};d.publish=function(a,c,d){var e={reject:function(a){},resolve:function(){}},f=new(h||(h=b("Promise")))(function(a,b){e.resolve=a,e.reject=b}),g=this.ensureConnected(j),i="connection_unknown";if(!g)i="connection_not_connected",e.reject(new Error("Client disconnected"));else{c=this.$24(a,c,d,e);i=c===!0?"connection_published":"connection_failed"}this.$10.eventLogPublish({connectionStatus:g,publishStatus:i,sessionID:this.$9,topic:a});return f};d.unsubscribe=function(a){this.$14["delete"](a);this.ensureConnected(l)&&this.$25(a);return!0};d.addHook=function(a){this.$19.addHook(a)};d.removeHook=function(a){this.$19.removeHook(a)};d.isRunning=function(){return this.$8};d.getSessionId=function(){return this.$9};d.ensureConnected=function(a){if(!this.$8){this.$10.debugTrace("ensureConnected","Mqtt connection: "+a+" called when not running");return!1}if(this.$7==null){this.$10.debugTrace("ensureConnected","Mqtt connection: "+a+" called when not connected, ignored");return!1}var b=this.$7.isConnected();if(!b){this.$10.debugTrace("ensureConnected","Mqtt connection: "+a+" called with client not connected");return!1}return!0};d.connectionState=function(){return this.$11};d.testOnlyGetSubscribedTopics=function(){return this.$14};d.$21=function(){this.$8&&this.$7!=null&&(this.$26("Disconnected"),this.$7!=null&&this.$7.disconnect(),this.$7=null)};d.$26=function(a){a!==this.$11&&(this.$11=a,this.$1(a))};d.$20=function(){var a=this;if(!this.$8)return;this.$26("Connecting");var b=Date.now();this.$9=c("PolarisMqttUtils").generateSessionId();var d=Array.from(this.$14),e=c("PolarisMqttUtils").endpointWithSessionId(this.$5,this.$9);try{this.$7=new(c("PolarisMqttProtocolClient"))(e);var f=this.$27(),g=f.map(function(a){return a.topic});e=this.$6.gen(this.$9,d,f);this.$7!=null&&(this.$7.connect({ignoreSubProtocol:!0,keepAliveInterval:i,mqttVersion:3,onConnectFailure:function(c){return a.$28(c,b,d,g)},onConnection:function(){return a.$29(f,d)},onConnectionError:function(b){return a.$30(b)},onConnectionLost:function(b){return a.$31(b)},onConnectSuccess:function(){return a.$32(b,d,g)},onMessageArrived:function(b,c){return a.$33(b,c)},onMessageDelivered:function(b){return a.$34(b)},userName:e}),c("InstagramODS").incr("web.mqtt.protocol.connectattempt"),this.$19.onConnectAttempt())}catch(a){c("InstagramODS").incr("web.mqtt.js_error_in_init_exception"),this.$26("Disconnected"),this.$35(!1,b,d,[],14,a.message),a&&this.$10.logErrorWarn(a,"ws_js_error"),this.$19.onWSFatal(),this.$36(new(c("PolarisMqttTypes").MqttChannelError)(!1,"ws_js_error",a),"client_init")}};d.$27=function(){var a=this.$4(),b=65536;return a.map(function(a){a.messageId=b--;return a})};d.$23=function(a){try{if(this.$7!=null){this.$7.subscribe(a);this.$10.debugTrace("#doSubscribe","Subscribing to "+a);this.$19.onSubscribe(a);c("InstagramODS").incr("web.mqtt.protocol.subscribe");return!0}}catch(a){this.$10.logError(a,"Exception subscribing"),c("InstagramODS").incr("web.mqtt.subscribe_exception"),c("InstagramODS").incr("web.mqtt.protocol.subscribe.error")}return!1};d.$25=function(a){try{if(this.$7!=null){this.$7.unsubscribe(a);this.$10.debugTrace("#doUnsubscribe","Unsubscribing to "+a);this.$19.onUnsubscribe(a);c("InstagramODS").incr("web.mqtt.protocol.unsubscribe");return!0}}catch(a){this.$10.logError(a,"Exception unsubscribing"),c("InstagramODS").incr("web.mqtt.unsubscribe_exception"),c("InstagramODS").incr("web.mqtt.protocol.unsubscribe.error")}return!1};d.$24=function(a,b,d,e){if(this.$7!=null)try{b=this.$7.publish(a,b,d);c("InstagramODS").incr("web.mqtt.protocol.publish");var f=b!=null?b:"null";this.$10.debugTrace("#doPublish","publish "+a+" with messageId:"+f+" qos:"+d);this.$19.onPublish(a);b!=null?this.$15.set(b,e):e.resolve();return!0}catch(a){this.$10.logError(a,"Exception publishing");c("InstagramODS").incr("web.mqtt.publish_exception");e.reject(a);c("InstagramODS").incr("web.mqtt.protocol.publish.error");return!1}else return!1};d.$37=function(a){var b=this;a===void 0&&(a=null);if(!this.$8)return;this.$21();this.$22("reconnect");this.$38();this.$9=-1;this.$13=0;a=a!=null?a:Math.pow(2,Math.min(this.$12,6))*(1e3+c("PolarisMqttEnv").Env.random()*200);this.$10.debugTrace("#scheduleReconnect","Reconnect in "+a+" ms");c("PolarisMqttEnv").Env.setTimeout(function(){b.$20()},a);this.$12+=1};d.$38=function(){if(!c("PolarisMqttEnv").Env.genGk(c("PolarisMqttEnv").MqttGkNames.mqtt_ws_reconnect_reset))return;var a=Date.now()-this.$13,b=this.$13!==0&&a>o,d=this.$12>p;(b||d)&&(this.$12=0);this.$13!==0&&a<=o&&c("InstagramODS").incr("web.mqtt.short_lived_session");d&&c("InstagramODS").incr("web.mqtt.connection_attempt_limit")};d.$35=function(a,b,c,d,e,f){a===!0?this.$18++:this.$17++,this.$10.eventLogConnect({attemptNumber:this.$12,connectionStatus:a,duration:Date.now()-b,errorCode:e,errorMessage:f,failTotal:this.$17,hostname:this.$5,publishes:d,sessionID:this.$9,subscribedTopics:c,successTotal:this.$18})};d.$28=function(a,b,d,e){var f=a.mqttError,g=f.errorMessage;this.$10.debugTrace("connect","Connect failed "+g);c("InstagramODS").incr("web.mqtt.protocol.onconnectfailure");this.$19.onConnectFailure();this.$35(!1,b,d,e,f.errorCode,g);if(a.connAck!=null){c("InstagramODS").incr("web.mqtt.protocol.connect_failure");if(a.connAck===q){this.$37(n);return}}this.$37()};d.$29=function(a,b){var d=this;c("InstagramODS").incr("web.mqtt.protocol.onconnection");this.$10.debugTrace("Connect","Socket established");this.$19.onConnected();b.forEach(function(a){d.$19.onSubscribe(a)});a.forEach(function(a){d.$19.onPublish(a.topic)});this.$26("TransportConnected")};d.$32=function(a,b,d){c("InstagramODS").incr("web.mqtt.protocol.onconnectsuccess"),this.$10.debugTrace("connect","Connect success"),this.$19.onConnectSuccess(),this.$35(!0,a,b,d),this.$26("Connected"),this.$39(b),c("PolarisMqttEnv").Env.genGk(c("PolarisMqttEnv").MqttGkNames.mqtt_ws_reconnect_reset)||(this.$12=0),this.$13=Date.now()};d.$31=function(a){c("InstagramODS").incr("web.mqtt.protocol.onconnectionlost"),a.errorCode&&this.$10.eventLogDisconnect({duration:Date.now()-this.$13,errorCode:a.errorCode,errorMessage:a.errorMessage,sessionID:this.$9}),this.$10.debugTrace("connect","connection lost"),this.$19.onConnectionLost(),this.$37()};d.$30=function(a){};d.$33=function(a,b){c("InstagramODS").incr("web.mqtt.protocol.onmessagearrived");this.$10.debugTrace("onMessageArrived","Message received on "+a);this.$19.onMessage(a);try{this.$3(a,b)}catch(a){this.$10.logError(a,"Listener threw error"),c("InstagramODS").incr("web.mqtt.listener_error")}};d.$34=function(a){c("InstagramODS").incr("web.mqtt.protocol.onmessagedelivered");var b=a!=null?a:"null";this.$10.debugTrace("onMessageDelivered","Delivered Message {ID: "+b+"}");if(a==null)return;b=this.$15.get(a);if(b==null)return;this.$15["delete"](a);b.resolve()};d.$22=function(a){this.$15.forEach(function(b,c,d){b.reject(new Error(a))}),this.$15.clear()};d.$39=function(a){var b=this,c=new Set(a);c.forEach(function(a){b.$14.has(a)||b.unsubscribe(a)});a=new Set(this.$14);a.forEach(function(a){c.has(a)||b.subscribe(a)})};d.$36=function(a,b){try{c("InstagramODS").incr("web.mqtt.js_error_in_init");var d=a?a.message:"error";this.$10.debugTrace("onError",b+": "+d);this.$2(a)}catch(a){c("InstagramODS").incr("web.mqtt.js_error_in_error_logging"),this.$10.logError(a,"JS error while trying to log previous error")}};return a}();g["default"]=a}),98);
__d("PolarisMqttChannel",["FBLogger","InstagramODS","PolarisChannelClientID","PolarisIrisSubscribeChecker","PolarisMqttAnalyticsHook","PolarisMqttConnection","PolarisMqttEnv","PolarisMqttUserName","PolarisMqttUtils","Promise","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i=60*1e3;a=function(){function a(a){var b=this,d=a.appId,e=a.capabilities,f=a.chatVisibility;f=f===void 0?!0:f;var g=a.clientCapabilities,h=a.endpoint,i=a.igSpecificOptions,j=a.initialSubscribedTopics,k=a.observer;a=a.userFbid;this.$8=c("PolarisMqttEnv").Env.getLoggerInstance();this.$8.setAppId(d);this.$9=new(c("PolarisMqttUserName"))(a,e,g,c("PolarisChannelClientID").getID(),d,f,i);this.$1=h;this.$5="Disconnected";this.$2=[k];this.$4=new Set();this.$6=new Map();this.$7=new(c("PolarisMqttConnection"))(i);(i==null?void 0:i.deviceId)!=null?this.$3=i.deviceId:this.$3=c("uuidv4")();this.$13=new(c("PolarisMqttAnalyticsHook"))();this.$7.addHook(this.$13);this.$7.addHook(new(c("PolarisIrisSubscribeChecker"))(function(){return b.$4.size>0}));this.$10=!1;this.$12=new Map();this.$11=[];this.$14(j)}var d=a.prototype;d.$14=function(a){var b=this;if(this.$7.isRunning()){this.$15("run","Connection started calling run again");return}if(c("PolarisMqttEnv").Env.genGk(c("PolarisMqttEnv").MqttGkNames.mqtt_ws_polling_enabled))if(c("PolarisMqttEnv").Env.genGk(c("PolarisMqttEnv").MqttGkNames.mqtt_ws_forced_polling_only)){this.$15("MqttChannel","Websocket disabled, will do long polling only");return}else if(!c("PolarisMqttUtils").hasWSSupport()){this.$15("MqttChannel","Websocket Unavailable, will do long polling only");c("InstagramODS").incr("web.mqtt.ws_unavailable_polling");return}this.$7.run({endpoint:this.$1,extraConnectMessageProvider:function(){return b.$16()},mqttUserName:this.$9,onJSError:function(a){b.$17(a)},onMessageReceived:function(a,c){b.$18(a,c)},onStateChange:function(a){b.$19(a)},subscribedTopics:a})};d.shutdown=function(){this.$7&&this.$7.shutdown()};d.publish=function(a,b,c){c===void 0&&(c={qos:1,skipBuffer:!1});return c.qos===0?this.$20(a,b):this.$21(a,b,c)};d.$20=function(a,b){return this.$7.publish(a,b,0)};d.$21=function(a,d,e){var f={reject:function(a){},resolve:function(){}},g=new(h||(h=b("Promise")))(function(a,b){f.resolve=a,f.reject=b}),i=c("PolarisMqttEnv").Env.random();d={ack:f,options:e,payload:d,publishToken:i,timeoutId:null,topic:a};e.skipBuffer?this.$7.connectionState()==="Connecting"?this.$11.push(d):this.$22(d):(d.timeoutId=this.$23(i),this.$12.set(i,d),this.$24(d));return g};d.$22=function(a){c("PolarisMqttUtils").promiseDone(this.$7.publish(a.topic,a.payload,a.options.qos),function(){a.ack.resolve()},function(b){a.ack.reject(b)})};d.$24=function(a){var b=this;c("PolarisMqttUtils").promiseDone(this.$7.publish(a.topic,a.payload,a.options.qos),function(){return b.$25(a)},function(){})};d.subscribe=function(a,b){this.$7.subscribe(a);var c=this.$6.get(a);!c?(c=[b],this.$6.set(a,c)):c.push(b)};d.subscribeChannelEvents=function(a){this.$2.push(a)};d.registerExtraConnectPayloadProvider=function(a){var b=this;this.$4.add(a);if(this.$7.isRunning()){a=a.getPublishMessages();a.forEach(function(a){b.publish(a.topic,a.payload,{qos:a.qos,skipBuffer:!0})["catch"](function(a){return b.$8.logError(a,a==null?void 0:a.message)})})}};d.unregisterExtraConnectPayloadProvider=function(a){this.$4["delete"](a)};d.unsubscribe=function(a){this.$7.unsubscribe(a),this.$6["delete"](a)};d.getConnectionState=function(){return this.$5};d.getEndpoint=function(){return this.$1};d.addHook=function(a){this.$7.addHook(a)};d.removeHook=function(a){this.$7.removeHook(a)};d.testOnlyMessageReceived=function(a,b){this.$18(a,b)};d.$26=function(a){var b=this.$12.get(a);b!=null&&b.timeoutId!=null&&c("PolarisMqttEnv").Env.clearTimeout(b.timeoutId);this.$12["delete"](a)};d.$23=function(a){var b=this;return c("PolarisMqttEnv").Env.setTimeout(function(a){var d=b.$12.get(a);if(!d)return;var e=d.topic;c("InstagramODS").incr("web.mqtt.publish_timeout");b.$8.debugTrace("publish_timeout","Timeout publishing topic: "+e+" publishToken: "+a);b.$26(a);d.ack.reject(new Error("Publish Timed Out"))},i,a)};d.$25=function(a){var b=a.publishToken,d=this.$12.get(b);if(!d)return;this.$26(b);a.ack.resolve();this.$8.debugTrace("publish_success","Topic: "+a.topic+" publishToken: "+a.publishToken);c("InstagramODS").incr("web.mqtt.publish_success")};d.$18=function(a,b){var d=this.$6.get(a);if(!d)this.$8.debugTrace("_onMessageReceived",a+" being dropped, no listeners");else for(a of d)try{a(b)}catch(a){this.$8.logError(a,"Listener exception"),c("InstagramODS").incr("web.mqtt.listener_error")}};d.$17=function(a){if(c("PolarisMqttEnv").Env.genGk(c("PolarisMqttEnv").MqttGkNames.mqtt_ws_polling_enabled)){a.isRecoverable?c("InstagramODS").incr("web.mqtt.recoverable_error_skipped"):c("InstagramODS").incr("web.mqtt.unrecoverable_error_skipped");return}a.isRecoverable?c("InstagramODS").incr("web.mqtt.recoverable_error_not_skipped"):c("InstagramODS").incr("web.mqtt.unrecoverable_error_not_skipped");a.isRecoverable||(this.$10=!0);this.$27(a)};d.$27=function(a){for(var b of this.$2)b.onJSError&&b.onJSError(a)};d.$19=function(a){var b=this;a==="Connecting"?(this.$11.forEach(function(a){a.ack.reject(new Error("Client Reconnecting"))}),this.$11=[]):a==="TransportConnected"&&(this.$11.forEach(function(a){b.$22(a)}),this.$11=[],this.$12.forEach(function(a,c,d){b.$24(a)}));this.$5=this.$28(a);this.$15("_changeState","Connection state = "+a);this.$29()};d.$28=function(a){switch(a){case"Connecting":case"TransportConnected":return"Connecting";case"Connected":return"Connected";case"Disconnected":return"Disconnected"}throw c("FBLogger")("ig_web").mustfixThrow("Unknown state "+a)};d.$29=function(){for(var a of this.$2)a.onMQTTStateChanged(this.$5)};d.$16=function(){var a=this,b=[];this.$4.forEach(function(d){try{d=d.getPublishMessages();Array.prototype.push.apply(b,d)}catch(b){a.$8.logError(b,"ConnectPayload provider exception"),c("InstagramODS").incr("web.mqtt.connectPayloadProvider_error")}});return b};d.$15=function(a,b){this.$8.debugTrace(a,"Mqtt channel: "+b)};d.setForegroundState=function(a){this.$9&&this.$9.setForegroundState(a)};d.setChatVisibility=function(a){this.$9&&this.$9.setChatVisibility(a)};return a}();g["default"]=a}),98);
__d("PolarisMqttLogger",["InstagramODS","PolarisChannelClientID","PolarisDirectLogger","PolarisMqttEnv"],(function(a,b,c,d,e,f,g){"use strict";a="mqtt_client";var h=null,i=new(d("PolarisDirectLogger").DirectLogger)(a,c("PolarisChannelClientID").getID()),j={CLIENT_ERROR:"mqtt_client_error",CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish"};b=function(){a.getInstance=function(){h||(h=new a());return h};function a(){this.$1=0,this.$2=Date.now(),this.$3=c("PolarisChannelClientID").getID()}var b=a.prototype;b.setAppId=function(a){this.$1===0&&(this.$1=a)};b.eventLogConnect=function(a){var b=a.attemptNumber,d=a.connectionStatus,e=a.duration,f=a.errorCode,g=a.errorMessage;a.failTotal;var h=a.hostname,i=a.publishes,k=a.sessionID,l=a.subscribedTopics;a.successTotal;d?c("InstagramODS").incr("web.mqtt.mqtt_client_connect.success"):c("InstagramODS").incr("web.mqtt.mqtt_client_connect.failed");a={attempt_number:b,connection_status:d,device_id:this.$3,duration:e,error_code:f,error_message:g,hostname:h,href:window.location.hostname,logged_in:c("PolarisMqttEnv").Env.isUserLoggedInNow(),publishes:i,session_id:k,subscribed_topics:l};this.$4(j.CONNECT,a)};b.eventLogPull=function(a){var b=a.duration,d=a.errorMessage,e=a.hostname,f=a.pullEventName,g=a.sessionID;a=a.status;a={connection_status:a,device_id:this.$3,duration:b,error_message:d,hostname:e,href:window.location.hostname,logged_in:c("PolarisMqttEnv").Env.isUserLoggedInNow(),session_id:g};this.$4(f,a)};b.eventLogDisconnect=function(a){var b=a.duration,d=a.errorCode,e=a.errorMessage;a=a.sessionID;c("InstagramODS").incr("web.mqtt.mqtt_client_disconnect");b={device_id:this.$3,duration:b,error_code:d,error_message:e,href:window.location.hostname,session_id:a};this.$4(j.DISCONNECT,b)};b.eventLogPublish=function(a){a.connectionStatus;a.publishStatus;a.sessionID;a=a.topic;c("InstagramODS").incr("web.mqtt.mqtt_client_publish");c("InstagramODS").incr_CAREFUL_WHEN_USE_DYNAMIC_KEY("web.mqtt.mqtt_client_publish."+a)};b.logError=function(a,b){c("PolarisMqttEnv").Env.scheduleLoggingCallback(function(){i.logError(b,a)})};b.eventLogMiscellaneousError=function(a){a=a.errorMessage;a={device_id:this.$3,error_message:a,href:window.location.hostname,logged_in:c("PolarisMqttEnv").Env.isUserLoggedInNow(),time_passed:Date.now()-this.$2};this.$4(j.CLIENT_ERROR,a)};b.logErrorWarn=function(a,b){c("PolarisMqttEnv").Env.scheduleLoggingCallback(function(){i.logError(b,a)})};b.logWarn=function(a,b){};b.debugTrace=function(a,b){c("PolarisMqttEnv").Env.scheduleLoggingCallback(function(){i.debugTrace(a,b)})};b.bumpCounter=function(a){};b.$4=function(a,b){var d=this;c("PolarisMqttEnv").Env.scheduleLoggingCallback(function(){b.event_type=a,b.app_id=d.$1,b.online=d.$5(),i.logDirectEvent(a,b)})};b.$5=function(){return window.navigator&&window.navigator.onLine!==void 0?window.navigator.onLine:!1};return a}();g["default"]=b}),98);
__d("polarisSetTimeoutAcrossTransitions",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){for(var c=arguments.length,d=new Array(c>2?c-2:0),e=2;e<c;e++)d[e-2]=arguments[e];return setTimeout.apply(void 0,[a,b].concat(d))}f["default"]=a}),66);
__d("PolarisMqttEnvInitializer",["PolarisIsLoggedIn","PolarisMqttEnv","PolarisMqttLogger","PolarisWebStorage","polarisSetTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";var h="mqtt:";a={initialize:function(){c("PolarisMqttEnv").Env.initialize(null,d("PolarisIsLoggedIn").isLoggedIn,null,c("polarisSetTimeoutAcrossTransitions"),function(){return c("PolarisMqttLogger").getInstance()},null,null,null,null,function(a,b){var d=c("PolarisWebStorage").getLocalStorage();if(d){d=d.getItem(h+a);if(d!=null)return d}return b},function(a,b){var d=c("PolarisWebStorage").getLocalStorage();d&&(b==null?d.removeItem(h+a):d.setItem(h+a,b))})}};b=a;g["default"]=b}),98);
__d("PolarisDirectMQTT",["InstagramODS","MercuryLocalIDs","PolarisCallGatingHelpers","PolarisConfig","PolarisDeviceOrMachineId","PolarisDirectConstants","PolarisDirectDeltaHandlers","PolarisDirectGraphQLSubscription","PolarisDirectIrisSubscription","PolarisDirectLogger","PolarisDirectSkywalkerSubscription","PolarisLiveDeltaHandler","PolarisLocales","PolarisMediaOverlayInfoTypes","PolarisMqttChannel","PolarisMqttEnvInitializer","PolarisReactRedux.react","nullthrows","polarisArraySplitChunks","polarisDeveloperSettings","polarisForEachAsync","randomInt"],(function(a,b,c,d,e,f,g){"use strict";var h=20;a=function(){function a(a,b){var e=this;this.$8=0;this.$14=function(a){var b;try{b=JSON.parse(a.substr(0,a.length-1))}catch(a){e.$4.logError("Could not parse mqttMessages",a);return}a=b.payload.header;if(a.type===4&&a.conferenceName.includes("ROOM")){var d,f;d=((d=b.payload.body)==null?void 0:(d=d.ringRequest)==null?void 0:d.ringType)%2===1;f=(f=b.payload.body)==null?void 0:(f=f.ringRequest)==null?void 0:(f=f.appMessages)==null?void 0:f.find(function(a){return a.body.genericMessage.topic==="ring_data"});var g="",h="",i="",j=[];if(f){f=JSON.parse(f==null?void 0:(f=f.body)==null?void 0:(f=f.genericMessage)==null?void 0:f.data);var k=f.display_name,l=f.display_uri,m=f.group_name,n=f.ig_thread_id;f=f.participant_usernames;g=n;i=k;j.push(l);if(m)h=m;else{n=f;try{n=JSON.parse(f)}catch(a){}h=Array.isArray(n)?[k].concat(n).join(", "):k}}e.$6(a.type,a.serverInfoData,g,d,h,j,i);c("InstagramODS").incr("web.rtc.ack_ring_message");e.$15(a.conferenceName,a.sequenceNumber,a.serverInfoData,a.transactionId,a.type,a.conferenceType)}else a.type===5&&a.conferenceName.includes("ROOM")?(e.$6(a.type,a.serverInfoData,"",!1,"",[],""),c("InstagramODS").incr("web.rtc.ack_dismiss_message"),e.$15(a.conferenceName,a.sequenceNumber,a.serverInfoData,a.transactionId,a.type,a.conferenceType)):c("InstagramODS").incr("web.rtc.rtc_message_ignored")};this.$16=function(a){var b=c("nullthrows")(e.$1),f;try{f=JSON.parse(a)}catch(a){e.$4.logError("Could not parse mqttMessages",a);return}if(!Array.isArray(f)){e.$4.debugTrace("parsed_message_not_array",typeof f);return}c("polarisForEachAsync")(c("polarisArraySplitChunks")(f,h),function(a){d("PolarisReactRedux.react").batch(function(){for(var c of a){var d=c.data,f=c.event,g=c.mutation_token,h=c.seq_id;e.$4.debugTrace("parsed_message",{event:f,mutation_token:g});if(f!=="patch"){e.$4.debugTrace("skipped_message",{event:f});return}if(!Array.isArray(d)){e.$4.debugTrace("parsed_message_bad_operations",typeof d);return}for(f of d)b.handleDelta(f,g);if(h){d=e.$2.subscription_type;e.$4.debugTrace("seq_id",{seq_id:h,subscriptionType:d});d==="message"&&b.onSeqIdUpdated(h)}}})})};this.$17=function(a){try{a=JSON.parse(a);if(a.status==="ok"){var b;(a==null?void 0:(b=a.payload)==null?void 0:b.activity_status)==null?e.$4.logDirectEvent("send_message_response_success"):e.$4.logDirectEvent("send_activity_response_success")}else{(a==null?void 0:(b=a.payload)==null?void 0:b.activity_status)==null?e.$4.logError("send_message_response_failed"):e.$4.logDirectEvent("send_activity_response_failed")}}catch(a){e.$4.logError("send_message_response_parse_failed",a)}};this.$18=function(a){e.$4.debugTrace("state_changed",a);var b=c("nullthrows")(e.$1);if(a==="Connected"){var f=c("nullthrows")(e.$5);f.subscribe("/ig_message_sync",e.$16);f.subscribe("/ig_send_message_response",e.$17);d("PolarisCallGatingHelpers").isIncomingCallEnabled()&&!d("PolarisCallGatingHelpers").isWebCallingEnabled()&&f.subscribe("/pubsub",e.$14);e.$3||(e.$3=new(d("PolarisDirectIrisSubscription").DirectIrisSubscription)(b,e.$2,f,e.$4.getDebugId()));e.$3.subscribe();e.$10||(e.$10=new(d("PolarisDirectGraphQLSubscription").DirectGraphQLSubscription)(b,f,e.$4.getDebugId()));e.$2.subscription_type==="message"?(e.$9||(e.$9=new(d("PolarisDirectSkywalkerSubscription").DirectSkywalkerSubscription)(b,f,e.$4.getDebugId())),e.$9.subscribe()):e.$4.debugTrace("skip_skywalker",e.$2);e.$10&&e.$10.subscribe()}else if(a==="Disconnected"){e.$3&&(e.$3.unsubscribe(),e.$3=null);e.$9&&(e.$9.unsubscribe(),e.$9=null);e.$10&&(e.$10.unsubscribeGraphQL(),e.$10=null);f=e.$5;f&&(f.unsubscribe("/ig_message_sync"),f.unsubscribe("/ig_send_message_response"),d("PolarisCallGatingHelpers").isIncomingCallEnabled()&&!d("PolarisCallGatingHelpers").isWebCallingEnabled()&&f.unsubscribe("/pubsub"))}b.onMqttConnectivityChanged(a)};this.$4=new(d("PolarisDirectLogger").DirectLogger)("DirectMQTT",b);this.$4.debugTrace("ctor",a);this.$1=null;this.$2=a;this.$3=null;this.$5=null;this.$9=null;this.$10=null}var b=a.prototype;b.$11=function(){return c("nullthrows")(d("PolarisConfig").getViewerId())};b.$12=function(){return parseInt(d("PolarisConfig").getIGAppID(),10)};b.$13=function(){return d("PolarisDeviceOrMachineId").getDeviceOrMachineId()};b.$15=function(a,b,d,e,f,g){var h=this;if(this.$7==null){var i=c("randomInt")(0,4294967294)+1;this.$7=String(i)}i={endpoint:{appId:this.$12(),deviceId:this.$13(),userId:this.$11()},jsonPayload:{body:{ringResponse:{deviceCapabilities:[],deviceStatus:0}},header:{clientSessionId:this.$7,clientStack:5,conferenceName:a,conferenceType:g,messageTags:[],responseStatusCode:200,retryCount:0,sequenceNumber:b,serverInfoData:d,transactionId:e,type:f}}};c("nullthrows")(this.$5).publish("/rtc_multi",JSON.stringify(i))["catch"](function(a){var b;f===4?c("InstagramODS").incr("web.rtc.ack_ring_message_failed"):f===5?c("InstagramODS").incr("web.rtc.ack_dismiss_message_failed"):c("InstagramODS").incr("web.rtc.ack_message_failed");b=(b=(b=h.$5)==null?void 0:b.getConnectionState())!=null?b:"Unknown";h.$4.logError("ack_rtc_message_failed",a,{conference_type:g,message_type:f,mqtt_state:b});throw a})};b.$19=function(a){var b=this;this.$4.logDirectEvent("send_attempt",{action:a.action,type:a.item_type||""});return c("nullthrows")(this.$5).publish("/ig_send_message",JSON.stringify(babelHelpers["extends"]({client_context:d("MercuryLocalIDs").generateOfflineThreadingID(),device_id:this.$13()},a)))["catch"](function(a){b.$4.logError("send_message_failed",a);throw a})};b.sendRtcHangupRequest=function(a){var b=this;a={endpoint:{appId:this.$12(),deviceId:this.$13(),userId:this.$11()},jsonPayload:{body:{hangupRequest:{detailedReasonString:"",reason:0}},header:{clientSessionId:this.$7,clientStack:5,messageTags:[],retryCount:0,sequenceNumber:this.$8++,serverInfoData:a,transactionId:String(c("randomInt")(0,4294967294)+1),type:2}}};return c("nullthrows")(this.$5).publish("/rtc_multi",JSON.stringify(a))["catch"](function(a){b.$4.logError("send_rtc_hangup_message_failed",a);throw a})};b.sendTextMessage=function(a,b,c,e,f){return this.$19({action:"send_item",item_type:d("PolarisDirectConstants").ThreadItemType.TEXT,mutation_token:c,replied_to_client_context:f,replied_to_item_id:e,text:b,thread_id:a})};b.sendMediaShare=function(a,b,c,e){var f=d("PolarisDirectConstants").ThreadItemType.MEDIA_SHARE;e==="clips"&&(f=d("PolarisDirectConstants").ThreadItemType.CLIP_SHARE);return(c==null?void 0:c.overlay_layout)===d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_LAYOUTS.MEDIA_COVER||(c==null?void 0:c.overlay_layout)===d("PolarisMediaOverlayInfoTypes").MEDIA_OVERLAY_LAYOUTS.MEDIA_COVER_WITH_BOTTOM_BANNER?this.$19({action:"send_item",item_type:f,media_id:b,share_treatment_title:d("PolarisDirectConstants").InformTreatmentTitleValues.FALLBACK,share_treatment_type:d("PolarisDirectConstants").InformTreatmentTypeValues.WARNING_SCREENS,thread_id:a}):this.$19({action:"send_item",item_type:f,media_id:b,thread_id:a})};b.sendLike=function(a,b){return this.$19({action:"send_item",item_type:d("PolarisDirectConstants").ThreadItemType.LIKE,mutation_token:b,thread_id:a})};b.indicateTypingActivity=function(a,b){return this.$19({action:"indicate_activity",activity_status:a,thread_id:b})};b.markVisualItemSeen=function(a,b){return this.$19({action:"mark_visual_item_seen",item_ids:JSON.stringify([a]),target_item_type:"voice_media",thread_id:b})};b.modifyLikeReaction=function(a,b,c,d,e){return this.$19({action:"send_item",emoji:e!=null?e:"",item_id:a,item_type:"reaction",node_type:"item",reaction_status:d,reaction_type:"like",target_item_type:b,thread_id:c})};b.disconnect=function(){this.$4.debugTrace("disconnect_start"),this.$3?(this.$4.debugTrace("unsubscribe_iris"),c("nullthrows")(this.$3).unsubscribe(),this.$3=null):this.$4.debugTrace("no_iris"),this.$9?(this.$4.debugTrace("unsubscribe_skywalker"),this.$9=null):this.$4.debugTrace("no_skywalker"),this.$10?(this.$4.debugTrace("unsubscribe_graphql"),this.$10=null):this.$4.debugTrace("no_graphql"),this.$5?(this.$4.debugTrace("shutdown_channel"),c("nullthrows")(this.$5).shutdown(),this.$5=null):this.$4.debugTrace("no_channel"),this.$1&&(this.$1=null),this.$4.debugTrace("disconnect_end")};b.connect=function(a,b){var e=this;this.$4.debugTrace("connect_start");this.disconnect();this.$1=new(d("PolarisDirectDeltaHandlers").DirectDeltaHandlers)(a,this.$4.getDebugId());this.$6=b;a={onJSError:function(a){e.$4.logError("mqtt_js_error",a)},onMQTTStateChanged:this.$18};b={appSpecificInfo:{},deviceId:this.$13()};var f=c("PolarisLocales").language_code;f!=null&&(b.appSpecificInfo["Accept-Language"]=f);c("PolarisMqttEnvInitializer").initialize();f={appId:this.$12(),capabilities:0,chatVisibility:!0,clientCapabilities:1,endpoint:d("PolarisDirectConstants").PROD_MQTT_GATEWAY,igSpecificOptions:b,initialSubscribedTopics:[],observer:a,userFbid:this.$11()};this.$5=new(c("PolarisMqttChannel"))(f);this.$4.debugTrace("connect_end")};b.subscribeToLiveEvent=function(a,b,d){var e=this.$10;if(e==null)return;b=new(c("PolarisLiveDeltaHandler"))(b);e.enableLiveEventHandler(a,b,d);e.subscribe()};b.unsubscribeToLiveEvent=function(a){var b=this.$10;if(b==null)return;b.disableLiveEventHandler(a);b.subscribe()};b.getLogger=function(){return this.$4};return a}();g.DirectMQTT=a}),98);/*FB_PKG_DELIM*/
__d("EBMainThreadEBDBApiDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("EBMainThreadEBDBApi").__setRef("EBMainThreadEBDBApiDeferred");function a(){return h.load().then(function(a){return a.startListeningDeviceRegistrations()})}function b(a){return h.load().then(function(b){return b.trackOverprompting(a)})}function d(a){return h.load().then(function(b){return b.addNewDevice(a)})}function e(){return h.load().then(function(a){return a.getEBDBDump()})}function f(){return h.load().then(function(a){return a.clearWorkerState()})}function i(a,b){return h.load().then(function(c){return c.trackConsistency(a,b)})}g.startListeningDeviceRegistrations=a;g.trackOverprompting=b;g.addNewDevice=d;g.getEBDBDump=e;g.clearWorkerState=f;g.trackConsistency=i}),98);
__d("LSWriteSupplementalMessage",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][writeSupplementalMessage] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.filter(c.db.table(302).fetch(),function(b){return b.threadId===a[1]&&b.toplevelOfflineThreadingId===a[2]&&b.supplementalKey===a[3]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[2]=void 0:(b=a.item,d[2]=b.messageTimestampMs)})},function(b){return c.i64.neq(d[2],void 0)?c.sequence([function(b){return c.i64.gt(d[2],a[5])?c.resolve((b=[!1,c.i64.cast([0,851])],d[12]=b[0],d[13]=b[1],b)):c.sequence([function(b){return c.forEach(c.filter(c.db.table(302).fetch(),function(b){return b.threadId===a[1]&&b.toplevelOfflineThreadingId===a[2]&&b.supplementalKey===a[3]}),function(a){return a["delete"]()})},function(b){return c.db.table(302).add({pk:void 0,messagePayload:a[0],threadId:a[1],toplevelOfflineThreadingId:a[2],supplementalKey:a[3],offlineThreadingId:a[4],messageTimestampMs:a[5]})},function(a){return a=[!0,void 0],d[12]=a[0],d[13]=a[1],a}])},function(a){return a=[d[12],d[13]],d[4]=a[0],d[5]=a[1],a}]):c.sequence([function(b){return c.forEach(c.filter(c.db.table(302).fetch(),function(b){return b.threadId===a[1]&&b.toplevelOfflineThreadingId===a[2]&&b.supplementalKey===a[3]}),function(a){return a["delete"]()})},function(b){return c.db.table(302).add({pk:void 0,messagePayload:a[0],threadId:a[1],toplevelOfflineThreadingId:a[2],supplementalKey:a[3],offlineThreadingId:a[4],messageTimestampMs:a[5]})},function(a){return a=[!0,void 0],d[4]=a[0],d[5]=a[1],a}])},function(a){return d[6]=c.i64.of_float(Date.now()),d[7]=c.i64.random(),d[9]="Finishing execution. Execution time: ",d[10]=c.i64.to_string(c.i64.sub(d[6],d[0])),d[11]=" ms",d[8]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][writeSupplementalMessage] ",d[8],d[9],d[8],d[10],d[8],d[11]].join("")),c.i64.eq(c.i64.mod_(d[7],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[12]=",",d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"writeSupplementalMessage",[d[9],d[12],d[10],d[12],d[11]].join(""),d[13],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[4],d[5]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMPSWriteSupplementalMessageStoredProcedure";a.__tables__=["local_message_persistence_store_supplemental"];e.exports=a}),null);
__d("LSWriteSupplementalMessageStoredProcedure",["LSSynchronousPromise","LSWriteSupplementalMessage","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSWriteSupplementalMessage"),e.messagePayload,e.threadId,e.toplevelOfflineThreadingId,e.supplementalKey,e.offlineThreadingId,e.messageTimestampMs);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSWriteTopLevelMessage",["LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(b){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][writeTopLevelMessage] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.filter(c.db.table(301).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[2]=void 0:(b=a.item,d[2]=b.messageTimestampMs)})},function(b){return c.i64.neq(d[2],void 0)?c.sequence([function(b){return c.i64.gt(d[2],a[3])?c.resolve((b=[!1,c.i64.cast([0,851])],d[12]=b[0],d[13]=b[1],b)):c.sequence([function(b){return c.filter(c.db.table(303).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[14]=!1:(a.item,d[14]=!0)})},function(b){return d[14]?c.sequence([function(b){return c.forEach(c.filter(c.db.table(303).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]}),function(b){var c=b.update;b.item;return c({deletedMessagePayload:a[0],isLocalOnlyMessage:a[4],messageTimestampMs:a[3]})})},function(b){return c.forEach(c.filter(c.db.table(301).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]&&c.i64.eq(b.messageTimestampMs,c.i64.cast([-1,4294967295]))}),function(b){var c=b.update;b.item;return c({messageTimestampMs:a[3]})})},function(a){return a=[!1,c.i64.cast([0,852])],d[16]=a[0],d[17]=a[1],a}]):c.sequence([function(b){return c.forEach(c.filter(c.db.table(301).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]}),function(a){return a["delete"]()})},function(b){return c.db.table(301).add({pk:void 0,messagePayload:a[0],threadId:a[1],offlineThreadingId:a[2],messageTimestampMs:a[3],isLocalOnlyMessage:a[4],extraData:a[5]})},function(a){return a=[!0,void 0],d[16]=a[0],d[17]=a[1],a}])},function(a){return a=[d[16],d[17]],d[12]=a[0],d[13]=a[1],a}])},function(a){return a=[d[12],d[13]],d[4]=a[0],d[5]=a[1],a}]):c.sequence([function(b){return c.filter(c.db.table(303).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[12]=!1:(a.item,d[12]=!0)})},function(b){return d[12]?c.sequence([function(b){return c.forEach(c.filter(c.db.table(303).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]}),function(b){var c=b.update;b.item;return c({deletedMessagePayload:a[0],isLocalOnlyMessage:a[4],messageTimestampMs:a[3]})})},function(b){return c.forEach(c.filter(c.db.table(301).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]&&c.i64.eq(b.messageTimestampMs,c.i64.cast([-1,4294967295]))}),function(b){var c=b.update;b.item;return c({messageTimestampMs:a[3]})})},function(a){return a=[!1,c.i64.cast([0,852])],d[14]=a[0],d[15]=a[1],a}]):c.sequence([function(b){return c.forEach(c.filter(c.db.table(301).fetch(),function(b){return b.threadId===a[1]&&b.offlineThreadingId===a[2]}),function(a){return a["delete"]()})},function(b){return c.db.table(301).add({pk:void 0,messagePayload:a[0],threadId:a[1],offlineThreadingId:a[2],messageTimestampMs:a[3],isLocalOnlyMessage:a[4],extraData:a[5]})},function(a){return a=[!0,void 0],d[14]=a[0],d[15]=a[1],a}])},function(a){return a=[d[14],d[15]],d[4]=a[0],d[5]=a[1],a}])},function(a){return d[6]=c.i64.of_float(Date.now()),d[7]=c.i64.random(),d[9]="Finishing execution. Execution time: ",d[10]=c.i64.to_string(c.i64.sub(d[6],d[0])),d[11]=" ms",d[8]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][writeTopLevelMessage] ",d[8],d[9],d[8],d[10],d[8],d[11]].join("")),c.i64.eq(c.i64.mod_(d[7],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[12]=",",d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"writeTopLevelMessage",[d[9],d[12],d[10],d[12],d[11]].join(""),d[13],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[4],d[5]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMPSWriteTopLevelMessageStoredProcedure";a.__tables__=["local_message_persistence_store","local_message_persistence_store_deleted_messages"];e.exports=a}),null);
__d("LSWriteTopLevelMessageStoredProcedure",["LSSynchronousPromise","LSWriteTopLevelMessage","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSWriteTopLevelMessage"),e.messagePayload,e.threadId,e.offlineThreadingId,e.messageTimestampMs,e.isLocalOnlyMessage,e.extraData);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MessageBackupTagsDelimiter",[],(function(a,b,c,d,e,f){"use strict";a=":";f.INSTAMADILLO_TAG_DELIMITER=a}),66);
__d("EncryptedBackupsWriteToMPSTables",["EncryptedBackupsUploadEntity","FBLogger","I64","IGDWEBUploadMessageUtils","LSFactory","LSWriteSupplementalMessageStoredProcedure","LSWriteTopLevelMessageStoredProcedure","MessageBackupTagsDelimiter","WAErrorMessage","WAGetSafeQPLError","WAResultOrError","asyncToGeneratorRuntime","gkx","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("ReverbWriteFailureFalcoEvent").__setRef("EncryptedBackupsWriteToMPSTables"),j=c("requireDeferred")("ReverbWriteSuccessFalcoEvent").__setRef("EncryptedBackupsWriteToMPSTables"),k=c("gkx")("8488");function l(a,b,d,e,f,g){e?c("promiseDone")(j.load(),function(c){return c.log(function(){return{backup_action:d,backup_protocol:f,labyrinth_version:0,message_id:a,thread_id:b}})}):c("promiseDone")(i.load(),function(c){return c.log(function(){return{backup_action:d,backup_protocol:f,failure_reason:g,labyrinth_version:0,message_id:a,thread_id:b}})})}function a(a,b,c,d,e){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){var i=b.backupActionType,j=b.instamadilloItemId,m=b.msgId,n=b.originalMsgProtocolId,o=b.protobuf,p=b.serverTs,q=b.sortOrderMs;b=b.supplementalKey;g==null?void 0:g.addPoint("mps_tables_write_start");m=m.externalId;n=n==null?void 0:n.externalId;j=j!=null?j:q;if(j==null){g==null?void 0:g.addPoint("mps_tables_write_missing_protobuf_ts");return d("WAResultOrError").makeError({errorCode:null,errorMsg:"protobufTimestampMs is null when writing to MPS tables"})}q=(h||(h=d("I64"))).of_float(j);j=!1;var r=k?"protobuf_only":"dual_upload";f&&(r="open_eb_ttlc");f=null;switch(i){case 1:g==null?void 0:g.addPoint("mps_top_level_write_start");try{i=(yield c("LSWriteTopLevelMessageStoredProcedure")(c("LSFactory")(a),{isLocalOnlyMessage:!1,messagePayload:d("EncryptedBackupsUploadEntity").getEbBackupMessageBytesBuffer(o),messageTimestampMs:q,offlineThreadingId:m,threadId:e}));var s=i[0];i=i[1];f=i;s&&(j=!0);l(m,e,"upsert_top_level",s,r);g==null?void 0:g.addPoint("mps_top_level_write",{bool:{mps_top_level_write_succesful:s}})}catch(a){l(m,e,"upsert_top_level",!1,r,d("WAErrorMessage").maybeGetMessageFromError(a)),g==null?void 0:g.addPoint("mps_top_level_write_error",{string:{mps_top_level_write_error:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a)}})}break;case 2:g==null?void 0:g.addPoint("mps_supplemental_write_start");if(n==null||b==null)l(m,e,"upsert_supplemental",!1,r),c("FBLogger")("labyrinth_web").warn("Missing toplevelOfflineThreadingId or supplementalKey when writing to MPS tables");else try{i=(yield c("LSWriteSupplementalMessageStoredProcedure")(c("LSFactory")(a),{messagePayload:d("EncryptedBackupsUploadEntity").getEbBackupMessageBytesBuffer(o),messageTimestampMs:q,offlineThreadingId:m,supplementalKey:b,threadId:e,toplevelOfflineThreadingId:n}));s=i[0];q=i[1];f=q;s&&(j=!0);l(m,e,"upsert_supplemental",s,r);g==null?void 0:g.addPoint("mps_supplemental_write",{bool:{mps_supplemental_write_successful:s}})}catch(a){l(m,e,"upsert_supplemental",!1,r,d("WAErrorMessage").maybeGetMessageFromError(a)),g==null?void 0:g.addPoint("mps_supplemental_write_error",{string:{mps_supplemental_write_error:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a)}})}break;case 4:g==null?void 0:g.addPoint("mps_delete_top_level_with_placeholder_write_start");if(n==null)break;try{b=(yield c("LSWriteTopLevelMessageStoredProcedure")(c("LSFactory")(a),{isLocalOnlyMessage:!1,messagePayload:d("EncryptedBackupsUploadEntity").getEbBackupMessageBytesBuffer(o),messageTimestampMs:(h||(h=d("I64"))).of_float(d("IGDWEBUploadMessageUtils").generateProtobufServerTs(n,p)),offlineThreadingId:m,threadId:e}));i=b[0];q=b[1];f=q;i&&(j=!0);l(n,e,"delete_top_level",i,r);g==null?void 0:g.addPoint("mps_delete_top_level_with_placeholder_write",{bool:{mps_delete_top_level_with_placeholder_write_successful:i}})}catch(a){l(n,e,"delete_top_level_with_placeholder",!1,r,d("WAErrorMessage").maybeGetMessageFromError(a)),g==null?void 0:g.addPoint("mps_delete_top_level_with_placeholder_write_error",{string:{mps_delete_top_level_with_placeholder_write_error:d("WAGetSafeQPLError").getSafeQPLErrorMessage(a)}})}break;case 3:j=!0;n!=null&&l(n,e,"delete_top_level",!1,r);break;default:g==null?void 0:g.addPoint("mps_write_unsupported_backup_action_type"),c("FBLogger")("labyrinth_web").warn("Unsupported backupActionType when writing to MPS tables")}if(j){g==null?void 0:g.addPoint("mps_write_successful");return d("WAResultOrError").makeResult(j)}else{g==null?void 0:g.addPoint("mps_write_unsuccessful");return d("WAResultOrError").makeError({errorCode:f,errorMsg:"Unsuccessful writing to MPS tables"})}});return m.apply(this,arguments)}function e(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){var e=b.msgId,f=b.sortOrderMs;b=b.tags;b!=null&&b.length!==0&&f!=null&&(yield a.local_message_persistence_store_tag_index.put({localMessagePersistenceStoreKey:(h||(h=d("I64"))).of_string(e.externalId),messageTimestampMs:h.of_float(f),offlineThreadingId:e.externalId,tag:b.join(d("MessageBackupTagsDelimiter").INSTAMADILLO_TAG_DELIMITER),threadId:c}))});return n.apply(this,arguments)}g.writeToMPSTables=a;g.writeTagsToMPSTables=e}),98);
__d("LSEncryptedBackupsAttachmentErrorCode",[],(function(a,b,c,d,e,f){a=Object.freeze({NO_ERROR:0,UNKNOWN_ERROR:1,MEDIA_TYPE_MISSING:2,PRODUCT_TYPE_MISSING:3,SERIALIZATION_ERROR:21});f["default"]=a}),66);
__d("LSEncryptedBackupsClientRestoreState",[],(function(a,b,c,d,e,f){a=Object.freeze({RESTORE_IN_PROGRESS:1,RESTORE_COMPLETE:2});f["default"]=a}),66);
__d("LSFindBackup",["LSArrayGetObjectAt","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(a){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsFindBackupStoredProcedure] Beginning execution."),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,e){var f=a.done;a=a.value;return f?(f=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,20]),void 0,void 0],d[1]=f[0],d[2]=f[1],d[3]=f[2],d[4]=f[3],d[5]=f[4],d[6]=f[5],d[7]=f[6],d[8]=f[7],d[9]=f[8],d[10]=f[9],d[11]=f[10],d[12]=f[11],d[13]=f[12],d[14]=f[13],d[15]=f[14],d[16]=f[15],d[17]=f[16],d[18]=f[17],f):(e=a.item,c.sequence([function(a){return d[32]=e.backupTenancy,d[31]=e.encryptionVersion,d[27]=void 0,c.i64.neq(d[27],void 0)?c.resolve(d[28]=d[27]):c.sequence([function(a){return d[33]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[34]=a[0],a})},function(a){return d[34]?d[43]=(d[33].push(c.i64.cast([0,0])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[35]?d[43]=(d[33].push(c.i64.cast([0,2])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[43]=(d[33].push(c.i64.cast([0,3])),d[33]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[43]=(d[33].push(c.i64.cast([0,4])),d[33]):0,d[38]=c.createArray(),d[39]=c.i64.of_int32(d[33].length),c.i64.gt(d[39],c.i64.cast([0,0]))?c.loopAsync(d[39],function(a){return d[43]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[33],d[43]).then(function(a){return a=a,d[44]=a[0],d[45]=a[1],a})},function(a){return d[46]=(d[38].push(d[44]),d[38])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[43]=c.createArray(),d[44]=c.i64.of_int32(d[38].length),c.i64.gt(d[44],c.i64.cast([0,0]))?c.loopAsync(d[44],function(a){return d[46]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[38],d[46]).then(function(a){return a=a,d[47]=a[0],d[48]=a[1],a})},function(a){return d[49]=(d[43].push(c.i64.to_string(d[47])),d[43])}])}):c.resolve()},function(a){return d[45]=d[43].join(","),d[40]=d[45]}])},function(a){return d[38].some(function(a){return c.i64.eq(d[31],a)})?d[41]=d[31]:d[41]=void 0,c.i64.neq(d[41],void 0)?d[42]=d[41]:d[42]=void 0,d[28]=d[42]}])},function(a){return c.i64.neq(d[28],void 0)?d[29]=d[28]:d[29]=c.i64.cast([0,0]),c.i64.neq(d[32],void 0)?d[30]=d[32]:d[30]=c.i64.cast([0,1]),a=[e.backupId,e.deviceId,e.mailboxRootKeyBlob,e.ocmfClientStateBlob,void 0,void 0,d[29],d[30],e.epochAuthPublicKeyBlob,e.epochAuthPrivateKeyBlob,e.devicePublicKeyBlob,e.devicePrivateKeyBlob,e.epochStoragePublicKeyBlob,e.epochStoragePrivateKeyBlob,e.obliviousValidationTokenBlob,e.authorityLevel,void 0,void 0],d[1]=a[0],d[2]=a[1],d[3]=a[2],d[4]=a[3],d[5]=a[4],d[6]=a[5],d[7]=a[6],d[8]=a[7],d[9]=a[8],d[10]=a[9],d[11]=a[10],d[12]=a[11],d[13]=a[12],d[14]=a[13],d[15]=a[14],d[16]=a[15],d[17]=a[16],d[18]=a[17],a}]))})},function(a){return c.i64.neq(d[1],void 0)?d[20]=c.i64.to_string(d[1]):d[20]=void 0,d[21]=c.i64.of_float(Date.now()),d[22]=c.i64.random(),d[24]="Finishing execution. Execution time: ",d[25]=c.i64.to_string(c.i64.sub(d[21],d[0])),d[26]=" ms",d[23]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsFindBackupStoredProcedure] ",d[23],d[24],d[23],d[25],d[23],d[26]].join("")),c.i64.eq(c.i64.mod_(d[22],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[27]=",",d[28]=c.createArray(),void 0!==void 0?d[29]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsFindBackupStoredProcedure",[d[24],d[27],d[25],d[27],d[26]].join(""),d[28],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[20]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsFindBackupStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state"];e.exports=a}),null);
__d("LSFlushDataTrace.nop",["MetaConfig","Promise","ReQL","updateAndFlushLSDataTrace"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(a,e,f){return!c("MetaConfig")._("62")?(h||(h=b("Promise"))).resolve():d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.data_trace_meta).getKeyRange(f)).then(function(d){if(d!=null)return c("updateAndFlushLSDataTrace")(a,f);else return(h||(h=b("Promise"))).resolve()})};a.__nop_name__="LSFlushDataTrace";g["default"]=a}),98);
__d("MAWRestoreRewriteUtils",["qex"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return c("qex")._("656")===!0};g.isOneDBEnabled=a}),98);
__d("LSGetLatestThreadIds.nop",["ExecutionEnvironment","I64","LSVec","MAWBridge","MAWBridgeSafeActionsWorkerAndUI","MAWRestoreRewriteUtils","Promise","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f=[];e=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(e.mi_act_mapping_table)).then(function(a){return a.map(function(a){a=a.jid;return(j||(j=d("I64"))).to_string(a)})}));if(e.length>0){var g=new Set(e);a.forEach(function(a){g.has(a)&&f.push(a)})}return(i||(i=b("Promise"))).resolve([c("LSVec").ofArray(f),!0])});return l.apply(this,arguments)}function m(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableDescending(a.e2ee_threads.index("threadOrder")).take((j||(j=d("I64"))).to_int32(b))));return a.map(function(a){a=a.jid;return a.split("@")[0]})});return n.apply(this,arguments)}function o(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield d("MAWBridgeSafeActionsWorkerAndUI").sendAndReceiveBackendWorkerAndUIShared("getLatestThreadIds",{numThreads:(j||(j=d("I64"))).to_int32(a)}));return a});return p.apply(this,arguments)}a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,l){l===void 0&&(l=!1);if((h||(h=c("ExecutionEnvironment"))).isInWorker)return d("MAWBridge").getBridge().sendAndReceive("event","getLSDBLatestThreadIds",{miActMappingFilteredThreads:l,numThreads:g});if((j||(j=d("I64"))).gt(g,(j||(j=d("I64"))).zero))try{e=d("MAWRestoreRewriteUtils").isOneDBEnabled()?yield m(a,g):yield o(g);return l?k(e,a):(i||(i=b("Promise"))).resolve([c("LSVec").ofArray(e),!0])}catch(a){return(i||(i=b("Promise"))).resolve([c("LSVec").ofArray([]),!1])}return(i||(i=b("Promise"))).resolve([c("LSVec").ofArray([]),!0])});function e(b,c,d,e,f){return a.apply(this,arguments)}return e}();a.__nop_name__="LSGetLatestThreadIds";g["default"]=a}),98);
__d("LSIssueAttachmentRestoreTask",["LSArrayGetObjectAt","LSBase64Encode.nop","LSBinaryToHex.nop","LSCreateDerivedKeys.nop","LSFindBackup","LSGetBlobFromInt64BE.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIssueNewTask","LSLogMebClientEvent.nop","LSOcmfClientMap.nop","LSOpeEncrypt.nop","LSTruncateSortKey.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] Beginning execution."),a[7]!==void 0?d[1]=a[7]:(d[28]=c.i64.random(),d[1]=c.i64.to_string(d[28])),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,e){var f=a.done;a=a.value;return f?(f=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,c.i64.cast([0,20]),void 0,void 0],d[2]=f[0],d[3]=f[1],d[4]=f[2],d[5]=f[3],d[6]=f[4],d[7]=f[5],d[8]=f[6],d[9]=f[7],d[10]=f[8],d[11]=f[9],d[12]=f[10],d[13]=f[11],d[14]=f[12],d[15]=f[13],d[16]=f[14],d[17]=f[15],d[18]=f[16],d[19]=f[17],f):(e=a.item,c.sequence([function(a){return d[33]=e.backupTenancy,d[32]=e.encryptionVersion,d[28]=void 0,c.i64.neq(d[28],void 0)?c.resolve(d[29]=d[28]):c.sequence([function(a){return d[34]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[35]=a[0],a})},function(a){return d[35]?d[44]=(d[34].push(c.i64.cast([0,0])),d[34]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[36]=a[0],a})},function(a){return d[36]?d[44]=(d[34].push(c.i64.cast([0,2])),d[34]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[37]=a[0],a})},function(a){return d[37]?d[44]=(d[34].push(c.i64.cast([0,3])),d[34]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[38]=a[0],a})},function(a){return d[38]?d[44]=(d[34].push(c.i64.cast([0,4])),d[34]):0,d[39]=c.createArray(),d[40]=c.i64.of_int32(d[34].length),c.i64.gt(d[40],c.i64.cast([0,0]))?c.loopAsync(d[40],function(a){return d[44]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[34],d[44]).then(function(a){return a=a,d[45]=a[0],d[46]=a[1],a})},function(a){return d[47]=(d[39].push(d[45]),d[39])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[44]=c.createArray(),d[45]=c.i64.of_int32(d[39].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(a){return d[47]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[39],d[47]).then(function(a){return a=a,d[48]=a[0],d[49]=a[1],a})},function(a){return d[50]=(d[44].push(c.i64.to_string(d[48])),d[44])}])}):c.resolve()},function(a){return d[46]=d[44].join(","),d[41]=d[46]}])},function(a){return d[39].some(function(a){return c.i64.eq(d[32],a)})?d[42]=d[32]:d[42]=void 0,c.i64.neq(d[42],void 0)?d[43]=d[42]:d[43]=void 0,d[29]=d[43]}])},function(a){return c.i64.neq(d[29],void 0)?d[30]=d[29]:d[30]=c.i64.cast([0,0]),c.i64.neq(d[33],void 0)?d[31]=d[33]:d[31]=c.i64.cast([0,1]),a=[e.backupId,e.deviceId,e.mailboxRootKeyBlob,e.ocmfClientStateBlob,void 0,void 0,d[30],d[31],e.epochAuthPublicKeyBlob,e.epochAuthPrivateKeyBlob,e.devicePublicKeyBlob,e.devicePrivateKeyBlob,e.epochStoragePublicKeyBlob,e.epochStoragePrivateKeyBlob,e.obliviousValidationTokenBlob,e.authorityLevel,void 0,void 0],d[2]=a[0],d[3]=a[1],d[4]=a[2],d[5]=a[3],d[6]=a[4],d[7]=a[5],d[8]=a[6],d[9]=a[7],d[10]=a[8],d[11]=a[9],d[12]=a[10],d[13]=a[11],d[14]=a[12],d[15]=a[13],d[16]=a[14],d[17]=a[15],d[18]=a[16],d[19]=a[17],a}]))})},function(a){return c.storedProcedure(b("LSFindBackup")).then(function(a){return a=a,d[21]=a[0],a})},function(e){return c.blobs.neq(d[5],void 0)?c.i64.neq(d[3],void 0)?d[21]!==void 0?c.blobs.neq(d[4],void 0)?c.sequence([function(e){return d[28]=c.createArray(),d[35]=(d[28].push(d[21]),d[28]),d[35]=(d[28].push(a[1]),d[28]),d[29]=c.toJSON(d[28]),d[30]=c.createArray(),d[35]=(d[30].push(c.i64.cast([0,32])),d[30]),c.nativeOperation(b("LSGetBlobFromString.nop"),["thread_ope_key","_",a[5]].join("")).then(function(a){return a=a,d[31]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[31],void 0,d[4],d[30]).then(function(a){return a=a,d[32]=a[0],a})},function(a){return d[32]?d[33]=!1:d[33]=!0,d[33]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] Got null keys while deriving message list OPE key. Returning null blobish"),d[36]="Got null keys while deriving message list OPE key. Returning null blobish",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",d[36]].join("")),d[35]=c.createArray(),void 0!==void 0?d[37]=(d[35].push(void 0),d[35]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",d[36],d[35],c.i64.cast([0,3]))},function(a){return d[34]=void 0}]):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[32],c.i64.cast([0,0])).then(function(a){return a=a,d[35]=a[0],d[36]=a[1],a})},function(a){return d[34]=d[35]}])},function(e){return c.blobs.neq(d[34],void 0)?c.sequence([function(e){return c.i64.neq(a[9],void 0)?d[35]=a[9]:d[35]=c.i64.cast([-1,4294967295]),c.nativeOperation(b("LSGetBlobFromInt64BE.nop"),a[6]).then(function(a){return a=a,d[36]=a[0],a})},function(a){return c.nativeOperation(b("LSTruncateSortKey.nop"),d[36]).then(function(a){return a=a,d[37]=a[0],a})},function(a){return c.nativeOperation(b("LSOpeEncrypt.nop"),d[34],d[37],c.i64.cast([0,16])).then(function(a){return a=a,d[38]=a[0],a})},function(a){return c.nativeOperation(b("LSBinaryToHex.nop"),d[38]).then(function(a){return a=a,d[39]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[29]).then(function(a){return a=a,d[40]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2NvcGU="),d[40]).then(function(a){return a=a,d[41]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[41]).then(function(a){return a=a,d[42]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[42]).then(function(a){return a=a,d[43]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[21]).then(function(a){return a=a,d[44]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWFpbGJveF9pZF9zY29wZQ=="),d[44]).then(function(a){return a=a,d[45]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[45]).then(function(a){return a=a,d[46]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[46]).then(function(a){return a=a,d[47]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[4]).then(function(a){return a=a,d[48]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWVzc2FnZV9pZF9zY29wZQ=="),d[48]).then(function(a){return a=a,d[49]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[49]).then(function(a){return a=a,d[50]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[50]).then(function(a){return a=a,d[51]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[4]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[52]).then(function(a){return a=a,d[53]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[53]).then(function(a){return a=a,d[54]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[54]).then(function(a){return a=a,d[55]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[5]).then(function(a){return a=a,d[56]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("dGhyZWFkX2lkX3Njb3Bl"),d[56]).then(function(a){return a=a,d[57]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[57]).then(function(a){return a=a,d[58]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[58]).then(function(a){return a=a,d[59]=a[0],a})},function(e){return d[60]=new c.Map(),d[60].set("attachment_index_key",d[43]==null?"":d[43]),d[60].set("backup_ent_fbid",a[0]),d[60].set("delivery_object_id",a[1]),d[60].set("device_id",d[3]),d[60].set("mailbox_partial_id",d[47]==null?"":d[47]),d[60].set("media_type",a[3]),d[60].set("message_partial_id",d[51]==null?"":d[51]),d[60].set("product_type",a[2]),d[60].set("salt_partial_id",d[55]==null?"":d[55]),d[60].set("sort_key",d[39]==null?"":d[39]),d[60].set("thread_partial_id",d[59]==null?"":d[59]),d[60].set("trace_id",d[1]),d[60].set("source",d[35]),d[61]=new c.Map(),d[61].set("otid",a[4]),d[61].set("server_thread_key",a[8]),d[61].set("timestamp",c.i64.to_string(a[6])),c.nativeOperation(b("LSBase64Encode.nop"),d[5]).then(function(a){return a=a,d[62]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[4]).then(function(a){return a=a,d[63]=a[0],a})},function(e){return d[64]=new c.Map(),d[64].set("ocmf_client_state_blob",d[62]==null?"":d[62]),d[64].set("mailbox_root_key",d[63]==null?"":d[63]),d[65]=c.createArray(),d[76]=(d[65].push(a[4]),d[65]),d[76]=(d[65].push(a[1]),d[65]),d[66]=c.toJSON(d[65]),d[60].set("raw_identifiers",d[61]),d[60].set("backup_id",d[21]),d[60].set("thread_id",a[5]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[66]).then(function(a){return a=a,d[67]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[67]).then(function(a){return a=a,d[68]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[68]).then(function(a){return a=a,d[69]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[69]).then(function(a){return a=a,d[70]=a[0],a})},function(a){return d[60].set("salt_partial_access_token",d[70]==null?"":d[70]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[29]).then(function(a){return a=a,d[71]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2FsdF9zY29wZQ=="),d[71]).then(function(a){return a=a,d[72]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[5],d[72]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[73]).then(function(a){return a=a,d[74]=a[0],a})},function(a){return d[60].set("salt_partial_attachment_index_key",d[74]==null?"":d[74]),d[60].set("raw_tokens",d[64]),d[75]=c.toJSON(d[60]),c.storedProcedure(b("LSIssueNewTask"),"encrypted_backups_attachment_restore",c.i64.cast([0,50020]),d[75],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(d[36]="OPE key is null for IssueAttachmentRestoreTask",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[36]].join("")),d[35]=c.createArray(),void 0!==void 0?d[37]=(d[35].push(void 0),d[35]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[36],d[35],c.i64.cast([0,3])))}]):(d[29]="Missing mailbox_root_key for IssueAttachmentRestoreTask",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[29]].join("")),d[28]=c.createArray(),void 0!==void 0?d[30]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[29],d[28],c.i64.cast([0,3]))):(d[29]="Missing backup_id for IssueAttachmentRestoreTask",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[29]].join("")),d[28]=c.createArray(),void 0!==void 0?d[30]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[29],d[28],c.i64.cast([0,3]))):(d[29]="Missing device_id for IssueAttachmentRestoreTask",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[29]].join("")),d[28]=c.createArray(),void 0!==void 0?d[30]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[29],d[28],c.i64.cast([0,3]))):(d[29]="Missing ocmf_client_state_blob for IssueAttachmentRestoreTask",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ","",d[29]].join("")),d[28]=c.createArray(),void 0!==void 0?d[30]=(d[28].push(void 0),d[28]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",d[29],d[28],c.i64.cast([0,3])))},function(a){return d[22]=c.i64.of_float(Date.now()),d[23]=c.i64.random(),d[25]="Finishing execution. Execution time: ",d[26]=c.i64.to_string(c.i64.sub(d[22],d[0])),d[27]=" ms",d[24]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure] ",d[24],d[25],d[24],d[26],d[24],d[27]].join("")),c.i64.eq(c.i64.mod_(d[23],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[28]=",",d[29]=c.createArray(),void 0!==void 0?d[30]=(d[29].push(void 0),d[29]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure",[d[25],d[28],d[26],d[28],d[27]].join(""),d[29],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueAttachmentRestoreTaskStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state"];e.exports=a}),null);
__d("LSIssueAttachmentRestoreTaskStoredProcedure",["LSIssueAttachmentRestoreTask","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueAttachmentRestoreTask"),e.backupEntFbid,e.deliveryObjectId,e.productType,e.mediaType,e.messageId,e.threadId,e.sortOrder,e.traceId,e.serverThreadKey,e.source);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSSerializeAttachmentBackupPayload",["LSArrayGetObjectAt","LSBase64Encode.nop","LSGetBlobFromString.nop","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop","LSOcmfClientMap.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][serializeAttachmentBackupPayload] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=void 0,d[3]=c.i64.of_int32(a[0].length),c.i64.gt(d[3],c.i64.cast([0,0]))?c.loopAsync(d[3],function(e){return d[17]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[17]).then(function(a){return a=a,d[18]=a[0],d[19]=a[1],a})},function(a){return d[20]=d[18].get("attachment_trace_id"),d[2]=d[20]}])}):c.resolve()},function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[17]=new c.Map(),d[17].set("error_msg","Expected a nonempty query result"),d[17].set("code",c.i64.cast([0,3])),d[17].set("src_line","MEBClientStateUtils.php:247 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[18]=c.createArray(),d[19]=(d[18].push(d[17]),d[18]),e=[void 0,d[18]],d[4]=e[0],d[5]=e[1],e):(b=a.item,d[17]=new c.Map(),d[17].set("backup_id",b.backupId),d[17].set("device_public_key_blob",b.devicePublicKeyBlob),d[17].set("device_private_key_blob",b.devicePrivateKeyBlob),d[17].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[17].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[17].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[17].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[17].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[17].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[17].set("orf_client_state_v2_blob",void 0),d[17].set("orf_v2_authority_level",void 0),d[17].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[17].set("device_id",b.deviceId),d[17].set("backup_tenancy",b.backupTenancy),d[17].set("encryption_version",b.encryptionVersion),d[17].set("revision_version",b.revisionVersion),d[17].set("initialize_restore_result",void 0),d[17].set("device_creation_timestamp_sec",void 0),d[17].set("authority_level",b.authorityLevel),e=[d[17],void 0],d[4]=e[0],d[5]=e[1],e)})},function(e){return d[7]=new c.Map(),d[7].set("value",d[4]),d[7].set("errors",d[5]),d[8]=d[7].get("value"),d[8]!==void 0?c.sequence([function(e){return d[17]=d[8].get("backup_id"),d[18]=d[8].get("device_public_key_blob"),d[19]=d[8].get("device_private_key_blob"),d[20]=d[8].get("epoch_storage_public_key_blob"),d[21]=d[8].get("epoch_storage_private_key_blob"),d[22]=d[8].get("epoch_auth_public_key_blob"),d[23]=d[8].get("epoch_auth_private_key_blob"),d[24]=d[8].get("mailbox_root_key_blob"),d[25]=d[8].get("ocmf_client_state_blob"),d[26]=d[8].get("orf_client_state_v2_blob"),d[27]=d[8].get("orf_v2_authority_level"),d[28]=d[8].get("oblivious_validation_token_blob"),d[29]=d[8].get("device_id"),d[30]=d[8].get("backup_tenancy"),d[31]=d[8].get("encryption_version"),d[32]=d[8].get("revision_version"),d[33]=d[8].get("initialize_restore_result"),d[34]=d[8].get("device_creation_timestamp_sec"),d[35]=d[8].get("authority_level"),c.i64.neq(d[29],void 0)?c.sequence([function(a){return d[38]=void 0,c.i64.neq(d[38],void 0)?c.resolve(d[39]=d[38]):c.sequence([function(a){return d[44]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]?d[54]=(d[44].push(c.i64.cast([0,0])),d[44]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[46]=a[0],a})},function(a){return d[46]?d[54]=(d[44].push(c.i64.cast([0,2])),d[44]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[47]?d[54]=(d[44].push(c.i64.cast([0,3])),d[44]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[48]=a[0],a})},function(a){return d[48]?d[54]=(d[44].push(c.i64.cast([0,4])),d[44]):0,d[49]=c.createArray(),d[50]=c.i64.of_int32(d[44].length),c.i64.gt(d[50],c.i64.cast([0,0]))?c.loopAsync(d[50],function(a){return d[54]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[44],d[54]).then(function(a){return a=a,d[55]=a[0],d[56]=a[1],a})},function(a){return d[57]=(d[49].push(d[55]),d[49])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[54]=c.createArray(),d[55]=c.i64.of_int32(d[49].length),c.i64.gt(d[55],c.i64.cast([0,0]))?c.loopAsync(d[55],function(a){return d[57]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[49],d[57]).then(function(a){return a=a,d[58]=a[0],d[59]=a[1],a})},function(a){return d[60]=(d[54].push(c.i64.to_string(d[58])),d[54])}])}):c.resolve()},function(a){return d[56]=d[54].join(","),d[51]=d[56]}])},function(a){return d[49].some(function(a){return c.i64.eq(d[31],a)})?d[52]=d[31]:d[52]=void 0,c.i64.neq(d[52],void 0)?d[53]=d[52]:d[53]=void 0,d[39]=d[53]}])},function(e){return c.i64.neq(d[39],void 0)?d[40]=d[39]:d[40]=c.i64.cast([0,0]),c.i64.neq(d[30],void 0)?d[41]=d[30]:d[41]=c.i64.cast([0,1]),c.i64.eq(a[4],c.i64.cast([0,0]))?c.sequence([function(e){return d[44]=c.createArray(),d[45]=c.i64.of_int32(a[0].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[61]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[61]).then(function(a){return a=a,d[62]=a[0],d[63]=a[1],a})},function(e){return d[64]=d[62].get("media_type"),d[65]=d[62].get("zippy_object_id"),d[84]=d[65],d[66]=d[62].get("attachment_trace_id"),d[67]=c.createArray(),d[85]=(d[67].push(c.i64.to_string(d[17])),d[67]),d[85]=(d[67].push(d[84]),d[67]),d[68]=c.toJSON(d[67]),d[69]=c.createArray(),d[85]=(d[69].push(a[1]),d[69]),d[85]=(d[69].push(d[84]),d[69]),d[70]=c.toJSON(d[69]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[68]).then(function(a){return a=a,d[71]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2NvcGU="),d[71]).then(function(a){return a=a,d[72]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[25],d[72]).then(function(a){return a=a,d[73]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[73]).then(function(a){return a=a,d[74]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[70]).then(function(a){return a=a,d[75]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[75]).then(function(a){return a=a,d[76]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[25],d[76]).then(function(a){return a=a,d[77]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[77]).then(function(a){return a=a,d[78]=a[0],a})},function(a){return c.nativeOperation(b("LSGetBlobFromString.nop"),d[68]).then(function(a){return a=a,d[79]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF9rZXlfc2FsdF9zY29wZQ=="),d[79]).then(function(a){return a=a,d[80]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[25],d[80]).then(function(a){return a=a,d[81]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[81]).then(function(a){return a=a,d[82]=a[0],a})},function(a){return d[83]=new c.Map(),d[83].set("attachment_index_key",d[74]==null?"":d[74]),d[83].set("media_type",d[64]),d[83].set("zippy_object_id",d[84]),d[83].set("attachment_trace_id",d[66]),d[83].set("salt_partial_access_token",d[78]==null?"":d[78]),d[83].set("salt_partial_attachment_index_key",d[82]==null?"":d[82]),d[85]=(d[44].push(d[83]),d[44])}])}):c.resolve()},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[1]).then(function(a){return a=a,d[46]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("bWVzc2FnZV9pZF9zY29wZQ=="),d[46]).then(function(a){return a=a,d[47]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[25],d[47]).then(function(a){return a=a,d[48]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[48]).then(function(a){return a=a,d[49]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[1]).then(function(a){return a=a,d[50]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("YXR0YWNobWVudF90b2tlbl9zYWx0X3Njb3Bl"),d[50]).then(function(a){return a=a,d[51]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[25],d[51]).then(function(a){return a=a,d[52]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[52]).then(function(a){return a=a,d[53]=a[0],a})},function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[2]).then(function(a){return a=a,d[54]=a[0],a})},function(a){return c.nativeOperation(b("LSHmac_v2.nop"),c.blob("dGhyZWFkX2lkX3Njb3Bl"),d[54]).then(function(a){return a=a,d[55]=a[0],a})},function(a){return c.nativeOperation(b("LSOcmfClientMap.nop"),d[25],d[55]).then(function(a){return a=a,d[56]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[56]).then(function(a){return a=a,d[57]=a[0],a})},function(b){return d[58]=new c.Map(),d[58].set("attachment_infos",d[44]),d[58].set("message_partial_id",d[49]==null?"":d[49]),d[58].set("product_type",a[3]),d[58].set("salt_partial_id",d[53]==null?"":d[53]),d[58].set("thread_partial_id",d[57]==null?"":d[57]),d[59]=c.toJSON(d[58]),d[60]=new c.Map(),d[60].set("payload",d[59]),b=[d[60],void 0],d[42]=b[0],d[43]=b[1],b}]):c.resolve((a[5]!==void 0?d[44]=a[5]:d[44]="",d[45]=".",d[46]=new c.Map(),d[46].set("error_code",c.i64.cast([-1,4294967295])),d[46].set("stored_procedure","LSEncryptedBackupsSerializeAttachmentBackupPayloadStoredProcedure"),d[46].set("error_message",d[44]),e=[void 0,d[46]],d[42]=e[0],d[43]=e[1],e))},function(a){return a=[d[42],d[43]],d[36]=a[0],d[37]=a[1],a}]):c.resolve((d[38]=".",d[39]=new c.Map(),d[39].set("error_code",c.i64.cast([0,24])),d[39].set("stored_procedure","LSEncryptedBackupsSerializeAttachmentBackupPayloadStoredProcedure"),d[39].set("error_message",""),e=[void 0,d[39]],d[36]=e[0],d[37]=e[1],e))},function(a){return a=[d[36],d[37]],d[9]=a[0],d[10]=a[1],a}]):c.resolve((d[17]=d[7].get("errors"),d[18]=d[7].get("errors"),d[19]=".",d[20]=new c.Map(),d[20].set("error_code",c.i64.cast([0,1])),d[20].set("stored_procedure","LSEncryptedBackupsSerializeAttachmentBackupPayloadStoredProcedure"),d[20].set("error_message",""),e=[void 0,d[20]],d[9]=e[0],d[10]=e[1],e))},function(a){return d[11]=c.i64.of_float(Date.now()),d[12]=c.i64.random(),d[14]="Finishing execution. Execution time: ",d[15]=c.i64.to_string(c.i64.sub(d[11],d[0])),d[16]=" ms",d[13]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][serializeAttachmentBackupPayload] ",d[13],d[14],d[13],d[15],d[13],d[16]].join("")),c.i64.eq(c.i64.mod_(d[12],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[17]=",",d[18]=c.createArray(),void 0!==void 0?d[19]=(d[18].push(void 0),d[18]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"serializeAttachmentBackupPayload",[d[14],d[17],d[15],d[17],d[16]].join(""),d[18],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[9],d[10]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsSerializeAttachmentBackupPayloadStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state"];e.exports=a}),null);
__d("LSWriteToPendingProtobufBackupsContextV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(305).add({pk:void 0,pendingBackupTaskId:a[0],actThreadId:a[1],toplevelOfflineThreadingId:a[2],messageTimestampMs:a[6],backupAction:a[7],supplementalKey:a[5],attachmentPayload:a[8],senderId:a[9]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSEncryptedBackupsWriteToPendingProtobufBackupsContextV2StoredProcedure";a.__tables__=["pending_protobuf_backups_context"];e.exports=a}),null);
__d("LSIssueMessageBackup",["LSArrayGetObjectAt","LSIsEncryptionVersionSecure","LSIssueNewTaskAndGetTaskID","LSLogMebClientEvent.nop","LSSerializeAttachmentBackupPayload","LSWriteToPendingProtobufBackupsContextV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][issueMessageBackup] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[15]=new c.Map(),d[15].set("error_msg","Expected a nonempty query result"),d[15].set("code",c.i64.cast([0,3])),d[15].set("src_line","MEBClientStateUtils.php:247 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[16]=c.createArray(),d[17]=(d[16].push(d[15]),d[16]),e=[void 0,d[16]],d[2]=e[0],d[3]=e[1],e):(b=a.item,d[15]=new c.Map(),d[15].set("backup_id",b.backupId),d[15].set("device_public_key_blob",b.devicePublicKeyBlob),d[15].set("device_private_key_blob",b.devicePrivateKeyBlob),d[15].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[15].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[15].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[15].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[15].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[15].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[15].set("orf_client_state_v2_blob",void 0),d[15].set("orf_v2_authority_level",void 0),d[15].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[15].set("device_id",b.deviceId),d[15].set("backup_tenancy",b.backupTenancy),d[15].set("encryption_version",b.encryptionVersion),d[15].set("revision_version",b.revisionVersion),d[15].set("initialize_restore_result",void 0),d[15].set("device_creation_timestamp_sec",void 0),d[15].set("authority_level",b.authorityLevel),e=[d[15],void 0],d[2]=e[0],d[3]=e[1],e)})},function(e){return d[5]=new c.Map(),d[5].set("value",d[2]),d[5].set("errors",d[3]),d[6]=d[5].get("value"),d[6]!==void 0?c.sequence([function(e){return d[15]=d[6].get("backup_id"),d[16]=d[6].get("device_public_key_blob"),d[17]=d[6].get("device_private_key_blob"),d[18]=d[6].get("epoch_storage_public_key_blob"),d[19]=d[6].get("epoch_storage_private_key_blob"),d[20]=d[6].get("epoch_auth_public_key_blob"),d[21]=d[6].get("epoch_auth_private_key_blob"),d[22]=d[6].get("mailbox_root_key_blob"),d[23]=d[6].get("ocmf_client_state_blob"),d[24]=d[6].get("orf_client_state_v2_blob"),d[25]=d[6].get("orf_v2_authority_level"),d[26]=d[6].get("oblivious_validation_token_blob"),d[27]=d[6].get("device_id"),d[28]=d[6].get("backup_tenancy"),d[29]=d[6].get("encryption_version"),d[30]=d[6].get("revision_version"),d[31]=d[6].get("initialize_restore_result"),d[32]=d[6].get("device_creation_timestamp_sec"),d[33]=d[6].get("authority_level"),c.i64.neq(d[27],void 0)?c.sequence([function(a){return d[36]=void 0,c.i64.neq(d[36],void 0)?c.resolve(d[37]=d[36]):c.sequence([function(a){return d[48]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[49]?d[58]=(d[48].push(c.i64.cast([0,0])),d[48]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[50]=a[0],a})},function(a){return d[50]?d[58]=(d[48].push(c.i64.cast([0,2])),d[48]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[51]=a[0],a})},function(a){return d[51]?d[58]=(d[48].push(c.i64.cast([0,3])),d[48]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[52]=a[0],a})},function(a){return d[52]?d[58]=(d[48].push(c.i64.cast([0,4])),d[48]):0,d[53]=c.createArray(),d[54]=c.i64.of_int32(d[48].length),c.i64.gt(d[54],c.i64.cast([0,0]))?c.loopAsync(d[54],function(a){return d[58]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[48],d[58]).then(function(a){return a=a,d[59]=a[0],d[60]=a[1],a})},function(a){return d[61]=(d[53].push(d[59]),d[53])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[58]=c.createArray(),d[59]=c.i64.of_int32(d[53].length),c.i64.gt(d[59],c.i64.cast([0,0]))?c.loopAsync(d[59],function(a){return d[61]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[53],d[61]).then(function(a){return a=a,d[62]=a[0],d[63]=a[1],a})},function(a){return d[64]=(d[58].push(c.i64.to_string(d[62])),d[58])}])}):c.resolve()},function(a){return d[60]=d[58].join(","),d[55]=d[60]}])},function(a){return d[53].some(function(a){return c.i64.eq(d[29],a)})?d[56]=d[29]:d[56]=void 0,c.i64.neq(d[56],void 0)?d[57]=d[56]:d[57]=void 0,d[37]=d[57]}])},function(e){var f;return c.i64.neq(d[37],void 0)?d[38]=d[37]:d[38]=c.i64.cast([0,0]),c.i64.neq(d[28],void 0)?d[39]=d[28]:d[39]=c.i64.cast([0,1]),c.sequence([function(e){return a[11]!==void 0?c.sequence([function(e){return d[50]=a[11].get("attachment_infos"),d[51]=a[11].get("attachment_infos"),d[52]=a[11].get("product_type"),d[53]=a[11].get("error"),d[54]=a[11].get("error_message"),c.storedProcedure(b("LSSerializeAttachmentBackupPayload"),d[51],a[1],a[0],d[52],d[53],d[54]).then(function(a){return a=a,d[55]=a[0],d[56]=a[1],a})},function(a){return d[55]?d[57]=!1:d[57]=!0,d[57]?c.sequence([function(a){return d[56]?d[63]=!1:d[63]=!0,d[63]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] Invalid Attachment payload generated"),d[68]="Invalid Attachment payload generated",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] ","",d[68]].join("")),d[67]=c.createArray(),void 0!==void 0?d[69]=(d[67].push(void 0),d[67]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageBackupStoredProcedure",d[68],d[67],c.i64.cast([0,3]))},function(a){return a=[void 0,void 0,d[50]],d[64]=a[0],d[65]=a[1],d[66]=a[2],a}]):c.resolve((a=[void 0,d[56],d[50]],d[64]=a[0],d[65]=a[1],d[66]=a[2],a))},function(a){return a=[d[64],d[65],d[66]],d[58]=a[0],d[59]=a[1],d[60]=a[2],a}]):c.resolve((d[63]=d[55].get("payload"),a=[d[63],void 0,d[50]],d[58]=a[0],d[59]=a[1],d[60]=a[2],a))},function(b){return d[63]=new c.Map(),d[64]=d[63].set("success",d[58]),d[65]=d[63].set("failure",d[59]),d[66]=d[63].set("upload_context",d[60]),d[67]=c.toJSON(d[63]),d[61]=d[67],d[62]=a[11].get("error"),b=[d[61],d[62]],d[48]=b[0],d[49]=b[1],b}]):c.resolve((function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] Null Attachments for the message"),e=[void 0,void 0],d[48]=e[0],d[49]=e[1],e))},function(a){return a=[d[48],d[49]],d[40]=a[0],d[41]=a[1],a}])},function(e){return d[46]=c.i64.add(c.i64.mul(c.i64.div(a[2],c.i64.cast([0,1e3])),c.i64.cast([0,1e3])),c.i64.div(c.i64.mod_(c.i64.and_(c.i64.asr_(c.i64.from_string(a[1]),c.i64.to_int32(c.i64.cast([0,22]))),c.i64.cast([511,4294967295])),c.i64.cast([0,1e5])),c.i64.cast([0,100]))),a[9]!==void 0?(d[48]=a[9].get("backup_action"),c.i64.eq(d[48],c.i64.cast([0,4]))?d[49]=a[2]:d[49]=d[46],d[42]=d[49]):d[42]=d[46],d[47]=["Sort Key (",c.i64.to_string(d[42]),") is not in MS. ","auth_ts (",c.i64.to_string(a[2]),"), otid (",a[1],")"].join(""),c.i64.lt(d[42],c.i64.cast([2,1410065408]))?(function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] ","",d[47]].join("")),d[48]=c.createArray(),void 0!==void 0?d[49]=(d[48].push(void 0),d[48]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageBackupStoredProcedure",d[47],d[48],c.i64.cast([0,3]))):c.i64.gt(c.i64.sub(d[42],c.i64.cast([249,3468343296])),c.i64.cast([255,4294967295]))?(function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] ","",d[47]].join("")),d[48]=c.createArray(),void 0!==void 0?d[49]=(d[48].push(void 0),d[48]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageBackupStoredProcedure",d[47],d[48],c.i64.cast([0,3]))):c.resolve()},function(e){return d[43]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["eb_upload",":",a[0]].join(""),c.i64.cast([0,50026]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,93]),void 0,c.i64.le(c.i64.cast([0,0]),c.i64.cast([0,0]))?c.i64.cast([0,0]):c.i64.add(d[43],c.i64.sub(c.i64.cast([0,0]),c.i64.mod_(d[43],c.i64.cast([0,0])))),c.i64.cast([0,0])).then(function(a){return a=a,d[44]=a[0],a})},function(b){return c.db.table(177).add({pk:void 0,pendingBackupTaskId:d[44],actionType:c.i64.cast([0,1]),contentType:c.i64.cast([0,1]),backupStatus:c.i64.cast([0,1]),listKey:a[0],uniqueKey:a[1],sortKey:c.i64.to_string(d[42]),persistentId:"",isInstamadillo:a[12],echoContent:a[4],lsTraceId:a[5],error:a[6],echoEncodingLatencyNs:a[7],errorMessage:a[8],attachmentPayload:d[40],attachmentErrorCode:d[41]})},function(b){return c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))?c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))?(d[48]=c.createArray(),d[50]=(d[48].push("Successfully issued message backup task. act thread id = "),d[48]),d[50]=(d[48].push(a[0]),d[48]),d[50]=(d[48].push(", otid = "),d[48]),d[50]=(d[48].push(a[1]),d[48]),d[49]=d[48].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageBackup] ","",d[49]].join("")),c.resolve()):(d[48]=c.createArray(),d[50]=(d[48].push("Successfully issued message remove task. act thread id = "),d[48]),d[50]=(d[48].push(a[0]),d[48]),d[50]=(d[48].push(", otid = "),d[48]),d[50]=(d[48].push(a[1]),d[48]),d[49]=d[48].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageBackup] ","",d[49]].join("")),c.resolve()):(d[48]=c.createArray(),d[50]=(d[48].push("Successfully issued thread remove task. act thread id = "),d[48]),d[50]=(d[48].push(a[0]),d[48]),d[49]=d[48].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageBackup] ","",d[49]].join("")),c.resolve())},function(e){return a[9]!==void 0?c.sequence([function(e){return d[48]=a[9].get("act_thread_id"),d[49]=a[9].get("backup_action"),d[50]=a[9].get("toplevel_offline_threading_id"),d[51]=a[9].get("supplemental_offline_threading_id"),d[52]=a[9].get("message_timestamp_ms"),d[53]=a[9].get("supplemental_key"),d[54]=a[9].get("attachment_payload"),d[55]=a[9].get("extra_data_for_eb_upload"),d[56]=a[9].get("message_protobuf"),d[57]=a[9].get("deletion_offline_threading_id"),c.storedProcedure(b("LSWriteToPendingProtobufBackupsContextV2"),d[44],d[48],d[50],d[51],d[57],d[53],d[52],d[49],d[54],void 0,d[56],d[55])},function(e){return d[58]=a[9].get("backup_action"),c.i64.eq(d[42],a[2])?(d[60]=["Sort key and authoritative_ts are equal for event type: ",c.i64.to_string(d[58])].join(""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] ",d[60]].join("")),d[59]=c.createArray(),void 0!==void 0?d[61]=(d[59].push(void 0),d[59]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageBackupStoredProcedure",d[60],d[59],c.i64.cast([0,4]))):(d[60]=["Sort key (",c.i64.to_string(d[42]),") and authoritative_ts (",c.i64.to_string(a[2]),") are not equal given OTID (",a[1],") for event type: ",c.i64.to_string(d[58])].join(""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] ",d[60]].join("")),d[59]=c.createArray(),void 0!==void 0?d[61]=(d[59].push(void 0),d[59]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageBackupStoredProcedure",d[60],d[59],c.i64.cast([0,4])))}]):c.i64.eq(d[42],a[2])?(d[49]=["Sort key and authoritative_ts are equal for event type: ",c.i64.to_string(c.i64.cast([-1,4294967295]))].join(""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] ",d[49]].join("")),d[48]=c.createArray(),void 0!==void 0?d[50]=(d[48].push(void 0),d[48]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageBackupStoredProcedure",d[49],d[48],c.i64.cast([0,4]))):(d[49]=["Sort key (",c.i64.to_string(d[42]),") and authoritative_ts (",c.i64.to_string(a[2]),") are not equal given OTID (",a[1],") for event type: ",c.i64.to_string(c.i64.cast([-1,4294967295]))].join(""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssueMessageBackupStoredProcedure] ",d[49]].join("")),d[48]=c.createArray(),void 0!==void 0?d[50]=(d[48].push(void 0),d[48]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssueMessageBackupStoredProcedure",d[49],d[48],c.i64.cast([0,4])))},function(a){return d[45]=new c.Map(),d[45].set("task_id",d[44]),a=[d[45],void 0],d[34]=a[0],d[35]=a[1],a}]):c.sequence([function(b){return d[36]=c.createArray(),d[39]=(d[36].push("Skipping the message upload since EB is disabled. act thread id = "),d[36]),d[39]=(d[36].push(a[0]),d[36]),d[39]=(d[36].push(", otid = "),d[36]),d[39]=(d[36].push(a[1]),d[36]),d[37]=d[36].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageBackup] ","",d[37]].join("")),c.resolve()},function(a){return d[38]=new c.Map(),d[38].set("error_code",c.i64.cast([0,24])),d[38].set("stored_procedure","LSEncryptedBackupsIssueMessageBackupStoredProcedure"),d[38].set("error_message",""),a=[void 0,d[38]],d[34]=a[0],d[35]=a[1],a}])},function(a){return a=[d[34],d[35]],d[7]=a[0],d[8]=a[1],a}]):c.sequence([function(b){return d[15]=d[5].get("errors"),d[16]=d[5].get("errors"),d[17]=c.createArray(),d[20]=(d[17].push("Skipping the message upload since EB is disabled. act thread id = "),d[17]),d[20]=(d[17].push(a[0]),d[17]),d[20]=(d[17].push(", otid = "),d[17]),d[20]=(d[17].push(a[1]),d[17]),d[18]=d[17].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageBackup] ","",d[18]].join("")),c.resolve()},function(a){return d[19]=new c.Map(),d[19].set("error_code",c.i64.cast([0,1])),d[19].set("stored_procedure","LSEncryptedBackupsIssueMessageBackupStoredProcedure"),d[19].set("error_message",""),a=[void 0,d[19]],d[7]=a[0],d[8]=a[1],a}])},function(a){return d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageBackup] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"issueMessageBackup",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[7],d[8]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueMessageBackupStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state","pending_backups_context_v2"];e.exports=a}),null);
__d("LSIssueMessageBackupStoredProcedure",["LSIssueMessageBackup","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueMessageBackup"),e.actThreadId,e.otid,e.authoritativeTs,e.source,e.echoDocument,e.traceId,e.error,e.echoEncodingLatencyNs,e.errorMessage,e.protobufBackupContext,e.tamThreadSubtype,e.attachmentBackupContext,e.isInstamadillo);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSIssueMessageRemove",["LSArrayGetObjectAt","LSIsEncryptionVersionSecure","LSIssueNewTaskAndGetTaskID","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][issueMessageRemove] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[15]=new c.Map(),d[15].set("error_msg","Expected a nonempty query result"),d[15].set("code",c.i64.cast([0,3])),d[15].set("src_line","MEBClientStateUtils.php:247 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[16]=c.createArray(),d[17]=(d[16].push(d[15]),d[16]),e=[void 0,d[16]],d[2]=e[0],d[3]=e[1],e):(b=a.item,d[15]=new c.Map(),d[15].set("backup_id",b.backupId),d[15].set("device_public_key_blob",b.devicePublicKeyBlob),d[15].set("device_private_key_blob",b.devicePrivateKeyBlob),d[15].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[15].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[15].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[15].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[15].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[15].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[15].set("orf_client_state_v2_blob",void 0),d[15].set("orf_v2_authority_level",void 0),d[15].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[15].set("device_id",b.deviceId),d[15].set("backup_tenancy",b.backupTenancy),d[15].set("encryption_version",b.encryptionVersion),d[15].set("revision_version",b.revisionVersion),d[15].set("initialize_restore_result",void 0),d[15].set("device_creation_timestamp_sec",void 0),d[15].set("authority_level",b.authorityLevel),e=[d[15],void 0],d[2]=e[0],d[3]=e[1],e)})},function(e){return d[5]=new c.Map(),d[5].set("value",d[2]),d[5].set("errors",d[3]),d[6]=d[5].get("value"),d[6]!==void 0?c.sequence([function(e){return d[15]=d[6].get("backup_id"),d[16]=d[6].get("device_public_key_blob"),d[17]=d[6].get("device_private_key_blob"),d[18]=d[6].get("epoch_storage_public_key_blob"),d[19]=d[6].get("epoch_storage_private_key_blob"),d[20]=d[6].get("epoch_auth_public_key_blob"),d[21]=d[6].get("epoch_auth_private_key_blob"),d[22]=d[6].get("mailbox_root_key_blob"),d[23]=d[6].get("ocmf_client_state_blob"),d[24]=d[6].get("orf_client_state_v2_blob"),d[25]=d[6].get("orf_v2_authority_level"),d[26]=d[6].get("oblivious_validation_token_blob"),d[27]=d[6].get("device_id"),d[28]=d[6].get("backup_tenancy"),d[29]=d[6].get("encryption_version"),d[30]=d[6].get("revision_version"),d[31]=d[6].get("initialize_restore_result"),d[32]=d[6].get("device_creation_timestamp_sec"),d[33]=d[6].get("authority_level"),c.i64.neq(d[27],void 0)?c.sequence([function(a){return d[36]=void 0,c.i64.neq(d[36],void 0)?c.resolve(d[37]=d[36]):c.sequence([function(a){return d[43]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[44]=a[0],a})},function(a){return d[44]?d[53]=(d[43].push(c.i64.cast([0,0])),d[43]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[45]=a[0],a})},function(a){return d[45]?d[53]=(d[43].push(c.i64.cast([0,2])),d[43]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[46]=a[0],a})},function(a){return d[46]?d[53]=(d[43].push(c.i64.cast([0,3])),d[43]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[47]?d[53]=(d[43].push(c.i64.cast([0,4])),d[43]):0,d[48]=c.createArray(),d[49]=c.i64.of_int32(d[43].length),c.i64.gt(d[49],c.i64.cast([0,0]))?c.loopAsync(d[49],function(a){return d[53]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[43],d[53]).then(function(a){return a=a,d[54]=a[0],d[55]=a[1],a})},function(a){return d[56]=(d[48].push(d[54]),d[48])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[53]=c.createArray(),d[54]=c.i64.of_int32(d[48].length),c.i64.gt(d[54],c.i64.cast([0,0]))?c.loopAsync(d[54],function(a){return d[56]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[48],d[56]).then(function(a){return a=a,d[57]=a[0],d[58]=a[1],a})},function(a){return d[59]=(d[53].push(c.i64.to_string(d[57])),d[53])}])}):c.resolve()},function(a){return d[55]=d[53].join(","),d[50]=d[55]}])},function(a){return d[48].some(function(a){return c.i64.eq(d[29],a)})?d[51]=d[29]:d[51]=void 0,c.i64.neq(d[51],void 0)?d[52]=d[51]:d[52]=void 0,d[37]=d[52]}])},function(e){return c.i64.neq(d[37],void 0)?d[38]=d[37]:d[38]=c.i64.cast([0,0]),c.i64.neq(d[28],void 0)?d[39]=d[28]:d[39]=c.i64.cast([0,1]),d[40]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["eb_upload",":",a[0]].join(""),c.i64.cast([0,50026]),"",void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),c.i64.cast([0,93]),void 0,c.i64.le(c.i64.cast([0,0]),c.i64.cast([0,0]))?c.i64.cast([0,0]):c.i64.add(d[40],c.i64.sub(c.i64.cast([0,0]),c.i64.mod_(d[40],c.i64.cast([0,0])))),c.i64.cast([0,0])).then(function(a){return a=a,d[41]=a[0],a})},function(b){return c.db.table(177).add({pk:void 0,pendingBackupTaskId:d[41],actionType:c.i64.cast([0,2]),contentType:c.i64.cast([0,1]),backupStatus:c.i64.cast([0,1]),listKey:a[0],uniqueKey:a[1],sortKey:c.i64.to_string(c.i64.add(c.i64.mul(c.i64.div(a[2],c.i64.cast([0,1e3])),c.i64.cast([0,1e3])),c.i64.div(c.i64.mod_(c.i64.and_(c.i64.asr_(c.i64.from_string(a[1]),c.i64.to_int32(c.i64.cast([0,22]))),c.i64.cast([511,4294967295])),c.i64.cast([0,1e5])),c.i64.cast([0,100])))),persistentId:"",isInstamadillo:!1,lsTraceId:a[4],error:a[5]})},function(b){return c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))?c.i64.eq(c.i64.cast([0,2]),c.i64.cast([0,1]))?(d[43]=c.createArray(),d[45]=(d[43].push("Successfully issued message backup task. act thread id = "),d[43]),d[45]=(d[43].push(a[0]),d[43]),d[45]=(d[43].push(", otid = "),d[43]),d[45]=(d[43].push(a[1]),d[43]),d[44]=d[43].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageRemove] ","",d[44]].join("")),c.resolve()):(d[43]=c.createArray(),d[45]=(d[43].push("Successfully issued message remove task. act thread id = "),d[43]),d[45]=(d[43].push(a[0]),d[43]),d[45]=(d[43].push(", otid = "),d[43]),d[45]=(d[43].push(a[1]),d[43]),d[44]=d[43].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageRemove] ","",d[44]].join("")),c.resolve()):(d[43]=c.createArray(),d[45]=(d[43].push("Successfully issued thread remove task. act thread id = "),d[43]),d[45]=(d[43].push(a[0]),d[43]),d[44]=d[43].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageRemove] ","",d[44]].join("")),c.resolve())},function(a){return d[42]=new c.Map(),d[42].set("task_id",d[41]),a=[d[42],void 0],d[34]=a[0],d[35]=a[1],a}]):c.sequence([function(b){return d[36]=c.createArray(),d[39]=(d[36].push("Skipping message upload since EB is disabled. act thread id = "),d[36]),d[39]=(d[36].push(a[0]),d[36]),d[39]=(d[36].push(", otid = "),d[36]),d[39]=(d[36].push(a[1]),d[36]),d[37]=d[36].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageRemove] ","",d[37]].join("")),c.resolve()},function(a){return d[38]=new c.Map(),d[38].set("error_code",c.i64.cast([0,24])),d[38].set("stored_procedure","LSEncryptedBackupsIssueMessageRemoveStoredProcedure"),d[38].set("error_message",""),a=[void 0,d[38]],d[34]=a[0],d[35]=a[1],a}])},function(a){return a=[d[34],d[35]],d[7]=a[0],d[8]=a[1],a}]):c.sequence([function(b){return d[15]=d[5].get("errors"),d[16]=d[5].get("errors"),d[17]=c.createArray(),d[20]=(d[17].push("Skipping message upload since EB is disabled. act thread id = "),d[17]),d[20]=(d[17].push(a[0]),d[17]),d[20]=(d[17].push(", otid = "),d[17]),d[20]=(d[17].push(a[1]),d[17]),d[18]=d[17].join(void 0||""),function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageRemove] ","",d[18]].join("")),c.resolve()},function(a){return d[19]=new c.Map(),d[19].set("error_code",c.i64.cast([0,1])),d[19].set("stored_procedure","LSEncryptedBackupsIssueMessageRemoveStoredProcedure"),d[19].set("error_message",""),a=[void 0,d[19]],d[7]=a[0],d[8]=a[1],a}])},function(a){return d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][issueMessageRemove] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"issueMessageRemove",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[7],d[8]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssueMessageRemoveStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state","pending_backups_context_v2"];e.exports=a}),null);
__d("LSIssueMessageRemoveStoredProcedure",["LSIssueMessageRemove","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueMessageRemove"),e.actThreadId,e.otid,e.authoritativeTs,e.source,e.traceId,e.error);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSTamThreadSubtype",[],(function(a,b,c,d,e,f){a=Object.freeze({STANDARD:0,VANISH_MODE:1,DUAL_SEND_SHADOW:2,BTV_COMPANION:3,BLEND_DUAL_SEND:4,BLEND_DUAL_SEND_NO_NETWORK:5});f["default"]=a}),66);
__d("MAWAsyncEBPendingQueryPromise",["Promise"],(function(a,b,c,d,e,f){"use strict";var g,h=new Map(),i=new Map(),j=new Map(),k=new Map(),l=new Map(),m=new Map();function a(a){var c=new(g||(g=b("Promise")))(function(b,c){i.set(a,b),k.set(a,c)});h.set(a,c);return c}function c(a,b){j.set(a,b)}function d(a){return j.get(a)}function e(a){var c=new(g||(g=b("Promise")))(function(b,c){l.set(a,{data:null,resolve:b}),m.set(a,c)});return c}function n(a,b){var c=i.get(a);c!=null&&(i["delete"](a),c(b));c=l.get(a);c!=null&&l.set(a,{data:b,resolve:c.resolve})}function o(a,b){var c=k.get(a);c!=null&&(i["delete"](a),c(b));c=m.get(a);c!=null&&(m["delete"](a),c(b),l["delete"](a))}function p(a){var b=l.get(a);b!=null&&b.data!=null&&(b.resolve(b.data),l["delete"](a),m["delete"](a))}f.getPendingQueryPromiseFromTrace=a;f.setJidFromThreadId=c;f.getJidFromThreadId=d;f.getWaitForRestorePromiseFromTrace=e;f.resolvePendingQueryIfPresent=n;f.rejectPendingQueryIfPresent=o;f.resolvePendingQueryUponReStore=p}),66);
__d("MAWBridgeTraceRecordCheckpointHandler",["I64","LSAppendDataTraceAddonStoredProcedure","LSDatabaseSingleton","LSFactory","LSFlushDataTrace.nop"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){var e=b.checkPointId,f=b.dataTraceId,g=b.errorMessage,i=b.tags;return c("LSAppendDataTraceAddonStoredProcedure")(c("LSFactory")(a),{checkPointId:e,dataTraceId:f,errorMessage:g,syncChannel:(h||(h=d("I64"))).neg_one,tags:i}).then(function(){if(b.shouldFlush)return c("LSFlushDataTrace.nop")(a,0,f)})}function a(a){return(i||(i=d("LSDatabaseSingleton"))).LSDatabaseSingleton.then(function(b){return b.runInTransaction(function(b){return j(b,a)},"readwrite",void 0,void 0,f.id+":43")})}g.call=j;g.callWithoutTxn=a}),98);
__d("MAWEBFrontendQPLLogger",["EBEnableUnifiedAttachment","EBUnifyLegacyMediaUpload","ExecutionEnvironment","MAWBridgeSafeActionsWorkerAndUI","MAWEBUploadTrackingUtils","MWEBODSEntityName.enum","ODS","QPLUserFlow","WAHashStringToNumber","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b,e){a!=null&&((i||(i=c("ExecutionEnvironment"))).isInWorker?(o("point",b),d("MAWEBUploadTrackingUtils").handleBridgeEbUploadTrackingQPL("point",a,b,e)):d("MAWBridgeSafeActionsWorkerAndUI").fireAndForgetBackendWorkerAndUIShared("addEbUploadTrackingWorkerQPL",{annotations:e,pointName:b,qplInstanceKey:a,qplType:"point"}))}function k(a,b){(i||(i=c("ExecutionEnvironment"))).isInWorker?(o("success","upload_tracking_completed"),d("MAWEBUploadTrackingUtils").handleBridgeEbUploadTrackingQPL("success",a,"upload_tracking_completed",b)):d("MAWBridgeSafeActionsWorkerAndUI").fireAndForgetBackendWorkerAndUIShared("addEbUploadTrackingWorkerQPL",{annotations:b,pointName:"upload_tracking_completed",qplInstanceKey:a,qplType:"success"})}function l(a,b,e){(i||(i=c("ExecutionEnvironment"))).isInWorker?(o("fail",b),d("MAWEBUploadTrackingUtils").handleBridgeEbUploadTrackingQPL("fail",a,b,e)):d("MAWBridgeSafeActionsWorkerAndUI").fireAndForgetBackendWorkerAndUIShared("addEbUploadTrackingWorkerQPL",{annotations:e,pointName:b,qplInstanceKey:a,qplType:"fail"})}function a(a){var b=a.deliveryObjectId,e=a.flow,f=a.mediaType,g=a.messageId,h=a.threadId;a=a.traceId;if(!m(e))return;var i=d("WAHashStringToNumber").hashStringToNumber(a);b={bool:{is_legacy_hardening:d("EBUnifyLegacyMediaUpload").getEnableUnifyLegacyMediaUpload(),is_unified_attachment:d("EBEnableUnifiedAttachment").getEbEnableUnifiedAttachment()},string:{deliveryObjectId:b,flow:e,mediaType:f,messageId:g,threadId:h,traceId:a}};c("QPLUserFlow").start(c("qpl")._(521480391,"1167"),{annotations:b,instanceKey:i})}function b(a,b,e,f){if(a==null)return;if(!m(e))return;e=d("WAHashStringToNumber").hashStringToNumber(a);if(b){c("QPLUserFlow").endSuccess(c("qpl")._(521480391,"1167"),{instanceKey:e});return}c("QPLUserFlow").endFailure(c("qpl")._(521480391,"1167"),"upload_attachment_backup_failed",{annotations:{string:{error:f!=null?f:"upload_attachment_backup_failed"}},instanceKey:e})}function m(a){return a==="unified"&&d("EBEnableUnifiedAttachment").getEbEnableUnifiedAttachment()||a==="old"&&!d("EBEnableUnifiedAttachment").getEbEnableUnifiedAttachment()}function e(a,b){a.forEach(function(a){if(a.uploadTrackingInstanceKey!=null){var c={string:{traceId:a.traceId}};j(a.uploadTrackingInstanceKey,b,c)}})}function f(a){return{addAnnotations:function(b){n(a,b)},addPoint:function(b,c){j(a,b,c)},endFail:function(b,c){l(a,b,c)},endSuccess:function(b){k(a,b)},getQPLAttrs:function(){return{event:c("qpl")._(521481602,"829"),instanceKey:a}},isActive:function(){return!0}}}function n(a,b){}function o(a,b){(h||(h=d("ODS"))).bumpEntityKey(7319,c("MWEBODSEntityName.enum").MAW_EB_FRONTEND_QPL_IN_WORKER,a+"."+b)}g.addPointEBUploadTracking=j;g.endEBUploadTracking=k;g.failEBUploadTracking=l;g.startFlowUploadAttachmentBackup=a;g.endFlowUploadAttachmentBackup=b;g.addPointForUploadMessageArray=e;g.makeEBFrontendQplFlowFromInstanceKey=f}),98);
__d("MAWBridgeUploadMessageHandler",["EBIsEbEnabled","EncryptedBackupsWriteToMPSTables","FBLogger","I64","LSDataTraceCheckPoint","LSEncryptedBackupsAttachmentErrorCode","LSFactory","LSIntEnum","LSIssueMessageBackupStoredProcedure","LSIssueMessageRemoveStoredProcedure","LSMEBTaskCreationSource","LSShape","LSTamThreadSubtype","LSVec","MAWCastToMsgrServerMediaType","MAWEBFrontendQPLLogger","MAWMsgType","MAWTraceUtils","MWEBODSEntityName.enum","MWEBODSUtils","Promise","WATimeUtils","asyncToGeneratorRuntime","cr:17101","gkx","isInstamadillo","isInstamadilloEB"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,b){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){var f,g;if(c("isInstamadilloEB")())return(j||(j=b("Promise"))).resolve();var k=m(e.uploadTrackingInstanceKey);e.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(e.uploadTrackingInstanceKey,"upload_tracking_bridge_handler");d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_COUNTER,"upload."+((f=e.messageType)!=null?f:"unknown"));f=e.protoMsg;var n=e.traceId;g=((g=e.uploadTrackingInstanceKey)!=null?g:e.traceId).toString();if(!(yield d("EBIsEbEnabled").isEbEnabledLS(a,n,k))){if(e.uploadTrackingInstanceKey!=null){n=e.uploadTrackingInstanceKey;d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(n,"user_device_not_enrolled_invalid_echo_request");d("MAWEBFrontendQPLLogger").endEBUploadTracking(n)}d("MAWTraceUtils").recordCheckpointForTrace(g,(h||(h=d("LSIntEnum"))).ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_UPLOAD_USER_DEVICE_NOT_ENROLLED),[],!1);d("MAWTraceUtils").recordInvalidUploadRequestAndFlushTrace(g,h.ofNumber(c("LSDataTraceCheckPoint").LABYRINTH_WEB_ECHO_MESSAGE_UPLOAD_INVALID_REQUEST),[]);return}n=e.echoDocument;var o=d("WATimeUtils").castMilliSecondsToUnixTime(e.sortOrderMs);if(e.actionType===1){var p=e.echoEncodingLatencyNs,q=e.errorCode,r=e.errorMessage;e.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(e.uploadTrackingInstanceKey,"issuing_message_backup");var s;if(f!=null)try{var t=f.sortOrderMs;if(t==null)throw c("FBLogger")("messenger_web").mustfixThrow("sort order is null for the protobuf message");yield d("EncryptedBackupsWriteToMPSTables").writeToMPSTables(a,f,e.threadId,!1,k);s=d("LSShape").ofRecord({act_thread_id:e.threadId,attachment_payload:null,backup_action:(h||(h=d("LSIntEnum"))).ofNumber(f.backupActionType),message_timestamp_ms:(i||(i=d("I64"))).of_float(t),supplemental_key:f.supplementalKey,toplevel_offline_threading_id:(t=(k=f.originalMsgProtocolId)==null?void 0:k.externalId)!=null?t:f.msgId.externalId})}catch(a){a instanceof Error?c("FBLogger")("labyrinth_web").catching(a).mustfix("[labyrinth_web] Error writing to MPSTables for the upload message due to runtime error"):c("FBLogger")("labyrinth_web").mustfix("[labyrinth_web] Error writing to MPSTables for the upload message")}var u;if(e.attachmentBackupContext!=null){k=l({bridgeUploadAttachmentBackupContext:e.attachmentBackupContext,messageId:e.messageId,serverThreadKey:null,threadId:e.threadId,traceId:e.traceId});k!=null&&(u=d("LSShape").ofRecord(k))}e.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(e.uploadTrackingInstanceKey,"upload_handler_echo_protobuf_context",{bool:{attachment_backup_context:u!=null,protobuf_context:s!=null}});if(e.messageType!=null){t=d("MAWMsgType").isMAWSupportedMediaType(e.messageType)?"media":"non-media";d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_COUNTER,"upload."+t)}u!=null&&d("MWEBODSUtils").markODSForEB(c("MWEBODSEntityName.enum").MAW_EB_UPLOAD_COUNTER,"upload.attachment_unified_backup");yield c("LSIssueMessageBackupStoredProcedure")(c("LSFactory")(a),{actThreadId:e.threadId,attachmentBackupContext:u,authoritativeTs:(i||(i=d("I64"))).of_float(o*1e3),echoDocument:n!=null?n:"",echoEncodingLatencyNs:p!=null?(i||(i=d("I64"))).of_float(p):void 0,error:q!=null?(h||(h=d("LSIntEnum"))).ofNumber(q):void 0,errorMessage:r!=null?r:void 0,isInstamadillo:c("isInstamadillo")(),otid:e.messageId,protobufBackupContext:s,source:(h||(h=d("LSIntEnum"))).ofNumber(c("LSMEBTaskCreationSource").TAM),tamThreadSubtype:h.ofNumber(c("isInstamadillo")()?c("LSTamThreadSubtype").BLEND_DUAL_SEND:c("LSTamThreadSubtype").STANDARD),traceId:g});e.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(e.uploadTrackingInstanceKey,"upload_tracking_upload_task_issued");void b("cr:17101").log(function(){return{message_id:e.messageId,trace_id:e.traceId}})}else e.actionType===2&&(yield c("LSIssueMessageRemoveStoredProcedure")(c("LSFactory")(a),{actThreadId:e.threadId,authoritativeTs:(i||(i=d("I64"))).of_float(o*1e3),otid:e.messageId,source:(h||(h=d("LSIntEnum"))).ofNumber(c("LSMEBTaskCreationSource").TAM),traceId:g}),e.uploadTrackingInstanceKey!=null&&d("MAWEBFrontendQPLLogger").addPointEBUploadTracking(e.uploadTrackingInstanceKey,"upload_tracking_remove_task_issued"))});return k.apply(this,arguments)}function l(a){var b;if(!c("gkx")("6956"))return void 0;var e=a.bridgeUploadAttachmentBackupContext,f=a.messageId,g=a.serverThreadKey,i=a.threadId;a=a.traceId;if(e.attachmentInfos.length===0)return;var j=e.attachmentInfos;d("MAWEBFrontendQPLLogger").startFlowUploadAttachmentBackup({deliveryObjectId:j[0].zippyObjectId,flow:"unified",mediaType:(b=d("MAWCastToMsgrServerMediaType").castMediaAttachmentTypeToServerMediaType(j[0].mediaType))!=null?b:"unknown",messageId:f,threadId:i,traceId:a});b=c("LSVec").ofArray(j.map(function(a){return d("LSShape").ofRecord({attachment_trace_id:a.attachmentTraceId,media_type:a.mediaType,zippy_object_id:a.zippyObjectId})}));f=(h||(h=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsAttachmentErrorCode").NO_ERROR);e.error!=null&&(f=(h||(h=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsAttachmentErrorCode").UNKNOWN_ERROR));i={attachment_infos:b,error:f,error_message:null,product_type:e.productType,server_thread_key:g};return i}function m(a){return a==null?null:d("MAWEBFrontendQPLLogger").makeEBFrontendQplFlowFromInstanceKey(a)}g.call=a;g.getMessageUploadAttachmentBackupContext=l}),98);/*FB_PKG_DELIM*/
__d("WAFindMostRecentMediaEntry",["WAMediaUtils","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=null;for(a of a){var c,e=a[0],f=a[1];f=d("WAMediaUtils").decodeMediaEntryData(f);(((c=b)==null?void 0:c[1].mediaKeyTimestamp)==null||f.mediaKeyTimestamp!=null&&f.mediaKeyTimestamp>((c=b)==null?void 0:c[1].mediaKeyTimestamp))&&(b=[e,f])}return b!=null?d("WAResultOrError").makeResult(b):d("WAResultOrError").makeError("no-media-entry")}g.findMostRecentMediaEntry=a}),98);
__d("MAWGetMostRescentDecodedMediaEntry",["MAWDbMediaTxns","MAWIndexedDb","MAWTransactionMode","MWFBLogger","WAFindMostRecentMediaEntry","WAHashUtils","WAResultOrError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["No existing media entry found for plaintextHash ",". Returning new MsgMap."]);h=function(){return a};return a}var i=d("MWFBLogger").MWMediaLogger.tags(["getMostRecentDecodedMediaEntry"]),j=d("MAWIndexedDb").makeMsgrTransactor({media:d("MAWTransactionMode").READONLY},"getMediaEntries",function(a){return function(b){return d("MAWDbMediaTxns").maybeGetMediaFromPlaintextHash(a,b).then(function(a){if(!a){i.DEBUG(h(),d("WAHashUtils").sanitisePlaintextHash(b));return d("WAResultOrError").makeError("no-media-by-plaintext-hash")}return d("WAResultOrError").makeResult(a.mediaEntries)})}});function a(a){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=(yield j(a));if(a.success===!1)return a;a=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(a.value);return a.success===!1?a:d("WAResultOrError").makeResult(a.value[1])});return k.apply(this,arguments)}g.getMediaEntries=j;g.getMostRecentDecodedMediaEntry=a}),98);
__d("MAWGetProtocolMsgIdAndSortOrderMsApi",["MAWIndexedDb","MAWTransactionMode","WAJids"],(function(a,b,c,d,e,f,g){"use strict";a=d("MAWIndexedDb").makeMsgrTransactor({messages:d("MAWTransactionMode").READONLY},"getProtocolMsgIdAndSortOrderMs",function(a){return function(b){return a.messages.get({msgId:b}).then(function(a){if(a==null)return null;var b=a.sortOrderMs;if(b==null)return null;if(d("WAJids").isAuthorSystem(a.author))return null;a={author:a.author,chat:a.threadJid,externalId:a.externalId};return{protocolMsgId:a,sortOrderMs:b}})}});g.getProtocolMsgIdAndSortOrderMs=a}),98);
__d("MpsMediaEntryCache",["FBLogger","MpsMessageToBridgeWrapper","WAHashUtils","WALongInt","WAMediaUtils","WAProgressiveJpegGetScanLengths","WATimeUtils","getMediaTypeFromConsumerMessage"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(a){var b,c=h.get(a.plainTextHash);((b=a.mediaKeyTimestamp)!=null?b:0)>=((b=c==null?void 0:c.mediaKeyTimestamp)!=null?b:0)&&h.set(a.plainTextHash,a)}function a(a){var b,e,f,g;a=d("MpsMessageToBridgeWrapper").MpsMessageToBridgeWrapper.fromTopLevel(a);var h=a.deserialize();h=(h=h.encryptedTransportMessage())==null?void 0:h.consumerMessage();if(h==null)return;b=(b=(b=(b=(b=(b=(b=h.audioMessage())==null?void 0:b.payload)!=null?b:(b=h.documentMessage())==null?void 0:b.payload)!=null?b:(b=h.imageMessage())==null?void 0:b.payload)!=null?b:(b=h.stickerMessage())==null?void 0:b.payload)!=null?b:(b=h.videoMessage())==null?void 0:b.payload)!=null?b:{};var j=b.ancillary;b=b.integral;if(j==null||b==null)return;e=(e=b.transport)==null?void 0:(e=e.integral)==null?void 0:e.directPath;f=(f=b.transport)==null?void 0:(f=f.integral)==null?void 0:f.mediaKeyTimestamp;f=f!=null?d("WATimeUtils").castLongIntToUnixTime(f):void 0;g=(g=b.transport)==null?void 0:(g=g.integral)==null?void 0:g.fileSha256;var k=g!=null?d("WAHashUtils").toPlaintextHash(g):void 0;h=d("getMediaTypeFromConsumerMessage").getMediaTypeFromConsumerMessage(h.proto);if(e==null||g==null||h==null||k==null){c("FBLogger")("mps").warn("Missing media entry fields");return}var l=null,m=j.scanLengths;j=j.scansSidecar;j!=null&&m!=null&&(l={scanLengths:m.map(d("WAProgressiveJpegGetScanLengths").asProgressiveJpegScanLength),sidecar:j});var n;j=(m=b.transport)==null?void 0:(j=m.ancillary)==null?void 0:(m=j.thumbnail)==null?void 0:m.downloadableThumbnail;if(j!=null){n={directPath:j.directPath,fileEncSha256:j.fileEncSha256,fileSha256:j.fileSha256,mediaKey:j.mediaKey,mediaKeyTimestamp:d("WATimeUtils").castLongIntToUnixTime((m=j.mediaKeyTimestamp)!=null?m:0),objectId:j.objectId}}g=d("WAMediaUtils").rawDataToMediaEntry({directPath:e,downloadableThumbnail:n,fileEncSha256:(m=b.transport)==null?void 0:(j=m.integral)==null?void 0:j.fileEncSha256,filename:null,fileSha256:g,mediaKey:(e=b.transport)==null?void 0:(m=e.integral)==null?void 0:m.mediaKey,mediaKeyTimestamp:f,objectId:b==null?void 0:(j=b.transport)==null?void 0:(g=j.ancillary)==null?void 0:g.objectId,progressiveJpegDetails:l,serverMediaType:h,size:d("WALongInt").numberOrThrowIfTooLarge((j=b==null?void 0:(e=b.transport)==null?void 0:(m=e.ancillary)==null?void 0:m.fileLength)!=null?j:0)});i({mediaEntry:g,mediaKeyTimestamp:f,msgId:a.getMsgId(),plainTextHash:k,serverMediaType:h,thumbnailHash:((l=n)==null?void 0:l.fileSha256)!=null?d("WAHashUtils").toPlaintextHash((b=n)==null?void 0:b.fileSha256):void 0})}function b(a){return h.get(a)}g.hydrateCache=a;g.getEntry=b}),98);
__d("WAMediaUtilsWasmUrl",["bx"],(function(a,b,c,d,e,f,g){"use strict";a=c("bx").getURL(c("bx")("237"));g.WAMediaUtilsWasmUrl=a}),98);
__d("WAPreloadWamediaUtilsWasm",["WAMediaUtilsWasmUrl","WAWasmModuleCache"],(function(a,b,c,d,e,f,g){"use strict";a=function(){void d("WAWasmModuleCache").loadWasmModule(d("WAMediaUtilsWasmUrl").WAMediaUtilsWasmUrl)};g.preloadWamediaUtilsWasm=a}),98);
__d("WAPreloadWebpCheckWasm",["WAWasmModuleCache","bx"],(function(a,b,c,d,e,f,g){"use strict";var h=c("bx").getURL(c("bx")("6946"));a=function(){void d("WAWasmModuleCache").loadWasmModule(h)};g.preloadWebpCheckWasm=a}),98);
__d("WAPrewarmMediaValidate",["WALogger","WAPreloadWamediaUtilsWasm","WAPreloadWebpCheckWasm"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["prewarmMediaValidate: serverMediaType is null"]);h=function(){return a};return a}function a(a){if(a==null){d("WALogger").WARN(h());return}(a==="sticker"||a==="image")&&d("WAPreloadWebpCheckWasm").preloadWebpCheckWasm();(a==="video"||a==="audio")&&d("WAPreloadWamediaUtilsWasm").preloadWamediaUtilsWasm()}g.prewarmMediaValidate=a}),98);
__d("WAMediaManagerPrepareMediaDownload",["Promise","WAErrorMessage","WAGetAgeBucketForMediaKeyTimestamp","WAHashUtils","WAMediaQplHelper","WAPrewarmMediaValidate","WAProgressiveJpegGetPJpegDetails","WAResultOrError"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media due to runtime-error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["start download ",". entry: "," mediaKeyTimestampAgeBucket: ",", size: ",", serverMediaType: ",""]);j=function(){return a};return a}var k=0;function a(a){var c=a.hash,e=a.logger,f=a.mediaDownloadFlow;a=a.mediaEntry;var g=a.directPath,l=a.downloadableThumbnail,m=a.mediaKeyTimestamp,n=a.serverMediaType,o=a.size;d("WAPrewarmMediaValidate").prewarmMediaValidate(n);m=d("WAGetAgeBucketForMediaKeyTimestamp").getAgeBucketForMediaKeyTimestamp(m);e.LOG(j(),d("WAHashUtils").sanitisePlaintextHash(c),f.downloadEntry,m,o,n);o=(c=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a).value)!=null?c:null;f.addPoint("wa_protocol_media_download_start",{bool:{duplicateDirectPath:(l==null?void 0:l.directPath)===g,hasDownloadableThumbnail:(l==null?void 0:l.directPath)!=null,isProgressiveJpeg:o!=null},string:{mediaKeyTimestampAgeBucket:m,mediaType:n}});return{logDownloadResult:function(a){k++;f.addAnnotations({"int":{concurrentDownloadCount:k}});return a.then(function(a){if(a.success){var b=a.value.validatedResult.validatedPlaintext.byteLength;f.addPoint("wa_protocol_media_download_end",{string:{media_size:d("WAMediaQplHelper").convertIntegerSizeToStringBucket(b)}})}else f.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:a.error}});return a})["catch"](function(a){f.addPoint("wa_protocol_media_download_fail",{string:{wa_protocol_media_download_fail_reason:"runtime-error"}});var c=d("WAErrorMessage").maybeGetMessageFromError(a);e.ERROR(i(),c);return(h||(h=b("Promise"))).resolve(d("WAResultOrError").DEPRECATED_makeError("runtime-error",a))})["finally"](function(){k--})}}}g.mediaManagerPrepareMediaDownload=a}),98);
__d("WAIsMp4",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a.length<8?!1:a[4]===102&&a[5]===116&&a[6]===121&&a[7]===112}f.isMp4=a}),66);
__d("WAIsOgg",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a.length<4)return!1;return a[0]!==79||a[1]!==103||a[2]!==103||a[3]!==83?!1:!0}f.isOgg=a}),66);
__d("WAIsWebP",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a.length<12)return!1;if(a[0]!==82||a[1]!==73||a[2]!==70||a[3]!==70)return!1;return a[8]!==87||a[9]!==69||a[10]!==66||a[11]!==80?!1:!0}f.isWebP=a}),66);
__d("WAMp4Check",["WAMediaUtilsWasmUrl","WAResultOrError","WASI","WAWasmModuleCache","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h="input",i="output",j="/"+h,k="/"+i;function l(a){var b,c=a.input,d=a.stdout;a=a.stderr;return{args:["wamediautil","mp4check","--error-tolerance=2","--json-report="+i,h],fs:(b={},b[j]={path:j,timestamps:{access:new Date(),change:new Date(),modification:new Date()},mode:"binary",content:new Uint8Array(c)},b[k]={path:k,timestamps:{access:new Date(),change:new Date(),modification:new Date()},mode:"string",content:""},b),stdout:d,stderr:a}}function a(a){var c=a.getWasmModule,e=a.logError,f=a.logMessage;return function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.input;a=d("WASI").createWasi(l({input:a,stderr:e,stdout:f}));var b=a.getImportObject;a=a.start;var g=(yield c());g=(yield WebAssembly.instantiate(g,b()));b=a(g);a=b.exitCode;g=b.fs;if(a!==0){e("mp4Check failed with exit code "+a);return d("WAResultOrError").makeError("invalid-media")}a=(b=g[k])==null?void 0:b.content;if(typeof a!=="string"){e("mp4check failed invalid result type");return d("WAResultOrError").makeError("runtime-error")}b=(g=JSON.parse(a))!=null?g:{};return d("WAResultOrError").makeResult({videoStreamReport:(b==null?void 0:b.video_stream_report)==null?null:{streamType:(a=b.video_stream_report)==null?void 0:a.stream_type,calculatedFps:(g=b.video_stream_report)==null?void 0:g.calculated_fps,nominalFps:(a=b.video_stream_report)==null?void 0:a.nominal_fps,videoWidth:(g=b.video_stream_report)==null?void 0:g.video_width,videoHeight:(a=b.video_stream_report)==null?void 0:a.video_height,duration:(g=b.video_stream_report)==null?void 0:g.duration,avgBitsPerSecond:(a=b.video_stream_report)==null?void 0:a.avg_bits_per_second},audioStreamReport:(b==null?void 0:b.audio_stream_report)==null?null:{streamType:(g=b.audio_stream_report)==null?void 0:g.stream_type,samplingRate:(a=b.audio_stream_report)==null?void 0:a.sampling_rate,numberOfChannels:(g=b.audio_stream_report)==null?void 0:g.number_of_channels,avgBitsPerSecond:(a=b.audio_stream_report)==null?void 0:a.avg_bits_per_second}})});function g(b){return a.apply(this,arguments)}return g}()}c=function(){return d("WAWasmModuleCache").loadWasmModule(d("WAMediaUtilsWasmUrl").WAMediaUtilsWasmUrl)};g.createMp4Check=a;g.getMp4CheckWasm=c}),98);
__d("WAParseWav",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=new DataView(a);if(a.byteLength<44)return null;return b.getUint32(0)!==1380533830||b.getUint32(8)!==1463899717?null:a}function b(a){a=new DataView(a);var b=a.getUint16(22,!0);a=a.getUint32(24,!0);return{numChannels:b,sampleRate:a}}f.validateWav=a;f.parseWav=b}),66);
__d("WAWebPCheck",["WAResultOrError","WASI","WAWasmModuleCache","asyncToGeneratorRuntime","bx"],(function(a,b,c,d,e,f,g){"use strict";var h="input",i="/"+h;function j(a){var b,c=a.input,d=a.stdout;a=a.stderr;return{args:["webpcheck",h],fs:(b={},b[i]={path:i,timestamps:{access:new Date(),change:new Date(),modification:new Date()},mode:"binary",content:new Uint8Array(c)},b),stdout:d,stderr:a}}function a(a){var c=a.getWasmModule,e=a.logError,f=a.logMessage;return function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=a.input;a=d("WASI").createWasi(j({input:a,stderr:e,stdout:f}));var b=a.getImportObject;a=a.start;var g=(yield c());g=(yield WebAssembly.instantiate(g,b()));b=a(g);a=b.exitCode;if(a!==0){e("WebPCheck failed with exit code "+a);return d("WAResultOrError").makeError("invalid-media")}return d("WAResultOrError").makeResult()});function g(b){return a.apply(this,arguments)}return g}()}var k=c("bx").getURL(c("bx")("6946"));e=function(){return d("WAWasmModuleCache").loadWasmModule(k)};g.createWebPCheck=a;g.getWebpCheckWasm=e}),98);
__d("WAValidateMedia",["Promise","WAIsMp4","WAIsOgg","WAIsWebP","WAMp4Check","WAParseWav","WAResultOrError","WATagsLogger","WAWebPCheck","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["validateMedia threw an exception: ",""]);k=function(){return a};return a}var l=d("WATagsLogger").TAGS(["WAValidateMedia"]);function a(a,b){b==null?void 0:b.addPoint("media_validation_start");return m(a).then(function(a){a.success?b==null?void 0:b.addPoint("media_validation_end",{bool:{is_validation_setup_failed:a.value.validationSetupFailed,is_validation_skipped:a.value.skipValidation},string:{validated_mime_type:a.value.mimeType}}):b==null?void 0:b.addPoint("media_validation_fail",{string:{validationError:a.error}});return a})["catch"](function(c){l.ERROR(k(),c);b==null?void 0:b.addPoint("media_validation_fail",{string:{validationError:c.toString()}});return d("WAResultOrError").makeResult({skipValidation:!0,mimeType:null,validatedPlaintext:a,validationSetupFailed:!0})})}function m(a){var c=new Uint8Array(a);if(d("WAIsWebP").isWebP(c))return p(a);if(d("WAIsMp4").isMp4(c))return r(a);if(d("WAIsOgg").isOgg(c))return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult({skipValidation:!1,mimeType:"audio/ogg",validatedPlaintext:a,validationSetupFailed:!1,audioStreamReport:null}));c=d("WAParseWav").validateWav(a);return c!=null?(h||(h=b("Promise"))).resolve(t(c)):(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeResult({mimeType:null,skipValidation:!0,validatedPlaintext:a,validationSetupFailed:!1}))}var n=function(a){l.WARN(j(),a)},o=function(a){l.LOG(i(),a)};function p(a){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAWebPCheck").createWebPCheck({getWasmModule:d("WAWebPCheck").getWebpCheckWasm,logError:n,logMessage:o});b=(yield b({input:a}));return!b.success?d("WAResultOrError").makeError(b.error==="invalid-media"?"invalid-webp":b.error):d("WAResultOrError").makeResult({skipValidation:!1,mimeType:"image/webp",validatedPlaintext:a,validationSetupFailed:!1})});return q.apply(this,arguments)}function r(a){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("WAMp4Check").createMp4Check({getWasmModule:d("WAMp4Check").getMp4CheckWasm,logError:n,logMessage:o});b=(yield b({input:a}));if(!b.success)return d("WAResultOrError").makeError(b.error==="invalid-media"?"invalid-mp4":b.error);b=b.value;var c=b.videoStreamReport;b=b.audioStreamReport;return c==null?b==null?d("WAResultOrError").makeError("invalid-mp4"):d("WAResultOrError").makeResult({skipValidation:!1,mimeType:"audio/mp4",validatedPlaintext:a,validationSetupFailed:!1,audioStreamReport:b}):d("WAResultOrError").makeResult({skipValidation:!1,mimeType:"video/mp4",validatedPlaintext:a,validationSetupFailed:!1,videoStreamReport:c,audioStreamReport:b})});return s.apply(this,arguments)}function t(a){var b=d("WAParseWav").parseWav(a),c=b.numChannels;b=b.sampleRate;return d("WAResultOrError").makeResult({skipValidation:!1,mimeType:"audio/wav",validatedPlaintext:a,validationSetupFailed:!1,audioStreamReport:{streamType:"LPCM",samplingRate:b,numberOfChannels:c}})}g.validateMedia=a}),98);
__d("WADownloadFullSizeOnlyTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","Promise","WADownloadMedia","WAFindMostRecentMediaEntry","WAIsMediaExpiredError","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAResultOrError","WAValidateMedia","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media after restore CDN URL: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and restore failed: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""]);k=function(){return a};return a}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.abortSignal,e=a.dbCallbacks,f=a.fullSizePlaintextHash,g=a.logger,i=a.mediaDownloadFlow;i.addPoint("get_media_entries_start");a=(yield e.getMediaEntries(f));if(!a.success){i.addPoint("get_media_entries_fail");return{fullsizePromise:(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("missing-media-entry"))}}a=a.value;i.addPoint("get_media_entries_end");var j=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(a);if(!j.success)return{fullsizePromise:(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("missing-media-entry"))};j=j.value;var k=j[0];j=j[1];j=d("WAMediaUtils").validateDecodedMediaEntryForDownload(j);if(!j.success)return{fullsizePromise:(h||(h=b("Promise"))).resolve(j)};j=j.value;f=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:f,logger:g,mediaDownloadFlow:i,mediaEntry:j});f=f.logDownloadResult;c=m({abortSignal:c,dbCallbacks:e,logger:g,mediaDownloadFlow:i,mediaEntries:a,msgIdOfRecentMediaEntry:k,recentMediaEntry:j}).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.success)return a;var b=(yield d("WAValidateMedia").validateMedia(a.value.plaintext,i));return!b.success?b:d("WAResultOrError").makeResult({serverMediaType:a.value.serverMediaType,unvalidatedMimeType:a.value.mimeType,validatedResult:b.value})});return function(b){return a.apply(this,arguments)}}());return{fullsizePromise:f(c)}});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.abortSignal,e=a.dbCallbacks,f=a.logger,g=a.mediaDownloadFlow;a.mediaEntries;var h=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var l=c("MAWEBSwitch").isEnabled()&&c("gkx")("23960");l&&g.addPoint("forcing_eb_download");l=l?d("WAResultOrError").makeError("signature-expired"):yield d("WADownloadMedia").downloadFullMediaOnly({abortSignal:b,downloadMediaMetric:g,mediaEntry:babelHelpers["extends"]({},a,{fbid:void 0,objectId:null}),protocolMsgId:null,updateMediaEntryForMsg:e.updateMediaEntryForMsg});if(l.success)return l;if(!d("WAIsMediaExpiredError").isMediaExpiredError(l.error)||!c("MAWEBSwitch").isEnabled())return l;var m=(yield e.getProtocolMsgIdAndSortOrderMs(h));if(m==null)return d("WAResultOrError").makeError("missing-sort-order-ms-for-restore");var n=m.protocolMsgId;m=m.sortOrderMs;a=a;h=h;var o=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(a.serverMediaType);if(o==null||a.objectId==null){f.ERROR(k(),l.error);return l}l=(yield d("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:a.objectId,logger:f,mediaDownloadFlow:g,mediaType:o,msgId:h,protocolMsgId:n,sortOrderMs:m}));if(!l.success){f.ERROR(j(),l.error);return l}o=(yield d("WADownloadMedia").downloadFullMediaOnly({abortSignal:b,downloadMediaMetric:babelHelpers["extends"]({},g,{addPoint:function(a,b){g.addPoint("second_"+a,b)}}),mediaEntry:babelHelpers["extends"]({},a,{directPath:l.value,fbid:void 0,objectId:null}),protocolMsgId:null,updateMediaEntryForMsg:e.updateMediaEntryForMsg}));if(!o.success){f.ERROR(i(),o.error);return o}return d("WAResultOrError").makeResult(o.value)});return n.apply(this,arguments)}g.startDownloadFullSizeTask=a;g.downloadOrRestoreFullSize=m}),98);
__d("WADownloadMediaPreviewV2",["WADownloadMedia","WADownloadProgressiveJpegPreview","WAMediaCrypto","WAMediaUtils","WAResultOrError","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["preview mediaEntry is incomplete: ",""]);h=function(){return a};return a}function a(a){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.abortSignal,c=a.hash,e=a.mediaEntry,f=a.progressiveJpegDetails,g=a.mediaDownloadFlow,i=a.updateMediaEntryForMsg;a=a.logger;var j=e.serverMediaType,k=d("WAMediaUtils").getMimeTypeFromServerMediaType(j);c=f==null?d("WAResultOrError").makeError("jpeg-stream-not-supported"):yield d("WADownloadProgressiveJpegPreview").maybeDownloadProgressiveJpegPreviewV2({abortSignal:b,hash:c,serverMediaType:j,mediaEntry:e,progressiveJpegDetails:f});if(c.success===!0)return d("WAResultOrError").makeResult({plaintext:c.value,mimeType:k,serverMediaType:j});f=e.downloadableThumbnail;if((f==null?void 0:f.directPath)==null)return d("WAResultOrError").makeError("media-not-found");c=d("WAMediaUtils").validateDownloadableThumbnailForDownload(f);if(c.success===!1){a.ERROR(h(),c.error);return d("WAResultOrError").makeError(c.error[0])}f=c.value;a=f.directPath;c=f.fileEncSha256;var l=f.fileSha256;f=f.mediaKey;var m=d("WAMediaCrypto").convertServerMediaTypeToPreviewMediaType(j);if(m==null)return d("WAResultOrError").makeError("request-error");b=(yield d("WADownloadMedia").downloadMediaImpl({abortSignal:b,protocolMsgId:null,downloadFlow:g,mediaTypeDetails:{messageType:m,type:"preview"},directPath:a,fileEncSha256:c,fileSha256:l,mediaKey:f,objectId:null,fbid:null,mediaEntry:e,dbCallbacks:{updateMediaEntryForMsg:i}}));return b.success===!1?b:d("WAResultOrError").makeResult({plaintext:b.value,mimeType:k,serverMediaType:j})});return i.apply(this,arguments)}g.downloadMediaPreview=a}),98);
__d("WAIsPreviewSupported",["$InternalEnum","WAProgressiveJpegGetPJpegDetails"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum").Mirrored(["NO","YES"]),i=b("$InternalEnum").Mirrored(["NO","YES","DuplicatedWithFullSize"]);function a(a){var b=a.serverMediaType;switch(b){case"image":var c,e;c=(c=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a).value)!=null?c:null;c=c!=null?h.YES:h.NO;if(((e=a.downloadableThumbnail)==null?void 0:e.directPath)==null)return[c,i.NO];a.downloadableThumbnail.directPath;e=a.downloadableThumbnail.directPath===a.directPath?i.DuplicatedWithFullSize:i.YES;return[c,e];case"video":if(((c=a.downloadableThumbnail)==null?void 0:c.directPath)==null)return[h.NO,i.NO];a.downloadableThumbnail.directPath;e=a.downloadableThumbnail.directPath===a.directPath?i.NO:i.YES;return[h.NO,e];case"sticker":case"ptt":case"audio":case"document":case"gif":case"ppic":case"md-app-state":case"md-msg-hist":case"kyc-id":case"template":case"thumbnail-image":case"thumbnail-video":case"thumbnail-gif":case"thumbnail-document":case"thumbnail-link":case"novi-video":case"novi-image":case"payment-bg-image":case"product":case"product-catalog-image":case"xma-image":case"biz-cover-photo":case"preview":case"newsletter-audio":case"newsletter-document":case"newsletter-image":case"newsletter-gif":case"newsletter-ptt":case"newsletter-sticker":case"newsletter-thumbnail-link":case"newsletter-video":case"sticker-pack":case"thumbnail-sticker-pack":case"music-artwork":return[h.NO,i.NO];default:b;return[h.NO,i.NO]}}g.PjpegPreviewSupport=h;g.DownloadablePreviewSupport=i;g.checkPreviewSupport=a}),98);
__d("WADownloadPreviewOnlyTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","Promise","WADownloadMediaPreviewV2","WAFindMostRecentMediaEntry","WAIsMediaExpiredError","WAIsPreviewSupported","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAValidateMedia","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media after restore CDN URL: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and restore failed: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""]);k=function(){return a};return a}function a(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.abortSignal,e=a.dbCallbacks,f=a.fullSizePlaintextHash,g=a.logger,i=a.mediaDownloadFlow;i.addPoint("get_media_entries_start");a=(yield e.getMediaEntries(f));if(!a.success){i.addPoint("get_media_entries_fail");return{previewPromise:(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("missing-media-entry"))}}i.addPoint("get_media_entries_end");var j=a.value;j=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(j);if(!j.success)return{previewPromise:(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("missing-media-entry"))};j=j.value;var k=j[0];j=j[1];j=d("WAMediaUtils").validateDecodedMediaEntryForDownload(j);if(!j.success)return{previewPromise:(h||(h=b("Promise"))).resolve(j)};j=j.value;var l=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:f,logger:g,mediaDownloadFlow:i,mediaEntry:j});l=l.logDownloadResult;var n=d("WAIsPreviewSupported").checkPreviewSupport(j),o=n[0];n=n[1];if(o===d("WAIsPreviewSupported").PjpegPreviewSupport.NO&&n===d("WAIsPreviewSupported").DownloadablePreviewSupport.NO)return{previewPromise:(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("preview-not-supported"))};o=m({abortSignal:c,dbCallbacks:e,fullSizePlaintextHash:f,logger:g,mediaDownloadFlow:i,mediaEntries:a.value,msgIdOfRecentMediaEntry:k,recentMediaEntry:j}).then(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){if(!a.success)return a;var b=(yield d("WAValidateMedia").validateMedia(a.value.plaintext,i));return!b.success?b:d("WAResultOrError").makeResult({serverMediaType:a.value.serverMediaType,unvalidatedMimeType:a.value.mimeType,validatedResult:b.value})});return function(b){return a.apply(this,arguments)}}());return{previewPromise:l(o)}});return l.apply(this,arguments)}function m(a){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.abortSignal,e=a.dbCallbacks,f=a.fullSizePlaintextHash,g=a.logger,h=a.mediaDownloadFlow;a.mediaEntries;var l=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var m=c("MAWEBSwitch").isEnabled()&&c("gkx")("23960");m&&h.addPoint("forcing_eb_download");var n=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a);n=n.success===!0?n.value:null;b={abortSignal:b,hash:f,logger:g,mediaDownloadFlow:h,progressiveJpegDetails:n,updateMediaEntryForMsg:e.updateMediaEntryForMsg};f=m?d("WAResultOrError").makeError("signature-expired"):yield d("WADownloadMediaPreviewV2").downloadMediaPreview(babelHelpers["extends"]({},b,{mediaEntry:babelHelpers["extends"]({},a,{fbid:void 0,objectId:null})}));if(f.success)return d("WAResultOrError").makeResult({mimeType:f.value.mimeType,plaintext:f.value.plaintext,serverMediaType:f.value.serverMediaType});if(!d("WAIsMediaExpiredError").isMediaExpiredError(f.error)||!c("MAWEBSwitch").isEnabled()||c("gkx")("1327")!==!0)return f;n=(yield e.getProtocolMsgIdAndSortOrderMs(l));if(n==null)return d("WAResultOrError").makeError("missing-sort-order-ms-for-restore");m=n.protocolMsgId;e=n.sortOrderMs;n=a;a=l;l=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(n.serverMediaType);if(l==null||((l=n.downloadableThumbnail)==null?void 0:l.objectId)==null){g.ERROR(k(),f.error);return f}l=(yield d("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:n.downloadableThumbnail.objectId,logger:g,mediaDownloadFlow:h,mediaType:"preview",msgId:a,protocolMsgId:m,sortOrderMs:e}));if(!l.success){g.ERROR(j(),l.error);return l}f=(yield d("WADownloadMediaPreviewV2").downloadMediaPreview(babelHelpers["extends"]({},b,{mediaDownloadFlow:babelHelpers["extends"]({},h,{addPoint:function(a,b){h.addPoint("second_"+a,b)}}),mediaEntry:babelHelpers["extends"]({},n,{directPath:l.value,fbid:void 0,objectId:null})})));if(!f.success){g.ERROR(i(),f.error);return f}return d("WAResultOrError").makeResult({mimeType:f.value.mimeType,plaintext:f.value.plaintext,serverMediaType:f.value.serverMediaType})});return n.apply(this,arguments)}g.startDownloadPreviewTask=a;g.downloadOrRestorePreviewOnly=m}),98);
__d("WADownloadProgressiveJpegUsingMediaStreaming",["WAByteArray","WACryptoSha256","WACryptoUtils","WADownloadProgressiveJpegPlaintextStreamer","WADownloadProgressiveJpegPreview","WAErrorMessage","WAMediaUtils","WAProgressiveJpegAddJPEGTrailingTag","WAResolvable","WAResultOrError","WAStreamAsyncIterator","WATypedArraysConcat","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Exception occurred during Media Streaming: Reason: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Media streaming for ProgressiveJpeg download failed due to plaintext hash mismatch."]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["pjpeg stream ended before reaching previewTargetScanIndex"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullsizeResolvable is settled before previewResolvable"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleProgressiveJpegDownloadStream unexpected runtime-error: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["handleProgressiveJpegDownloadStream completed"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["create DownloadAndDecryptPJpegStream unexpected runtime-error: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["Using Media Streaming to download ProgressiveJpeg."]);o=function(){return a};return a}function a(a){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.abortSignal,c=a.directPath,e=a.downloadFlow,f=a.fileEncSha256,g=a.fileSha256,h=a.logger,i=a.mediaKey,j=a.progressiveJpegDetails,p=a.serverMediaType,r=h.TAGS(["MediaStreaming"]);r.LOG(o());e.addPoint("create_pjpeg_stream_start");a=(yield d("WADownloadProgressiveJpegPlaintextStreamer").downloadProgressiveJpegPlaintextUsingStreams({abortSignal:b,directPath:c,eventFlow:e,fileEncSha256:f,mediaKey:i,progressiveJpegDetails:j,serverMediaType:p})["catch"](function(a){r.ERROR(n(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)}));if(a.success===!1){e.addPoint("create_pjpeg_stream_fail");return a}e.addPoint("create_pjpeg_stream_end");var s=new(d("WAResolvable").Resolvable)();h=!1;b=q({downloadFlow:e,fileSha256:g,mediaStreamingLogger:r,previewResolvable:s,progressiveJpegDetails:j,progressiveJpegDownloadStream:a.value,serverMediaType:p}).then(function(a){h=!0;r.DEV(m());return a})["catch"](function(a){h=!0;r.ERROR(l(),d("WAErrorMessage").maybeGetMessageFromError(a));s.reject(a);return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)});var t=d("WAMediaUtils").getMimeTypeFromServerMediaType(p);function u(a){return a.success===!1?a:d("WAResultOrError").makeResult({mimeType:t,plaintext:a.value,serverMediaType:p})}c=b.then(u);f=s.promise.then(u);i=(yield s.promise);i.success===!0&&h===!0&&r.ERROR(k());if(i.success===!0)return d("WAResultOrError").makeResult({fullsizePromise:c,previewPromise:f});e=(yield b);i.success;if(e.success===!0)return d("WAResultOrError").makeResult({fullsizePromise:c,previewPromise:f});e.success;return e});return p.apply(this,arguments)}function q(a){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.downloadFlow,c=a.fileSha256,e=a.mediaStreamingLogger,f=a.previewResolvable,g=a.progressiveJpegDetails;a=a.progressiveJpegDownloadStream;b.addPoint("download_pjpeg_preview_start");var k=0;g=d("WADownloadProgressiveJpegPreview").getPreviewTargetScan(g.scanLengths)-1;try{var l=[],m=!0,n=!1,o;try{for(var p=babelHelpers.asyncIterator(d("WAStreamAsyncIterator").streamAsyncIterator(a)),a,a;a=(yield p.next()),m=a.done,a=(yield a.value),!m;m=!0){a=a;if(a==null)continue;l.push(a);if(k===g){b.addPoint("media_streaming_preview_processed");a=d("WAByteArray").uint8ArrayToBuffer(d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(l,[d("WAProgressiveJpegAddJPEGTrailingTag").JPEG_TRAILING_TAG])));f.resolve(d("WAResultOrError").makeResult(a));b.addPoint("download_pjpeg_preview_end")}k++}}catch(a){n=!0,o=a}finally{try{!m&&p["return"]!=null&&(yield p["return"]())}finally{if(n)throw o}}f.isSettled===!1&&(e.ERROR(j()),f.resolve(d("WAResultOrError").makeError("runtime-error")),b.addPoint("download_pjpeg_preview_fail"));a=d("WAByteArray").uint8ArrayToBuffer(d("WATypedArraysConcat").concatTypedArrays(Uint8Array,[].concat(l)));k=(yield d("WACryptoSha256").sha256(a));if(!d("WACryptoUtils").arrayBuffersEqual(c,k)){e.WARN(i());return d("WAResultOrError").makeError("hash-mismatch")}return d("WAResultOrError").makeResult(a)}catch(a){e.ERROR(h(),a);f.isSettled===!1&&(f.resolve(d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)),b.addPoint("download_pjpeg_preview_fail"));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)}});return r.apply(this,arguments)}g.downloadProgresiveJpegUsingMediaStreaming=a}),98);
__d("WADownloadFullSizeAndPreviewTask",["EncryptedBackupsResignCdnUrl","MAWCastToMsgrServerMediaType","MAWEBSwitch","Promise","UserAgent","WADownloadFullSizeOnlyTask","WADownloadPreviewOnlyTask","WADownloadProgressiveJpegUsingMediaStreaming","WAErrorMessage","WAFindMostRecentMediaEntry","WAHashUtils","WAIsMediaExpiredError","WAIsPreviewSupported","WAMediaManagerPrepareMediaDownload","WAMediaUtils","WAProgressiveJpegGetPJpegDetails","WAResultOrError","WAStartMediaDownloadQplFlow","WAValidateMedia","asyncToGeneratorRuntime","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadProgresiveJpegUsingMediaStreaming unexpected runtime-error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Failed to download media and can not restore: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["downloadProgresiveJpegUsingMediaStreaming unexpected runtime-error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["media entry: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["skip pjpeg streaming because pjpeg metadata is null"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["fallback to non-streaming download"]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["outter promise failed: ",""]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["outter promise: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid mediaEntry for download: ",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["preview duplicated with fullsize"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["preview not supported"]);s=function(){return a};return a}function a(a){return t.apply(this,arguments)}function t(){t=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.abortSignal,e=a.dbCallbacks,f=a.fullSizePlaintextHash,g=a.logger;a=a.mediaDownloadFlow;a.addPoint("get_media_entries_start");var i=(yield e.getMediaEntries(f));if(!i.success){a.addPoint("get_media_entries_fail");return{fullsizePromise:(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("missing-media-entry")),previewPromise:h.resolve(d("WAResultOrError").makeError("missing-media-entry"))}}a.addPoint("get_media_entries_end");i=i.value;var j=d("WAFindMostRecentMediaEntry").findMostRecentMediaEntry(i);if(!j.success)return{fullsizePromise:(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("missing-media-entry")),previewPromise:h.resolve(d("WAResultOrError").makeError("missing-media-entry"))};j=j.value;var k=j[0];j=j[1];j=d("WAMediaUtils").validateDecodedMediaEntryForDownload(j);if(!j.success){g.ERROR(q(),j.error);return{fullsizePromise:(h||(h=b("Promise"))).resolve(j),previewPromise:h.resolve(j)}}return w({abortSignal:c,dbCallbacks:e,fullSizePlaintextHash:f,logger:g,mediaDownloadFlow:a,mediaEntries:i,msgIdOfRecentMediaEntry:k,recentMediaEntry:j.value}).then(function(a){g.DEV(p(),a.success===!0?"success":a.error);if(!a.success){g.ERROR(o(),a.error);return{fullsizePromise:(h||(h=b("Promise"))).resolve(a),previewPromise:h.resolve(a)}}return a.value})});return t.apply(this,arguments)}function u(a,b){return v.apply(this,arguments)}function v(){v=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=(yield a);if(!a.success)return(h||(h=b("Promise"))).resolve(a);c=(yield d("WAValidateMedia").validateMedia(a.value.plaintext,c));return!c.success?c:d("WAResultOrError").makeResult({serverMediaType:a.value.serverMediaType,unvalidatedMimeType:a.value.mimeType,validatedResult:c.value})});return v.apply(this,arguments)}function w(a){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.abortSignal,c=a.dbCallbacks,e=a.fullSizePlaintextHash,f=a.logger,g=a.mediaDownloadFlow,h=a.mediaEntries,i=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var j=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:e,logger:f,mediaDownloadFlow:g,mediaEntry:a});j=j.logDownloadResult;var k={abortSignal:b,dbCallbacks:c,logger:f,mediaDownloadFlow:g,mediaEntries:h,msgIdOfRecentMediaEntry:i,recentMediaEntry:a};b=(yield y(babelHelpers["extends"]({},k,{fullSizePlaintextHash:e})));if(b.success){c=b.value;h=c.fullsizePromise;i=c.previewPromise;a=h.then(function(a){if(a.success)return a;g.addPoint("fallback_to_non_streaming_download",{string:{streaming_fallback_reason:a.error}});return d("WADownloadFullSizeOnlyTask").downloadOrRestoreFullSize(k)});return d("WAResultOrError").makeResult({fullsizePromise:j(u(a,g)),previewPromise:u(i,g)})}c=C(b.error);if(!c.shouldFallback)return d("WAResultOrError").makeError(c.error);g.addPoint("fallback_to_non_streaming_download",{string:{streaming_fallback_reason:c.error}});f.LOG(n());h=u(d("WADownloadFullSizeOnlyTask").downloadOrRestoreFullSize(k),g);a=A(babelHelpers["extends"]({},k,{fullSizePlaintextHash:e,fullsizePromise:h}));return d("WAResultOrError").makeResult({fullsizePromise:j(h),previewPromise:a})});return x.apply(this,arguments)}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b,e=a.abortSignal,f=a.dbCallbacks,g=a.logger,h=a.mediaDownloadFlow;a.mediaEntries;var n=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var o=c("MAWEBSwitch").isEnabled()&&c("gkx")("23960");o&&h.addPoint("forcing_eb_download");var p=a.directPath,q=a.fileEncSha256,r=a.fileSha256,s=a.mediaKey,t=a.serverMediaType;b=(b=d("WAProgressiveJpegGetPJpegDetails").maybeGetProgressiveJpegDetailsUsingMediaEntry(a).value)!=null?b:null;if(b==null||a.serverMediaType!=="image"||!d("WAMediaUtils").isTransformStreamSupported()||c("UserAgent").isBrowser("Safari < 18")||c("UserAgent").isBrowser("Mobile Safari < 18")){a.serverMediaType==="image"&&b==null&&(g.LOG(m()),g.DEV(l(),a));return d("WAResultOrError").makeError("jpeg-stream-not-supported")}h.addPoint("media_streaming_start");o=o?d("WAResultOrError").makeError("signature-expired"):yield d("WADownloadProgressiveJpegUsingMediaStreaming").downloadProgresiveJpegUsingMediaStreaming({abortSignal:e,directPath:p,downloadFlow:h,fileEncSha256:q,fileSha256:r,logger:g,mediaKey:s,progressiveJpegDetails:b,serverMediaType:t})["catch"](function(a){g.ERROR(k(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)});if(o.success){h.addPoint("media_streaming_end");return o}if(!d("WAIsMediaExpiredError").isMediaExpiredError(o.error)||!c("MAWEBSwitch").isEnabled()){B(h,o);return o}p=(yield f.getProtocolMsgIdAndSortOrderMs(n));if(p==null)return d("WAResultOrError").makeError("missing-sort-order-ms-for-restore");q=p.protocolMsgId;r=p.sortOrderMs;s=a;t=n;f=s.fileEncSha256;p=s.fileSha256;a=s.mediaKey;n=s.serverMediaType;var u=d("MAWCastToMsgrServerMediaType").castToMsgrServerMediaType(n);if(u==null||s.objectId==null){g.ERROR(j(),o.error);return o}o=(yield d("EncryptedBackupsResignCdnUrl").resignCdnUrl({deliveryObjectId:s.objectId,logger:g,mediaDownloadFlow:h,mediaType:u,msgId:t,protocolMsgId:q,sortOrderMs:r}));if(!o.success)return o;h.addPoint("second_media_streaming_start");s=(yield d("WADownloadProgressiveJpegUsingMediaStreaming").downloadProgresiveJpegUsingMediaStreaming({abortSignal:e,directPath:o.value,downloadFlow:babelHelpers["extends"]({},h,{addPoint:function(a,b){h.addPoint("second_"+a,b)}}),fileEncSha256:f,fileSha256:p,logger:g,mediaKey:a,progressiveJpegDetails:b,serverMediaType:n})["catch"](function(a){g.ERROR(i(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)}));if(s.success){h.addPoint("second_media_streaming_end");return s}else{B(h,s);return s}});return z.apply(this,arguments)}function A(a){var c=a.abortSignal,e=a.dbCallbacks,f=a.fullSizePlaintextHash,g=a.fullsizePromise,i=a.logger,j=a.mediaDownloadFlow,k=a.mediaEntries,l=a.msgIdOfRecentMediaEntry;a=a.recentMediaEntry;var m=a.serverMediaType,n=d("WAIsPreviewSupported").checkPreviewSupport(a),o=n[0];n=n[1];if(o===d("WAIsPreviewSupported").PjpegPreviewSupport.NO&&n===d("WAIsPreviewSupported").DownloadablePreviewSupport.NO){i.LOG(s());return(h||(h=b("Promise"))).resolve(d("WAResultOrError").makeError("preview-not-supported"))}if(n===d("WAIsPreviewSupported").DownloadablePreviewSupport.DuplicatedWithFullSize){i.LOG(r());return g}var p=d("WAStartMediaDownloadQplFlow").startMediaDownloadQplFlow({downloadEntry:j.downloadEntry,isPreview:!0,msgType:null,protocolMsgId:null,triggerUIView:null});o=d("WAMediaManagerPrepareMediaDownload").mediaManagerPrepareMediaDownload({hash:f,logger:i,mediaDownloadFlow:p,mediaEntry:a});n=o.logDownloadResult;p.addAnnotations({bool:{isMediaManager:!0},string:{downloadKind:"fullsizeAndPreview",fullSizeMediaType:m,mediaType:"preview",sanitisedMediaHash:d("WAHashUtils").sanitisePlaintextHash(f)}});g=d("WADownloadPreviewOnlyTask").downloadOrRestorePreviewOnly({abortSignal:c,dbCallbacks:e,fullSizePlaintextHash:f,logger:i,mediaDownloadFlow:p,mediaEntries:k,msgIdOfRecentMediaEntry:l,recentMediaEntry:a});return n(u(g,p)).then(function(a){a.success?p.endSuccess():p.endFail(a.error,{string:{failReason:a.error}});return a})["catch"](function(a){p.endFail("runtime-error",{string:{failReason:d("WAErrorMessage").maybeGetMessageFromError(a)}});return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})}function B(a,b){a.addPoint("media_streaming_fail",{string:{wa_media_download_streaming_fail_reason:b.payload!=null?d("WAErrorMessage").maybeGetMessageFromError(b.payload):b.error}})}function C(a){switch(a){case"runtime-error":case"jpeg-stream-not-supported":return{error:a,shouldFallback:!0};case"missing-expected-hmacs":case"hmac-chiphertext-array-mismatch":return{error:a,shouldFallback:!0};case"missing-media-entry":case"missing-media-entry-for-restore":case"missing-sort-order-ms-for-restore":case"preview-not-supported":return{error:a,shouldFallback:!1};case"direct-path-undefined":case"direct-path-corrupted":case"direct-path-empty":case"create-payload-failed":case"resign-cdn-url-request-error":case"resign-cdn-url-runtime-error":case"resign-cdn-url-timeout":case"resign-cdn-url-gql-error":return{error:a,shouldFallback:!1};case"invalid-webp":case"invalid-mp4":return{error:a,shouldFallback:!1};case"decryption-error":case"enc-hash-mismatch":case"hash-mismatch":case"ciphertext-hash-mismatch":return{error:a,shouldFallback:!0};case"access-expired":case"disconnected":case"backoff":case"body-network-error":case"http-fetch-exception":case"http-fetch-aborted":case"no-host":case"server-timeout":case"unspecified-http-error":case"media-not-found":case"download-throttled":case"request-error":case"max-attempts-exceeded":case"signature-expired":case"media-entry-invalid":return{error:a,shouldFallback:!1};case"media-entry-invalid-direct-path":case"media-entry-invalid-file-enc-sha256":case"media-entry-invalid-file-sha256":case"media-entry-invalid-media-key":case"media-entry-invalid-server-media-type":return{error:a,shouldFallback:!1}}}g.startDownloadFullSizeAndPreviewTask=a}),98);
__d("WAMediaManagerLogger",["WAHashUtils","WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";var h=d("WATagsLogger").TAGS(["MediaManager"]);function a(a){var b=a.downloadKind;a=a.fullSizePlaintextHash;a=h.TAGS(["download","hash:"+d("WAHashUtils").sanitisePlaintextHash(a),b]);return a}function b(a){var b=a.plaintextHash;a=a.uploadKind;b=h.TAGS(["upload","hash:"+d("WAHashUtils").sanitisePlaintextHash(b),a]);return b}g.baseLogger=h;g.createDownloadLogger=a;g.createUploadLogger=b}),98);
__d("WAIsMediaDownloadRemovePersistedJobEnable",["gkx","memoize"],(function(a,b,c,d,e,f,g){"use strict";a=c("memoize")(function(){return c("gkx")("12064")});g.isMediaDownloadRemovePersistedJobEnable=a}),98);
__d("WAMediaManagerWorkerScheduler",["WAIsMediaDownloadRemovePersistedJobEnable","WorkerScheduler"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){h==null&&(h=d("WorkerScheduler").makeScheduler("MediaManager",{concurrency:16,maxConcurrency:32,maxThrottleMs:d("WAIsMediaDownloadRemovePersistedJobEnable").isMediaDownloadRemovePersistedJobEnable()?60*1e3:30*1e3,timeToStuckMs:d("WAIsMediaDownloadRemovePersistedJobEnable").isMediaDownloadRemovePersistedJobEnable()?180*1e3:60*1e3}));return h}g.mediaManagerWorkerScheduler=a}),98);
__d("WAUploadMediaQuick",["Promise","WACreateRetrier","WAEncryptAndUploadPlaintext","WAMediaUtils","WATimeUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["start uploadMediaQuick"]);i=function(){return a};return a}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=a.mediaUploadFlow,e=a.plaintext,f=a.plaintextHash,g=a.serverMediaType;a=a.logger;a.DEV(i());c.addPoint("create_upload_retrier_start");a=(yield d("WACreateRetrier").createUploadRetrier(g,c));if(!a.success){c.addPoint("create_upload_retrier_fail");return a}c.addPoint("create_upload_retrier_end");c.addPoint("create_media_key_start");var j=d("WAMediaUtils").createMediaKey(),k=d("WAMediaUtils").createUploadToken(),l=d("WATimeUtils").unixTime();c.addPoint("create_media_key_end");j=(yield d("WAEncryptAndUploadPlaintext").encryptAndUploadPlaintext({size:0,filename:"",mediaKey:j,mediaKeyTimestamp:l,serverMediaType:g,mediaUploadFlow:c,plaintext:e,plaintextHash:f,updateMediaEntry:function(){return(h||(h=b("Promise"))).resolve()},uploadRetrier:a.value,uploadToken:k,getDownloadableThumbnailForMedia:function(){return(h||(h=b("Promise"))).resolve()}}));return j});return j.apply(this,arguments)}g.uploadMediaQuick=a}),98);
__d("mapWorkerSchedulerTask",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){return babelHelpers["extends"]({},a,{promise:a.promise.then(b),run:function(){return a.run().then(b)}})}f.mapWorkerSchedulerTask=a}),66);
__d("WAMediaManager",["$InternalEnum","WADownloadFullSizeAndPreviewTask","WADownloadFullSizeOnlyTask","WADownloadPreviewOnlyTask","WAErrorMessage","WAHashUtils","WAMediaManagerCache","WAMediaManagerLogger","WAMediaManagerWorkerScheduler","WAResultOrError","WATimeUtils","WAUploadMediaQuick","WorkerScheduler","justknobx","mapWorkerSchedulerTask"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["upload end"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["preview end"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["previewPromise runtime-error: ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullsize end"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullsizePromise runtime-error: ",""]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["fullsize: ",", preview: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["end"]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["end"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["runtime-error: ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);t=function(){return a};return a}var u=b("$InternalEnum").Mirrored(["HIGH","MEDIUM","LOW"]);function a(a){var b=a.dbCallbacks,e=d("WAMediaManagerWorkerScheduler").mediaManagerWorkerScheduler(),f=d("WAMediaManagerCache").createMediaDownloadCache(),g=function(a){var c=d("WAMediaManagerLogger").createDownloadLogger({downloadKind:"fullsize",fullSizePlaintextHash:a.fullSizePlaintextHash}),g=f.getFullsize(a);c.DEV(t(),g.type);if(g.type==="cache-hit")return g.cache;var h=new AbortController(),i=e.task({fn:function(){return d("WADownloadFullSizeOnlyTask").startDownloadFullSizeTask({abortSignal:h.signal,dbCallbacks:b,fullSizePlaintextHash:a.fullSizePlaintextHash,logger:c,mediaDownloadFlow:a.mediaDownloadFlow})},name:"media-manager-download-fullsize-only",priority:v(a.priority)}),j=i.run();g.setCache(a.fullSizePlaintextHash,h,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(i,function(a){return a.fullsizePromise}));return j.then(function(a){return a.fullsizePromise})["catch"](function(a){c.ERROR(s(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(r())})},u=function(a){var c=d("WAMediaManagerLogger").createDownloadLogger({downloadKind:"preview",fullSizePlaintextHash:a.fullSizePlaintextHash}),g=f.getPreview(a);c.DEV(q(),g.type);if(g.type==="cache-hit")return g.cache;var h=new AbortController(),i=e.task({fn:function(){return d("WADownloadPreviewOnlyTask").startDownloadPreviewTask({abortSignal:h.signal,dbCallbacks:b,fullSizePlaintextHash:a.fullSizePlaintextHash,logger:c,mediaDownloadFlow:a.mediaDownloadFlow})},name:"media-manager-download-preview-only",priority:v(a.priority)});g.setCache(a.fullSizePlaintextHash,h,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(i,function(a){return a.previewPromise}));g=i.run();return g.then(function(a){return a.previewPromise})["catch"](function(a){c.ERROR(p(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(o())})};a=function(a){var c=d("WAMediaManagerLogger").createDownloadLogger({downloadKind:"fullsizeAndPreview",fullSizePlaintextHash:a.fullSizePlaintextHash}),h=f.getFullsizeAndPreview(a),i=h.fullsizeCacheResult;h=h.previewCacheResult;c.DEV(n(),i.type,h.type);if(i.type==="cache-hit"&&h.type==="cache-hit")return{fullsizePromise:i.cache,previewPromise:h.cache};if(h.type==="cache-hit"){var o=g(a);return{fullsizePromise:o,previewPromise:h.cache}}if(i.type==="cache-hit"){o=u(a);return{fullsizePromise:i.cache,previewPromise:o}}i.type;h.type;var p=new AbortController();o=e.task({fn:function(){return d("WADownloadFullSizeAndPreviewTask").startDownloadFullSizeAndPreviewTask({abortSignal:p.signal,dbCallbacks:b,fullSizePlaintextHash:a.fullSizePlaintextHash,logger:c,mediaDownloadFlow:a.mediaDownloadFlow})},name:"media-manager-download-fullsize-and-preview",priority:v(a.priority)});i.setCache(a.fullSizePlaintextHash,p,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(o,function(a){return a.fullsizePromise}));h.setCache(a.fullSizePlaintextHash,p,a.mediaDownloadFlow,d("mapWorkerSchedulerTask").mapWorkerSchedulerTask(o,function(a){return a.previewPromise}));i=o.run();return{fullsizePromise:i.then(function(a){return a.fullsizePromise})["catch"](function(a){c.ERROR(m(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(l())}),previewPromise:i.then(function(a){return a.previewPromise})["catch"](function(a){c.ERROR(k(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)})["finally"](function(){c.DEV(j())})}};var w=z(),x=w.isInMemoryMediaUploadCache;w=function(a){var b=d("WAMediaManagerLogger").createUploadLogger({plaintextHash:a.plaintextHash,uploadKind:"fullsize"});if(c("justknobx")._("4810")){var e=x({chatJid:a.chatJid,plaintextHash:a.plaintextHash});a.mediaUploadFlow.addAnnotations({bool:{is_cross_thread_dedupe_candidate:e==="cross-thread",is_in_thread_dedupe_candidate:e==="in-thread"}})}return d("WAUploadMediaQuick").uploadMediaQuick({logger:b,mediaUploadFlow:a.mediaUploadFlow,plaintext:a.plaintext,plaintextHash:a.plaintextHash,serverMediaType:a.serverMediaType})["catch"](function(a){b.ERROR(i(),d("WAErrorMessage").maybeGetMessageFromError(a));return d("WAResultOrError").makeError("runtime-error")})["finally"](function(){b.DEV(h())})};return{clearCache:f.clearCache,dequeueDownload:f.cancelTask,enqueueDownloadFullSize:y("fullsize",g),enqueueDownloadFullSizeAndPreview:y("fullsizeAndPreview",a),enqueueDownloadPreview:y("preview",u),enqueueUploadFullSize:w}}function v(a){switch(a){case u.HIGH:return d("WorkerScheduler").BLOCKING_PRIORITY;case u.MEDIUM:return d("WorkerScheduler").REGULAR_PRIORITY;case u.LOW:return d("WorkerScheduler").BACKGROUND_PRIORITY}}var w=typeof ((e=navigator.storage)==null?void 0:e.getDirectory)==="function",x=typeof self.caches==="object";function y(a,b){return function(c){var e=c.fullSizePlaintextHash,f=c.mediaDownloadFlow;try{f.addPoint("enqueue_start",{bool:{isMediaManager:!0,isOPFSSupported:w,isWebCacheSupported:x},string:{downloadKind:a,sanitisedMediaHash:d("WAHashUtils").sanitisePlaintextHash(e)}});e=b(c);f.addPoint("enqueue_end");return e}catch(a){f.addPoint("enqueue_fail");throw a}}}function z(){var a=new Map();return{isInMemoryMediaUploadCache:function(b){var c=b.chatJid;b=b.plaintextHash;var e=a.get(b);if(e==null){a.set(b,{chatJids:new Set([c]),ttl:d("WATimeUtils").futureUnixTime(2*d("WATimeUtils").DAY_SECONDS)});return"no-cache"}var f=e.chatJids;e=e.ttl;if(d("WATimeUtils").isInFuture(e)){e=f.has(c);f.add(c);return e?"in-thread":"cross-thread"}a.set(b,{chatJids:new Set([c]),ttl:d("WATimeUtils").futureUnixTime(2*d("WATimeUtils").DAY_SECONDS)});return"no-cache"}}}g.MediaTaskPriority=u;g.createMediaManager=a;g.toWorkerSchedulerPriority=v}),98);
__d("WAMediaManagerCache",["WAHashUtils","WAMediaManager","WAMediaManagerLogger","WAPromiseDelays"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker task cancel"]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["http abort cancel"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["start"]);j=function(){return a};return a}var k=1e3*30;function a(){var a=new Map(),b=new Map(),c=function(a,c,e,f){b.set(a,{abortController:c,mediaDownloadFlow:e,task:f}),f.promise.then(function(a){a=a.success;return a?d("WAPromiseDelays").delayMs(k):void 0})["finally"](function(){b["delete"](a)})},e=function(b,c,e,f){a.set(b,{abortController:c,mediaDownloadFlow:e,task:f}),f.promise.then(function(a){a=a.success;return a?d("WAPromiseDelays").delayMs(k):void 0})["finally"](function(){a["delete"](b)})};return{cancelTask:function(c){var e=d("WAMediaManagerLogger").baseLogger.TAGS(["hash:"+d("WAHashUtils").sanitisePlaintextHash(c),"cancelTask"]);e.LOG(j());var f=[b,a];for(f of f){var g=f.get(c);if(g!=null){var k=g.task.cancel();g.mediaDownloadFlow.addPoint("cancel_download_triggered");k===!1?(g.abortController.abort(),g.mediaDownloadFlow.addPoint("http_abort_cancel"),e.LOG(i())):(g.mediaDownloadFlow.addPoint("worker_task_cancel_cancel"),e.LOG(h()));f["delete"](c)}}},clearCache:function(){a.clear(),b.clear()},getFullsize:function(a){var e=b.get(a.fullSizePlaintextHash);if(e!=null){l(a.mediaDownloadFlow,"hit","fullsize");e.task.promote(d("WAMediaManager").toWorkerSchedulerPriority(a.priority));return{cache:e.task.promise,type:"cache-hit"}}l(a.mediaDownloadFlow,"miss","fullsize");return{setCache:c,type:"cache-miss"}},getFullsizeAndPreview:function(f){var g=d("WAMediaManager").toWorkerSchedulerPriority(f.priority),h=b.get(f.fullSizePlaintextHash),i=a.get(f.fullSizePlaintextHash);if(h!=null&&i!=null){l(f.mediaDownloadFlow,"hit","fullsize-and-preview");h.task.promote(g);i.task.promote(g);return{fullsizeCacheResult:{cache:h.task.promise,type:"cache-hit"},previewCacheResult:{cache:i.task.promise,type:"cache-hit"}}}if(h!=null){l(f.mediaDownloadFlow,"hit","fullsize");h.task.promote(g);return{fullsizeCacheResult:{cache:h.task.promise,type:"cache-hit"},previewCacheResult:{setCache:e,type:"cache-miss"}}}if(i!=null){l(f.mediaDownloadFlow,"hit","preview");i.task.promote(g);return{fullsizeCacheResult:{setCache:c,type:"cache-miss"},previewCacheResult:{cache:i.task.promise,type:"cache-hit"}}}l(f.mediaDownloadFlow,"miss","fullsize-and-preview");return{fullsizeCacheResult:{setCache:c,type:"cache-miss"},previewCacheResult:{setCache:e,type:"cache-miss"}}},getPreview:function(b){var c=a.get(b.fullSizePlaintextHash);if(c!=null){l(b.mediaDownloadFlow,"hit","preview");c.task.promote(d("WAMediaManager").toWorkerSchedulerPriority(b.priority));return{cache:c.task.promise,type:"cache-hit"}}l(b.mediaDownloadFlow,"miss","preview");return{setCache:e,type:"cache-miss"}}}}function l(a,b,c){a.addAnnotations({string:{media_manager_cache_result:b,media_manager_cache_type:c}})}g.DOWNLOAD_TASK_CACHE_TTL_MS=k;g.createMediaDownloadCache=a}),98);
__d("MpsMediaManager",["MAWDbChunkTxns","MAWIndexedDb","MAWTransactionMode","MpsMediaEntryCache","MpsMessageToBridgeWrapper","MpsToBridgeMessageId","Promise","WAJids","WAMediaManager","WAMediaUtils","WAStanzaUtils","WAValidateMedia","WebMps","asyncToGeneratorRuntime","emptyFunction","err"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(){return d("WAMediaManager").createMediaManager({dbCallbacks:{getMediaEntries:function(a){a=d("MpsMediaEntryCache").getEntry(a);return a!=null?(h||(h=b("Promise"))).resolve({success:!0,value:new Map([[a.msgId,a.mediaEntry]])}):(h||(h=b("Promise"))).resolve({error:"no-media-by-plaintext-hash",success:!1})},getProtocolMsgIdAndSortOrderMs:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a=d("MpsToBridgeMessageId").bridgeMsgIdToMps(a);var b=a.messageId;a=a.threadId;b=(yield d("WebMps").mps().loadMessage({config:{shouldFetchSupplementals:!1,shouldFetchTags:!1,strategy:"local-only"},debug:{purpose:"mps_media_manager"},messageId:b,threadId:a}));if(!b.value)return;a=d("MpsMessageToBridgeWrapper").MpsMessageToBridgeWrapper.fromTopLevel(b.value.toplevelProtobuf);b=a.getAuthor();if(d("WAJids").isAuthorSystem(b))return;return{protocolMsgId:{author:b,chat:a.getChatJid(),externalId:d("WAStanzaUtils").toStanzaId(a.getExternalId())},sortOrderMs:a.message.timestampMs}});function c(b){return a.apply(this,arguments)}return c}(),updateMediaEntryForMsg:function(){return(h||(h=b("Promise"))).resolve()}}})},j=d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READWRITE},"storeChunk",function(a){return function(b,e,f){return d("MAWDbChunkTxns").getOrCreateMediaChunkWithPlaintextHash(a,b,e,f).then(c("emptyFunction"))}});function k(a,b,c){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){if(a==null)return;a=(yield d("WAValidateMedia").validateMedia(a.blobData,b));if(a.value==null)return;return{success:!0,value:{serverMediaType:c,unvalidatedMimeType:d("WAMediaUtils").getMimeTypeFromServerMediaType(c),validatedResult:a.value}}});return l.apply(this,arguments)}a=function(){var a=i(),e={clearCache:a.clearCache,dequeueDownload:a.dequeueDownload,enqueueDownloadFullSize:function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=d("MpsMediaEntryCache").getEntry(b.fullSizePlaintextHash);if(!c)return{error:"missing-media-entry",success:!1};var e=(yield d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READONLY},"mpsEnqueueDownloadFullSize",function(a){return function(){return d("MAWDbChunkTxns").maybeGetChunkByPlaintextHash(a,b.fullSizePlaintextHash)}})().then(function(a){return k(a,b.mediaDownloadFlow,c.serverMediaType)}));if(e!=null)return e;e=(yield a.enqueueDownloadFullSize(b));if(e.success===!0){var f;yield j(b.fullSizePlaintextHash,e.value.validatedResult.validatedPlaintext,(f=e.value.validatedResult.mimeType)!=null?f:e.value.unvalidatedMimeType)}return e});function e(a){return c.apply(this,arguments)}return e}(),enqueueDownloadFullSizeAndPreview:function(a){return{fullsizePromise:e.enqueueDownloadFullSize(a),previewPromise:e.enqueueDownloadPreview(a)}},enqueueDownloadPreview:function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var c=d("MpsMediaEntryCache").getEntry(b.fullSizePlaintextHash),e=c==null?void 0:c.thumbnailHash;if(c==null)return{error:"missing-media-entry",success:!1};else if(e==null)return{error:"preview-not-supported",success:!1};var f=(yield d("MAWIndexedDb").makeMsgrTransactor({chunk:d("MAWTransactionMode").READONLY},"mpsEnqueueDownloadPreview",function(a){return function(){return d("MAWDbChunkTxns").maybeGetChunkByPlaintextHash(a,e)}})().then(function(a){return k(a,b.mediaDownloadFlow,c.serverMediaType)}));if(f!=null)return f;f=(yield a.enqueueDownloadPreview(b));if(f.success===!0){var g;yield j(e,f.value.validatedResult.validatedPlaintext,(g=f.value.validatedResult.mimeType)!=null?g:f.value.unvalidatedMimeType)}return f});function e(a){return c.apply(this,arguments)}return e}(),enqueueUploadFullSize:function(){throw c("err")("Not implemented")}};return e};g.storeChunk=j;g.getMpsMediaManager=a}),98);
__d("MAWMediaManager",["MAWGetMostRescentDecodedMediaEntry","MAWGetProtocolMsgIdAndSortOrderMsApi","MAWMpsGating","MAWUpdateMediaEntryForMsgApi","MpsMediaManager","WAMediaManager"],(function(a,b,c,d,e,f,g){"use strict";var h=null;function a(){if(h==null){if(d("MAWMpsGating").isFullMpsEnabled()){var a=d("MpsMediaManager").getMpsMediaManager();h=a;return a}a=d("WAMediaManager").createMediaManager({dbCallbacks:{getMediaEntries:d("MAWGetMostRescentDecodedMediaEntry").getMediaEntries,getProtocolMsgIdAndSortOrderMs:d("MAWGetProtocolMsgIdAndSortOrderMsApi").getProtocolMsgIdAndSortOrderMs,updateMediaEntryForMsg:d("MAWUpdateMediaEntryForMsgApi").updateMediaEntryForMsg}});h=a;return a}return h}g.getMawMediaManager=a}),98);/*FB_PKG_DELIM*/
__d("EBMessagePointQueryWithPersistenceQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="10035011859900671"}),null);
__d("EBMessagePointQueryWithPersistenceQuery.graphql",["EBMessagePointQueryWithPersistenceQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a={defaultValue:null,kind:"LocalArgument",name:"app_id"},c={defaultValue:null,kind:"LocalArgument",name:"restore_payload_string"},d={defaultValue:null,kind:"LocalArgument",name:"restore_type"},e=[{kind:"Variable",name:"app_id",variableName:"app_id"},{kind:"Variable",name:"restore_payload_string",variableName:"restore_payload_string"},{kind:"Variable",name:"restore_type",variableName:"restore_type"}],f={alias:null,args:null,kind:"ScalarField",name:"encryption_version",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"epoch_anon_id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"epoch_id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"encrypted_protobuf_stanza",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"protobuf_timestamp_ms",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"sk_ciphertext",storageKey:null},l=[g,h];return{fragment:{argumentDefinitions:[a,c,d],kind:"Fragment",metadata:null,name:"EBMessagePointQueryWithPersistenceQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:e,concreteType:"XFBEncryptedBackupMessages",kind:"LinkedField",name:"messages_point_restore",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"handleRestoreMessagesGraphQLResponse_XFBEncryptedBackupMessages"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[c,d,a],kind:"Operation",name:"EBMessagePointQueryWithPersistenceQuery",selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackup",kind:"LinkedField",name:"encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMailbox",kind:"LinkedField",name:"mailbox",plural:!1,selections:[{alias:null,args:e,concreteType:"XFBEncryptedBackupMessages",kind:"LinkedField",name:"messages_point_restore",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupMessage",kind:"LinkedField",name:"encrypted_messages",plural:!0,selections:[{alias:null,args:null,concreteType:"XFBEchoDocument",kind:"LinkedField",name:"echo_document",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"echo_document_string",storageKey:null},f,g,h,{alias:null,args:null,kind:"ScalarField",name:"epoch_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"otid",storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanzas",kind:"LinkedField",name:"protobuf_stanzas",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"message_tags",storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"top_level_protobuf",plural:!1,selections:[i,f,g,h,j,k],storageKey:null},{alias:null,args:null,concreteType:"XFBProtobufStanza",kind:"LinkedField",name:"supplemental_protobufs",plural:!0,selections:[i,f,g,h,j,k,{alias:null,args:null,kind:"ScalarField",name:"supplemental_key",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"backup_id",storageKey:null},{alias:null,args:null,concreteType:"XFBMessageRangeInfo",kind:"LinkedField",name:"message_range_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"has_more_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"has_more_after",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_before",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"next_message_timestamp_ms_after",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"should_delete_mailbox",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exception_string",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"thread_not_found",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochDerivationSet",kind:"LinkedField",name:"epoch_derivation_set",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEncryptedBackupsEpochEdge",kind:"LinkedField",name:"epoch_edges",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"backward_edge",storageKey:null},{alias:null,args:null,concreteType:"XFBEpochForwardEdge",kind:"LinkedField",name:"forward_edge",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"auth_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"encrypted_entropy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entropy_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"epoch_storage_public_key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"psk_fingerprint",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"from_epoch",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"XFBEpochIds",kind:"LinkedField",name:"to_epoch",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"from_epoch_fingerprint",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"to_epoch_fingerprint",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("EBMessagePointQueryWithPersistenceQuery_facebookRelayOperation"),metadata:{},name:"EBMessagePointQueryWithPersistenceQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("EBMessagePointQueryWithPersistence",["Base64Utils","EBAPIQPLPoints","EBAPISharedUtils","EBAPIWorkerCheck","EBIsEbEnabled","EBMessagePointQueryWithPersistenceQuery.graphql","EBSMDBAPI","EBSMHydrationUtils","I64","LSDecryptMessageProtobufsStoredProcedure","LSDecryptMessagesStoredProcedure","LSEncryptedBackupsBackupTenancy","LSFactory","LSIntEnum","LSMEBTaskCreationSource","LSShape","LSVec","MAWBridge","MAWCurrentUser","MAWEBRestoreTrackingUtils","MAWEncryptedBackupUtils","MAWJobDefinitions","MAWMainTraceUtils","QPLUserFlow","WAHashStringToNumber","WALogger","WAResultOrError","WorkerRelay","WorkerRelayNetwork","asyncToGeneratorRuntime","cr:14165","gkx","handleRestoreMessagesGraphQLResponse","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] graphQL point restore error ",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["[protobuf-only] decryptMessageProtobufs failed with error: ",""]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["[protobuf-only] decryptMessageProtobufs failed with an error"]);m=function(){return a};return a}function n(){var a=babelHelpers.taggedTemplateLiteralLoose(["[echo-only][echo] decryptMessageEcho failed with error: ",""]);n=function(){return a};return a}function o(){var a=babelHelpers.taggedTemplateLiteralLoose(["[echo-only][echo] decryptMessageEcho failed with an error."]);o=function(){return a};return a}function p(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is not complete - cannot proceed with graphQL restore"]);p=function(){return a};return a}function q(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] backup_id is null during graphQL restore"]);q=function(){return a};return a}function r(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] message range info is null - cannot proceed with graphQL restore"]);r=function(){return a};return a}function s(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] server side exception during graphql restore - ",""]);s=function(){return a};return a}function t(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] GQL worker point restore query returned null for message response"]);t=function(){return a};return a}function u(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] mandatory params of client state are null"]);u=function(){return a};return a}function v(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No client state found - unable to restore"]);v=function(){return a};return a}function w(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] No client state found - unable to restore"]);w=function(){return a};return a}function x(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web] Calling EBLS without EBLS being available for message point query"]);x=function(){return a};return a}var y=h!==void 0?h:h=b("EBMessagePointQueryWithPersistenceQuery.graphql");function a(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.jid,g=a.messageId,h=a.sortOrderMs,z=a.source,A=a.threadId;a=a.traceId;if(!d("EBAPIWorkerCheck").runningInWorker())return d("WAResultOrError").makeError("unsupported-context");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql");var B=a!=null?a:d("MAWMainTraceUtils").createTraceId(),C=d("WAHashStringToNumber").hashStringToNumber(B),D=c("qpl")._(521474469,"2612");c("QPLUserFlow").start(D,{annotations:{bool:{mainThreadRestore:!1,workerThreadRestore:!0},"int":{source:z!=null?z:c("LSMEBTaskCreationSource").UNKNOWN}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestorePoint(z,B,"GQL_WORKER",!0);try{var E;if(b("cr:14165")==null){d("WALogger").ERROR(x());c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.EBLS_NOT_INITIALIZED,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.EBLS_NOT_INITIALIZED}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"ebls_not_initialized");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("ebls-not-initialized")}c("QPLUserFlow").addPoint(D,"before_ebls_initialization",{instanceKey:C});yield b("cr:14165").genLSClient();c("QPLUserFlow").addPoint(D,"after_ebls_initialization",{instanceKey:C});var F=(yield b("cr:14165").getLSStorage()),G=(yield d("EBIsEbEnabled").isEbEnabledLS(F.tables));if(c("gkx")("2489")){var H=d("EBSMDBAPI").getEBLSDB();H=(yield d("EBSMHydrationUtils").loadEBdataToEphemeralRestore(H));var I=d("EBAPISharedUtils").getClientStateFromPersistedEBSM(H);H=d("EBAPISharedUtils").getAvailableEpochsFromPersistedEBSM(H);if(I===null){d("WALogger").ERROR(w());c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.NO_CLIENT_STATE,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.NO_CLIENT_STATE}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"no_client_state");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("no-client-state")}var J=G!=null?G:d("EBAPISharedUtils").isBackupTenancyAuthoritative(I);if(!J){c("QPLUserFlow").addPoint(D,"eb_not_enabled",{instanceKey:C});c("QPLUserFlow").endSuccess(D,{instanceKey:C});d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"eb_not_enabled",traceId:B});d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(B,!0);d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.success");return d("WAResultOrError").makeResult()}J=d("EBAPISharedUtils").getDeviceAndKeyMetadata(I,H)}else{I=(yield d("MAWEncryptedBackupUtils").getBackupTenancy(F.tables));H=G!=null?G:I!=null&&(i||(i=d("I64"))).equal(I,(j||(j=d("LSIntEnum"))).ofNumber(c("LSEncryptedBackupsBackupTenancy").PRODUCTION));if(!H){c("QPLUserFlow").addPoint(D,"eb_not_enabled",{instanceKey:C});c("QPLUserFlow").endSuccess(D,{instanceKey:C});d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"eb_not_enabled",traceId:B});d("MAWEBRestoreTrackingUtils").markEBRestoreSuccess(B,!0);d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.success");return d("WAResultOrError").makeResult()}d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"lsdb_singleton_retrieved",traceId:B});c("QPLUserFlow").addPoint(D,"lsdb_singleton_retrieved",{instanceKey:C});J=(yield d("handleRestoreMessagesGraphQLResponse").getClientState(F))}if(J==null){d("WALogger").ERROR(v());c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.NO_CLIENT_STATE,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.NO_CLIENT_STATE}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"no_client_state");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("no-client-state")}G=J;I=G.backupId;H=G.device_id;var K=G.locally_available_epochs,L=G.mailboxRootKey;G=G.ocmfClientStateBlob;if(I==null||H==null||L==null||G==null){d("WALogger").ERROR(u());c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.INVALID_CLIENT_STATE,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.INVALID_CLIENT_STATE}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.INVALID_CLIENT_STATE);d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("invalid-client-state")}d("MAWEBRestoreTrackingUtils").addQPLRestorePointWithAnnotationsWorker({annotations:{string:{device_id:(i||(i=d("I64"))).to_string((E=(E=J)==null?void 0:E.device_id)!=null?E:(i||(i=d("I64"))).zero)}},pointName:"client_state_retrieved",traceId:B});c("QPLUserFlow").addPoint(D,"client_state_retrieved",{data:{string:{device_id:i.to_string((J=(E=J)==null?void 0:E.device_id)!=null?J:(i||(i=d("I64"))).zero)}},instanceKey:C});E=d("MAWCurrentUser").getAppID();d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"app_id_retrieved",traceId:B});c("QPLUserFlow").addPoint(D,"app_id_retrieved",{instanceKey:C});J={restore_context:{act_thread_id:d("MAWJobDefinitions").toThreadJidPrimaryId(A),site:"www",tam_thread_subtype:0},success:babelHelpers["extends"]({device_context:{device_id:i.to_string(H),locally_available_epochs:K,raw_tokens:{mailbox_root_key:d("Base64Utils").fromArrayBuffer(L),ocmf_client_state_blob:d("Base64Utils").fromArrayBuffer(G)}},message_id:g},h!=null?{reference_timestamp:h}:{})};d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"graphql_query_start",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.GRAPHQL_QUERY_START,{instanceKey:C});yield d("WorkerRelayNetwork").createWorkerNetworkExecute();K=(yield d("WorkerRelay").createWorkerQuery(y,{app_id:String(E!=null?E:"0"),restore_payload_string:JSON.stringify(J),restore_type:"POINT_QUERY_RESTORE"}));d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"graphql_query_end",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.GRAPHQL_QUERY_END,{instanceKey:C});if(K==null||(K==null?void 0:(L=K.viewer)==null?void 0:(G=L.encrypted_backup)==null?void 0:G.mailbox)==null){c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.INVALID_GRAPHQL_RESPONSE,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.INVALID_GRAPHQL_RESPONSE}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"gql_point_restore_exception");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("invalid-graphql-response")}L=K==null?void 0:(g=K.viewer)==null?void 0:(E=g.encrypted_backup)==null?void 0:(J=E.mailbox)==null?void 0:J.messages_point_restore;if(L==null){d("WALogger").ERROR(t());c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.INVALID_GRAPHQL_RESPONSE,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.INVALID_GRAPHQL_RESPONSE}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"gql_point_restore_exception");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("invalid-graphql-response")}G=L;if((G==null?void 0:G.encrypted_messages)==null){c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.NULL_MESSAGES,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.NULL_MESSAGES}},instanceKey:C});d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"null_messages",traceId:B});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"null_messages");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("invalid-graphql-response")}K=G.backup_id;g=G.encrypted_messages;E=G.epoch_derivation_set;J=G.exception_string;L=G.message_range_info;G=G.should_delete_mailbox;if(J!=null){d("WALogger").ERROR(s(),J);G===!0&&(c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DELETE_MAILBOX,{instanceKey:C}),d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"delete_mailbox",traceId:B}));c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.SERVER_SIDE_EXCEPTION,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.SERVER_SIDE_EXCEPTION,exception:J}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.SERVER_SIDE_EXCEPTION,{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.SERVER_SIDE_EXCEPTION,exception:J}});d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("server-side-exception")}d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"derive_and_store_epochs_start",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DERIVE_AND_STORE_EPOCHS_START,{instanceKey:C});c("QPLUserFlow").addAnnotations(D,{bool:{hasEpochs:E!=null&&E.epoch_edges.length>0}},{instanceKey:C});yield d("handleRestoreMessagesGraphQLResponse").deriveAndStoreEpochs(E,F,H,B,!0);d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"derive_and_store_epochs_end",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DERIVE_AND_STORE_EPOCHS_END,{instanceKey:C});g.length===0&&(c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.NO_MESSAGES_TO_RESTORE,{instanceKey:C}),d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"no_messages",traceId:B}));if(L==null){d("WALogger").ERROR(r());c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.MISSING_RANGE_INFO,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.MISSING_RANGE_INFO}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"missing_message_range_info");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("missing-message-range-info")}K==null&&(d("WALogger").WARN(q()),c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.BACKUP_ID_NULL,{instanceKey:C}),d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"backup_id_null",traceId:B}));G=L.has_more_after;J=L.has_more_before;E=L.next_message_timestamp_ms_after;H=L.next_message_timestamp_ms_before;if(J==null||G==null||E==null||H==null){d("WALogger").ERROR(p());c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.MISSING_RANGE_INFO,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.MISSING_RANGE_INFO}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"message_range_info_null");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("missing-message-range-info")}L=d("handleRestoreMessagesGraphQLResponse").processMessageArray(g,K!=null?K:(i||(i=d("I64"))).to_string(I),D,C);var M=L.encryptedLSEchoMessages,N=L.encryptedMessagesWithProtobufs;if(N.length===0){d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"decrypt_messages_echo_start",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DECRYPT_MESSAGES_ECHO_START,{instanceKey:C});g=(yield F.runInTransaction(function(a){return c("LSDecryptMessagesStoredProcedure")(c("LSFactory")(a),{actThreadId:A,encryptedMessages:c("LSVec").ofArray(M)})},"readwrite",void 0,void 0,f.id+":742"));K=g[0];I=g[1];if(I!=null){L=d("LSShape").toRecord(I);d("WALogger").ERROR(o());d("WALogger").WARN(n(),L.error_message);c("QPLUserFlow").endFailure(D,"ECHO_DECRYPTION_FAILURE",{annotations:{string:{error_description:L.error_message}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(a,!1,"ECHO_DECRYPTION_FAILURE",{string:{error_description:L.error_message}});d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("echo-decryption-failure")}d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"decrypt_messages_echo_end",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DECRYPT_MESSAGES_ECHO_END,{instanceKey:C});g=K;if(g!=null){I=c("LSVec").toArray(g).map(function(a){return d("LSShape").toRecord(a).value});c("promiseDone")(d("MAWBridge").getBridge().sendAndReceive("event","uiUpdate",{events:[{tag:"RestoreNativeOp",value:{chatJid:e,echoMessages:c("LSVec").ofArray(I),hasMoreAfter:G,hasMoreBefore:J,isPointQuery:!0,nextMessageTimestampMsAfter:(i||(i=d("I64"))).of_string(E),nextMessageTimestampMsBefore:i.of_string(H),referenceTimestamp:h!=null?(i||(i=d("I64"))).to_string(h):void 0,requestId:B,taskSource:(j||(j=d("LSIntEnum"))).ofNumber(z!=null?z:c("LSMEBTaskCreationSource").UNKNOWN),threadId:A}}]}))}}else{d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"decrypt_messages_protobuf_start",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DECRYPT_MESSAGES_PROTOBUF_START,{instanceKey:C});L=(yield F.runInTransaction(function(a){return c("LSDecryptMessageProtobufsStoredProcedure")(c("LSFactory")(a),{actThreadId:A,encryptedMessagesWithProtobufs:c("LSVec").ofArray(N)})},"readwrite",void 0,void 0,f.id+":846"));K=L[0];g=L[1];if(g!=null){I=d("LSShape").toRecord(g);d("WALogger").ERROR(m());d("WALogger").WARN(l(),I.error_message);c("QPLUserFlow").endFailure(D,"PROTOBUF_DECRYPTION_FAILURE",{annotations:{string:{error_description:I.error_message}},instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(a,!1,"PROTOBUF_DECRYPTION_FAILURE",{string:{error_description:I.error_message}});d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("protobuf-decryption-failure")}d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"decrypt_messages_protobuf_end",traceId:B});c("QPLUserFlow").addPoint(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DECRYPT_MESSAGES_PROTOBUF_END,{instanceKey:C});if(K!=null){F=d("MAWEncryptedBackupUtils").convertLSTypesToJSTypesForRestoreJob(K);c("promiseDone")(d("MAWBridge").getBridge().sendAndReceive("event","uiUpdate",{events:[{tag:"RestoreNativeOp",value:{chatJid:e,decryptedMessagesProtobufs:F,hasMoreAfter:G,hasMoreBefore:J,isPointQuery:!0,nextMessageTimestampMsAfter:(i||(i=d("I64"))).of_string(E),nextMessageTimestampMsBefore:i.of_string(H),referenceTimestamp:h!=null?(i||(i=d("I64"))).to_string(h):void 0,requestId:B,taskSource:(j||(j=d("LSIntEnum"))).ofNumber(z!=null?z:c("LSMEBTaskCreationSource").UNKNOWN),threadId:A}}]}))}else{c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DECRYPTED_PROTOBUFS_NULL,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.DECRYPTED_PROTOBUFS_NULL}},instanceKey:C});d("MAWEBRestoreTrackingUtils").addQPLRestorePointWorker({pointName:"decrypted_protobufs_null",traceId:B});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"decrypted_protobufs_null");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").makeError("invalid-graphql-response")}}c("QPLUserFlow").endSuccess(D,{annotations:{bool:{isEcho:N.length===0,isProtobuf:N.length>0}},instanceKey:C});d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.success");return d("WAResultOrError").makeResult()}catch(a){d("WALogger").ERROR(k(),a);c("QPLUserFlow").endFailure(D,d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.RUNTIME_ERROR,{annotations:{string:{error_description:d("EBAPIQPLPoints").EBMessageRestoreQueryQPLPoints.RUNTIME_ERROR,errorStackTrace:(L=a.stack)!=null?L:""}},error:a,instanceKey:C});d("MAWEBRestoreTrackingUtils").markEBRestoreFail(B,!0,"gql_point_restore_exception");d("EBAPISharedUtils").bumpOdsRestoreKey("restore.request.point.gql.error");return d("WAResultOrError").DEPRECATED_makeError("runtime-error",a)}});return z.apply(this,arguments)}g.pointRestoreQuery=y;g.messagePointQueryWithPersistence=a}),98);
__d("MAWIsFbProfileDirectoryItemXmaEnabled",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("15740")}g.isFbProfileDirectoryItemXmaEnabled=a}),98);
__d("MAWIsLiveLocationXmaEnabled",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("3758")===!0}g.isLiveLocationXmaEnabled=a}),98);
__d("MAWIsMemoriesXmaEnabled",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("1063")}g.isMemoriesXmaEnabled=a}),98);
__d("MAWIsRTCCallXmaEnabled",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("865")===!0||c("qex")._("675")===!0}g.isRTCCallXmaEnabled=a}),98);
__d("MWXMAV2IsDataclassLiveLocationXMA",[],(function(a,b,c,d,e,f){"use strict";function a(a){if(a==null)return!1;a=JSON.parse(a);if(a==null)return!1;a=a.content;if(a==null||(a==null?void 0:a.__typename)!=="XMSGXmaSingleContent")return!1;a=a.custom_template_data;if(a==null||(a==null?void 0:a.__typename)!=="XMSGXmaLocationTemplateData")return!1;a=a.location_metadata;return a==null||(a==null?void 0:a.__typename)!=="XMSGXmaLiveLocationMetadata"?!1:!0}f.isDataclassLiveLocationXMA=a}),66);
__d("MAWParseXMAFBConfig",["FBLogger","MAWIsFbProfileDirectoryItemXmaEnabled","MAWIsLiveLocationXmaEnabled","MAWIsMemoriesXmaEnabled","MAWIsRTCCallXmaEnabled","MWXMAV2IsDataclassLiveLocationXMA","WAArmadilloXMA.pb","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=new Set([(b=d("WAArmadilloXMA.pb")).EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_SHARE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_SHORT,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_SHARE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_GAMING_CUSTOM_UPDATE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_EXTERNAL_LINK_SHARE,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_AUDIO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_GROUP_VIDEO_CALL,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_FEED_POST_PRIVATE_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_FRIEND_UPDATES_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_HIGHLIGHTS_TAB_LOCAL_EVENT_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_EVENT,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_STORY_MENTION,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PRODUCER_STORY_REPLY,b.EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_RECEIVER_FETCH]);function a(a){var b=a.fbTargetType,e=a.silentExposure;a=a.xmaDataclass;if(b!=null&&h.has(b))return!0;e=e!=null?e:!1;switch(b){case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_CONTACT:return e?c("gkx")("5304"):c("gkx")("4902");case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_AI_CONTACT:return e?c("gkx")("9338"):c("gkx")("9339");case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING_V2:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_LOCATION_SHARING:return a!=null&&d("MWXMAV2IsDataclassLiveLocationXMA").isDataclassLiveLocationXMA(a)?d("MAWIsLiveLocationXmaEnabled").isLiveLocationXmaEnabled():e?c("gkx")("5320"):c("gkx")("6952");case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_POST_MENTION:return e?c("gkx")("2605"):c("gkx")("2722");case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.MSG_MEMORIES_SHARE:return d("MAWIsMemoriesXmaEnabled").isMemoriesXmaEnabled();case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_VIDEO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_AUDIO_CALL:case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.RTC_MISSED_VIDEO_CALL:return d("MAWIsRTCCallXmaEnabled").isRTCCallXmaEnabled();case d("WAArmadilloXMA.pb").EXTENDED_CONTENT_MESSAGE_EXTENDED_CONTENT_TYPE.FB_PROFILE_DIRECTORY_ITEM:return d("MAWIsFbProfileDirectoryItemXmaEnabled").isFbProfileDirectoryItemXmaEnabled();default:c("FBLogger")("maw_db").mustfix("MAWParseXMAFBConfig encountered an unknown unsupported XMA type: %s",String(b));return!1}}g.FB_FULLY_SUPPORTED_TARGET_TYPES=h;g.isFBSupportedTargetType=a}),98);
__d("MAWStateManagerSyncToMainThread",["FBLogger","MAWBridge","WACommsConnectionState"],(function(a,b,c,d,e,f,g){"use strict";var h={WACommsConnectionState:d("WACommsConnectionState").WACommsConnectionState};function a(){var a=function(a){var b=h[a];i(a,b.get());b.onSet(function(b){i(a,b)})};for(var b of Object.keys(h))a(b)}function b(a,b){var d=h[a];if(d==null){c("FBLogger")("messenger_e2ee_web").warn("Unable to find GenericStateManager for key %s",a);return}d.set(b)}function e(){for(var a of Object.keys(h)){var b=h[a];i(a,b.get())}}function i(a,b){d("MAWBridge").getBridge().fireAndForget("event","updateStateManagerStateInMainThread",{stateManagerKey:a,value:b})}g.subscribeAndSyncStateManagerValuesToMainThread=a;g.updateStateManagerInMainThreadFromBridgeCall=b;g.resendCurrentValuesToMainThread=e}),98);
__d("MSGDataclassTypes.flow",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({HistoryRestore:"HISTORY_RESTORE",Reporting:"REPORTING",Fts:"FTS",NewMemberExport:"NEW_MEMBER_EXPORT"});d=a({Before:"BEFORE",After:"AFTER"});e=a({UpsertBackupItem:"UPSERT_BACKUP_ITEM",RemoveBackupItem:"REMOVE_BACKUP_ITEM"});b=a({Message:"MESSAGE",Thread:"THREAD"});var g=a({Photo:"PHOTO",Permanent:"PERMANENT",Ephemeral:"EPHEMERAL",Video:"VIDEO",Gif:"GIF",Audio:"AUDIO",File:"FILE",Raven:"RAVEN",UnreadRaven:"UNREAD_RAVEN",ShareIgMedia:"SHARE_IG_MEDIA",ShareLink:"SHARE_LINK",ShareIgClips:"SHARE_IG_CLIPS",Shh:"SHH",StoryReply:"STORY_REPLY",DisappearingMessage:"DISAPPEARING_MESSAGE",RavenSeen:"RAVEN_SEEN",RavenReplayed:"RAVEN_REPLAYED",RavenReadOnce:"RAVEN_READ_ONCE",RavenReplayable:"RAVEN_REPLAYABLE",RavenPermanent:"RAVEN_PERMANENT",ActionLog:"ACTION_LOG"}),h=a({Fbn:"FBN",Instamadillo:"INSTAMADILLO",Unknown:"UNKNOWN"}),i=a({Retroactive:"RETROACTIVE",Realtime:"REALTIME",InfiniteRetroactive:"INFINITE_RETROACTIVE"}),j=a({Success:"SUCCESS",RetryableException:"RETRYABLE_EXCEPTION",PermanentFailure:"PERMANENT_FAILURE"}),k=a({NotApplicable:"NOT_APPLICABLE",NeedsUpload:"NEEDS_UPLOAD",AlreadyUploaded:"ALREADY_UPLOADED"}),l=a({DeleteBackupStateOnClient:"DELETE_BACKUP_STATE_ON_CLIENT",IssueCheckBackupStateTask:"ISSUE_CHECK_BACKUP_STATE_TASK",UpsertStatusTrigger:"UPSERT_STATUS_TRIGGER",UpsertReenrollmentTrigger:"UPSERT_REENROLLMENT_TRIGGER",UpdateInitializeRestoreResult:"UPDATE_INITIALIZE_RESTORE_RESULT",InitializeRestore:"INITIALIZE_RESTORE",DeleteAndInsertPakeMessage:"DELETE_AND_INSERT_PAKE_MESSAGE",RotateDeviceKeysStart:"ROTATE_DEVICE_KEYS_START",LegacyRetroactiveBackup:"LEGACY_RETROACTIVE_BACKUP",UpdatePbqWithNeedsBackupUploadStatus:"UPDATE_PBQ_WITH_NEEDS_BACKUP_UPLOAD_STATUS",SyncDeviceCreationTimestamp:"SYNC_DEVICE_CREATION_TIMESTAMP"}),m=a({LlmOutput:"llm_output",SendQuery:"send_query",StartTyping:"start_typing",StopTyping:"stop_typing",VideoAboutToFinish:"video_about_to_finish"}),n=a({Text:"text",Image:"image",Voice:"voice",Link_1p:"link_1p",Link_3p:"link_3p"}),o=a({Reasoning:"REASONING",Responding:"RESPONDING"}),p=a({Keyword:"KEYWORD",Method:"METHOD",Str:"STR",Number:"NUMBER",Comment:"COMMENT",Default:"DEFAULT"}),q=a({Bing:"BING",Brave:"BRAVE",Google:"GOOGLE",HelpCenter:"HELP_CENTER",InHouse:"IN_HOUSE",Kss:"KSS",Mase:"MASE"}),r=a({RequestStart:"REQUEST_START",Searching:"SEARCHING",Imagining:"IMAGINING",UnderstandingImage:"UNDERSTANDING_IMAGE",Generating:"GENERATING",StreamingImage:"STREAMING_IMAGE"}),s=a({Love:"LOVE",Giftwrap:"GIFTWRAP",Celebration:"CELEBRATION",Fire:"FIRE",AvatarLove:"AVATAR_LOVE",AvatarAngry:"AVATAR_ANGRY",AvatarCry:"AVATAR_CRY",AvatarLaugh:"AVATAR_LAUGH",Halloween:"HALLOWEEN",NomNomDash:"NOM_NOM_DASH",NewYears:"NEW_YEARS",ValentinesDay:"VALENTINES_DAY",AntiValentines:"ANTI_VALENTINES"}),t=a({Reminder:"REMINDER",Subscription:"SUBSCRIPTION"}),u=a({Memu:"MEMU",Imagine:"IMAGINE",ImagineRestyle:"IMAGINE_RESTYLE"}),v=a({Unknown:"UNKNOWN",Memu:"MEMU",Synthetic:"SYNTHETIC",UserUploaded:"USER_UPLOADED"}),w=a({Simple:"SIMPLE",Retro:"RETRO",Messages:"MESSAGES"}),x=a({MagicModBackdrop:"MAGIC_MOD_BACKDROP",MagicModRestyle:"MAGIC_MOD_RESTYLE",Imagine:"IMAGINE",Memu:"MEMU"}),y=a({PaidPartnership:"PAID_PARTNERSHIP",NoBranding:"NO_BRANDING"}),z=a({AskMetaAi:"ASK_META_AI",Summarize:"SUMMARIZE"}),A=a({BanUser:"BAN_USER",RemoveUser:"REMOVE_USER",SuspendUser:"SUSPEND_USER",RemoveMessage:"REMOVE_MESSAGE",ReportMessage:"REPORT_MESSAGE",HideMessage:"HIDE_MESSAGE"}),B=a({MothersDay:"MOTHERS_DAY",FathersDay:"FATHERS_DAY",Graduation:"GRADUATION",NationalSelfie:"NATIONAL_SELFIE",PhIndependenceDay:"PH_INDEPENDENCE_DAY",JulyFourth:"JULY_FOURTH",FriendshipDay:"FRIENDSHIP_DAY"}),C=a({Birthday:"BIRTHDAY",Attribution:"ATTRIBUTION"}),D=a({XmaWebUrl:"XMA_WEB_URL"}),E=a({GenAiGetInfo:"GEN_AI_GET_INFO",GenAiReminder:"GEN_AI_REMINDER",GenAiThreadSurfing:"GEN_AI_THREAD_SURFING"}),F=a({Mention:"MENTION",Reply:"REPLY"}),G=a({Note:"NOTE",Prompt:"PROMPT",PromptResponse:"PROMPT_RESPONSE"}),H=a({Restaurant:"RESTAURANT",Movie:"MOVIE",TvShows:"TV_SHOWS",Celebrity:"CELEBRITY",SportsTeam:"SPORTS_TEAM"}),I=a({GetInfo:"GET_INFO",GetRestaurantInfo:"GET_RESTAURANT_INFO",Reviews:"REVIEWS",MenuHighlights:"MENU_HIGHLIGHTS",Address:"ADDRESS",WhereToWatch:"WHERE_TO_WATCH",LatestNews:"LATEST_NEWS",FindNextGame:"FIND_NEXT_GAME",ResponseCard:"RESPONSE_CARD"}),J=a({Untranscribed:"UNTRANSCRIBED",Transcribing:"TRANSCRIBING",Success:"SUCCESS",Error:"ERROR",UnsupportedLanguage:"UNSUPPORTED_LANGUAGE"}),K=a({Undefined:"UNDEFINED",Genmoji:"GENMOJI",Metamoji:"METAMOJI",AnimatedEmoji:"ANIMATED_EMOJI"}),L=a({Video:"VIDEO",Image:"IMAGE",Other:"OTHER"}),M=a({Unactioned:"UNACTIONED",Accepted:"ACCEPTED",Deleted:"DELETED"}),N=a({FbmInbox:"FBM_INBOX",Profile:"PROFILE",Feed:"FEED",FbSearch:"FB_SEARCH",Watch:"WATCH",Shorts:"SHORTS",Ufi:"UFI",Ctm:"CTM",Cts:"CTS",Psrib:"PSRIB",Srib:"SRIB",Rta:"RTA",Mp:"MP",CommentMentions:"COMMENT_MENTIONS",ZorroMessage:"ZORRO_MESSAGE",FbHelpCenterXsMetaAi:"FB_HELP_CENTER_XS_META_AI",Dating:"DATING",IgReels:"IG_REELS",IgStory:"IG_STORY",IgFeed:"IG_FEED",IgProfile:"IG_PROFILE",IgNotes:"IG_NOTES",IgLive:"IG_LIVE",IgExternalLink:"IG_EXTERNAL_LINK",IgComment:"IG_COMMENT",FbNotes:"FB_NOTES",FbGroups:"FB_GROUPS",GenAiSuggestedPrompts:"GEN_AI_SUGGESTED_PROMPTS",GenAiMultiModal:"GEN_AI_MULTI_MODAL",GenAiFlAshImagine:"GEN_AI_FlASH_IMAGINE",GenAiAssistant:"GEN_AI_ASSISTANT",GenAiLocation:"GEN_AI_LOCATION",Sharesheet:"SHARESHEET",ProductHighlights:"PRODUCT_HIGHLIGHTS",MagicMessenger:"MAGIC_MESSENGER"}),O=a({Unspecified:"UNSPECIFIED",QuickEmoji:"QUICK_EMOJI",Avatar:"AVATAR",SuggestedReply:"SUGGESTED_REPLY",PostLwrSuggestedReply:"POST_LWR_SUGGESTED_REPLY",WriteWithAi:"WRITE_WITH_AI",GifLightWeight:"GIF_LIGHT_WEIGHT",StickerLightWeight:"STICKER_LIGHT_WEIGHT",QuickEmojiPalette:"QUICK_EMOJI_PALETTE"}),P=a({Default:"DEFAULT",CriticalUserMessage:"CRITICAL_USER_MESSAGE",NonCriticalAdminXma:"NON_CRITICAL_ADMIN_XMA"}),Q=a({ThreadviewSuggestedPrompt:"THREADVIEW_SUGGESTED_PROMPT",TypeaheadSuggestedPrompt:"TYPEAHEAD_SUGGESTED_PROMPT",SuggestedPrompt:"SUGGESTED_PROMPT",NullStatePrompt:"NULL_STATE_PROMPT",UserInputPrompt:"USER_INPUT_PROMPT",GenericPrompt:"GENERIC_PROMPT",ThreadviewUserInputPrompt:"THREADVIEW_USER_INPUT_PROMPT",Icebreakers:"ICEBREAKERS",ThreadSurfingPrompt:"THREAD_SURFING_PROMPT",MetaAiVoiceConversationStarter:"META_AI_VOICE_CONVERSATION_STARTER",MetaAiTextConversationStarter:"META_AI_TEXT_CONVERSATION_STARTER"}),R=a({Mention:"MENTION",SuperReact:"SUPER_REACT",StoryReply:"STORY_REPLY",MessageReply:"MESSAGE_REPLY",ContentReply:"CONTENT_REPLY",ContentMention:"CONTENT_MENTION",ContentShare:"CONTENT_SHARE",OnPlatform:"ON_PLATFORM",OffPlatform:"OFF_PLATFORM",MessageForward:"MESSAGE_FORWARD",Avatar:"AVATAR",SocialSticker:"SOCIAL_STICKER",NoteReply:"NOTE_REPLY",InvokesGenAiResponse:"INVOKES_GEN_AI_RESPONSE",SentFromGenAiBot:"SENT_FROM_GEN_AI_BOT",DisappearingMessage:"DISAPPEARING_MESSAGE",IncludesOnPlatformContent:"INCLUDES_ON_PLATFORM_CONTENT",IncludesOffPlatformContent:"INCLUDES_OFF_PLATFORM_CONTENT",IncludesLink:"INCLUDES_LINK",MultitabEnv:"MULTITAB_ENV",PowerUp:"POWER_UP",MsysSend:"MSYS_SEND",EditMessage:"EDIT_MESSAGE",VanishMode:"VANISH_MODE",Superlative:"SUPERLATIVE",Raven:"RAVEN",Hotlike:"HOTLIKE",IsDialtone:"IS_DIALTONE",MessageReshare:"MESSAGE_RESHARE",PostReply:"POST_REPLY",IsNotDialtone:"IS_NOT_DIALTONE",ThirdPartyReshare:"THIRD_PARTY_RESHARE",ZeroBalanceDetected:"ZERO_BALANCE_DETECTED",ConversationStarter:"CONVERSATION_STARTER",AnimatedAiSticker:"ANIMATED_AI_STICKER",AiGeneratedSticker:"AI_GENERATED_STICKER",MagicModImage:"MAGIC_MOD_IMAGE",ShareOfOriginalUserContent:"SHARE_OF_ORIGINAL_USER_CONTENT",LightweightInteractionAsStoryReply:"LIGHTWEIGHT_INTERACTION_AS_STORY_REPLY",WriteWithMetaAi:"WRITE_WITH_META_AI",AvatarStyle_1:"AVATAR_STYLE_1",AvatarStyle_2:"AVATAR_STYLE_2",MetaAiEntitySuggestedPrompts:"META_AI_ENTITY_SUGGESTED_PROMPTS",ContentConversationStarter:"CONTENT_CONVERSATION_STARTER",MetaAiIntents:"META_AI_INTENTS"}),S=a({MsgrE2EeGenai:"MSGR_E2EE_GENAI"}),T=a({Imagine:"IMAGINE",Imaginev2:"IMAGINEV2",Imagineme:"IMAGINEME"}),U=a({Animate:"ANIMATE",AnimateImagineme:"ANIMATE_IMAGINEME"}),V=a({Share:"SHARE",Reply:"REPLY",Mention:"MENTION",Bump:"BUMP"}),W=a({Statusupdate:"STATUSUPDATE",Grouppost:"GROUPPOST",Shareurl:"SHAREURL"}),X=a({Single:"SINGLE",Hscroll:"HSCROLL",Xcenter:"XCENTER",Portrait:"PORTRAIT",Layered:"LAYERED",Placeholder:"PLACEHOLDER",ExpiredPlaceholder:"EXPIRED_PLACEHOLDER",PilePrompt:"PILE_PROMPT",Stack:"STACK",SharedStack:"SHARED_STACK",StackCard:"STACK_CARD",StandardDxma:"STANDARD_DXMA",DxmaPlaceholder:"DXMA_PLACEHOLDER",Grid:"GRID"}),Y=a({Text:"TEXT",Media:"MEDIA"}),Z=a({Unknown:"UNKNOWN",TwoOptionCombined:"TWO_OPTION_COMBINED",IgTwoOptionCombined:"IG_TWO_OPTION_COMBINED",FiveOptionStarRating:"FIVE_OPTION_STAR_RATING"}),$=a({Unknown:"UNKNOWN",Location:"LOCATION",People:"PEOPLE",Event:"EVENT",ResharedPost:"RESHARED_POST",ResharedContent:"RESHARED_CONTENT",Page:"PAGE",Fundraiser:"FUNDRAISER",Product:"PRODUCT",AntiBully:"ANTI_BULLY",Instagram:"INSTAGRAM"}),aa=a({Grid:"GRID",Hscroll:"HSCROLL",Portrait:"PORTRAIT",Single:"SINGLE",Vstack:"VSTACK",SharedStack:"SHARED_STACK"}),ba=a({Left:"LEFT",Center:"CENTER"}),ca=a({Test:"TEST",None:"NONE",IgMediaShare:"IG_MEDIA_SHARE",IgMultipostShare:"IG_MULTIPOST_SHARE",IgStoryReply:"IG_STORY_REPLY",IgStoryPhotoShare:"IG_STORY_PHOTO_SHARE",IgStoryPhotoMention:"IG_STORY_PHOTO_MENTION",IgClipsShare:"IG_CLIPS_SHARE",IgSingleVideoPostShare:"IG_SINGLE_VIDEO_POST_SHARE",IgStoryVideoShare:"IG_STORY_VIDEO_SHARE",IgStoryReaction:"IG_STORY_REACTION",IgIgtvShare:"IG_IGTV_SHARE",IgShopShare:"IG_SHOP_SHARE",IgProfileShare:"IG_PROFILE_SHARE",IgStoryPhotoHighlightShare:"IG_STORY_PHOTO_HIGHLIGHT_SHARE",IgStoryVideoHighlightShare:"IG_STORY_VIDEO_HIGHLIGHT_SHARE",IgStoryVideoMention:"IG_STORY_VIDEO_MENTION",IgStoryHighlightReply:"IG_STORY_HIGHLIGHT_REPLY",IgStoryHighlightReaction:"IG_STORY_HIGHLIGHT_REACTION",IgExternalLink:"IG_EXTERNAL_LINK",IgReceiverFetch:"IG_RECEIVER_FETCH",IgTextPostAppShare:"IG_TEXT_POST_APP_SHARE",FbFeedShare:"FB_FEED_SHARE",FbStoryReply:"FB_STORY_REPLY",FbStoryShare:"FB_STORY_SHARE",FbStoryMention:"FB_STORY_MENTION",FbFeedVideoShare:"FB_FEED_VIDEO_SHARE",FbGamingCustomUpdate:"FB_GAMING_CUSTOM_UPDATE",FbProducerStoryReply:"FB_PRODUCER_STORY_REPLY",FbEvent:"FB_EVENT",FbFeedPostPrivateReply:"FB_FEED_POST_PRIVATE_REPLY",FbShort:"FB_SHORT",FbCommentMentionShare:"FB_COMMENT_MENTION_SHARE",FbPostMention:"FB_POST_MENTION",MsgExternalLinkShare:"MSG_EXTERNAL_LINK_SHARE",MsgP2PPayment:"MSG_P2P_PAYMENT",MsgOpgP2PPayment:"MSG_OPG_P2P_PAYMENT",MsgLocationSharingDeprecated:"MSG_LOCATION_SHARING_DEPRECATED",MsgLocationSharingV2:"MSG_LOCATION_SHARING_V2",MsgReceiverFetch:"MSG_RECEIVER_FETCH",MsgIgMediaShare:"MSG_IG_MEDIA_SHARE",MsgGenAiSearchPluginResponse:"MSG_GEN_AI_SEARCH_PLUGIN_RESPONSE",MsgReelsList:"MSG_REELS_LIST",MsgContact:"MSG_CONTACT",MsgFile:"MSG_FILE",MsgAiContact:"MSG_AI_CONTACT",MsgMemoriesShare:"MSG_MEMORIES_SHARE",MsgEarlyAccessFbShare:"MSG_EARLY_ACCESS_FB_SHARE",MsgSharedAlbum:"MSG_SHARED_ALBUM",MsgReceiverFetchFallback:"MSG_RECEIVER_FETCH_FALLBACK",MsgAiBotSearchResult:"MSG_AI_BOT_SEARCH_RESULT",MsgGenAiSubscription:"MSG_GEN_AI_SUBSCRIPTION",MsgGenAiReminder:"MSG_GEN_AI_REMINDER",MsgGenAiTask:"MSG_GEN_AI_TASK",MsgGenAi_1PSearchResult:"MSG_GEN_AI_1P_SEARCH_RESULT",MsgGenAiMemuOnboardingResponse:"MSG_GEN_AI_MEMU_ONBOARDING_RESPONSE",RtcAudioCall:"RTC_AUDIO_CALL",RtcVideoCall:"RTC_VIDEO_CALL",RtcMissedAudioCall:"RTC_MISSED_AUDIO_CALL",RtcMissedVideoCall:"RTC_MISSED_VIDEO_CALL",RtcGroupAudioCall:"RTC_GROUP_AUDIO_CALL",RtcGroupVideoCall:"RTC_GROUP_VIDEO_CALL",RtcMissedGroupAudioCall:"RTC_MISSED_GROUP_AUDIO_CALL",RtcMissedGroupVideoCall:"RTC_MISSED_GROUP_VIDEO_CALL",RtcOngoingVideoCall:"RTC_ONGOING_VIDEO_CALL",RtcOngoingAudioCall:"RTC_ONGOING_AUDIO_CALL",LiveLocation:"LIVE_LOCATION",OcAvatarStaticSticker:"OC_AVATAR_STATIC_STICKER"}),da=a({XmaWebUrl:"XMA_WEB_URL",XmaOpenNative:"XMA_OPEN_NATIVE",XmaMsgExternalLinkShare:"XMA_MSG_EXTERNAL_LINK_SHARE",XmaGenAiSearchPluginResponseSources:"XMA_GEN_AI_SEARCH_PLUGIN_RESPONSE_SOURCES",XmaSharedAlbumViewer:"XMA_SHARED_ALBUM_VIEWER",XmaMetaAiSingleSubscription:"XMA_META_AI_SINGLE_SUBSCRIPTION",XmaMetaAiSubscriptions:"XMA_META_AI_SUBSCRIPTIONS",XmaMetaAiReminders:"XMA_META_AI_REMINDERS",XmaMetaAiTask:"XMA_META_AI_TASK",XmaGamePlay:"XMA_GAME_PLAY",ViewSingleAiTask:"VIEW_SINGLE_AI_TASK",ViewAllAiTasks:"VIEW_ALL_AI_TASKS",XmaMetaAiLocation:"XMA_META_AI_LOCATION",XmaMetaAiLookupEntity:"XMA_META_AI_LOOKUP_ENTITY",XmaP2POpgTransfer:"XMA_P2P_OPG_TRANSFER"}),ea=a({Album:"ALBUM",Clips:"CLIPS",Video:"VIDEO"}),fa=a({None:"NONE",VodVideo:"VOD_VIDEO",LiveVideo:"LIVE_VIDEO",ShortsVideo:"SHORTS_VIDEO"}),ga=a({Default:"DEFAULT",ThreadsIcon:"THREADS_ICON",FacebookIcon:"FACEBOOK_ICON",ExternalLinkIcon:"EXTERNAL_LINK_ICON",MessengerIcon:"MESSENGER_ICON",InstagramIcon:"INSTAGRAM_ICON",OculusIcon:"OCULUS_ICON"}),ha=a({Default:"DEFAULT"}),ia=a({None:"NONE",Collage:"COLLAGE",Photo:"PHOTO",Video:"VIDEO",MultiPhoto:"MULTI_PHOTO",MessengerIcon:"MESSENGER_ICON",InstagramIcon:"INSTAGRAM_ICON",ReelsIcon:"REELS_ICON",Live:"LIVE",YoutubeVideo:"YOUTUBE_VIDEO",YoutubeShorts:"YOUTUBE_SHORTS",Blur:"BLUR",Pill:"PILL"}),ja=a({Default:"DEFAULT",P2PPreviewImageWithTextOverlay:"P2P_PREVIEW_IMAGE_WITH_TEXT_OVERLAY",Playable:"PLAYABLE",AutoPlayable:"AUTO_PLAYABLE",BlurredImage:"BLURRED_IMAGE",BlurredPlayable:"BLURRED_PLAYABLE",InformTreatmentWithLabel:"INFORM_TREATMENT_WITH_LABEL",InformTreatmentWithWarningScreen:"INFORM_TREATMENT_WITH_WARNING_SCREEN",YoutubePlayer:"YOUTUBE_PLAYER",ImageWithPlayButton:"IMAGE_WITH_PLAY_BUTTON",Placeholder:"PLACEHOLDER",AutoPlayableWithAspectRatio:"AUTO_PLAYABLE_WITH_ASPECT_RATIO"}),ka=a({Default:"DEFAULT",Rounded:"ROUNDED",BlurredCircle:"BLURRED_CIRCLE",TemplateAsset:"TEMPLATE_ASSET",DefaultWithGradient:"DEFAULT_WITH_GRADIENT"}),la=a({MediaLabel:"MEDIA_LABEL",Misinformation:"MISINFORMATION",PostCover:"POST_COVER",PostLabel:"POST_LABEL",Private:"PRIVATE",Sensitive:"SENSITIVE",WarningScreens:"WARNING_SCREENS"}),ma=a({None:"NONE",YoutubeVideo:"YOUTUBE_VIDEO",YoutubeShorts:"YOUTUBE_SHORTS"}),na=a({None:"NONE",Fb:"FB",FbAlwaysWhite:"FB_ALWAYS_WHITE",DotsThreeHorizontal:"DOTS_THREE_HORIZONTAL",ChevronDown:"CHEVRON_DOWN",FbInfoSmall:"FB_INFO_SMALL"}),oa=a({Simple:"SIMPLE",Retro:"RETRO",Messages:"MESSAGES"}),pa=a({Missed:"MISSED",Ended:"ENDED",Started:"STARTED"}),qa=a({Video:"VIDEO",Audio:"AUDIO"}),ra=a({Weekly:"WEEKLY",Daily:"DAILY"}),sa=a({Paypal:"PAYPAL",Venmo:"VENMO"}),ta=a({Default:"DEFAULT",Overlay:"OVERLAY"}),ua=a({Started:"STARTED",Ended:"ENDED",Active:"ACTIVE",Expired:"EXPIRED"}),va=a({Keyword:"KEYWORD",Method:"METHOD",Str:"STR",Number:"NUMBER",Comment:"COMMENT",Default:"DEFAULT"}),wa=a({Square:"SQUARE",Circle:"CIRCLE"});a=a({Chevron:"CHEVRON"});f.MpsQueryCaller=c;f.MpsMessageRangeQueryDirection=d;f.MpsBackupOperation=e;f.MpsBackupContentType=b;f.MpsMessageTag=g;f.MpsUploadType=h;f.MpsMessageBackupSource=i;f.MpsServerMessageUploadStatus=j;f.MpsServerAttachmentUploadStatus=k;f.MebSplitDatabaseExecutionType=l;f.AiBotEmbodimentTrigger=m;f.XmsgGenAiMessageType=n;f.GenAiUnifiedResponseSectionType=o;f.GenAiCodeBlockType=p;f.GenAiOrchestratorSearchEngine=q;f.XmsgStreamStatusType=r;f.XmsgPowerUpStyle=s;f.XmsgGenAiBotSubscriptionProductType=t;f.XmsgGenAiBotResponseProductType=u;f.XmsgaiBotResponseImagineSource=v;f.XmsgMemoriesTemplateType=w;f.XmsgaiProduct=x;f.XmsgContentBrandingOption=y;f.XmsgaiInvocationOptions=z;f.XmsgSuggestedModerationActionType=A;f.XmsgHighlightsTabMoment=B;f.XmsgHighlightsTabReplySourceType=C;f.XmsgMustacheCtaType=D;f.XmsgInlineEntityType=E;f.XmsgNoteMessageType=F;f.XmsgNoteModelType=G;f.XmsgaiLookupEntityType=H;f.XmsgaiLookupActionType=I;f.XmsgTranscriptionStatus=J;f.XmsgImageGlyphType=K;f.XmsgOculusMediaType=L;f.XmsgMessageRequestStatus=M;f.XmsgMessageSendProductType=N;f.XmsgStoryReplyType=O;f.GenAiContextInjectionType=P;f.GenAiPromptType=Q;f.XmsgFeatureTags=R;f.XmsgMessageStreamingProductType=S;f.Xmsge2EeGenAiEncryptedImageProductType=T;f.Xmsge2EeGenAiEncryptedVideoProductType=U;f.XmsgMsgrXmaActionType=V;f.XmsgMsgrReceiverFetchContentType=W;f.XmsgMsgrReceiverFetchXmaLayoutType=X;f.XmsgReportedMessageType=Y;f.XmsgStoryOverlayPollStyle=Z;f.XmsgStoryOverlayTagType=$;f.XmsgXmaLayoutType=aa;f.XmsgXmaVStackLayoutHeaderAlignmentType=ba;f.XmsgXmaContentType=ca;f.XmsgctaType=da;f.XmsgXmaContentAttributionIcon=ea;f.XmsgXmaOverlayContentType=fa;f.XmsgXmaSubtitleDecorationType=ga;f.XmsgXmaVerifiedType=ha;f.XmsgXmaImageDecorationType=ia;f.XmsgXmaCustomPreviewType=ja;f.XmsgXmaMessagingAttachmentFaviconStyle=ka;f.XmsgXmaGatingType=la;f.XmsgXmaYoutubePreviewMediaType=ma;f.XmsgXmaCtaIconType=na;f.XmsgMemoriesE2EeSendTemplateType=oa;f.XmsgXmaRtcCallState=pa;f.XmsgXmaRtcCallType=qa;f.XmsgXmaSubscriptionRecurrenceType=ra;f.XmsgXmaOpgP2pPaymentMethodType=sa;f.XmsgXmaStandardGenericBodyLayoutType=ta;f.XmsgXmaLiveLocationSessionState=ua;f.XmsgXmaCodeBlockType=va;f.XmsgXmaCompactGenericTemplatePreviewStyle=wa;f.XmsgXmaCompactGenericTemplateAccessoryType=a}),66);
__d("MWThreadListConsts",["I64"],(function(a,b,c,d,e,f,g){"use strict";var h;a=56;b=900;c=10;g.threadlistItemHeight=a;g.minimumPixelsNeededForMaxDisplay=b;g.DEFAULT_MIN_LAST_ACTIVITY_TIMESTAMP=(h||d("I64")).one;g.SNIPPET_MAX_NEWEST_INCOMING_MESSAGES_COUNT=c}),98);/*FB_PKG_DELIM*/
__d("EBGetMinosWasm",["WAWasmModuleCache","bx"],(function(a,b,c,d,e,f,g){"use strict";var h=c("bx").getURL(c("bx")("31853"));a=function(){return d("WAWasmModuleCache").loadWasmModule(h)};g.getMinosWasm=a}),98);
__d("EBMinosLogger",["WATagsLogger"],(function(a,b,c,d,e,f,g){"use strict";a=d("WATagsLogger").TAGS(["minos"]);g.minosLogger=a}),98);
__d("EBMinosQplFlow",["QPLUserFlow","Random","gkx","justknobx","qpl"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.threadId;return h({annotations:{string:{threadId:a}},event:c("qpl")._(521473369,"2834")})}function b(a){a=a.threadId;return h({annotations:{string:{threadId:a}},event:c("qpl")._(521485893,"2835")})}function e(){return h({event:c("qpl")._(521473922,"2832")})}function h(a){var b=a.annotations;a=a.event;var e=d("Random").uint32();c("QPLUserFlow").start(a,{annotations:babelHelpers["extends"]({},b,{bool:babelHelpers["extends"]({},b==null?void 0:b.bool,{m1_1_enabled:c("gkx")("14828"),m1_2_enabled:c("gkx")("14827"),use_minos_thread_id:!0}),"int":babelHelpers["extends"]({},b==null?void 0:b["int"],{instanceKey:e,retryCount:0})}),instanceKey:e,timeoutInMs:c("justknobx")._("1405")});return k(a,e)}function f(){return h({event:c("qpl")._(521473150,"2143")})}function i(){return h({event:c("qpl")._(521482880,"16")})}function j(){return h({event:c("qpl")._(521479165,"3055")})}function k(a,b){return{addAnnotations:function(d){c("QPLUserFlow").addAnnotations(a,d,{instanceKey:b})},addPoint:function(d,e){e&&c("QPLUserFlow").addAnnotations(a,e,{instanceKey:b}),c("QPLUserFlow").addPoint(a,d,{instanceKey:b})},endFailWithError:function(d,e,f){f=babelHelpers["extends"]({},f,{string:babelHelpers["extends"]({},f==null?void 0:f.string,{failReason:e})});c("QPLUserFlow").endFailure(a,d,{annotations:f,instanceKey:b})},endSuccess:function(d){c("QPLUserFlow").endSuccess(a,{annotations:d,instanceKey:b})},getInstanceKey:function(){return b}}}g.startMinosMessageEnqueueQpl=a;g.startMinosMessageUploadQpl=b;g.startMinosUploadMekQpl=e;g.startMinosWritePublicKeysQpl=f;g.startMinosVerifySingleEpochQpl=i;g.startMinosCreateEpochParamsQpl=j}),98);
__d("EBMinosTypes",["$InternalEnum","WAJids"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return a}function c(a){return a.endsWith(d("WAJids").MSGR_USER_DOMAIN)?a.slice(0,-d("WAJids").MSGR_USER_DOMAIN.length):null}var h=d("WAJids").createJidUtils({platform:"msgr"});function e(a){return h.toUserJid(a)}function f(a){return a}function i(a){return a}function j(a){return a}function k(a){return a}function l(a){return a}function m(a){return a}function n(a){return a}function o(a){return a}function p(a){return a}function q(a){return a}function r(a){return a}function s(a){return a}function t(a){return a}function u(a){return a}function v(a){return a}function w(a){return a}function x(a){return a}function y(a){return a}function z(a){return a}function A(a){return a}function B(a){return a}function C(a){return a}function D(a){return a}function E(a){return a}function F(a){return a}function G(a){return a}function H(a){return a}function I(a){return a}function J(a){return a}function K(a){return a}b=b("$InternalEnum")({INVALID:"-1",IMAGE:"0",PTT:"1",DOCUMENT:"3",VIDEO:"4",GIF:"5",STICKER:"6",XMA:"22",MESSENGER_PREVIEW:"25"});g.unsafeCastToUserFbId=a;g.userJidToUserFbId=c;g.userFbidToUserJid=e;g.unsafeCastToMinosThreadId=f;g.unsafeCastToEpochHead=i;g.unsafeCastToEpochSignature=j;g.unsafeCastToEpochNumber=k;g.unsafeCastToEpochCreationTime=l;g.unsafeCastToExportRootKey=m;g.unsafeCastToMekId=n;g.unsafeCastMekKey=o;g.unsafeCastMekRosterHash=p;g.unsafeCastToEncryptedMek=q;g.unsafeCastToMekFbId=r;g.unsafeCastToMekMiThreadId=s;g.unsafeCastToEncryptedMessage=t;g.unsafeCastToEncryptedMessageSignature=u;g.unsafeCastToDecryptedMessage=v;g.unsafeCastToMailboxFbId=w;g.unsafeCastToMailboxSigningPK=x;g.unsafeCastToMailboxSigningSK=y;g.unsafeCastToMailboxEncryptionPK=z;g.unsafeCastToMailboxEncryptionSK=A;g.unsafeCastToMailboxAuthPK=B;g.unsafeCastToMailboxAuthSK=C;g.unsafeCastToTransportSenderEphemeralPK=D;g.unsafeCastToTransportSenderEphemeralKeySig=E;g.unsafeCastToTransportSigningPK=F;g.unsafeCastToTransportSigningSK=G;g.unsafeCastToEpochFbId=H;g.castToSupplementalOpToken=I;g.unsafeCastToAttachmentAccessTokenSecret=J;g.unsafeCastToAttachmentPrimaryKeySecret=K;g.MinosAttachmentMediaType=b}),98);
__d("EBMinosWasm.pb",["WAProtoConst"],(function(a,b,c,d,e,f,g){a={};b={};c={};e={};f={};var h={},i={},j={},k={},l={},m={},n={},o={},p={},q={},r={},s={},t={},u={},v={},w={},x={},y={},z={},A={},B={},C={},D={},E={},F={},G={},H={},I={},J={},K={},L={},M={},N={},O={},P={},Q={},R={},S={},T={},U={},V={},W={},X={},Y={},Z={};a.name="MinosMessageMetadata";a.internalSpec={mekId:[1,(d=d("WAProtoConst")).FLAGS.REQUIRED|d.TYPES.BYTES],timestamp:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64],messageId:[3,d.FLAGS.REQUIRED|d.TYPES.STRING],threadId:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};b.name="MinosEncryptAndSignMessageInput";b.internalSpec={transportSigningSk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mek:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],plaintext:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],metadata:[4,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,a]};c.name="MinosEncryptAndSignMessageResult";c.internalSpec={ciphertext:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],signature:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};e.name="MinosDecryptAndVerifyMessageInput";e.internalSpec={transportSigningPk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mek:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],encryptedMessageCiphertext:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],encryptedMessageSignature:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],metadata:[5,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,a]};f.name="MinosDecryptAndVerifyMessageResult";f.internalSpec={plaintext:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};h.name="MekBundle";h.internalSpec={key:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mekId:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],rosterHash:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES]};i.name="GenerateMekInput";i.internalSpec={epochHeads:[1,d.FLAGS.REPEATED|d.TYPES.BYTES]};j.name="GenerateMekResult";j.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,h]};k.name="GenerateMekRosterHashInput";k.internalSpec={epochHeads:[1,d.FLAGS.REPEATED|d.TYPES.BYTES]};l.name="GenerateMekRosterHashResult";l.internalSpec={rosterHash:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};m.name="EncryptMekForDistributionInput";m.internalSpec={senderEpochHead:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],toMailboxPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],fromKeypair:[3,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,n],mek:[4,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,h]};n.name="EncryptMekForDistributionInput$MailboxAuthKP";n.internalSpec={sk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],pk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};o.name="EncryptMekForDistributionResult";o.internalSpec={ciphertext:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};p.name="DecryptMekForDistributionInput";p.internalSpec={toMailboxSk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],fromPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],mekId:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],senderEpochHead:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],rosterHash:[5,d.FLAGS.REQUIRED|d.TYPES.BYTES],ciphertext:[6,d.FLAGS.REQUIRED|d.TYPES.BYTES]};q.name="DecryptMekForDistributionResult";q.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};r.name="EncryptMeksForDistributionFromTransportSenderInput";r.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,h],transportSigningKp:[2,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,s],recipientMailboxEncryptionPks:[3,d.FLAGS.REPEATED|d.TYPES.BYTES],recipientEpochHeads:[4,d.FLAGS.REPEATED|d.TYPES.BYTES]};s.name="EncryptMeksForDistributionFromTransportSenderInput$TransportSigningKP";s.internalSpec={sk:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],pk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};t.name="EncryptMeksForDistributionFromTransportSenderResult";t.internalSpec={encryptedMeks:[1,d.FLAGS.REPEATED|d.TYPES.BYTES],ephemeralEncryptionPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],signingPk:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],signature:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};u.name="DecryptMekForDistributionFromTransportSenderInput";u.internalSpec={mekDistribution:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,v],mekId:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],rosterHash:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],recipientEncSk:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};v.name="DecryptMekForDistributionFromTransportSenderInput$TransportSenderMEKDistributionSingleRecipient";v.internalSpec={encryptedMek:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],ephemeralEncryptionPk:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES],signingPk:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],signature:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES]};w.name="DecryptMekForDistributionFromTransportSenderResult";w.internalSpec={mek:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};x.name="WrapTransportSigningPublicKeyInput";x.internalSpec={keyBytes:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};y.name="WrapTransportSigningPublicKeyResult";y.internalSpec={prefixedKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};z.name="WrapTransportSigningSecretKeyInput";z.internalSpec={keyBytes:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};A.name="WrapTransportSigningSecretKeyResult";A.internalSpec={prefixedKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};B.name="DeriveMailboxSigningKeypairInput";B.internalSpec={exportRootKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64]};C.name="DeriveMailboxSigningKeypairResult";C.internalSpec={mailboxSigningPublicKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxSigningPrivateKey:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};D.name="DeriveMailboxEncryptionKeypairInput";D.internalSpec={exportRootKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64]};E.name="DeriveMailboxEncryptionKeypairResult";E.internalSpec={mailboxEncryptionPublicKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxEncryptionPrivateKey:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};F.name="DeriveMailboxAuthKeypairInput";F.internalSpec={exportRootKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64]};G.name="DeriveMailboxAuthKeypairResult";G.internalSpec={mailboxAuthPublicKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxAuthPrivateKey:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};H.name="DeriveAttachmentAccessTokenSecretInput";H.internalSpec={mediaKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};I.name="DeriveAttachmentAccessTokenSecretResult";I.internalSpec={attachmentAccessTokenSecret:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};J.name="DeriveAttachmentPrimaryKeySecretInput";J.internalSpec={mediaKey:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};K.name="DeriveAttachmentPrimaryKeySecretResult";K.internalSpec={attachmentPrimaryKeySecret:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};L.name="EpochPublicData";L.internalSpec={epochNumber:[1,d.FLAGS.REQUIRED|d.TYPES.UINT64],userFbid:[2,d.FLAGS.REQUIRED|d.TYPES.STRING],mailboxSigningPk:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxEncryptionPk:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],mailboxAuthPk:[5,d.FLAGS.REQUIRED|d.TYPES.BYTES],previousEpochHead:[6,d.TYPES.BYTES]};M.name="EpochSignatures";M.internalSpec={selfSignature:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES],prevSignature:[2,d.TYPES.BYTES]};N.name="MinosSignedEpoch";N.internalSpec={epochPublicData:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],signatures:[2,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,M],epochHead:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES]};O.name="MinosOpenInitialEpochInput";O.internalSpec={userFbid:[1,d.FLAGS.REQUIRED|d.TYPES.STRING],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64],exportRootKey:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES]};P.name="MinosOpenInitialEpochResult";P.internalSpec={minosSignedEpoch:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,N]};Q.name="MinosOpenEpochInput";Q.internalSpec={userFbid:[1,d.FLAGS.REQUIRED|d.TYPES.STRING],epochNumber:[2,d.FLAGS.REQUIRED|d.TYPES.UINT64],exportRootKey:[3,d.FLAGS.REQUIRED|d.TYPES.BYTES],previousExportRootKey:[4,d.FLAGS.REQUIRED|d.TYPES.BYTES],previousEpochNumber:[5,d.FLAGS.REQUIRED|d.TYPES.UINT64],previousEpochHead:[6,d.FLAGS.REQUIRED|d.TYPES.BYTES]};R.name="MinosOpenEpochResult";R.internalSpec={minosSignedEpoch:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,N]};S.name="MinosValidateEpochInput";S.internalSpec={epochPublicData:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],previousEpochPublicData:[2,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],signatures:[3,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,M]};T.name="MinosValidateEpochResult";T.internalSpec={valid:[1,d.TYPES.BOOL],errorMessage:[2,d.TYPES.STRING],__oneofs__:{result:["valid","errorMessage"]}};U.name="MinosVerifySingleEpochInput";U.internalSpec={epochPublicData:[1,d.FLAGS.REQUIRED|d.TYPES.MESSAGE,L],signature:[2,d.FLAGS.REQUIRED|d.TYPES.BYTES]};V.name="MinosVerifySingleEpochResult";V.internalSpec={valid:[1,d.FLAGS.REQUIRED|d.TYPES.BOOL]};W.name="MinosThreadIdFromOneToOneThreadInput";W.internalSpec={actThreadId:[1,d.FLAGS.REQUIRED|d.TYPES.STRING],selfFbid:[2,d.FLAGS.REQUIRED|d.TYPES.STRING]};X.name="MinosThreadIdFromOneToOneThreadResult";X.internalSpec={threadId:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};Y.name="MinosThreadIdFromActThreadIdInput";Y.internalSpec={actThreadId:[1,d.FLAGS.REQUIRED|d.TYPES.STRING]};Z.name="MinosThreadIdFromActThreadIdResult";Z.internalSpec={threadId:[1,d.FLAGS.REQUIRED|d.TYPES.BYTES]};g.MinosMessageMetadataSpec=a;g.MinosEncryptAndSignMessageInputSpec=b;g.MinosEncryptAndSignMessageResultSpec=c;g.MinosDecryptAndVerifyMessageInputSpec=e;g.MinosDecryptAndVerifyMessageResultSpec=f;g.MekBundleSpec=h;g.GenerateMekInputSpec=i;g.GenerateMekResultSpec=j;g.GenerateMekRosterHashInputSpec=k;g.GenerateMekRosterHashResultSpec=l;g.EncryptMekForDistributionInputSpec=m;g.EncryptMekForDistributionInput$MailboxAuthKPSpec=n;g.EncryptMekForDistributionResultSpec=o;g.DecryptMekForDistributionInputSpec=p;g.DecryptMekForDistributionResultSpec=q;g.EncryptMeksForDistributionFromTransportSenderInputSpec=r;g.EncryptMeksForDistributionFromTransportSenderInput$TransportSigningKPSpec=s;g.EncryptMeksForDistributionFromTransportSenderResultSpec=t;g.DecryptMekForDistributionFromTransportSenderInputSpec=u;g.DecryptMekForDistributionFromTransportSenderInput$TransportSenderMEKDistributionSingleRecipientSpec=v;g.DecryptMekForDistributionFromTransportSenderResultSpec=w;g.WrapTransportSigningPublicKeyInputSpec=x;g.WrapTransportSigningPublicKeyResultSpec=y;g.WrapTransportSigningSecretKeyInputSpec=z;g.WrapTransportSigningSecretKeyResultSpec=A;g.DeriveMailboxSigningKeypairInputSpec=B;g.DeriveMailboxSigningKeypairResultSpec=C;g.DeriveMailboxEncryptionKeypairInputSpec=D;g.DeriveMailboxEncryptionKeypairResultSpec=E;g.DeriveMailboxAuthKeypairInputSpec=F;g.DeriveMailboxAuthKeypairResultSpec=G;g.DeriveAttachmentAccessTokenSecretInputSpec=H;g.DeriveAttachmentAccessTokenSecretResultSpec=I;g.DeriveAttachmentPrimaryKeySecretInputSpec=J;g.DeriveAttachmentPrimaryKeySecretResultSpec=K;g.EpochPublicDataSpec=L;g.EpochSignaturesSpec=M;g.MinosSignedEpochSpec=N;g.MinosOpenInitialEpochInputSpec=O;g.MinosOpenInitialEpochResultSpec=P;g.MinosOpenEpochInputSpec=Q;g.MinosOpenEpochResultSpec=R;g.MinosValidateEpochInputSpec=S;g.MinosValidateEpochResultSpec=T;g.MinosVerifySingleEpochInputSpec=U;g.MinosVerifySingleEpochResultSpec=V;g.MinosThreadIdFromOneToOneThreadInputSpec=W;g.MinosThreadIdFromOneToOneThreadResultSpec=X;g.MinosThreadIdFromActThreadIdInputSpec=Y;g.MinosThreadIdFromActThreadIdResultSpec=Z}),98);
__d("WAErrorMessage",[],(function(a,b,c,d,e,f){"use strict";var g="NoErrorMessageProvided";function a(a){if(typeof a==="string")return a;if(a instanceof Error)return a.toString();if(typeof a==="object")if(typeof (a==null?void 0:a.description)==="string")return a.description;else if(typeof (a==null?void 0:a.message)==="string")return a.message;return g}f.NO_ERROR_MESSAGE_PROVIDED=g;f.maybeGetMessageFromError=a}),66);
__d("WASIContext",[],(function(a,b,c,d,e,f){"use strict";a=function(a){var b;this.fs=(b=a==null?void 0:a.fs)!=null?b:{};this.args=(b=a==null?void 0:a.args)!=null?b:[];this.env=(b=a==null?void 0:a.env)!=null?b:{};this.stdin=(b=a==null?void 0:a.stdin)!=null?b:function(){return null};this.stdout=(b=a==null?void 0:a.stdout)!=null?b:function(){};this.stderr=(b=a==null?void 0:a.stderr)!=null?b:function(){};this.debug=a==null?void 0:a.debug;this.isTTY=!!(a==null?void 0:a.isTTY)};f.WASIContext=a}),66);
__d("WASISnapshotPreview1",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({SUCCESS:0,E2BIG:1,EACCESS:2,EADDRINUSE:3,EADDRNOTAVAIL:4,EAFNOSUPPORT:5,EAGAIN:6,EALREADY:7,EBADF:8,EBADMSG:9,EBUSY:10,ECANCELED:11,ECHILD:12,ECONNABORTED:13,ECONNREFUSED:14,ECONNRESET:15,EDEADLK:16,EDESTADDRREQ:17,EDOM:18,EDQUOT:19,EEXIST:20,EFAULT:21,EFBIG:22,EHOSTUNREACH:23,EIDRM:24,EILSEQ:25,EINPROGRESS:26,EINTR:27,EINVAL:28,EIO:29,EISCONN:30,EISDIR:31,ELOOP:32,EMFILE:33,EMLINK:34,EMSGSIZE:35,EMULTIHOP:36,ENAMETOOLONG:37,ENETDOWN:38,ENETRESET:39,ENETUNREACH:40,ENFILE:41,ENOBUFS:42,ENODEV:43,ENOENT:44,ENOEXEC:45,ENOLCK:46,ENOLINK:47,ENOMEM:48,ENOMSG:49,ENOPROTOOPT:50,ENOSPC:51,ENOSYS:52,ENOTCONN:53,ENOTDIR:54,ENOTEMPTY:55,ENOTRECOVERABLE:56,ENOTSOCK:57,ENOTSUP:58,ENOTTY:59,ENXIO:60,EOVERFLOW:61,EOWNERDEAD:62,EPERM:63,EPIPE:64,EPROTO:65,EPROTONOSUPPORT:66,EPROTOTYPE:67,ERANGE:68,EROFS:69,ESPIPE:70,ESRCH:71,ESTALE:72,ETIMEDOUT:73,ETXTBSY:74,EXDEV:75,ENOTCAPABLE:76});d=(c=b("$InternalEnum"))({REALTIME:0,MONOTONIC:1,PROCESS_CPUTIME_ID:2,THREAD_CPUTIME_ID:3});e=c({SET:0,CUR:1,END:2});b=c({UNKNOWN:0,BLOCK_DEVICE:1,CHARACTER_DEVICE:2,DIRECTORY:3,REGULAR_FILE:4,SOCKET_DGRAM:5,SOCKET_STREAM:6,SYMBOLIC_LINK:7});var g=c({DIR:0});c=c({CLOCK:0,FD_READ:1,FD_WRITE:2});var h={SYMLINK_FOLLOW:1<<0},i={CREAT:1<<0,DIRECTORY:1<<1,EXCL:1<<2,TRUNC:1<<3},j={APPEND:1<<0,DSYNC:1<<1,NONBLOCK:1<<2,RSYNC:1<<3,SYNC:1<<4},k={FD_DATASYNC:BigInt(1)<<BigInt(0),FD_READ:BigInt(1)<<BigInt(1),FD_SEEK:BigInt(1)<<BigInt(2),FD_FDSTAT_SET_FLAGS:BigInt(1)<<BigInt(3),FD_SYNC:BigInt(1)<<BigInt(4),FD_TELL:BigInt(1)<<BigInt(5),FD_WRITE:BigInt(1)<<BigInt(6),FD_ADVISE:BigInt(1)<<BigInt(7),FD_ALLOCATE:BigInt(1)<<BigInt(8),PATH_CREATE_DIRECTORY:BigInt(1)<<BigInt(9),PATH_CREATE_FILE:BigInt(1)<<BigInt(10),PATH_LINK_SOURCE:BigInt(1)<<BigInt(11),PATH_LINK_TARGET:BigInt(1)<<BigInt(12),PATH_OPEN:BigInt(1)<<BigInt(13),FD_READDIR:BigInt(1)<<BigInt(14),PATH_READLINK:BigInt(1)<<BigInt(15),PATH_RENAME_SOURCE:BigInt(1)<<BigInt(16),PATH_RENAME_TARGET:BigInt(1)<<BigInt(17),PATH_FILESTAT_GET:BigInt(1)<<BigInt(18),PATH_FILESTAT_SET_SIZE:BigInt(1)<<BigInt(19),PATH_FILESTAT_SET_TIMES:BigInt(1)<<BigInt(20),FD_FILESTAT_GET:BigInt(1)<<BigInt(21),FD_FILESTAT_SET_SIZE:BigInt(1)<<BigInt(22),FD_FILESTAT_SET_TIMES:BigInt(1)<<BigInt(23),PATH_SYMLINK:BigInt(1)<<BigInt(24),PATH_REMOVE_DIRECTORY:BigInt(1)<<BigInt(25),PATH_UNLINK_FILE:BigInt(1)<<BigInt(26),POLL_FD_READWRITE:BigInt(1)<<BigInt(27),SOCK_SHUTDOWN:BigInt(1)<<BigInt(28),SOCK_ACCEPT:BigInt(1)<<BigInt(29)},l={ATIM:1<<0,ATIM_NOW:1<<1,MTIM:1<<2,MTIM_NOW:1<<3},m={SUBSCRIPTION_CLOCK_ABSTIME:1<<0},n={FD_READWRITE_HANGUP:1<<0},o=64,p=48,q=32;f.RESULT=a;f.Clock=d;f.Whence=e;f.FileType=b;f.PreopenType=g;f.EventType=c;f.LookupFlags=h;f.OpenFlags=i;f.FileDescriptorFlags=j;f.RightsFlags=k;f.FileStatTimestampFlags=l;f.SubscriptionClockFlags=m;f.EventReadWriteFlags=n;f.FILESTAT_SIZE=o;f.SUBSCRIPTION_SIZE=p;f.EVENT_SIZE=q}),66);
__d("WASIDrive",["WASISnapshotPreview1","WATextEncoding"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.nextFD=10,this.openMap=new Map(),this.fs=babelHelpers["extends"]({},a),this.openMap.set(3,new j(this.fs,"/"))}var b=a.prototype;b.$1=function(a,b,c){a=new h(a,c);b&&(a.buffer=new Uint8Array(new ArrayBuffer(1024),0,0));c=this.nextFD;this.openMap.set(c,a);this.nextFD++;return[d("WASISnapshotPreview1").RESULT.SUCCESS,c]};b.$2=function(a,b){a=new j(a,b);b=this.nextFD;this.openMap.set(b,a);this.nextFD++;return[d("WASISnapshotPreview1").RESULT.SUCCESS,b]};b.$3=function(a,b){return b==="."?!0:a.containsDirectory(b)};b.open=function(a,b,c,e){var f,g=!!(c&(f=d("WASISnapshotPreview1")).OpenFlags.CREAT),h=!!(c&f.OpenFlags.DIRECTORY),i=!!(c&f.OpenFlags.EXCL);c=!!(c&f.OpenFlags.TRUNC);f=this.openMap.get(a);if(!(f instanceof j))return[d("WASISnapshotPreview1").RESULT.EBADF];if(f.containsFile(b)){if(h)return[d("WASISnapshotPreview1").RESULT.ENOTDIR];if(i)return[d("WASISnapshotPreview1").RESULT.EEXIST];a=f.get(b);return this.$1(a,c,e)}else if(this.$3(f,b)){if(b===".")return this.$2(this.fs,"/");var k="/"+b+"/";h=Object.entries(this.fs).filter(function(a){a=a[0];return a.startsWith(k)});return this.$2(Object.fromEntries(h),k)}else{if(g){i=f.fullPath(b);this.fs[i]={path:i,mode:"binary",content:new Uint8Array(0),timestamps:{access:new Date(),modification:new Date(),change:new Date()}};return this.$1(this.fs[i],c,e)}return[d("WASISnapshotPreview1").RESULT.ENOTCAPABLE]}};b.close=function(a){if(!this.openMap.has(a))return d("WASISnapshotPreview1").RESULT.EBADF;var b=this.openMap.get(a);b instanceof h&&b.sync();this.openMap["delete"](a);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.read=function(a,b){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.read(b)]};b.pread=function(a,b,c){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.pread(b,c)]};b.write=function(a,b){a=this.openMap.get(a);if(!a||a instanceof j)return d("WASISnapshotPreview1").RESULT.EBADF;a.write(b);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.pwrite=function(a,b,c){a=this.openMap.get(a);if(!a||a instanceof j)return d("WASISnapshotPreview1").RESULT.EBADF;a.pwrite(b,c);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.sync=function(a){a=this.openMap.get(a);if(!a||a instanceof j)return d("WASISnapshotPreview1").RESULT.EBADF;a.sync();return d("WASISnapshotPreview1").RESULT.SUCCESS};b.seek=function(a,b,c){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.seek(b,c)]};b.tell=function(a){a=this.openMap.get(a);return!a||a instanceof j?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.tell()]};b.renumber=function(a,b){if(!this.exists(a)||!this.exists(b))return d("WASISnapshotPreview1").RESULT.EBADF;if(a===b)return d("WASISnapshotPreview1").RESULT.SUCCESS;this.close(b);a=this.openMap.get(a);this.openMap.set(b,a);return d("WASISnapshotPreview1").RESULT.SUCCESS};b.unlink=function(a,b){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;if(!a.contains(b))return d("WASISnapshotPreview1").RESULT.ENOENT;for(var c of Object.keys(this.fs))(c===a.fullPath(b)||c.startsWith(a.fullPath(b)+"/"))&&delete this.fs[c];return d("WASISnapshotPreview1").RESULT.SUCCESS};b.rename=function(a,b,c,e){a=this.openMap.get(a);c=this.openMap.get(c);if(!(a instanceof j)||!(c instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;if(!a.contains(b))return d("WASISnapshotPreview1").RESULT.ENOENT;if(c.contains(e))return d("WASISnapshotPreview1").RESULT.EEXIST;a=a.fullPath(b);b=c.fullPath(e);for(c of Object.keys(this.fs))if(c.startsWith(a)){e=c.replace(a,b);this.fs[e]=this.fs[c];this.fs[e].path=e;delete this.fs[c]}return d("WASISnapshotPreview1").RESULT.SUCCESS};b.list=function(a){a=this.openMap.get(a);return!(a instanceof j)?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.list()]};b.stat=function(a){a=this.openMap.get(a);return!(a instanceof h)?[d("WASISnapshotPreview1").RESULT.EBADF]:[d("WASISnapshotPreview1").RESULT.SUCCESS,a.stat()]};b.pathStat=function(a,b){a=this.openMap.get(a);if(!(a instanceof j))return[d("WASISnapshotPreview1").RESULT.EBADF];if(a.containsFile(b)){var c=a.fullPath(b);c=new h(this.fs[c],0).stat();return[d("WASISnapshotPreview1").RESULT.SUCCESS,c]}else if(this.$3(a,b)){if(b===".")return[d("WASISnapshotPreview1").RESULT.SUCCESS,new j(this.fs,"/").stat()];var e="/"+b+"/";c=Object.entries(this.fs).filter(function(a){a=a[0];return a.startsWith(e)});a=new j(Object.fromEntries(c),e).stat();return[d("WASISnapshotPreview1").RESULT.SUCCESS,a]}else return[d("WASISnapshotPreview1").RESULT.ENOTCAPABLE]};b.setFlags=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setFlags(b);return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.setSize=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setSize(Number(b));return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.setAccessTime=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setAccessTime(b);return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.setModificationTime=function(a,b){a=this.openMap.get(a);if(a instanceof h){a.setModificationTime(b);return d("WASISnapshotPreview1").RESULT.SUCCESS}else return d("WASISnapshotPreview1").RESULT.EBADF};b.pathSetAccessTime=function(a,b,c){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;a=a.get(b);if(a==null)return d("WASISnapshotPreview1").RESULT.ENOTCAPABLE;b=new h(a,0);b.setAccessTime(c);b.sync();return d("WASISnapshotPreview1").RESULT.SUCCESS};b.pathSetModificationTime=function(a,b,c){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;a=a.get(b);if(a==null)return d("WASISnapshotPreview1").RESULT.ENOTCAPABLE;b=new h(a,0);b.setModificationTime(c);b.sync();return d("WASISnapshotPreview1").RESULT.SUCCESS};b.pathCreateDir=function(a,b){a=this.openMap.get(a);if(!(a instanceof j))return d("WASISnapshotPreview1").RESULT.EBADF;if(a.contains(b))return d("WASISnapshotPreview1").RESULT.ENOTCAPABLE;a=a.fullPath(b)+"/.runno";this.fs[a]={path:a,timestamps:{access:new Date(),modification:new Date(),change:new Date()},mode:"string",content:""};return d("WASISnapshotPreview1").RESULT.SUCCESS};b.exists=function(a){return this.openMap.has(a)};b.fileType=function(a){a=this.openMap.get(a);if(!a)return d("WASISnapshotPreview1").FileType.UNKNOWN;else if(a instanceof h)return d("WASISnapshotPreview1").FileType.REGULAR_FILE;else return d("WASISnapshotPreview1").FileType.DIRECTORY};b.fileFdflags=function(a){a=this.openMap.get(a);if(a instanceof h)return a.fdflags;else return 0};return a}();var h=function(){var b=a.prototype;b.getOffset=function(){return Number(this.$1)};function a(a,b){this.$1=BigInt(0);this.isDirty=!1;this.file=a;if(this.file.mode==="string"){a=this.file.content;var c=d("WATextEncoding").newTextEncoder();this.buffer=c.encode(a)}else this.buffer=this.file.content;this.fdflags=b;this.flagAppend=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.APPEND);this.flagDSync=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.DSYNC);this.flagNonBlock=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.NONBLOCK);this.flagRSync=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.RSYNC);this.flagSync=!!(b&d("WASISnapshotPreview1").FileDescriptorFlags.SYNC)}b.read=function(a){a=this.buffer.subarray(this.getOffset(),this.getOffset()+a);this.$1+=BigInt(a.length);return a};b.pread=function(a,b){return this.buffer.subarray(b,b+a)};b.write=function(a){this.isDirty=!0;if(this.flagAppend){var b=this.buffer.length;this.$2(b+a.byteLength);this.buffer.set(a,b)}else{b=Math.max(this.getOffset()+a.byteLength,this.buffer.byteLength);this.$2(b);this.buffer.set(a,this.getOffset());this.$1+=BigInt(a.byteLength)}(this.flagDSync||this.flagSync)&&this.sync()};b.pwrite=function(a,b){this.isDirty=!0;if(this.flagAppend){var c=this.buffer.length;this.$2(c+a.byteLength);this.buffer.set(a,c)}else{c=Math.max(b+a.byteLength,this.buffer.byteLength);this.$2(c);this.buffer.set(a,b)}(this.flagDSync||this.flagSync)&&this.sync()};b.sync=function(){if(!this.isDirty)return;this.isDirty=!1;if(this.file.mode==="binary"){this.file.content=new Uint8Array(this.buffer);return}var a=d("WATextEncoding").newTextDecoder();this.file.content=a.decode(this.buffer);return};b.seek=function(a,b){switch(b){case d("WASISnapshotPreview1").Whence.SET:this.$1=a;break;case d("WASISnapshotPreview1").Whence.CUR:this.$1+=a;break;case d("WASISnapshotPreview1").Whence.END:this.$1=BigInt(this.buffer.length)+a;break}return this.$1};b.tell=function(){return this.$1};b.stat=function(){return{path:this.file.path,timestamps:this.file.timestamps,type:d("WASISnapshotPreview1").FileType.REGULAR_FILE,byteLength:this.buffer.length}};b.setFlags=function(a){this.fdflags=a};b.setSize=function(a){this.$2(a)};b.setAccessTime=function(a){this.file.timestamps.access=a};b.setModificationTime=function(a){this.file.timestamps.modification=a};b.$2=function(a){if(a<=this.buffer.buffer.byteLength){this.buffer=new Uint8Array(this.buffer.buffer,0,a);return}var b;this.buffer.buffer.byteLength===0?b=new ArrayBuffer(a<1024?1024:a*2):a>this.buffer.buffer.byteLength*2?b=new ArrayBuffer(a*2):b=new ArrayBuffer(this.buffer.buffer.byteLength*2);b=new Uint8Array(b,0,a);b.set(this.buffer);this.buffer=b};return a}();function i(a,b){b=b.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");b=new RegExp("^"+b);return a.replace(b,"")}var j=function(){function a(a,b){this.dir=a,this.prefix=b}var b=a.prototype;b.containsFile=function(a){for(var b of Object.keys(this.dir)){var c=i(b,this.prefix);if(c===a)return!0}return!1};b.containsDirectory=function(a){for(var b of Object.keys(this.dir)){var c=i(b,this.prefix);if(c.startsWith(a+"/"))return!0}return!1};b.contains=function(a){for(var b of Object.keys(this.dir)){var c=i(b,this.prefix);if(c===a||c.startsWith(a+"/"))return!0}return!1};b.get=function(a){return this.dir[this.fullPath(a)]};b.fullPath=function(a){return""+this.prefix+a};b.list=function(){var a=[],b=new Set();for(var c of Object.keys(this.dir)){var e=i(c,this.prefix);if(e.includes("/")){var f=e.split("/")[0];if(b.has(f))continue;b.add(f);a.push({name:f,type:d("WASISnapshotPreview1").FileType.DIRECTORY})}else a.push({name:e,type:d("WASISnapshotPreview1").FileType.REGULAR_FILE})}return a};b.stat=function(){return{path:this.prefix,timestamps:{access:new Date(),modification:new Date(),change:new Date()},type:d("WASISnapshotPreview1").FileType.DIRECTORY,byteLength:0}};return a}();g.WASIDrive=a}),98);
__d("WASI",["WACryptoDependencies","WASIContext","WASIDrive","WASISnapshotPreview1","WATextEncoding","err"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b,e=new(d("WASIContext").WASIContext)(a),f=new(d("WASIDrive").WASIDrive)(e.fs);function g(){return Object.entries(e.env).map(function(a){var b=a[0];a=a[1];return b+"="+a})}var o={args_get:function(a,c){a=a;c=c;var f=new DataView(b.buffer);for(var g of e.args){f.setUint32(a,c,!0);a+=4;var h=d("WATextEncoding").newTextEncoder().encode(g+"\0"),i=new Uint8Array(b.buffer,c,h.byteLength);i.set(h);c+=h.byteLength}return d("WASISnapshotPreview1").RESULT.SUCCESS},args_sizes_get:function(a,c){var f=e.args,g=f.reduce(function(a,b){return a+d("WATextEncoding").newTextEncoder().encode(b+"\0").byteLength},0),h=new DataView(b.buffer);h.setUint32(a,f.length,!0);h.setUint32(c,g,!0);return d("WASISnapshotPreview1").RESULT.SUCCESS},clock_res_get:function(){throw c("err")("clock_res_get is not implemented")},clock_time_get:function(a,c,e){c=d("WASISnapshotPreview1").Clock.cast(a);if(c==null)return d("WASISnapshotPreview1").RESULT.EINVAL;switch(c){case d("WASISnapshotPreview1").Clock.REALTIME:case d("WASISnapshotPreview1").Clock.MONOTONIC:case d("WASISnapshotPreview1").Clock.PROCESS_CPUTIME_ID:case d("WASISnapshotPreview1").Clock.THREAD_CPUTIME_ID:a=new DataView(b.buffer);a.setBigUint64(e,n(new Date()),!0);return d("WASISnapshotPreview1").RESULT.SUCCESS}},environ_get:function(a,c){a=a;c=c;var e=new DataView(b.buffer);for(var f of g()){e.setUint32(a,c,!0);a+=4;var h=d("WATextEncoding").newTextEncoder().encode(f+"\0"),i=new Uint8Array(b.buffer,c,h.byteLength);i.set(h);c+=h.byteLength}return d("WASISnapshotPreview1").RESULT.SUCCESS},environ_sizes_get:function(a,c){var e=g().reduce(function(a,b){return a+d("WATextEncoding").newTextEncoder().encode(b+"\0").byteLength},0),f=new DataView(b.buffer);f.setUint32(a,g().length,!0);f.setUint32(c,e,!0);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_advise:function(){throw c("err")("fd_advise is not implemented")},fd_allocate:function(){throw c("err")("fd_allocate is not implemented")},fd_close:function(a){return f.close(a)},fd_datasync:function(){throw c("err")("fd_datasync is not implemented")},fd_fdstat_get:function(a,c){if(a<3){if(e.isTTY){var g=i^d("WASISnapshotPreview1").RightsFlags.FD_SEEK^d("WASISnapshotPreview1").RightsFlags.FD_TELL;g=l(d("WASISnapshotPreview1").FileType.CHARACTER_DEVICE,0,g)}else g=l(d("WASISnapshotPreview1").FileType.CHARACTER_DEVICE,0);var h=new Uint8Array(b.buffer,c,g.byteLength);h.set(g);return d("WASISnapshotPreview1").RESULT.SUCCESS}if(!f.exists(a))return d("WASISnapshotPreview1").RESULT.EBADF;h=f.fileType(a);g=f.fileFdflags(a);a=l(h,g);h=new Uint8Array(b.buffer,c,a.byteLength);h.set(a);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_fdstat_set_flags:function(a,b){return f.setFlags(a,b)},fd_fdstat_set_rights:function(){return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_filestat_get:function(a,c){if(a<3){var e;switch(a){case 0:e="/dev/stdin";break;case 1:e="/dev/stdout";break;case 2:e="/dev/stderr";break;default:e="/dev/undefined";break}var g=k({path:e,byteLength:0,timestamps:{access:new Date(),modification:new Date(),change:new Date()},type:d("WASISnapshotPreview1").FileType.CHARACTER_DEVICE}),h=new Uint8Array(b.buffer,c,g.byteLength);h.set(g);return d("WASISnapshotPreview1").RESULT.SUCCESS}h=f.stat(a);if(h.length===1)return h[0];g=h[1];a=k(g);h=new Uint8Array(b.buffer,c,a.byteLength);h.set(a);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_filestat_set_size:function(){throw c("err")("fd_filestat_set_size is not implemented")},fd_filestat_set_times:function(){throw c("err")("fd_filestat_set_times is not implemented")},fd_pread:function(){throw c("err")("fd_pread is not implemented")},fd_prestat_dir_name:function(a,c,e){if(a!==3)return d("WASISnapshotPreview1").RESULT.EBADF;a=d("WATextEncoding").newTextEncoder().encode("/");c=new Uint8Array(b.buffer,c,e);c.set(a.subarray(0,e));return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_prestat_get:function(a,c){if(a!==3)return d("WASISnapshotPreview1").RESULT.EBADF;a=d("WATextEncoding").newTextEncoder().encode(".");c=new DataView(b.buffer,c);c.setUint8(0,d("WASISnapshotPreview1").PreopenType.DIR);c.setUint32(4,a.byteLength,!0);return d("WASISnapshotPreview1").RESULT.SUCCESS},fd_pwrite:function(){throw c("err")("fd_pwrite is not implemented")},fd_read:function(a,c,g,h){if(a===1||a===2)return d("WASISnapshotPreview1").RESULT.ENOTSUP;var i=new DataView(b.buffer);c=j(i,c,g);g=d("WATextEncoding").newTextEncoder();var k=0,l=d("WASISnapshotPreview1").RESULT.SUCCESS;for(c of c){var m=void 0;if(a===0){var n=e.stdin(c.byteLength);if(n==null)break;m=g.encode(n)}else{n=f.read(a,c.byteLength);if(n.length===1){l=n[0];break}else m=n[1]}n=Math.min(c.byteLength,m.byteLength);c.set(m.subarray(0,n));k+=n}i.setUint32(h,k,!0);return l},fd_readdir:function(){throw c("err")("fd_readdir is not implemented")},fd_renumber:function(){throw c("err")("fd_renumber is not implemented")},fd_seek:function(a,e,g,h){g=d("WASISnapshotPreview1").Whence.cast(g);if(g==null)throw c("err")("fd_seek: invalid whence");a=f.seek(a,e,g);if(a.length===1)return a[0];e=a[0];g=a[1];a=new DataView(b.buffer);a.setBigUint64(h,g,!0);return e},fd_sync:function(){throw c("err")("fd_sync is not implemented")},fd_tell:function(a,c){a=f.tell(a);if(a.length===1)return a[0];var d=a[0];a=a[1];var e=new DataView(b.buffer);e.setBigUint64(c,a,!0);return d},fd_write:function(a,c,g,h){if(a===0)return d("WASISnapshotPreview1").RESULT.ENOTSUP;var i=new DataView(b.buffer);c=j(i,c,g);g=d("WATextEncoding").newTextDecoder();var k=0,l=d("WASISnapshotPreview1").RESULT.SUCCESS;for(c of c){if(c.byteLength===0)continue;if(a===1||a===2){var m=a===1?e.stdout:e.stderr,n=g.decode(c);m(n)}else{l=f.write(a,c);if(l!==d("WASISnapshotPreview1").RESULT.SUCCESS)break}k+=c.byteLength}i.setUint32(h,k,!0);return l},path_create_directory:function(){throw c("err")("path_create_directory is not implemented")},path_filestat_get:function(){throw c("err")("path_filestat_get is not implemented")},path_filestat_set_times:function(){throw c("err")("path_filestat_set_times is not implemented")},path_link:function(){throw c("err")("path_link is not implemented")},path_open:function(a,c,d,e,g,h,i,j,k){c=new DataView(b.buffer);h=m(b,d,e);i=f.open(a,h,g,j);if(i.length===1)return i[0];d=i[0];e=i[1];c.setUint32(k,e,!0);return d},path_readlink:function(){throw c("err")("path_readlink is not implemented")},path_remove_directory:function(){throw c("err")("path_remove_directory is not implemented")},path_rename:function(){throw c("err")("path_rename is not implemented")},path_symlink:function(){throw c("err")("path_symlink is not implemented")},path_unlink_file:function(){throw c("err")("path_unlink_file is not implemented")},poll_oneoff:function(){throw c("err")("poll_oneoff is not implemented")},proc_exit:function(a){throw new h(a)},proc_raise:function(){throw c("err")("proc_raise is not implemented")},random_get:function(a,c){a=new Uint8Array(b.buffer,a,c);d("WACryptoDependencies").getCrypto().getRandomValues(a);return d("WASISnapshotPreview1").RESULT.SUCCESS},sched_yield:function(){throw c("err")("sched_yield is not implemented")},sock_accept:function(){throw c("err")("sock_accept is not implemented")},sock_recv:function(){throw c("err")("sock_recv is not implemented")},sock_send:function(){throw c("err")("sock_send is not implemented")},sock_shutdown:function(){throw c("err")("sock_shutdown is not implemented")}};return{getImportObject:function(){return{wasi_snapshot_preview1:o}},start:function(a){var d=a.exports.memory;if(d instanceof WebAssembly.Memory)b=d;else throw c("err")("Expected memory object");d=a.exports._start;try{d()}catch(a){if(a instanceof h)return{exitCode:a.code,fs:f.fs};else if(a instanceof WebAssembly.RuntimeError)return{exitCode:134,fs:f.fs};else throw a}return{exitCode:0,fs:f.fs}}}}var h=function(b){babelHelpers.inheritsLoose(a,b);function a(a){var c;c=b.call(this)||this;c.code=a;return c}return a}(babelHelpers.wrapNativeSuper(Error)),i=(b=d("WASISnapshotPreview1")).RightsFlags.FD_DATASYNC|b.RightsFlags.FD_READ|b.RightsFlags.FD_SEEK|b.RightsFlags.FD_FDSTAT_SET_FLAGS|b.RightsFlags.FD_SYNC|b.RightsFlags.FD_TELL|b.RightsFlags.FD_WRITE|b.RightsFlags.FD_ADVISE|b.RightsFlags.FD_ALLOCATE|b.RightsFlags.PATH_CREATE_DIRECTORY|b.RightsFlags.PATH_CREATE_FILE|b.RightsFlags.PATH_LINK_SOURCE|b.RightsFlags.PATH_LINK_TARGET|b.RightsFlags.PATH_OPEN|b.RightsFlags.FD_READDIR|b.RightsFlags.PATH_READLINK|b.RightsFlags.PATH_RENAME_SOURCE|b.RightsFlags.PATH_RENAME_TARGET|b.RightsFlags.PATH_FILESTAT_GET|b.RightsFlags.PATH_FILESTAT_SET_SIZE|b.RightsFlags.PATH_FILESTAT_SET_TIMES|b.RightsFlags.FD_FILESTAT_GET|b.RightsFlags.FD_FILESTAT_SET_SIZE|b.RightsFlags.FD_FILESTAT_SET_TIMES|b.RightsFlags.PATH_SYMLINK|b.RightsFlags.PATH_REMOVE_DIRECTORY|b.RightsFlags.PATH_UNLINK_FILE|b.RightsFlags.POLL_FD_READWRITE|b.RightsFlags.SOCK_SHUTDOWN|b.RightsFlags.SOCK_ACCEPT;function j(a,b,c){var d=new Array(c);b=b;for(var e=0;e<c;e++){var f=a.getUint32(b,!0);b+=4;var g=a.getUint32(b,!0);b+=4;d[e]=new Uint8Array(a.buffer,f,g)}return d}function k(a){var b=new Uint8Array(d("WASISnapshotPreview1").FILESTAT_SIZE),c=new DataView(b.buffer);c.setBigUint64(0,BigInt(0),!0);c.setBigUint64(8,BigInt(o(a.path)),!0);c.setUint8(16,a.type);c.setBigUint64(24,BigInt(1),!0);c.setBigUint64(32,BigInt(a.byteLength),!0);c.setBigUint64(40,n(a.timestamps.access),!0);c.setBigUint64(48,n(a.timestamps.modification),!0);c.setBigUint64(56,n(a.timestamps.change),!0);return b}function l(a,b,c){var d=c!=null?c:i;c=c!=null?c:i;var e=new Uint8Array(24),f=new DataView(e.buffer,0,24);f.setUint8(0,a);f.setUint32(2,b,!0);f.setBigUint64(8,d,!0);f.setBigUint64(16,c,!0);return e}function m(a,b,c){return d("WATextEncoding").newTextDecoder().decode(new Uint8Array(a.buffer,b,c))}function n(a){return BigInt(a.getTime())*BigInt(1e6)}function o(a,b){b===void 0&&(b=0);var c=3735928559^b;b=1103547991^b;for(var d=0,e;d<a.length;d++)e=a.charCodeAt(d),c=Math.imul(c^e,2654435761),b=Math.imul(b^e,1597334677);c=Math.imul(c^c>>>16,2246822507)^Math.imul(b^b>>>13,3266489909);b=Math.imul(b^b>>>16,2246822507)^Math.imul(c^c>>>13,3266489909);return 4294967296*(2097151&b)+(c>>>0)}g.createWasi=a}),98);
__d("WACreateWasmFunction",["WAErrorMessage","WAResultOrError","WASI","asyncToGeneratorRuntime","decodeProtobuf","encodeProtobuf"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Unexpected runtime error: ",", for cli: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["invalid result type"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["non-zero-exit-code: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["",""]);l=function(){return a};return a}var m="input",n="output",o="/"+m,p="/"+n;function q(a){var b=a.command,c=a.input,d=a.stderr,e=a.stdout;a=a.cli;var f=new Date();return{args:[a,b,"-i="+m,"-o="+n],fs:(a={},a[o]={content:new Uint8Array(c),mode:"binary",path:o,timestamps:{access:f,change:f,modification:f}},a),stderr:d,stdout:e}}function a(a){var c=a.InputSpec,e=a.ResultSpec,f=a.command,g=a.getWasmModule,m=a.logger,n=a.validateResult,o=a.cli,r=m.TAGS(["WasmFunc"]),s=function(a){r.ERROR(l(),a)},t=function(a){r.LOG(k(),a)};return function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{a=d("encodeProtobuf").encodeProtobuf(c,a).readBuffer();a=d("WASI").createWasi(q({cli:o,command:f,input:a,stderr:s,stdout:t}));var b=a.getImportObject;a=a.start;var k=(yield g());k=(yield WebAssembly.instantiate(k,b()));b=a(k);a=b.exitCode;k=b.fs;k=(b=k[p])==null?void 0:b.content;if(a!==0){r.ERROR(j(),a);return d("WAResultOrError").makeError("wasm-internal-non-zero-exit-code")}if(!(k instanceof Uint8Array)){r.ERROR(i());return d("WAResultOrError").makeError("wasm-internal-invalid-result-type")}b=d("decodeProtobuf").decodeProtobuf(e,k);return n(b)}catch(a){r.ERROR(h(),d("WAErrorMessage").maybeGetMessageFromError(a),o);return a instanceof Error?d("WAResultOrError").DEPRECATED_makeError("wasm-internal-runtime-error",a):d("WAResultOrError").makeError("wasm-internal-runtime-error")}});function k(b){return a.apply(this,arguments)}return k}()}g.createWasmFunction=a}),98);/*FB_PKG_DELIM*/
__d("E2eeStateTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({NONE:0,NEGOTIATED:1,STATIC:2});d=a({NONE:0,MEDIA_CHANNEL_KEY_PROTOCOL:1});f=a({SENDER_KEY:0,SESSION_KEY:1});b=a({NOT_SET:0,CONTROL:1,TEST:2});var g=a({NOT_SET:0,CONTROL:1,TEST:2});a=a({ENABLED:0,DISABLED:1,FALLBACK:2});e.exports={E2eeKeyNegotiationProtocolEnum:f,E2eeStateCapabilitiesEnum:d,E2eeStateP2PSFrameExpStatus:g,InfraMandatedExpStatus:b,KeyNegotiationModeEnum:c,SignalingKeyMessageProtocolEnum:a}}),null);
__d("FBXHorizonMetaCastingControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/casting/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("GeneratedLoggerUtils",["invariant","Banzai","JstlMigrationFalcoEvent","getDataWithLoggerOptions"],(function(a,b,c,d,e,f,g){"use strict";var h=window.location.search.indexOf("showlog")>-1;function a(a,c,d,e){var f=b("getDataWithLoggerOptions")(c,e);c=a.split(":")[0];var g=a.split(":")[1];c=="logger"?b("JstlMigrationFalcoEvent").log(function(){return{logger_config_name:g,payload:f}}):b("Banzai").post(a,f,d);h}c={log:a,serializeVector:function(a){if(!a)return a;if(Array.isArray(a))return a;if(a.toArray){var b=a;return b.toArray()}if(typeof a==="object"&&a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"])return Array.from(a);g(0,3874,a)},serializeMap:function(a){if(!a)return a;if(a.toJS){var b=a;return b.toJS()}if(typeof a==="object"&&a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]){b=a;var c={};for(b of b)c[b[0]]=b[1];return c}if(Object.prototype.toString.call(a)==="[object Object]")return a;g(0,3875,a)},checkExtraDataFieldNames:function(a,b){Object.keys(a).forEach(function(a){Object.prototype.hasOwnProperty.call(b,a)&&g(0,3876,a)})},warnForInvalidFieldNames:function(a,b,c,d){},throwIfNull:function(a,b){a||g(0,3877,b);return a}};e.exports=c}),null);
__d("HorizonMetaIsCastingRoute",["FBXHorizonMetaCastingControllerRouteBuilder","URI","isHorizonDotMetaDotComURI"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=(h||(h=c("URI"))).getRequestURI(),b=c("FBXHorizonMetaCastingControllerRouteBuilder").buildUri({});return!c("isHorizonDotMetaDotComURI")(a)?!1:a.addTrailingSlash().getPath()===b.getPath()}b={getIsCastingRoute:a};g["default"]=b}),98);
__d("IGDOverLSMqttChannel",["CurrentUser","Env","MqttChannel","MqttEnv","MqttEnvInitializer","MqttWebConfig","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i;c("MqttEnvInitializer").initialize();function j(a){d("MqttEnv").setIsUserLoggedInNow(c("CurrentUser").isLoggedIn);var b=c("CurrentUser").getAppID()==null?936619743392459:Number(c("CurrentUser").getAppID());return new(c("MqttChannel"))({appId:b,capabilities:c("MqttWebConfig").capabilities,chatVisibility:!0,clientCapabilities:c("MqttWebConfig").clientCapabilities,clientType:"cookie_auth",deviceId:a,endpoint:(i||(i=c("Env"))).ig_mqtt_wss_endpoint||"wss://edge-chat.instagram.com/chat",initialSubscribedTopics:c("MqttWebConfig").subscribedTopics,phpOverride:c("MqttWebConfig").hostNameOverride,pollingEndpoint:(i||(i=c("Env"))).ig_mqtt_polling_endpoint||"https://edge-chat.instagram.com/mqtt/pull",userFbid:c("CurrentUser").getPossiblyNonFacebookUserID()})}var k=null,l;function m(a){k==null&&(k=j(a));a=k;l==null?void 0:l(a);return a}function a(){return new(h||(h=b("Promise")))(function(a){k?a(m()):l=function(b){a(b)}})}function e(){k!=null&&(k.shutdown(),k=null)}g.getInstance=m;g.waitAndGetInstance=a;g.shutdownAndClear=e}),98);
__d("IGWebCallWindowControllerLoader",["FBLogger","JSResourceForInteraction","Promise","asyncToGeneratorRuntime","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("RTWebCallWindowOpener").__setRef("IGWebCallWindowControllerLoader"),j=c("requireDeferred")("ZenonCallWindowController").__setRef("IGWebCallWindowControllerLoader"),k=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}return a}(babelHelpers.wrapNativeSuper(Error));a=function(){function a(a,b){this.$1=null,this.$2=a,this.$3=b}var d=a.prototype;d.init=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var a=(yield (h||(h=b("Promise"))).all([j.load(),i.load()])),d=a[0];a=a[1];this.$1=new d(this.$2,{callWindowInitializerResource:this.$3,callWindowOpener:new a(),uriBuilderResource:c("JSResourceForInteraction")("IGCallUriBuilder").__setRef("IGWebCallWindowControllerLoader")})}catch(a){c("FBLogger")("rtc_www").catching(a).warn("Failed to initialize call window controller")}});function d(){return a.apply(this,arguments)}return d}();d.initCall=function(a){if(this.$1)return this.$1.initCall(a);else throw new k()};return a}();a.ResourceNotReadyError=k;g["default"]=a}),98);
__d("IGWebPreCallContext",["react"],(function(a,b,c,d,e,f,g){"use strict";var h;a=(h||d("react")).createContext;b=a(null);g["default"]=b}),98);
__d("ZenonCallInviteModelLoader",["BaseEventEmitter","Promise","asyncToGeneratorRuntime","emptyFunction","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("requireDeferred")("ZenonCallInviteModel").__setRef("ZenonCallInviteModelLoader"),j=c("requireDeferred")("delegateZenonCallInviteModel").__setRef("ZenonCallInviteModelLoader");a=function(a){babelHelpers.inheritsLoose(d,a);function d(b){var d;d=a.call(this)||this;d.$ZenonCallInviteModelLoader$p_1=null;d.getCurrentInvite=function(){return null};d.startListening=function(a){this.$ZenonCallInviteModelLoader$p_1=a};d.stopListening=function(){this.$ZenonCallInviteModelLoader$p_1=null};d.dismiss=c("emptyFunction");d.accept=c("emptyFunction");d.decline=c("emptyFunction");d.$ZenonCallInviteModelLoader$p_2=b;return d}var e=d.prototype;e.init=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield (h||(h=b("Promise"))).all([i.load(),j.load()])),c=a[0];a=a[1];c=new c(this.$ZenonCallInviteModelLoader$p_2);a(this,c);this.$ZenonCallInviteModelLoader$p_1!==null&&c.startListening(this.$ZenonCallInviteModelLoader$p_1)});function c(){return a.apply(this,arguments)}return c}();return d}(c("BaseEventEmitter"));g["default"]=a}),98);
__d("MWSCastingCenterDeviceMediaStatus",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["LAUNCHING","LAUNCHED","DEVICE_UNAVAILABLE","CONTENT_UNAVAILABLE","NETWORK_FAILURE","FAILED"]);f.DeviceMediaStatus=a}),66);
__d("MWSCastingCenterUtils",["fbt","MWSCastingCenterDeviceMediaStatus","UserAgent","formatDate","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";e=3e4;function a(){return c("gkx")("8702")&&c("UserAgent").isBrowser("Chrome for iOS")}function b(a){var b=a.mediaType,e=a.status;a=a.time;var f="warning",g=b==="LAUNCH_APP"?h._(/*BTDS*/"Abrindo..."):h._(/*BTDS*/"Abrindo...");if(e!=null)switch(e){case d("MWSCastingCenterDeviceMediaStatus").DeviceMediaStatus.LAUNCHING:break;case d("MWSCastingCenterDeviceMediaStatus").DeviceMediaStatus.LAUNCHED:f="active";g=b==="LAUNCH_APP"?h._(/*BTDS*/"Aberto \u00e0(s) {time}",[h._param("time",c("formatDate")(a,"g:i A"))]):h._(/*BTDS*/"Aberto \u00e0(s) {time}",[h._param("time",c("formatDate")(a,"g:i A"))]);break;case d("MWSCastingCenterDeviceMediaStatus").DeviceMediaStatus.DEVICE_UNAVAILABLE:f="error";g=h._(/*BTDS*/"Dispositivo n\u00e3o dispon\u00edvel");break;case d("MWSCastingCenterDeviceMediaStatus").DeviceMediaStatus.CONTENT_UNAVAILABLE:f="error";g=b==="LAUNCH_APP"?h._(/*BTDS*/"App n\u00e3o instalado"):h._(/*BTDS*/"Arquivo ausente");break;case d("MWSCastingCenterDeviceMediaStatus").DeviceMediaStatus.NETWORK_FAILURE:f="error";g=h._(/*BTDS*/"Falha da solicita\u00e7\u00e3o de rede");break;case d("MWSCastingCenterDeviceMediaStatus").DeviceMediaStatus.FAILED:f="error";g=h._(/*BTDS*/"Erro inesperado");break}return{statusIndicator:f,statusText:g}}g.REQUEST_TIMEOUT_MS=e;g.isBrowserSupportedForMobileManagedCasting=a;g.getMediaStatusIndicator=b}),226);
__d("OCCastingZenonUtils",["UserAgent","gkx"],(function(a,b,c,d,e,f,g){"use strict";b=function(a){return a==="Connected"||a==="Connecting"};function a(){return c("gkx")("1930")||c("gkx")("25763")&&(c("UserAgent").isBrowser("Chrome for iOS")||c("UserAgent").isBrowser("Mobile Safari"))}g.hasCallStarted=b;g.isBrowserSupportedForMobileWebCasting=a}),98);
__d("ZenonAppProvider",["HorizonMetaIsCastingRoute","IGDWebUtils","ZenonActorHooks"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("IGDWebUtils").isInstagramWebSupportedApp(n())}function b(){return o(n())}function e(){return n()===351299233827255}function f(){return n()===2057013231240274}function h(){return n()===518491789147974}function i(){var a=d("ZenonActorHooks").ZenonActor.getAppID();return a==null?!1:Number(a)===2763362503905702||Number(a)===1013624499181349||Number(a)===351299233827255&&c("HorizonMetaIsCastingRoute").getIsCastingRoute()}function j(){var a=d("ZenonActorHooks").ZenonActor.getAppID();return a==null?!1:Number(a)===218968626708284}function k(){var a=d("ZenonActorHooks").ZenonActor.getAppID();return a==null?!1:Number(a)===772021112871879||Number(a)===2220391788200892}function l(){var a=n();return a===949958857019662||a===1358015658191005||a===445865345227527}function m(){var a=d("ZenonActorHooks").ZenonActor.getAppID();return a==null?!1:Number(a)===514771569228061||Number(a)===436761779744620}function n(){var a=d("ZenonActorHooks").ZenonActor.getAppID();return a==null?null:Number(a)}function o(a){return a!=null?a===2763362503905702||a===1013624499181349||a===351299233827255:!1}g.isInstagramApp=a;g.isOculusApp=b;g.isHorizonApp=e;g.isHorizonWorldsApp=f;g.isCastingCenterApp=h;g.isOculusCastingSite=i;g.isMDCApp=j;g.isMessengerWebApp=k;g.isMetaAI=l;g.isBizWebApp=m}),98);
__d("ZenonActorHooks",["CurrentUser","FBLogger","ZenonAppProvider","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h=null,i=null,j=null,k=!1,l=!1,m=new Set();function n(a,b){b===void 0&&(b="Fallback to CurrentUser"),m.has(a)||(c("FBLogger")("rtc_www").blameToPreviousFrame().info("ZenonActor."+a+" - "+b),m.add(a))}function a(){return[o.getID(),function(a){n("useZenonActor:setter","This setter should not be used as Zenon should currently doesn't allow switching Actor"),h=a}]}function b(a,b,c){b===void 0&&(b=!1);c===void 0&&(c=!1);if(h!==null){if(l)return;n("initZenonActor","ZenonActor is being reinitalized. This may indicate unneccessary ZenonActorProvider's to RelayEnvironmentProvider's in the component tree.")}l=l||b;k=k||c;typeof a==="string"||typeof a==="number"?(h=a.toString(),i=null,j=null):(a==null?void 0:a.actorID)!=null&&(h=a.actorID.toString(),i=a.name,j=a.shortName)}var o={getAccountID:function(){if(o.isInstagramUser())return c("CurrentUser").getEIMU();if(o.isOculusCastingUser())return c("CurrentUser").getEOCPU();return o.isMDCUser()?c("CurrentUser").getPossiblyNonFacebookUserID():c("CurrentUser").getAccountID()},getAppID:function(){return c("CurrentUser").getAppID()},getID:function(){if(o.isInstagramUser())return c("CurrentUser").getEIMU();if(o.isOculusCastingUser())return c("CurrentUser").getEOCPU();if(o.isMDCUser())return c("CurrentUser").getPossiblyNonFacebookUserID();if(o.isHorizonWebUser()&&!c("gkx")("5683"))return c("CurrentUser").getEPOU();if(o.isKadabraUser())return c("CurrentUser").getARID();if(h===null){n("getID");return c("CurrentUser").getID()}else return h},getName:function(){var a;return(a=i)!=null?a:c("CurrentUser").getName()},getShortName:function(){var a;return(a=j)!=null?a:c("CurrentUser").getShortName()},isEmployee:function(){return c("CurrentUser").isEmployee()},isHorizonWebUser:function(){return c("CurrentUser").getEPOU()!==0&&d("ZenonAppProvider").isHorizonApp()},isInstagramUser:function(){return c("CurrentUser").getEIMU()!==0&&d("ZenonAppProvider").isInstagramApp()},isKadabraUser:function(){return c("gkx")("11152")&&c("CurrentUser").getAppID()===String(1358015658191005)},isLoggedIn:function(){return c("CurrentUser").isLoggedIn()},isLoggedInNow:function(){return c("CurrentUser").isLoggedInNow()},isManagedMetaAccount:function(){return c("CurrentUser").isManagedMetaAccount()},isMDCUser:function(){return c("CurrentUser").getPossiblyNonFacebookUserID()!=="0"&&d("ZenonAppProvider").isMDCApp()},isMessengerCallGuestUser:function(){return c("CurrentUser").isMessengerCallGuestUser()},isOculusCastingUser:function(){return c("CurrentUser").getEOCPU()!==0&&d("ZenonAppProvider").isOculusApp()},isOculusUser:function(){return c("CurrentUser").getEPOU()!==0&&d("ZenonAppProvider").isOculusApp()},isPage:function(){return k},isTestUser:function(){return c("CurrentUser").isTestUser()},isWorkishUser:function(){return c("CurrentUser").isWorkroomsUser()||c("CurrentUser").isWorkUser()},isWorkroomsUser:function(){return c("CurrentUser").isWorkroomsUser()},isWorkUser:function(){return c("CurrentUser").isWorkUser()}};g.useZenonActor=a;g.initZenonActor=b;g.ZenonActor=o}),98);
__d("RTWebIncomingRingConfiguration",["MWSCastingCenterUtils","OCCastingZenonUtils","UserAgent","ZenonAppProvider","ZenonRTWebBrowserFeatureSupport","gkx"],(function(a,b,c,d,e,f,g){"use strict";f=function(a,b){return function(){return c("UserAgent").isBrowser(a)&&(b==null||b)}};var h=[f("Chrome >= 77",!c("gkx")("5285")&&!c("gkx")("6351")),f("Chrome >= 87"),f("Edge (Chromium Based) >= 79"),f("Edge PWA (Chromium Based) >= 79"),f("Opera >= 67"),f("Firefox >= 70"),f("Safari >= 16",c("gkx")("24226")||c("gkx")("6974")),f("Oculus Browser >= 7",c("gkx")("24228")),d("OCCastingZenonUtils").isBrowserSupportedForMobileWebCasting,d("MWSCastingCenterUtils").isBrowserSupportedForMobileManagedCasting];(d("ZenonAppProvider").isMetaAI()||d("ZenonAppProvider").isMDCApp())&&(h.push(f("Mobile Safari >= 16")),h.push(f("Chrome for iOS >= 130")));var i=h.some(function(a){return a()});function a(){return h.some(function(a){return a()})}function b(){return i}function e(){return c("gkx")("23430")&&d("ZenonRTWebBrowserFeatureSupport").isInsertableStreamsSupported()}g.isSupportedClient_TEST_ONLY=a;g.isSupportedClient=b;g.isE2EESupportedClient=e}),98);
__d("ZenonIncomingRingSDK",["BaseEventEmitter","RTWebIncomingRingConfiguration","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("ZenonParentCallsManager").__setRef("ZenonIncomingRingSDK"),i=[1,2,15,16];a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$ZenonIncomingRingSDK$p_1=[],c.$ZenonIncomingRingSDK$p_2=[],b)||babelHelpers.assertThisInitialized(c)}var c=b.prototype;c.init=function(a){var b=this;this.$ZenonIncomingRingSDK$p_3=a;h.onReady(function(c){b.callsManager==null&&(b.callsManager=new c(a));c=b.callsManager;c.addListener("unsupportedRing",function(a){return b.emit("unsupportedRing",a)});c.addListener("incomingRing",function(a){var c;if(a.actorID!=null&&!((c=b.$ZenonIncomingRingSDK$p_3)==null?void 0:c.enableIncomingActorCalls))return;b.emit("incomingRing",a)});c.addListener("ringCancel",function(a){return b.emit("ringCancel",a)});c.initListeners(b.$ZenonIncomingRingSDK$p_1);while(b.$ZenonIncomingRingSDK$p_2.length>0){var d=b.$ZenonIncomingRingSDK$p_2.shift();c.startOutgoingCallIntent(d.nonce,d.callParams)}})};c.initListeners=function(a){var b=this.callsManager;if(b!=null)b.initListeners(a);else{(b=this.$ZenonIncomingRingSDK$p_1).push.apply(b,a)}};c.removeListeners=function(a){var b=this;if(this.callsManager!=null)this.callsManager.removeListeners(a);else{var c=function(a){b.$ZenonIncomingRingSDK$p_1=b.$ZenonIncomingRingSDK$p_1.filter(function(b){return b!==a})};for(a of a)c(a)}};c.isCallSupported=function(a){switch(a.type){case"thread":if(this.$ZenonIncomingRingSDK$p_3&&i.includes(a.threadType)){return(a=d("RTWebIncomingRingConfiguration").isSupportedClient())!=null?a:!1}break;default:return!1}return!1};c.startCallIntent=function(a,b){this.callsManager?this.callsManager.startOutgoingCallIntent(a,b):this.$ZenonIncomingRingSDK$p_2.push({callParams:b,nonce:a})};return b}(c("BaseEventEmitter"));g["default"]=a}),98);
__d("IGWebPreCallContextSingleton",["FBLogger","IGWebCallWindowControllerLoader","JSResource","ZenonCallInviteModelLoader","ZenonIncomingRingSDK","gkx","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("IgSignalingListener").__setRef("IGWebPreCallContextSingleton"),i=!1,j;function a(a){if(!c("gkx")("25307"))return null;if(j!=null)return j;try{var b=new(c("ZenonIncomingRingSDK"))();j={callInviteModel:new(c("ZenonCallInviteModelLoader"))(b),callWindowController:new(c("IGWebCallWindowControllerLoader"))(a,c("JSResource")("IGWebCallWindowInitializer").__setRef("IGWebPreCallContextSingleton")),incomingRingSDK:b};return j}catch(a){c("FBLogger")("rtc_www").catching(a).mustfix("Pre-call context initialization failed! This breaks all calling!");return null}}function b(a){if(!c("gkx")("25307"))return null;if(i)return j;i=!0;c("promiseDone")(j.callInviteModel.init());c("promiseDone")(j.callWindowController.init());j.incomingRingSDK.init({enableIncomingActorCalls:!1,relayEnvironment:a});c("promiseDone")(h.load(),function(a){j.incomingRingSDK.initListeners([new a()])});return j}g.create=a;g.init=b}),98);
__d("IGWebPreCallProvider.react",["CometRelay","IGWebPreCallContext","IGWebPreCallContextSingleton","react","react-compiler-runtime","useStable"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useEffect;function a(a){var b=d("react-compiler-runtime").c(9);a=a.children;var e=d("CometRelay").useRelayEnvironment(),f;b[0]!==e?(f=function(){return d("IGWebPreCallContextSingleton").create({relayEnvironment:e})},b[0]=e,b[1]=f):f=b[1];var g=c("useStable")(f),h;b[2]!==g||b[3]!==e?(f=function(){g&&(d("IGWebPreCallContextSingleton").init(e),g.callInviteModel.startListening({callsBlocked:!1}))},h=[g,e],b[2]=g,b[3]=e,b[4]=f,b[5]=h):(f=b[4],h=b[5]);j(f,h);b[6]!==a||b[7]!==g?(f=i.jsx(c("IGWebPreCallContext").Provider,{value:g,children:a}),b[6]=a,b[7]=g,b[8]=f):f=b[8];return f}g["default"]=a}),98);
__d("PolarisAppStoreLauncher.react",["InstagramODS","PolarisUA","URI","polarisGetInstallAppHref","react","react-compiler-runtime","usePolarisDynamicIpadUpsell"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||d("react")).useEffect,k="launch_app_store",l="instagram_carbon",m="utm_campaign",n="utm_medium";function o(a){a=d("PolarisUA").isMobile()||a;var b=new URLSearchParams(location.search);if(!a||!b.get(k))return null;a=new URL(location.href);var e=b.get(l)==="true";a.searchParams["delete"](k);a.searchParams["delete"](l);history.replaceState({},document.title,a.toString());if(e){c("InstagramODS").incr("web.logging.preload_ods.iglite_open_app_store");c("InstagramODS").incr("web.logging.preload_ods.polaris_iglite_open_app_store");a=b.get(m);e=b.get(n);return d("polarisGetInstallAppHref").getInstallIGLiteCarbonAppHref(a!=null&&a!==""?a:"instagramlitecarbon",e!=null?e:"")}return d("polarisGetInstallAppHref").getInstallAppHref()}function a(){var a=d("react-compiler-runtime").c(3),b=d("usePolarisDynamicIpadUpsell").usePolarNewIpadUpsellExperience(),e,f;a[0]!==b?(e=function(){var a=o(b);a!=null&&(h||(h=c("URI"))).goURIOnWindow(a)},f=[b],a[0]=b,a[1]=e,a[2]=f):(e=a[1],f=a[2]);j(e,f);return null}g["default"]=a}),98);
__d("PolarisCallGatingHelpers",["PolarisUA","RTWebIncomingRingConfiguration","gkx","justknobx","qex"],(function(a,b,c,d,e,f,g){"use strict";function h(){return i()||j()?!1:!0}function a(){return c("gkx")("24007")}function i(){return c("gkx")("24007")}function j(){return!d("PolarisUA").isDesktop()||!d("RTWebIncomingRingConfiguration").isSupportedClient()}function b(){return!h()?!1:!c("justknobx")._("471")}function e(){return c("qex")._("83")===!0}g.isWebCallingEnabled=h;g.isVerifiedUserAndCallingEnabled=a;g.isIncomingCallEnabled=b;g.isCallsPathMigrationEnabled=e}),98);
__d("PolarisSwitchAccountsModalLazy.react",["CometPlaceholder.react","IGCoreModal.react","IGDSBox.react","IGDSSpinner.react","JSResourceForInteraction","lazyLoadComponent","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=c("lazyLoadComponent")(c("JSResourceForInteraction")("PolarisSwitchAccountsModal.react").__setRef("PolarisSwitchAccountsModalLazy.react"));function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("IGCoreModal.react"),{children:i.jsx(c("IGDSBox.react"),{alignItems:"center",height:112,justifyContent:"center",position:"relative",width:"100%",children:i.jsx(c("IGDSSpinner.react"),{size:"medium"})})}),children:i.jsx(j,{})}),a[0]=b):b=a[0];return b}g["default"]=a}),98);
__d("RpWebInfraActionsLoggerEventFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744334");b=d("FalcoLoggerInternal").create("rp_web_infra_actions_logger_event",a);e=b;g["default"]=e}),98);
__d("RtcWebUserActionsDebugFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744337");b=d("FalcoLoggerInternal").create("rtc_web_user_actions_debug",a);e=b;g["default"]=e}),98);
__d("RtcWebUserActionsFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1744338");b=d("FalcoLoggerInternal").create("rtc_web_user_actions",a);e=b;g["default"]=e}),98);
__d("ZenonAuditedCheckpointLogId",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["RP_ROOMS_INFRA_WWW__E2EE","RP_ROOMS_INFRA_WWW__WASM","RP_ROOMS_INFRA_WWW__LOGGER_INFRA","RP_ROOMS_INFRA_WWW__STATE_MACHINE","RP_ROOMS_INFRA_WWW__ERROR","RP_ROOMS_INFRA_WWW__E2EE_DEVICE_VERIFIER","RP_ROOMS_INFRA_WWW__PLATFORM"]);c=a;f["default"]=c}),66);
__d("ZenonCallWindowErrors",[],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="ZenonOpeningAnotherCallError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));b=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="ZenonConferenceNameMutationFailedError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));c=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="ZenonIncompleteControllerParamsError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));d=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="ZenonUnsupportedThreadTypeError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));e=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.name="ZenonCannotAcceptInviteError",b)||babelHelpers.assertThisInitialized(c)}return b}(babelHelpers.wrapNativeSuper(Error));var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="ZenonInviteNotFoundError",a)||babelHelpers.assertThisInitialized(c)}return a}(babelHelpers.wrapNativeSuper(Error)),h=function(b){babelHelpers.inheritsLoose(a,b);function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(a=c=b.call.apply(b,[this].concat(e))||this,c.name="ZenonUninitializedError",a)||babelHelpers.assertThisInitialized(c)}return a}(babelHelpers.wrapNativeSuper(Error));f.OpeningAnotherCallError=a;f.ConferenceNameMutationFailedError=b;f.IncompleteControllerParamsError=c;f.UnsupportedThreadTypeError=d;f.CannotAcceptInviteError=e;f.InviteNotFoundError=g;f.UninitializedError=h}),66);
__d("isEmployeeTestUserZenonLogging",["gkx"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("gkx")("25162")||c("gkx")("25152")||c("gkx")("25209")}g["default"]=a}),98);
__d("ZenonInfraActionsLogger",["Log","RpWebInfraActionsLoggerEventFalcoEvent","ZenonAuditedCheckpointLogId","formatDate","isEmployeeTestUserZenonLogging","justknobx"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1={callTrigger:void 0,conferenceName:void 0,deviceID:void 0,mediaPath:"sfu",peerID:void 0,serverInfoData:void 0,signalingID:void 0},this.$2=new Set(),this.$3=new Map(),this.$4=new Map()}var b=a.prototype;b.updateCachedValues=function(a){Object.assign(this.$1,a)};b.setE2eeIsMandatedForCall=function(a){this.$3.set(a,!0)};b.logCheckpointEmployeesTestUsersOnly=function(a){if(!c("isEmployeeTestUserZenonLogging")())return;this.logCheckpoint(a)};b.logCheckpoint=function(a){this.logEvent(babelHelpers["extends"]({},a))};b.logCheckpointOnceForDomain=function(a){var b=a.checkpoint;this.$2.has(b)||(this.$2.add(b),this.logCheckpoint(a))};b.logError=function(a){this.logEvent(babelHelpers["extends"]({},a))};b.startTimer=function(a){var b=Date.now();this.$4.set(a,b);this.logEvent({checkpoint:a+"_timerStart"})};b.stopTimer=function(a){var b=this.$4.get(a);this.$4["delete"](a);b=b!=null?Date.now()-b:null;this.logEvent({checkpoint:a+"_timerEnd",eventTimeElapsed:b});return parseInt(b,10)};b.logEvent=function(a){var b;b=(b=this.$3.get((b=this.$1.signalingID)!=null?b:""))!=null?b:!1;if(b&&!c("justknobx")._("1021"))return;if(b&&a.auditId==null){b="Encountered an unaudited log line, dropping it.";a.error!=null?this.logEvent({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__LOGGER_INFRA,error:b}):this.logEvent({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__LOGGER_INFRA,checkpoint:b});return}if(((b=a.checkpoint)==null?void 0:b.length)!=null&&a.checkpoint.length>3e5)return;var d={call_id:(b=a.signalingID)!=null?b:this.$1.signalingID==null?void 0:String(this.$1.signalingID),call_trigger:this.$1.callTrigger,call_type:(b=a.callType)!=null?b:null,checkpoint:a.checkpoint,client_session_id:this.$1.signalingID,client_time:Date.now().toString(),conference_name:(b=a.conferenceName)!=null?b:this.$1.conferenceName,connection:(b=a.connectionState)!=null?b:this.$1.connectionState,device_id:this.$1.deviceID,error:a.error,error_domain:a.errorDomain,event_time_elapsed:(b=a.eventTimeElapsed)==null?void 0:b.toString(),is_caller:(b=a.isCaller)!=null?b:null,media_path:(b=a.mediaPath)!=null?b:this.$1.mediaPath,message_id:a.messageID,peer_connection:(b=a.peerConnectionState)!=null?b:this.$1.peerConnectionState,peer_id:this.$1.peerID,sdp_format:(b=a.sdpFormat)!=null?b:null,server_info_data:(b=a.serverInfoData)!=null?b:this.$1.serverInfoData,signaling:(b=a.signalingState)!=null?b:this.$1.signalingState,state_machine_id:a.stateMachineID};c("RpWebInfraActionsLoggerEventFalcoEvent").log(function(){return d})};return a}();b=new a();g["default"]=b}),98);
__d("ZenonLoggingUtils",["ZenonAppProvider"],(function(a,b,c,d,e,f,g){"use strict";function a(){return d("ZenonAppProvider").isHorizonApp()||d("ZenonAppProvider").isHorizonWorldsApp()?!1:!0}g.shouldAllowLogging=a}),98);
__d("ZenonMachineToQPLEvent",["qpl"],(function(a,b,c,d,e,f,g){"use strict";b={ConnectionStateMachine:(a=c("qpl"))._(64243854,"2452"),ParentSignalingClient:a._(64234815,"1094"),PeerConnectionStateMachine:a._(64239068,"6172"),SignalingStateMachine:a._(64245348,"8823")};g["default"]=b}),98);
__d("ZenonODSLogger",["ODS"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(){}var b=a.prototype;b.logCounter=function(a){(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_multiway",a),h.flush()};b.logE2eeCounter=function(a){(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_e2ee",a),h.flush()};return a}();b=new a();g["default"]=b}),98);
__d("ZenonDebugLogger",["ChannelClientID","CurrentUser","FBLogger","IGDWebUtils","Log","LogHistory","ODS","QuickLogActionType","QuickPerformanceLogger","RpWebStateMachineLoggingBlocklist","UserAgentData","ZenonAuditedCheckpointLogId","ZenonInfraActionsLogger","ZenonLoggingUtils","ZenonMachineToQPLEvent","ZenonODSLogger","formatDate","isEmployeeTestUserZenonLogging"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=null;a=function(){a.getInstance=function(){j||(j=new a());return j};a.getFBLogger=function(a){var b;a===void 0&&(a={});return c("FBLogger")("rpweb").addMetadata("RT_WEB","CALL_ID",""+((b=a.signalingID)!=null?b:"null")).addMetadata("RT_WEB","PEER_ID",""+((b=a.peerID)!=null?b:"null"))};function a(){var a;this.$1=d("LogHistory").getInstance("webrtc");this.$2=d("ChannelClientID").getID();this.$3=JSON.stringify({browser:(a=c("UserAgentData")).browserName,browser_version:a.browserFullVersion,device:a.deviceName,msg_source:"web",os:a.platformName,os_version:a.platformFullVersion,version:2});a=c("CurrentUser").getAppID();a!=null&&d("IGDWebUtils").isInstagramWebSupportedApp(Number(a))?this.$4=parseInt(a,10):this.$4=219994525426954;this.$5=new Set(c("RpWebStateMachineLoggingBlocklist").EVENT_TYPES);this.$6=new Set(c("RpWebStateMachineLoggingBlocklist").STATES)}var b=a.prototype;b.$7=function(a,b,d){b===void 0&&(b=!0);var e=c("formatDate")(new Date(),"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",e+" "+a);b&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] "+a,messageID:d})};b.$8=function(a,b,d){var e=c("formatDate")(new Date(),"[H:i:s:X]",{skipPatternLocalization:!0});this.$1.log("Console",e+" "+a+". StateMachineID:  "+(b!=null?b:""));e={auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:"[ZP] "+a+".",stateMachineID:b};d!=null&&(e.messageID=d);c("ZenonInfraActionsLogger").logCheckpoint(e)};b.$9=function(a,b,e,f){f===void 0&&(f=0);a=c("ZenonMachineToQPLEvent")==null?void 0:c("ZenonMachineToQPLEvent")[a];if(!(a&&(i||(i=c("QuickPerformanceLogger")))&&c("QuickLogActionType")&&d("ZenonLoggingUtils").shouldAllowLogging()))return;e==="terminated"?(i||(i=c("QuickPerformanceLogger"))).markerEnd(a,2,f):(i||(i=c("QuickPerformanceLogger"))).markerPoint(a,b,{data:{string:{data:e}},instanceKey:f})};b.$10=function(a){return isNaN(+a)?0:+a};b.getLogHistory=function(){return this.$1};b.logStateMachine=function(a,b,d,e,f){if(!c("isEmployeeTestUserZenonLogging")())return;if(this.$5.has(d))return;var g="["+a+"] [Current State: "+b+"] Processing event: "+d;g={auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__STATE_MACHINE,checkpoint:""+g,stateMachineID:e};f!=null&&(g.messageID=f);c("ZenonInfraActionsLogger").logCheckpoint(g);this.$9(a,d,b,this.$10(e))};b.logStateMachineTransition=function(a,b,d,e,f,g,h,i){if(this.$6.has(d)||this.$5.has(f))return;if(!c("isEmployeeTestUserZenonLogging")())return;var j="";g!=null&&g.length===1&&g[0].type==="defer"?j="["+a+"] [[DEFERRED] "+f+" did not trigger transition. Current state remains "+d:d!==e?j="["+a+"] [[PROCESSED] "+f+" caused transition from "+(e||"")+" to "+d+".":b?j="["+a+"] [[PROCESSED] "+f+" did not trigger transition. Current state remains "+d:(j="["+a+"] [[DROPPED] "+f+" did not trigger transition. Current state remains "+d,this.$11(a));this.$8(j,h,i)};b.startQPL=function(a,b){b===void 0&&(b=0),(i||(i=c("QuickPerformanceLogger")))&&d("ZenonLoggingUtils").shouldAllowLogging()&&(i||(i=c("QuickPerformanceLogger"))).markerStart(a,this.$10(b))};b.endQPL=function(a,b){b===void 0&&(b=0),(i||(i=c("QuickPerformanceLogger")))&&c("QuickLogActionType")&&d("ZenonLoggingUtils").shouldAllowLogging()&&(i||(i=c("QuickPerformanceLogger"))).markerEnd(a,2,this.$10(b))};b.logConsole=function(a){this.$7(a,!1)};b.logMQTTStateChange=function(a){var b="mqtt_client_state_"+a;c("ZenonODSLogger").logCounter(b);c("isEmployeeTestUserZenonLogging")()&&c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] onMQTTStateChanged: "+a+", document.visibility: "+document.visibilityState+", document.hasFocus: "+String(document.hasFocus())+", navigator.onLine: "+String(navigator.onLine)})};b.logMQTTConnectStats=function(a,b){c("ZenonInfraActionsLogger").logCheckpoint({auditId:c("ZenonAuditedCheckpointLogId").RP_ROOMS_INFRA_WWW__PLATFORM,checkpoint:"[ZP] MQTT Connection time: "+String(a)+"ms, Retry Count: "+String(b)})};b.$11=function(a){(h||(h=d("ODS"))).bumpEntityKey(4083,"zenon_state_machine",a+"_event_dropped"),h.flush()};return a}();g["default"]=a}),98);
__d("ZenonPeerID",["invariant"],(function(a,b,c,d,e,f,g,h){"use strict";var i="MW_PEER_ID";function a(a){a.length>0||h(0,33504);if(a==="MW_PEER_ID")return i;isNaN(a)===!1||h(0,33551,a);return a}function b(a){return isNaN(a)||a===i?null:a}g.ZenonMWPeerID=i;g.convertStringToPeerID=a;g.convertPeerIDForLogging=b}),98);
__d("ZenonSDESKeyDetector",[],(function(a,b,c,d,e,f){"use strict";var g=/inline:\s*[0-9a-zA-z+/]{40}(\b|\s|$)/;function a(a){return g.test(JSON.stringify(a))}f["default"]=a}),66);
__d("ZenonSignalingProtocol",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({MW:"mw",MWPP:"mw++"});c=a;f["default"]=c}),66);
__d("ZenonUserActionLogger",["RtcWebUserActionsDebugFalcoEvent","RtcWebUserActionsFalcoEvent","ZenonDebugLogger","ZenonLoggingUtils","ZenonSDESKeyDetector","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map(),i=window.location.hostname.search("facebook")!==-1?"facebook":window.location.hostname.search("messenger")!==-1?"messenger_dot_com":null,j={logCheckpoint:function(a){j.logEvent(babelHelpers["extends"]({},a,{event:"checkpoint"}))},logClick:function(a){j.logEvent(babelHelpers["extends"]({},a,{event:"tap"}))},logError:function(a){j.logEvent(babelHelpers["extends"]({},a,{event:"error"}))},logEvent:function(a){var b;if(c("ZenonSDESKeyDetector")(a))throw c("unrecoverableViolation")("ZenonUserActionLogger event contains SDES crypto key! This log entry must be removed!","rtc_www");if(!d("ZenonLoggingUtils").shouldAllowLogging())return;b=babelHelpers["extends"]({},a,{page:(b=a.page)!=null?b:i});var e=babelHelpers["extends"]({},b,{client_time:Date.now().toString()});c("RtcWebUserActionsDebugFalcoEvent").log(function(){return e});c("RtcWebUserActionsFalcoEvent").log(function(){return e});c("ZenonDebugLogger").getInstance().getLogHistory().log((a=a.event)!=null?a:"null",JSON.stringify(b))},logImpression:function(a){j.logEvent(babelHelpers["extends"]({},a,{event:"impression"}))},logPreCallClick:function(a){j.logEvent(babelHelpers["extends"]({},a,{event:"tap"}))},logPreCallImpression:function(a){j.logEvent(babelHelpers["extends"]({},a,{event:"impression"}))},startTimer:function(a){var b=Date.now();h=h.set(a,b);j.logCheckpoint({checkpoint:a+"_timerStart"})},stopTimer:function(a){var b=a.checkpointName===void 0?a.timerName:a.checkpointName,c=a.event||{},d=function(a){var b=h.get(a);if(b!=null){h["delete"](a);return parseInt(Date.now()-b,10)}return null};d=d(a.timerName);j.logCheckpoint(babelHelpers["extends"]({},c,{checkpoint:b+"_timerEnd",event_time_elapsed:d==null?void 0:d.toString()}));return parseInt(d,10)}};f.exports=j}),34);/*FB_PKG_DELIM*/
__d("LsDataTraceFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("1743851");b=d("FalcoLoggerInternal").create("ls_data_trace",a);e=b;g["default"]=e}),98);
__d("LSDataTraceFlush",["ArmadilloDataTraceType","I64","LSDataTraceType","LSIntEnum","LsDataTraceFalcoEvent","ODS","Promise","ReQL","asyncToGeneratorRuntime","clearTimeout","gkx","promiseDone","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=(i||(i=d("I64"))).of_string("120000"),m=i.of_string("600000"),n=new Set(["encrypted_backups_upload","encrypted_backups_media_backup"]);function o(a,b,c){var e=a.length;if(e===0)return[(i||(i=d("I64"))).neg_one,i.neg_one,void 0,void 0,void 0];e=a.find(function(a){return a.errorMessage!=null});e=e==null?void 0:e.errorMessage;a=a[a.length-1|0];var f=(i||(i=d("I64"))).of_float(Date.now()),g=a.timestampMs,h=i.compare(i.sub(f,c),l)>=0;return!b&&h?[(i||(i=d("I64"))).sub(f,c),a.checkPointId,g,e,"trace expired"]:[i.sub(g,c),a.checkPointId,g,e,e]}function p(a){return a.reduce(function(a,b,c){var e,f=(i||(i=d("I64"))).to_string(b.checkPointId),g=b.timestampMs;e=i.to_string((e=b.syncChannel)!=null?e:(i||(i=d("I64"))).neg_one);b=b.tags;b=b!=null?","+b:"";if(c===0)a.pointsList="".concat("(",f,",",e,b,")");else{c=String((i||(i=d("I64"))).to_int32(i.sub(g,a.lastCheckPointTimestamp)));a.pointsList=a.pointsList.concat("-",c,"-(",f,",",e,b,")")}a.lastCheckPointTimestamp=g;return a},{lastCheckPointTimestamp:(i||(i=d("I64"))).zero,pointsList:""}).pointsList}var q=i.of_string("2");function r(a){var b=a.traceType;b=(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").TASK))?"send":(i||(i=d("I64"))).equal(b,d("ArmadilloDataTraceType").armadilloMessageSend)?"armadillo send":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_UPLOAD))?"encrypted_backups_upload":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_RESTORE))?"encrypted_backups_restore":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_MEDIA_BACKUP))?"encrypted_backups_media_backup":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").SAP_VESTA_LOGIN))?"sap_vesta_login":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").SAP_VESTA_REGISTRATION))?"sap_vesta_registration":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_MEDIA_RESTORE))?"encrypted_backups_media_restore":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_INIT))?"shadow_encrypted_backups_init":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_ADD_DEVICE))?"shadow_encrypted_backups_add_device":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_UPLOAD))?"shadow_encrypted_backups_upload":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_RESTORE))?"shadow_encrypted_backups_restore":(i||(i=d("I64"))).equal(b,(k||(k=d("LSIntEnum"))).ofNumber(c("LSDataTraceType").ENCRYPTED_BACKUPS_SHADOW_DELETE_BACKUP))?"shadow_encrypted_backups_delete_backup":a.contextTwo;return b}function s(a,b){var e=b.traceId,f=b.shouldFlush,g=r(b),h=b.traceType,j=(i||(i=d("I64"))).equal(h,d("ArmadilloDataTraceType").armadilloMessageSend)?"tam_message_send":b.contextOne,k=(i||(i=d("I64"))).equal(b.traceType,q)?void 0:b.predefinedId,l=b.initTimestampMs;return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.data_trace_addon.index("traceIdAddonId")).getKeyRange(e)).then(function(a){var b=o(a,f,l),h=b[0],m=b[1],n=b[3],q=b[4],r=a.length,s=p(a);c("LsDataTraceFalcoEvent").log(function(){return{check_point_count:(i||(i=d("I64"))).to_string(i.of_int32(r)),check_point_list:s,client_event_ts:i.to_string(i.of_float(Date.now())),cold_start_time:void 0,data_trace_id:e,database_id:j,delivered_messages:void 0,error_message:q,first_error_message:n,has_backgrounded:!1,last_check_point:i.to_string(m),latency:i.to_string(h),media_type:void 0,num_of_attachments:void 0,persisted_metadata:void 0,predefined_id:k,sent_rich_media_messages:void 0,sent_text_messages:void 0,start_time:i.to_string(l),trace_flow:g!=null?g:""}})}).then(function(){return a.data_trace_meta["delete"](e)})}function a(a,c){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.data_trace_meta).getKeyRange(c)).then(function(c){if(c!=null)return s(a,c);else return(h||(h=b("Promise"))).resolve()})}var t={contents:void 0};function u(a){return d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(a.data_trace_meta.index("shouldFlushInitTimestampMsTraceId")).getKeyRange(!1).bounds({lt:d("ReQL").key((i||(i=d("I64"))).sub(i.of_float(Date.now()),l))})).then(function(a){if(c("gkx")("23914")){var b=(i||(i=d("I64"))).of_float(Date.now());return a.filter(function(a){var c=r(a);if(c!=null&&n.has(c)){c=(i||(i=d("I64"))).compare(i.sub(b,a.initTimestampMs),m)>=0;return c}return!0})}return a})}function v(a){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield u(a.tables));if(c.length===0)return;return a.runInTransaction(function(a){return u(a).then(function(c){return(h||(h=b("Promise"))).all(c.map(function(b){return s(a,b)}))})},"readwrite",void 0,void 0,f.id+":312")});return w.apply(this,arguments)}function x(){var a=t.contents;if(a!=null){c("clearTimeout")(a);return}}function y(a){c("promiseDone")(v(a),function(){x();var b=c("setTimeout")(function(){y(a)},6e4);t.contents=b},function(){x(),(j||(j=d("ODS"))).bumpEntityKey(3185,"mw_trace","error")});return x}e=a;a=y;e={flush:e,flushExpiredDataTraces:a};g["default"]=e}),98);
__d("LSJSONOp",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({BLOCK:1,LOAD:2,STORE:3,STORE_ARRAY:4,CALL_STORED_PROCEDURE:5,CALL_NATIVE_TYPE_OPERATION:6,CALL_NATIVE_OPERATION:7,LIST:8,UNDEFINED:9,INFINITY:10,NAN:11,RETURN:12,BOOL_TO_STR:13,BLOBS_TO_STRING:14,BLOBS_OF_STRING:15,TO_BLOB:16,I64_OF_FLOAT:17,I64_TO_FLOAT:18,I64_FROM_STRING:19,I64_TO_STRING:20,READ_GK:21,READ_QE:22,IF:23,OR:24,AND:25,NOT:26,IS_NULL:27,ENFORCE_NOT_NULL:28,GENERIC_EQUAL:29,I64_EQUAL:30,BLOB_EQUAL:31,GENERIC_NOT_EQUAL:32,I64_NOT_EQUAL:33,BLOB_NOT_EQUAL:34,GENERIC_GREATER_THAN:35,I64_GREATER_THAN:36,BLOB_GREATER_THAN:37,GENERIC_GREATER_THAN_OR_EQUAL:38,I64_GREATER_THAN_OR_EQUAL:39,BLOB_GREATER_THAN_OR_EQUAL:40,GENERIC_LESS_THAN:41,I64_LESS_THAN:42,BLOB_LESS_THAN:43,GENERIC_LESS_THAN_OR_EQUAL:44,I64_LESS_THAN_OR_EQUAL:45,BLOB_LESS_THAN_OR_EQUAL:46,THROW:47,LOG_CONSOLE:48,LOGGER_LOG:49,NATIVE_OP_ARRAY_CREATE:50,NATIVE_OP_ARRAY_APPEND:51,NATIVE_OP_ARRAY_GET_SIZE:52,NATIVE_OP_MAP_CREATE:53,NATIVE_OP_MAP_GET:54,NATIVE_OP_MAP_SET:55,NATIVE_OP_MAP_KEYS:56,NATIVE_OP_MAP_DELETE:57,NATIVE_OP_MAP_HAS:58,NATIVE_OP_STR_JOIN:59,NATIVE_OP_CURRENT_TIME:60,NATIVE_OP_JSON_STRINGIFY:61,NATIVE_OP_RNG_NUM:62,NATIVE_OP_LOCALIZATION_SUPPORTED:63,NATIVE_OP_LOCALIZATION_SUPPORTED_V2:64,NATIVE_OP_RESOLVE_LOCALIZED:65,NATIVE_OP_RESOLVE_LOCALIZED_V2:66,ADD:68,I64_ADD:69,I64_CAST:70,READ_JUSTKNOB:71,READ_IGGK:72,GET_RUN_MODE:73,STR_TRIM:74,STR_REPLACE:75,JOIN:76,STR_LIKE:77,LENGTH:78,IN:79,IN_VEC:80,SUB:81,MUL:82,DIV:83,MOD:84,I64_SUB:85,I64_MUL:86,I64_DIV:87,I64_MOD:88,I64_IN:89,I64_IN_VEC:90,BITWISE_LEFT_SHIFT:91,BITWISE_RIGHT_SHIFT:92,ARITHMETIC_RIGHT_SHIFT:93,BITWISE_AND:94,BITWISE_OR:95,BITWISE_XOR:96,TERNARY:97,XOR:98,NULLISH_COALESE:99,READ_COLUMN:100,READ_COLUMN_REF:101,READ_GROUP_COUNT:102,COMMENT:103,IMPORT:104,LOOP:105,QUERY_COMPARISON_EQUAL:106,QUERY_COMPARISON_NOT_EQUAL:107,QUERY_COMPARISON_GREATER_THAN:108,QUERY_COMPARISON_GREATER_THAN_OR_EQUAL:109,QUERY_COMPARISON_LESS_THAN:110,QUERY_COMPARISON_LESS_THAN_OR_EQUAL:111,QUERY_MERGE_CONSTRAINTS:112,QUERY_FETCH_ROWS:113,QUERY_FILTER_ROWS:114,QUERY_SORT_ROWS_BY:115,QUERY_DELETE_ROWS:116,QUERY_SLICE_ROWS:117,QUERY_COUNT_ROWS:118,QUERY_PEEK_NEXT_ROW_ID:119,QUERY_UPDATE_ROWS:120,QUERY_INSERT_ROWS:121,QUERY_PUT_ROWS:122,QUERY_FOREACH_ROW:123,QUERY_SELECT_MATCH_ROW:124,QUERY_CURSOR_SLICE:125,QUERY_GROUP_BY:126,SUB_STRING:127});c=a;f["default"]=c}),66);
__d("LSMaybeDeferredImports",["LSSynchronousPromise"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h(a)}function b(a){return h(a)}function h(b){var a=null;return{load:function(){return a==null?b.load().then(function(b){a=b;return a}):d("LSSynchronousPromise").maybeMakeSynchronousPromise(a)}}}g.wrapReqDeferredMaybeSync=a;g.wrapJSResourceForInteractionMaybeSync=b}),98);
__d("LSSelectOrder",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum").Mirrored(["ASC","DESC"]);c=a;f["default"]=c}),66);
__d("LSDatascriptJSONEval",["FBLogger","JSResourceForInteraction","LS","LSMaybeDeferredImports","isPromise"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["2"]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["0"]);j=function(){return a};return a}var k=d("LSMaybeDeferredImports").wrapJSResourceForInteractionMaybeSync(c("JSResourceForInteraction")("LSLocalize").__setRef("LSDatascriptJSONEval"));function l(a,b,d){if((h||(h=c("isPromise")))(a))return a.then(b,d);try{return b(a)}catch(a){if(d)return d(a);else throw a}}a=function(){function a(a,b,d,e){var f=this;e===void 0&&(e=[]);this.$4={};this.$5=[];this.$6=null;this.$7=function(a){return l(f.$8(a),function(a){return a},function(b){c("FBLogger")("messenger_web").catching(b).mustfix("Error evaluating step op: %s",Array.isArray(a)?a[0]:"<primitive value>");throw b})};this.$1=b;this.$2=a;this.$3=d;for(b=0;b<e.length;b++)this.$4[b]=e[b]}var d=a.prototype;d.eval=function(){return this.$2==null?this.$1.resolveGuaranteeAsync([]):this.$1.resolveGuaranteeAsync(this.$7(this.$2.step))};d.$8=function(a){var d=this;if(!Array.isArray(a))return a;var e=a[0];a=a.slice(1);var f=a;switch(e){case 8:return f.map(this.$7);case 2:return this.$4[f[0]];case 3:return l(this.$7(f[1]),function(a){return d.$4[f[0]]=a});case 4:return l(this.$7(f[2]),function(a){var b=f[0],c=f[1];for(var e=0;e<c;e++,b++)d.$4[b]=a[e];return a});case 12:a=f[0];e=f[1];var g=[];for(a=a;a<e;a++)g[a]=this.$4[a];return g;case 1:var h;a=function(a){h=l(h,function(){return d.$7(f[a])})};for(e=0;e<f.length;e++)a(e);return h;case 5:return(g=this.$1).storedProcedure.apply(g,f.map(this.$7));case 6:return(e=this.$1).nativeTypeOperation.apply(e,f.map(this.$7));case 7:return(a=this.$1).nativeOperation.apply(a,f.map(this.$7));case 9:return;case 10:return Infinity;case 11:return NaN;case 13:return this.$7(f[0])?"1":"0";case 14:return this.$1.blobs.to_string(this.$7(f[0]));case 15:return this.$1.blobs.of_string(this.$7(f[0]));case 16:return this.$1.blob(this.$7(f[0]));case 17:return this.$1.i64.of_float(this.$7(f[0]));case 18:g=this.$7(f[0]);return g!=null?this.$1.i64.to_float(g):void 0;case 19:return this.$1.i64.from_string(this.$7(f[0]));case 70:return this.$1.i64.cast(this.$7(f[0]));case 20:return this.$1.i64.to_string(this.$7(f[0]));case 21:return(e=this.$3)==null?void 0:(a=e.gk)==null?void 0:a[f[0]];case 22:var m;g=f[0];e=f[1];a=f[2];var n=f[3];m=(m=this.$3)==null?void 0:(m=m.qe)==null?void 0:(m=m[g])==null?void 0:(g=m[e])==null?void 0:g[a];if(m==null)return m;switch(n){case"BOOL":case"STR":return m;case"I64":if(typeof m!=="object")throw c("FBLogger")("messenger_web").mustfixThrow("Cannot convert value to string");return this.$1.i64.from_string(m.toString())}return;case 23:if(this.$7(f[0]))return this.$7(f[1]);else if(f[2]!=null)return this.$7(f[2]);return;case 24:return this.$7(f[0])||this.$7(f[1]);case 25:return this.$7(f[0])&&this.$7(f[1]);case 26:return!this.$7(f[0]);case 27:return this.$7(f[0])==null;case 28:return this.$1.notnull(this.$7(f[0]));case 29:return this.$7(f[0])===this.$7(f[1]);case 30:return this.$1.i64.eq(this.$7(f[0]),this.$7(f[1]));case 31:return this.$1.blobs.eq(this.$7(f[0]),this.$7(f[1]));case 32:return this.$7(f[0])!==this.$7(f[1]);case 33:return this.$1.i64.neq(this.$7(f[0]),this.$7(f[1]));case 34:return this.$1.blobs.neq(this.$7(f[0]),this.$7(f[1]));case 35:return this.$7(f[0])>this.$7(f[1]);case 36:return this.$1.i64.gt(this.$7(f[0]),this.$7(f[1]));case 37:return this.$1.blobs.gt(this.$7(f[0]),this.$7(f[1]));case 38:return this.$7(f[0])>=this.$7(f[1]);case 39:return this.$1.i64.ge(this.$7(f[0]),this.$7(f[1]));case 40:return this.$1.blobs.ge(this.$7(f[0]),this.$7(f[1]));case 41:return this.$7(f[0])<this.$7(f[1]);case 42:return this.$1.i64.lt(this.$7(f[0]),this.$7(f[1]));case 43:return this.$1.blobs.lt(this.$7(f[0]),this.$7(f[1]));case 44:return this.$7(f[0])<=this.$7(f[1]);case 45:return this.$1.i64.le(this.$7(f[0]),this.$7(f[1]));case 46:return this.$1.blobs.le(this.$7(f[0]),this.$7(f[1]));case 47:return this.$1["throw"](f[0]);case 48:return this.$1.print(this.$7(f[0]));case 49:e=this.$7(f[0]);g=f[1];a=this.$1.logger(e);switch(g){case"mustfix":return a.mustfix(e);case"info":return a.info(e);case"warn":return a.warn(e);case"debug":return a.debug(e);default:throw c("FBLogger")("messenger_web").mustfixThrow("Invalid logger level %s",g)}case 50:return f.length===0?this.$1.createArray():(n=this.$1).createArrayWithElements.apply(n,this.$7(f[0]));case 51:m=this.$7(f[0]);m.push(this.$7(f[1]));return m;case 52:return this.$1.i64.of_int32(this.$7(f[0]).length);case 53:return new this.$1.Map();case 54:return this.$7(f[0]).get(this.$7(f[1]));case 55:return this.$7(f[0]).set(this.$7(f[1]),this.$7(f[2]));case 56:return this.$7(f[0]).keys();case 57:return this.$7(f[0])["delete"](this.$7(f[1]));case 58:return this.$7(f[0]).has(this.$7(f[1]));case 59:return this.$7(f[0]).join(this.$7(f[1])||"");case 60:return this.$1.i64.of_float(Date.now());case 61:return this.$1.toJSON(this.$7(f[0]));case 62:return this.$1.i64.random();case 63:case 64:return!0;case 65:return k.load().then(function(a){a=a.localizeV1Async;return a(d.$7(f[0]),d.$7(f[1]))});case 66:return k.load().then(function(a){a=a.localizeV2Async;return a(d.$7(f[0]),d.$7(f[1]))});case 68:return this.$7(f[0])+this.$7(f[1]);case 69:return this.$1.i64.add(this.$7(f[0]),this.$7(f[1]));case 71:return(a=this.$3)==null?void 0:(e=a.justknob)==null?void 0:e[f[0]];case 72:return(g=this.$3)==null?void 0:(n=g.iggk)==null?void 0:n[f[0]];case 100:return this.$5[f[0]][f[1]];case 101:if(this.$6==null)throw c("FBLogger")("messenger_web").mustfixThrow("Attempting to read column ref when none exist!");return this.$6[f[0]];case 102:return this.$5[this.$7(f[0])].group_count;case 73:return this.$1.rm;case 74:return this.$7(f[0]).trim();case 75:return this.$7(f[0]).split(this.$7(f[1])).join(this.$7(f[2]));case 76:return f.map(this.$7).join("");case 77:return this.$1.like(this.$7(f[0]),this.$7(f[1]));case 78:return[0,this.$7(f[0]).length];case 79:m=f.map(this.$7);a=m[0];e=m.slice(1);return e.includes(a);case 80:return this.$7(f[1]).includes(this.$7(f[0]));case 81:return this.$7(f[0])-this.$7(f[1]);case 82:return this.$7(f[0])*this.$7(f[1]);case 83:return this.$7(f[0])/this.$7(f[1]);case 84:return this.$7(f[0])%this.$7(f[1]);case 91:return this.$1.i64.lsl_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 92:return this.$1.i64.lsr_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 93:return this.$1.i64.asr_(this.$7(f[0]),this.$1.i64.to_int32(this.$7(f[1])));case 94:return this.$1.i64.and_(this.$7(f[0]),this.$7(f[1]));case 95:return this.$1.i64.or_(this.$7(f[0]),this.$7(f[1]));case 96:return this.$1.i64.xor(this.$7(f[0]),this.$7(f[1]));case 85:return this.$1.i64.sub(this.$7(f[0]),this.$7(f[1]));case 86:return this.$1.i64.mul(this.$7(f[0]),this.$7(f[1]));case 87:return this.$1.i64.div(this.$7(f[0]),this.$7(f[1]));case 88:return this.$1.i64.mod_(this.$7(f[0]),this.$7(f[1]));case 89:g=f.map(this.$7);var o=g[0];n=g.slice(1);return n.some(function(a){return d.$1.i64.eq(o,a)});case 90:var p=this.$7(f[0]);return this.$7(f[1]).some(function(a){return d.$1.i64.eq(p,a)});case 97:return this.$7(f[0])?this.$7(f[1]):this.$7(f[2]);case 98:m=this.$7(f[0]);e=this.$7(f[1]);return(m||e)&&!(m&&e);case 99:return(a=this.$7(f[0]))!=null?a:this.$7(f[1]);case 103:return;case 104:return b.call(null,f[0]);case 105:g=function(){var b=d.$7(f[0]),e=f[1],g=c("LS").n,a,h=function(b){a=l(a,function(){d.$4[e]=b;return d.$7(f[2])})};for(var k=g(j());d.$1.i64.lt(k,b);k=d.$1.i64.add(k,g(i())))h(k);return{v:a}}();if(typeof g==="object")return g.v;case 106:return this.$7(f[0]);case 107:throw c("FBLogger")("messenger_web").mustfixThrow("not equal query comparison operator not supported");case 108:return{gt:this.$7(f[0])};case 109:return{gte:this.$7(f[0])};case 110:return{lt:this.$7(f[0])};case 111:return{lte:this.$7(f[0])};case 112:return f.length===1?this.$7(f[0]):(n=this.$1).merge.apply(n,f.map(this.$7));case 113:m=f[0];e=f[1];a=f.slice(2);g=a.map(this.$7);switch(e){case"ASC":return(n=this.$1.db.table(m)).fetch.apply(n,g);case"DESC":return(a=this.$1.db.table(m)).fetchDesc.apply(a,g)}return;case 114:return this.$1.filter(this.$7(f[0]),function(a){d.$6=a;a=d.$7(f[1]);d.$6=null;return a});case 115:return(e=this.$1).sortBy.apply(e,f.map(this.$7));case 116:return this.$1.forEach(this.$7(f[0]),function(a){return a["delete"]()});case 117:return this.$1.islc(this.$7(f[0]),0,this.$7(f[1]));case 118:return this.$1.count(this.$7(f[0]));case 119:return this.$1.db.table(f[0]).peekNextAutoIncrementId();case 120:return this.$1.forEach(this.$7(f[0]),function(a){var b=a.item;a=a.update;var c={};d.$6=b;for(b=1;b<f.length;b+=2)c[f[b]]=d.$7(f[b+1]);d.$6=null;return a(c)});case 121:n=f[0];m={};for(a=1;a<f.length;a+=2)m[f[a]]=this.$7(f[a+1]);return this.$1.db.table(n).add(m);case 122:g=f[0];e={};for(a=1;a<f.length;a+=2)e[f[a]]=this.$7(f[a+1]);return this.$1.db.table(g).put(e);case 123:return this.$1.forEach(this.$7(f[0]),function(a){a=a.item;d.$5[f[1]]=a;return d.$7(f[2])});case 124:return this.$7(f[0]).next().then(function(a){var b=a.done;a=a.value;if(b)return d.$7(f[3]);else{b=f[1];if(b!=null){d.$5[b]=a.item;return d.$7(f[2])}}return 0});case 125:return this.$7(f[0]).slice(0,this.$7(f[1]));case 126:return this.$1.groupBy(this.$7(f[0]),f[1]).forEach(function(a){d.$5[f[2]]=a;return d.$7(f[3])});case 127:return this.$7(f[0]).substr(this.$1.i64.to_int32(this.$7(f[1])),this.$1.i64.to_int32(this.$7(f[2])))}};return a}();g["default"]=a}),98);
__d("TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE",["Env","TrustedTypes","err"],(function(a,b,c,d,e,f,g){"use strict";var h;d={createScript:function(a){for(var b=arguments.length,d=new Array(b>1?b-1:0),e=1;e<b;e++)d[e-1]=arguments[e];d.forEach(function(a){if(typeof window!=="undefined"&&typeof window.trustedTypes!=="undefined"&&!window.trustedTypes.isScript(a))throw c("err")("Trusted Function requires TrustedScripts args only.")});var f=d.slice(0,-1).join(","),g=d.pop().toString();return"(function anonymous(\n     "+f+"\n     ) {\n     "+g+"\n     })"}};var i=c("TrustedTypes").createPolicy("unsafe-function-do-not-use",d);function b(){for(var b=arguments.length,d=new Array(b),e=0;e<b;e++)d[e]=arguments[e];if(c("TrustedTypes").isSupportedNatively()&&(h||(h=c("Env"))).useTrustedTypes){var f=i.createScript.apply(i,[""].concat(d));return a.eval(f)}else return babelHelpers.construct(Function,d)}g.TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE=i;g.createTrustedFunction=b}),98);
__d("LSDatascriptEvaluator",["FBLogger","LSDatascriptJSONEval","LSFactory","MWPBumpEntityKey","TrustedTypesNoOpPolicy_DO_NOT_USE","TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE","justknobx"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var e=function(b){return function(c,d){var e;return a==null?void 0:(e=a.qe)==null?void 0:(e=e[c])==null?void 0:(c=e[b])==null?void 0:c[d]}},f=new Proxy({getBool:e("fb"),getNumber:e("fb"),getString:e("fb")},{get:function(a,b){return b in a?a[b]:{getBool:e(b),getNumber:e(b),getString:e(b)}}}),g=function(b){var c;return a==null?void 0:(c=a.gk)==null?void 0:c[b]};g.ig=function(b){var c;return a==null?void 0:(c=a.iggk)==null?void 0:c[b]};var h={getBool:function(b){var c;return a==null?void 0:(c=a.justknob)==null?void 0:c[b]}};return function(a){var e;e=d("TrustedTypesUnsafeFunctionScriptPolicy_DO_NOT_USE").createTrustedFunction((e=c("TrustedTypesNoOpPolicy_DO_NOT_USE")).createScript("gkx"),e.createScript("qex"),e.createScript("justknobx"),e.createScript("return "+b));return e(g,f,h)(c("LSFactory")(a,{dynamic:!0}))}}var i=function(a){return c("FBLogger")("messenger_web","invalid_sync_script_target").mustfixThrow('Received a sync script with an illegal target of "%s"',a!=null?a:-1)};function j(a,b){var d=JSON.parse(b),e=a!=null?a:{gk:{},iggk:{},justknob:{},qe:{}};return function(a){return new(c("LSDatascriptJSONEval"))(d,c("LSFactory")(a,{dynamic:!0}),e).eval()}}function k(a,b,d){if(!c("justknobx")._("3078"))return l(a,b,d);if(d==null)throw i(d);switch(d){case 3:return j(a,b);default:throw i(d)}}function l(a,b,d){if(d==null){c("FBLogger")("lightspeed","null_target").mustfix("Received <null> target field for sync script!");return h(a,b)}switch(d){case 3:return j(a,b);case 2:return h(a,b);case 1:throw c("FBLogger")("messenger_web","invalid_sync_script_target").mustfixThrow("Received a sync script with LSProgramTarget of DASM, this should never happen!")}}function a(a){return function(b){if(b==null)throw c("FBLogger")("messenger_web").mustfixThrow("Error creating eval function, db is undefined. This is likely a currying error in the definition for LSDatascriptEvaluator");return function(e){var g=e.experiments,h=e.priority,i=e.syncScript,j=e.target;e=e.taskNames;g=g!=null?JSON.parse(g):null;try{var l=k(g,i,j);return b.runInTransaction(function(b){a&&a();return l(b)},"readwrite",h,{taskNames:e,type:"sync_script"},f.id+":228")}catch(a){d("MWPBumpEntityKey").bumpEntityKeyWithAppId("lsplatform","eval_datascript_failure");c("FBLogger")("messenger_web").catching(a).mustfix("Error executing sync script");throw a}}}}a.__debugModuleName="LSDatascriptEvaluator";g.default=a}),98);
__d("LSDatascriptEvaluatorEager",["LSDatascriptEvaluator","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return(h||(h=b("Promise"))).resolve(c("LSDatascriptEvaluator"))}g["default"]=a}),98);
__d("LSPlatformSyncSystemEager",["LSPlatformSyncSystem","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return(h||(h=b("Promise"))).resolve(c("LSPlatformSyncSystem"))}g["default"]=a}),98);
__d("LogWebQplNOP",["I64","LSIntEnum","Promise","QPLUserFlow","WAHashStringToNumber","WALogger","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["LSLogWebQpl error: ",""]);k=function(){return a};return a}function l(a){a=a==null?null:(j||(j=d("I64"))).to_int32(a);switch(a){case 521476165:return c("qpl")._(521476165,"2432");case 521481602:return c("qpl")._(521481602,"829");default:return null}}function a(a,e,f,g,m,n){return new(h||(h=b("Promise")))(function(b,h){try{h=m?(i||(i=d("LSIntEnum"))).unwrapIntEnum(m):null;var o=l(e);if(o!=null&&f!=null){h={"int":{num_messages:(j||(j=d("I64"))).to_int32(g)},string:{message_count:String(g),taskSource:(h=h==null?void 0:h.toString())!=null?h:"unknown"}};n===!0?c("QPLUserFlow").endSuccess(o,{annotations:h,instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)}):n===!1?c("QPLUserFlow").endFailure(o,f,{annotations:h,instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)}):(c("QPLUserFlow").addAnnotations(o,h,{instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)}),c("QPLUserFlow").addPoint(o,f,{instanceKey:d("WAHashStringToNumber").hashStringToNumber(a)}))}b()}catch(a){d("WALogger").ERROR(k(),a),b()}})}g.call=a}),98);
/**
 * License: https://www.facebook.com/legal/license/ZMc_bSwzLKC/
 */
__d("ristretto255-0.1.1",["tweetnacl-1.0.3"],(function(a,b,c,d,e,f,g){var h=c("tweetnacl-1.0.3")();Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:function(a,b){return new Uint8Array(Array.prototype.slice.call(this,a,b))}});c={};var i=h.lowlevel,j=i.gf([1]);function k(){return[i.gf(),i.gf(),i.gf(),i.gf()]}var l=new Uint8Array([226,242,174,10,106,188,78,113,168,132,169,97,197,0,81,95,88,227,11,106,165,130,221,141,182,166,89,69,224,141,45,118]),m=new Float64Array([235,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function n(a,b,c){var d=new Float64Array(64);for(var e=0;e<32;e++)for(var f=0;f<32;f++)d[e+f]+=b[e]*c[f];i.modL(a,d)}function o(a,b){n(a,b,b)}function p(a,b){for(var c=0;c<32;c++)a[c]=b[c];for(c=251;c>=0;c--)o(a,a),(m[c>>3]>>(c&7)&1)!==0&&n(a,a,b)}var q=i.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]),r=i.gf([11803,18811,63136,32407,21693,7032,36364,44957,53757,12789,64713,3900,18604,11139,12735,14185]),s=i.gf([16618,32861,64938,39368,29374,23105,5655,40239,55360,65025,31633,5826,64674,53167,35077,30828]),t=i.gf([49526,37983,2497,57980,13583,52574,41272,11393,57316,48752,43997,39316,57559,45747,29352,656]),u=i.gf([19744,17645,23210,12717,6553,45086,18988,53918,20203,21147,54063,19676,8769,63084,45946,22888]);function v(a){var b=new Uint8Array(32);i.pack25519(b,a);a=1;for(var c=0;c<32;c++)a&=b[c]===0;return a}function w(a,b,c){var d;c=-c;for(var e=0;e<16;e++)d=a[e]^b[e],d&=c,a[e]^=d}function x(a){var b=new Uint8Array(32);i.pack25519(b,a);return b[0]&1}function y(a,b){i.Z(a,i.gf(),b)}function z(a,b,c){var d=i.gf();y(d,b);i.set25519(a,b);w(a,d,c)}function A(a,b){z(a,b,x(b))}function B(a,b,c){var d=i.gf(),e=i.gf(),f=i.gf(),g=i.gf(),h=i.gf(),j=i.gf();i.S(d,c);i.M(d,d,c);i.S(a,d);i.M(a,a,c);i.M(a,a,b);i.pow2523(a,a);i.M(a,a,d);i.M(a,a,b);i.S(e,a);i.M(e,e,c);i.Z(f,e,b);i.A(g,e,b);i.M(h,b,q);i.A(h,e,h);d=v(f);c=v(g);b=v(h);i.M(j,a,q);w(a,j,c|b);A(a,a);return d|c}function C(a){var b=i.gf(),c=i.gf(),d=i.gf(),e=i.gf(),f=i.gf(),g=i.gf(),h=i.gf(),k=i.gf(),l=i.gf(),m=i.gf(),n=i.gf(),o=i.gf(),p=i.gf(),r=i.gf(),t=i.gf(),u=i.gf(),v=i.gf(),y=0,C=new Uint8Array(32);i.A(m,a[2],a[1]);i.Z(v,a[2],a[1]);i.M(m,m,v);i.M(n,a[0],a[1]);i.S(o,n);i.M(o,m,o);B(f,j,o);i.M(b,f,m);i.M(c,f,n);i.M(u,b,c);i.M(u,u,a[3]);i.M(g,a[0],q);i.M(h,a[1],q);i.M(e,b,s);i.M(l,a[3],u);y=x(l);p=i.gf(a[0]);r=i.gf(a[1]);d=i.gf(c);w(p,h,y);w(r,g,y);w(d,e,y);i.M(t,p,u);z(r,r,x(t));i.Z(k,a[2],r);i.M(k,d,k);A(k,k);i.pack25519(C,k);return C}function D(a){var b=a[31]&127^127;for(var c=30;c>0;c--)b|=a[c]^255;b=(b|0>>>0)-1>>8;c=237-1-(a[0]|0>>>0)>>8;return 1-((b&c|a[0])&1|(a[31]&255)>>7)}function E(a,b){var c=i.gf(),d=i.gf(),e=i.gf(),f=i.gf(),g=i.gf(),h=i.gf(),k=i.gf(),l=i.gf(),m=i.gf(),n=i.gf();if(D(b)===0)return-1;i.unpack25519(e,b);i.S(f,e);i.set25519(g,j);i.Z(g,g,f);i.S(k,g);i.set25519(h,j);i.A(h,h,f);i.S(l,h);i.M(m,i.D,k);y(m,m);i.Z(m,m,l);i.M(n,m,l);i.set25519(d,j);b=B(c,d,n);i.M(a[0],c,h);i.M(a[1],c,a[0]);i.M(a[1],a[1],m);i.M(a[0],a[0],e);i.A(a[0],a[0],a[0]);A(a[0],a[0]);i.M(a[1],g,a[1]);i.set25519(a[2],j);i.M(a[3],a[0],a[1]);return-(1-b|x(a[3])|v(a[1]))}function F(a,b){var c=i.gf(),d=i.gf(),e=i.gf(),f=i.gf(),g=i.gf(),h=i.gf(),k=i.gf(),l=i.gf(),m=i.gf(),n=i.gf(),o=i.gf(),p=i.gf(),s=i.gf(),v=i.gf();i.set25519(e,j);i.S(f,b);i.M(f,q,f);i.A(m,f,e);i.M(m,m,t);i.set25519(c,j);y(c,c);i.A(g,f,i.D);i.M(n,f,i.D);i.Z(n,c,n);i.M(n,n,g);g=1-B(h,m,n);i.M(k,h,b);A(k,k);y(k,k);w(h,k,g);w(c,f,g);i.Z(d,f,e);i.M(d,d,c);i.M(d,d,u);i.Z(d,d,n);i.A(o,h,h);i.M(o,o,n);i.M(p,d,r);i.S(l,h);i.Z(s,e,l);i.A(v,e,l);i.M(a[0],o,v);i.M(a[1],s,p);i.M(a[2],p,v);i.M(a[3],o,s)}function G(a){var b=i.gf(),c=i.gf(),d=k(),e=k();i.unpack25519(b,a.slice(0,32));i.unpack25519(c,a.slice(32,64));F(d,b);F(e,c);i.add(d,e);return d}function a(a){var b=k();i.scalarbase(b,a);return C(b)}function b(a,b){var c=k(),d=k();if(E(c,b)!==0)throw new Error("Invalid argument");i.scalarmult(d,c,a);return C(d)}function d(a){var b=k();return E(b,a)===-1?!1:!0}function H(a,b){var c=k(),d=k();if(E(c,a)===-1)throw new Error("Invalid argument");if(E(d,b)===-1)throw new Error("Invalid argument");return[c,d]}function e(a,b){a=H(a,b);b=a[0];a=a[1];i.add(b,a);return C(b)}function I(a,b){var c=i.gf();y(c,b[3]);var d=i.gf();y(d,b[0]);d=[d,b[1],b[2],c];i.add(a,d)}function g(a,b){a=H(a,b);b=a[0];a=a[1];I(b,a);return C(b)}function J(){var a=h.randomBytes(64);return G(a)}function K(a){return C(G(a))}function L(){return C(J())}function M(){var a;new Uint8Array(32);var b=0;do{a=h.randomBytes(32);a[31]&=31;var c=32,d=1;do c--,b|=a[c]-i.L[c]>>8&d,d&=(a[c]^i.L[c])-1>>8;while(c!==0)}while(b===0);return a}function N(a){var b=new Uint8Array(32);p(b,a);return b}function O(a){var b=new Float64Array(64);for(var c=0;c<32;c++)b[c]=-a[c];c=new Uint8Array(32);i.modL(c,b);return c}function P(a,b){var c=new Float64Array(64);for(var d=0;d<32;d++)c[d]=a[d]+b[d];d=new Uint8Array(32);i.modL(d,c);return d}function Q(a,b){return P(a,O(b))}function R(a,b){var c=new Uint8Array(32);n(c,a,b);return c}c.scalarMultBase=a;c.scalarMult=b;c.isValid=d;c.add=e;c.sub=g;c.fromHash=K;c.getRandom=L;c.basePoint=l;c.scalar={};c.scalar.getRandom=M;c.scalar.invert=N;c.scalar.negate=O;c.scalar.add=P;c.scalar.sub=Q;c.scalar.mul=R;c.unsafe={};c.unsafe.point={};c.unsafe.point.toBytes=C;c.unsafe.point.fromBytes=E;c.unsafe.point.fromHash=G;c.unsafe.point.sub=I;c.unsafe.point.add=i.add;c.unsafe.point.scalarMultBase=i.scalarbase;c.unsafe.point.scalarMult=i.scalarmult;c.unsafe.point.getRandom=J;c.unsafe.point.alloc=k;c.unsafe.constants={};c.unsafe.constants.LSub2=m;c.unsafe.constants.sqrtm1=q;c.unsafe.constants.sqrtadm1=r;c.unsafe.constants.invsqrtamd=s;c.unsafe.constants.onemsqd=t;c.unsafe.constants.sqdmone=u;f.exports=c}),34);
__d("ristretto255",["ristretto255-0.1.1"],(function(a,b,c,d,e,f){e.exports=b("ristretto255-0.1.1")}),null);/*FB_PKG_DELIM*/
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("javascript-blowfish-1.0.5",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a=function(b,c){this.key=b,(c==="ecb"||c==="cbc")&&(this.mode=c),this.sBox0=a.sBox0.slice(),this.sBox1=a.sBox1.slice(),this.sBox2=a.sBox2.slice(),this.sBox3=a.sBox3.slice(),this.pArray=a.pArray.slice(),this.generateSubkeys(b)};a.prototype={sBox0:null,sBox1:null,sBox2:null,sBox3:null,pArray:null,key:null,mode:"ecb",iv:"abc12345",keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encrypt:function(a,b){if(this.mode==="ecb")return this.encryptECB(a);if(this.mode==="cbc")return this.encryptCBC(a,b);throw new Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f.")},decrypt:function(a,b){if(this.mode==="ecb")return this.decryptECB(a);if(this.mode==="cbc")return this.decryptCBC(a,b);throw new Error("\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u0440\u0435\u0436\u0438\u043c \u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u0438\u044f.")},encryptECB:function(a){a=this.utf8Decode(a);var b=Math.ceil(a.length/8),c="";for(var d=0;d<b;d++){var e=a.substr(d*8,8);if(e.length<8){var f=8-e.length;while(0<f--)e+="\0"}var g;f=this.split64by32(e);e=f[0];g=f[1];f=this.encipher(e,g);e=f[0];g=f[1];c+=this.num2block32(e)+this.num2block32(g)}return c},encryptCBC:function(a,b){a=this.utf8Decode(a);var c=Math.ceil(a.length/8),d;b=this.split64by32(b);d=b[0];b=b[1];var e="";for(var f=0;f<c;f++){var g=a.substr(f*8,8);if(g.length<8){var h=8-g.length;while(0<h--)g+="\0"}var i;h=this.split64by32(g);g=h[0];i=h[1];g=this.xor(g,d);i=this.xor(i,b);h=this.encipher(g,i);g=h[0];i=h[1];d=g;b=i;e+=this.num2block32(g)+this.num2block32(i)}return e},decryptECB:function(a){var b=Math.ceil(a.length/8),c="";for(var d=0;d<b;d++){var e=a.substr(d*8,8);if(e.length<8)throw new Error("\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u0430: \u0434\u043b\u0438\u043d\u043d\u0430 \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043a\u0440\u0430\u0442\u043d\u0430 8 \u0431\u0430\u044b\u0439\u0442\u0430\u043c.");var f,g;e=this.split64by32(e);f=e[0];g=e[1];e=this.decipher(f,g);f=e[0];g=e[1];c+=this.num2block32(f)+this.num2block32(g)}c=this.utf8Encode(c);return c},decryptCBC:function(a,b){var c=Math.ceil(a.length/8),d,e,f;b=this.split64by32(b);d=b[0];b=b[1];var g="";for(var h=0;h<c;h++){var i=a.substr(h*8,8);if(i.length<8)throw new Error("\u0417\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u043f\u043e\u0432\u0440\u0435\u0436\u0434\u0435\u043d\u0430: \u0434\u043b\u0438\u043d\u043d\u0430 \u0437\u0430\u0448\u0438\u0444\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043a\u0440\u0430\u0442\u043d\u0430 8 \u0431\u0430\u0439\u0442\u0430\u043c.");var j,k;i=this.split64by32(i);j=i[0];k=i[1];e=j;f=k;i=this.decipher(j,k);j=i[0];k=i[1];j=this.xor(j,d);k=this.xor(k,b);d=e;b=f;g+=this.num2block32(j)+this.num2block32(k)}g=this.utf8Encode(g);return g},F:function(a){var b=a>>>24,c=a<<8>>>24,d=a<<16>>>24;a=a<<24>>>24;b=this.addMod32(this.sBox0[b],this.sBox1[c]);b=this.xor(b,this.sBox2[d]);b=this.addMod32(b,this.sBox3[a]);return b},encipher:function(a,b){var c;for(var d=0;d<16;d++)a=this.xor(a,this.pArray[d]),b=this.xor(this.F(a),b),c=a,a=b,b=c;c=a;a=b;b=c;b=this.xor(b,this.pArray[16]);a=this.xor(a,this.pArray[17]);return[a,b]},decipher:function(a,b){var c;a=this.xor(a,this.pArray[17]);b=this.xor(b,this.pArray[16]);c=a;a=b;b=c;for(var d=15;d>=0;d--)c=a,a=b,b=c,b=this.xor(this.F(a),b),a=this.xor(a,this.pArray[d]);return[a,b]},generateSubkeys:function(a){var b=0,c=0,d,e;for(d=0;d<18;d++){for(e=4;e>0;e--)b=this.fixNegative(b<<8|a.charCodeAt(c)),c=(c+1)%a.length;this.pArray[d]=this.xor(this.pArray[d],b);b=0}e=[0,0];for(d=0;d<18;d+=2)e=this.encipher(e[0],e[1]),this.pArray[d]=e[0],this.pArray[d+1]=e[1];for(d=0;d<256;d+=2)e=this.encipher(e[0],e[1]),this.sBox0[d]=e[0],this.sBox0[d+1]=e[1];for(d=0;d<256;d+=2)e=this.encipher(e[0],e[1]),this.sBox1[d]=e[0],this.sBox1[d+1]=e[1];for(d=0;d<256;d+=2)e=this.encipher(e[0],e[1]),this.sBox2[d]=e[0],this.sBox2[d+1]=e[1];for(d=0;d<256;d+=2)e=this.encipher(e[0],e[1]),this.sBox3[d]=e[0],this.sBox3[d+1]=e[1]},block32toNum:function(a){return this.fixNegative(a.charCodeAt(0)<<24|a.charCodeAt(1)<<16|a.charCodeAt(2)<<8|a.charCodeAt(3))},num2block32:function(a){return String.fromCharCode(a>>>24)+String.fromCharCode(a<<8>>>24)+String.fromCharCode(a<<16>>>24)+String.fromCharCode(a<<24>>>24)},xor:function(a,b){return this.fixNegative(a^b)},addMod32:function(a,b){return this.fixNegative(a+b|0)},fixNegative:function(a){return a>>>0},split64by32:function(a){var b=a.substring(0,4);a=a.substring(4,8);return[this.block32toNum(b),this.block32toNum(a)]},utf8Decode:function(a){var b="";for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(d&63|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(d&63|128))}return b},utf8Encode:function(a){var b="",c=0,d=0,e=0,f;while(c<a.length)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(e=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|e&63),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(e&63)<<6|f&63),c+=3);return b},base64Encode:function(a){var b="",c,d,e,f,g,h,i=0;while(i<a.length)c=a.charCodeAt(i++),d=a.charCodeAt(i++),e=a.charCodeAt(i++),f=c>>2,c=(c&3)<<4|d>>4,g=(d&15)<<2|e>>6,h=e&63,isNaN(d)?g=h=64:isNaN(e)&&(h=64),b=b+this.keyStr.charAt(f)+this.keyStr.charAt(c)+this.keyStr.charAt(g)+this.keyStr.charAt(h);return b},base64Decode:function(a){var b="",c,d,e,f,g,h=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(h<a.length)d=this.keyStr.indexOf(a.charAt(h++)),e=this.keyStr.indexOf(a.charAt(h++)),f=this.keyStr.indexOf(a.charAt(h++)),g=this.keyStr.indexOf(a.charAt(h++)),d=d<<2|e>>4,e=(e&15)<<4|f>>2,c=(f&3)<<6|g,b=b+String.fromCharCode(d),f!=64&&(b=b+String.fromCharCode(e)),g!=64&&(b=b+String.fromCharCode(c));return b},trimZeros:function(a){return a.replace(/\0+$/g,"")}};a.pArray=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731];a.sBox0=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946];a.sBox1=[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055];a.sBox2=[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504];a.sBox3=[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462];g.exports=a}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
__d("javascript-blowfish",["javascript-blowfish-1.0.5"],(function(a,b,c,d,e,f){e.exports=b("javascript-blowfish-1.0.5")()}),null);
/**
 * License: https://www.facebook.com/legal/license/t3hOLs8wlXy/
 */
__d("remove-accents-0.4.2",[],(function(a,b,c,d,e,f){"use strict";b={};var g={exports:b};function h(){var a={"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\u1ea4":"A","\u1eae":"A","\u1eb2":"A","\u1eb4":"A","\u1eb6":"A","\xc6":"AE","\u1ea6":"A","\u1eb0":"A","\u0202":"A","\xc7":"C","\u1e08":"C","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\u1ebe":"E","\u1e16":"E","\u1ec0":"E","\u1e14":"E","\u1e1c":"E","\u0206":"E","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\u1e2e":"I","\u020a":"I","\xd0":"D","\xd1":"N","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\u1ed0":"O","\u1e4c":"O","\u1e52":"O","\u020e":"O","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xdd":"Y","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\u1ea5":"a","\u1eaf":"a","\u1eb3":"a","\u1eb5":"a","\u1eb7":"a","\xe6":"ae","\u1ea7":"a","\u1eb1":"a","\u0203":"a","\xe7":"c","\u1e09":"c","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\u1ebf":"e","\u1e17":"e","\u1ec1":"e","\u1e15":"e","\u1e1d":"e","\u0207":"e","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\u1e2f":"i","\u020b":"i","\xf0":"d","\xf1":"n","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\u1ed1":"o","\u1e4d":"o","\u1e53":"o","\u020f":"o","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xfd":"y","\xff":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u0108":"C","\u0109":"c","\u010a":"C","\u010b":"c","\u010c":"C","\u010d":"c","C\u0306":"C","c\u0306":"c","\u010e":"D","\u010f":"d","\u0110":"D","\u0111":"d","\u0112":"E","\u0113":"e","\u0114":"E","\u0115":"e","\u0116":"E","\u0117":"e","\u0118":"E","\u0119":"e","\u011a":"E","\u011b":"e","\u011c":"G","\u01f4":"G","\u011d":"g","\u01f5":"g","\u011e":"G","\u011f":"g","\u0120":"G","\u0121":"g","\u0122":"G","\u0123":"g","\u0124":"H","\u0125":"h","\u0126":"H","\u0127":"h","\u1e2a":"H","\u1e2b":"h","\u0128":"I","\u0129":"i","\u012a":"I","\u012b":"i","\u012c":"I","\u012d":"i","\u012e":"I","\u012f":"i","\u0130":"I","\u0131":"i","\u0132":"IJ","\u0133":"ij","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u1e30":"K","\u1e31":"k","K\u0306":"K","k\u0306":"k","\u0139":"L","\u013a":"l","\u013b":"L","\u013c":"l","\u013d":"L","\u013e":"l","\u013f":"L","\u0140":"l","\u0141":"l","\u0142":"l","\u1e3e":"M","\u1e3f":"m","M\u0306":"M","m\u0306":"m","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u0149":"n","N\u0306":"N","n\u0306":"n","\u014c":"O","\u014d":"o","\u014e":"O","\u014f":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","P\u0306":"P","p\u0306":"p","\u0154":"R","\u0155":"r","\u0156":"R","\u0157":"r","\u0158":"R","\u0159":"r","R\u0306":"R","r\u0306":"r","\u0212":"R","\u0213":"r","\u015a":"S","\u015b":"s","\u015c":"S","\u015d":"s","\u015e":"S","\u0218":"S","\u0219":"s","\u015f":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u021b":"t","\u021a":"T","\u0164":"T","\u0165":"t","\u0166":"T","\u0167":"t","T\u0306":"T","t\u0306":"t","\u0168":"U","\u0169":"u","\u016a":"U","\u016b":"u","\u016c":"U","\u016d":"u","\u016e":"U","\u016f":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0216":"U","\u0217":"u","V\u0306":"V","v\u0306":"v","\u0174":"W","\u0175":"w","\u1e82":"W","\u1e83":"w","X\u0306":"X","x\u0306":"x","\u0176":"Y","\u0177":"y","\u0178":"Y","Y\u0306":"Y","y\u0306":"y","\u0179":"Z","\u017a":"z","\u017b":"Z","\u017c":"z","\u017d":"Z","\u017e":"z","\u017f":"s","\u0192":"f","\u01a0":"O","\u01a1":"o","\u01af":"U","\u01b0":"u","\u01cd":"A","\u01ce":"a","\u01cf":"I","\u01d0":"i","\u01d1":"O","\u01d2":"o","\u01d3":"U","\u01d4":"u","\u01d5":"U","\u01d6":"u","\u01d7":"U","\u01d8":"u","\u01d9":"U","\u01da":"u","\u01db":"U","\u01dc":"u","\u1ee8":"U","\u1ee9":"u","\u1e78":"U","\u1e79":"u","\u01fa":"A","\u01fb":"a","\u01fc":"AE","\u01fd":"ae","\u01fe":"O","\u01ff":"o","\xde":"TH","\xfe":"th","\u1e54":"P","\u1e55":"p","\u1e64":"S","\u1e65":"s","X\u0301":"X","x\u0301":"x","\u0403":"\u0413","\u0453":"\u0433","\u040c":"\u041a","\u045c":"\u043a","A\u030b":"A","a\u030b":"a","E\u030b":"E","e\u030b":"e","I\u030b":"I","i\u030b":"i","\u01f8":"N","\u01f9":"n","\u1ed2":"O","\u1ed3":"o","\u1e50":"O","\u1e51":"o","\u1eea":"U","\u1eeb":"u","\u1e80":"W","\u1e81":"w","\u1ef2":"Y","\u1ef3":"y","\u0200":"A","\u0201":"a","\u0204":"E","\u0205":"e","\u0208":"I","\u0209":"i","\u020c":"O","\u020d":"o","\u0210":"R","\u0211":"r","\u0214":"U","\u0215":"u","B\u030c":"B","b\u030c":"b","\u010c\u0323":"C","\u010d\u0323":"c","\xca\u030c":"E","\xea\u030c":"e","F\u030c":"F","f\u030c":"f","\u01e6":"G","\u01e7":"g","\u021e":"H","\u021f":"h","J\u030c":"J","\u01f0":"j","\u01e8":"K","\u01e9":"k","M\u030c":"M","m\u030c":"m","P\u030c":"P","p\u030c":"p","Q\u030c":"Q","q\u030c":"q","\u0158\u0329":"R","\u0159\u0329":"r","\u1e66":"S","\u1e67":"s","V\u030c":"V","v\u030c":"v","W\u030c":"W","w\u030c":"w","X\u030c":"X","x\u030c":"x","Y\u030c":"Y","y\u030c":"y","A\u0327":"A","a\u0327":"a","B\u0327":"B","b\u0327":"b","\u1e10":"D","\u1e11":"d","\u0228":"E","\u0229":"e","\u0190\u0327":"E","\u025b\u0327":"e","\u1e28":"H","\u1e29":"h","I\u0327":"I","i\u0327":"i","\u0197\u0327":"I","\u0268\u0327":"i","M\u0327":"M","m\u0327":"m","O\u0327":"O","o\u0327":"o","Q\u0327":"Q","q\u0327":"q","U\u0327":"U","u\u0327":"u","X\u0327":"X","x\u0327":"x","Z\u0327":"Z","z\u0327":"z"},b=Object.keys(a).join("|"),c=new RegExp(b,"g"),d=new RegExp(b,"");b=function(b){return b.replace(c,function(b){return a[b]})};var e=function(a){return!!a.match(d)};g.exports=b;g.exports.has=e;g.exports.remove=b}var i=!1;function j(){i||(i=!0,h());return g.exports}function a(a){switch(a){case void 0:return j()}}e.exports=a}),null);
__d("remove-accents",["remove-accents-0.4.2"],(function(a,b,c,d,e,f){e.exports=b("remove-accents-0.4.2")()}),null);/*FB_PKG_DELIM*/
__d("XRefererFrameControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/common/referer_frame.php",Object.freeze({no_lower:!1}),void 0);b=a;g["default"]=b}),98);
__d("ControlledReferer",["invariant","ConstUriUtils","XRefererFrameControllerRouteBuilder","getRequestConstUri","isInternalFBURI","isWorkplaceDotComURI"],(function(a,b,c,d,e,f,g,h){function i(a,b,e){function f(){var c="";try{c=a.contentWindow.location.pathname}catch(a){return}if(c!=="/intern/common/referer_frame.php"&&c!=="/common/referer_frame.php"&&c!=="/common/referer_frame.php/")return;b()}var g=c("XRefererFrameControllerRouteBuilder").buildUri({cb:1});g=g;c("isInternalFBURI")(c("getRequestConstUri")())&&(g=d("ConstUriUtils").getUri("/intern/common/referer_frame.php"));e==null&&c("isWorkplaceDotComURI")(c("getRequestConstUri")())&&(e="workplace");if(e){var i;g=(i=g)==null?void 0:i.addQueryParam("fb_source",e)}g!=null||h(0,67317);a.onload=f;a.src=g.toString()}function a(a,b,c){i(a,function(){a.contentWindow.document.body.innerHTML=b},c)}g.shouldUseFacebookReferer=i;g.useFacebookRefererHtml=a}),98);
__d("StaticContainer.react",["react"],(function(a,b,c,d,e,f,g){var h,i=h||d("react");a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.shouldComponentUpdate=function(a){return!!a.shouldUpdate};c.render=function(){var a=this.props.children;return a===null||a===!1?null:i.Children.only(a)};return b}(i.Component);g["default"]=a}),98);
__d("ControlledRefererIFrame.react",["ControlledReferer","ControlledRefererIFrameConfig","SecurePostMessage","StaticContainer.react","TrustedTypesNoOpPolicy_DO_NOT_USE","URI","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react");a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var e=b.prototype;e.mountFrameRef=function(a){this.frame=a};e.updateFrame=function(){var a=this,b=this.frame;if(!b)return;this.props.onBeforeFrameRender&&this.props.onBeforeFrameRender(this.props);d("ControlledReferer").shouldUseFacebookReferer(b,function(){var e=b.contentWindow.document;e.body.innerHTML=c("TrustedTypesNoOpPolicy_DO_NOT_USE").createHTML('\n        <form method="GET" id="theform"></form>\n        '+d("ControlledRefererIFrameConfig").additional_markup+"\n      ");var f=new(h||(h=c("URI")))(a.props.src).qualify(),g=e.getElementById("theform");g.action=f.toString();var i=f.getQueryData();f=function(a){if(Object.prototype.hasOwnProperty.call(i,a)){var b=i[a];if(Array.isArray(b))b.forEach(function(b){var c=e.createElement("input");c.name=a+"[]";c.setAttribute("value",b);c.autocomplete="off";c.type="hidden";g.appendChild(c)});else{b=e.createElement("input");b.name=a;b.setAttribute("value",i[a]);b.autocomplete="off";b.type="hidden";g.appendChild(b)}}};for(var j in i)f(j);f=e.createElement("iframe");f.frameborder=0;f.width=f.height="1";f.onload=function(){return e.getElementById("theform").submit()};e.body.appendChild(f);a.props.onFrameRender&&a.props.onFrameRender(a.props)})};e.componentDidMount=function(){this.updateFrame()};e.componentDidUpdate=function(a){a.src!==this.props.src&&this.updateFrame()};e.UNSAFE_componentWillReceiveProps=function(a){var b=this.frame;b&&(a.width!==this.props.width||a.height!==this.props.height)&&(a.width!=null&&(b.width=""+a.width),a.height!=null&&(b.height=""+a.height))};e.render=function(){var a=this,b=this.props;b.src;b.onFrameRender;b.onBeforeFrameRender;b.useTrustedHtml;b=babelHelpers.objectWithoutPropertiesLoose(b,["src","onFrameRender","onBeforeFrameRender","useTrustedHtml"]);return j.jsx(c("StaticContainer.react"),{children:j.jsx("iframe",babelHelpers["extends"]({},b,{ref:function(b){return a.mountFrameRef(b)}}))})};e.postMessage=function(a,b){this.frame&&c("SecurePostMessage").sendMessageToSpecificOrigin(this.frame.contentWindow,a,b)};return b}(j.PureComponent);g["default"]=a}),98);
__d("DocumentTitle",["Arbiter"],(function(a,b,c,d,e,f,g){var h=1500,i=null,j=!1,k=0,l=[],m=null,n=document.title,o=0;function p(){l.length>0?!j?(q(l[k].title),k=++k%l.length):r():(clearInterval(i),i=null,r())}function q(a){document.title=a,j=!0}function r(){s.set(m||n,!0),j=!1}var s=function(){function a(a){this.$1=a}a.get=function(){return n};a.set=function(a,b){var d=a.toString();document.title=d;!b?(n=d,m=null,c("Arbiter").inform("update_title",a)):m=d};a.blink=function(b){b={title:b.toString()};l.push(b);i===null&&(i=setInterval(p,h));return new a(b)};var b=a.prototype;b.stop=function(){var a=l.indexOf(this.$1);a>=0&&(l.splice(a,1),k>a?k--:k==a&&k==l.length&&(k=0))};a.badge=function(b){var d=a.get();d=b?"("+b+") "+d:d;a.set(d,!0);c("Arbiter").inform("update_title_badge",b,"state");o=b};a.preserveBadgeAndSet=function(b){a.set(b,!1),c("Arbiter").inform("update_title",b),a.badge(o)};return a}();g["default"]=s}),98);
__d("IGDBadgeIconImpressionLoggingWrapper.react",["MessengerWebUXLogger","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(4);a=a.children;var e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e={eventName:"visit_inbox"},b[0]=e):e=b[0];e=c("MessengerWebUXLogger").useImpressionLoggerRef(e);var f;b[1]!==a||b[2]!==e?(f=i.jsx("div",{ref:e,children:a}),b[1]=a,b[2]=e,b[3]=f):f=b[3];return f}g["default"]=a}),98);
__d("IGDSCallFilled24Icon.react",["IGDSSVGIconBase.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M4.9 24.002q-.2 0-.4-.008a3.319 3.319 0 0 1-2.161-.92A18.862 18.862 0 0 1 .454 21.02a2.223 2.223 0 0 1 .171-2.893 14.91 14.91 0 0 1 5.829-4.014 2.5 2.5 0 0 1 1.896.186l.96.512a.888.888 0 0 0 .75.044 8.653 8.653 0 0 0 2.872-1.922 8.66 8.66 0 0 0 1.922-2.871.889.889 0 0 0-.044-.75l-.512-.962a2.495 2.495 0 0 1-.186-1.895 14.906 14.906 0 0 1 4.014-5.83 2.22 2.22 0 0 1 2.893-.17 18.89 18.89 0 0 1 2.056 1.884 3.323 3.323 0 0 1 .92 2.16c.206 5.552-3.946 10.564-6.44 13.057-2.432 2.433-7.264 6.446-12.654 6.446Z"}),b[0]=e):e=b[0];b[1]!==a?(e=i.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:e})),b[1]=a,b[2]=e):e=b[2];return e}b=i.memo(a);g["default"]=b}),98);
__d("IGDSLockFilledIcon.react",["IGDSSVGIconBase.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M10 5.667V4c0-2.2-1.8-4-4-4S2 1.8 2 4v1.667C.9 5.7 0 6.6 0 7.7v6.267C0 15.1.9 16 2.033 16h7.934A2.02 2.02 0 0 0 12 13.967V7.7c0-1.1-.9-2-2-2.033Zm-4-4C7.3 1.667 8.333 2.7 8.333 4v1.667H3.667V4C3.667 2.7 4.7 1.667 6 1.667Z",fill:"currentColor"}),b[0]=e):e=b[0];b[1]!==a?(e=i.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{aspectRatio:.75,viewBox:"0 0 12 16",children:e})),b[1]=a,b[2]=e):e=b[2];return e}b=i.memo(a);g["default"]=b}),98);
__d("PolarisAppInstallConstants",["keyMirror"],(function(a,b,c,d,e,f,g){"use strict";a=c("keyMirror")({"default":null,instagramlitecarbon:null,openinapp:null});b=["postPage","profilePage","locationPage","feedPage","exploreLandingPage","ActivityFeedPage"];g.APP_BANNER_VARIANTS=a;g.ALLOWLISTED_PAGE_IDS=b}),98);
__d("PolarisIncomingCallActions",[],(function(a,b,c,d,e,f){"use strict";function a(){return{type:"ACK_INCOMING_CALL"}}function b(a,b,c,d,e,f){return{avatarUris:e,callerName:f,hasVideo:c,igThreadId:b,serverInfoData:a,threadName:d,type:"UPDATE_INCOMING_CALL"}}f.ackCall=a;f.updateCall=b}),66);
__d("useBlinkDocumentTitle",["DocumentTitle","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(a){var b=d("react-compiler-runtime").c(3),e,f;b[0]!==a?(e=function(){if(a==null)return j;var b=c("DocumentTitle").blink(a);return function(){b.stop()}},f=[a],b[0]=a,b[1]=e,b[2]=f):(e=b[1],f=b[2]);i(e,f)}function j(){}g["default"]=a}),98);
__d("PolarisIncomingCallBlinkingTitle.react",["fbt","PolarisCallGatingHelpers","react","react-compiler-runtime","useBlinkDocumentTitle"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(2);a=a.callerName;var c;b[0]!==a?(c=d("PolarisCallGatingHelpers").isWebCallingEnabled()&&a!=null?j.jsx(k,{callerName:a}):null,b[0]=a,b[1]=c):c=b[1];return c}function k(a){var b=d("react-compiler-runtime").c(2);a=a.callerName;var e;b[0]!==a?(e=h._(/*BTDS*/"{caller_name} est\u00e1 ligando",[h._param("caller_name",a)]),b[0]=a,b[1]=e):e=b[1];c("useBlinkDocumentTitle")(e);return null}g["default"]=a}),226);
__d("PolarisIncomingCall.react",["fbt","CometPressable.react","I64","IGCoreModal.react","IGDSBox.react","IGDSCallFilled24Icon.react","IGDSLockFilledIcon.react","IGDSTextVariants.react","IGDSVideoChatFilled24Icon.react","IGDSXFilledIcon.react","IGDThreadTTLCUtils","IGWebPreCallContext","IGWebPreCallHooks","PolarisCallGatingHelpers","PolarisCallNavigator","PolarisDirectLogger","PolarisDirectStrings","PolarisIGCoreText","PolarisIncomingCallActions","PolarisIncomingCallBlinkingTitle.react","PolarisReactRedux.react","PolarisUserAvatar.react","ReQL","ReQLSuspense","ZenonCallInviteModelTypes","bx","intlList","promiseDone","react","useIGDIsE2EECallingEnabled","usePolarisMQTT","useReStore"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=k||(k=d("react"));b=k;var m=b.useContext,n=b.useEffect;function a(){var a,b=function(a){if(a&&a.type===d("ZenonCallInviteModelTypes").CallInviteModelType.ringing){var b;b=(b=a.controllerParams.serverInfoData)!=null?b:"";var e=a.requestingVideo;a=(a=a.controllerParams.appMessages)==null?void 0:a.ring_data;var f="",g="",h="",i,j=[],k=[];if(a!=null){a=JSON.parse(a);h=a.display_name;i=a.display_uri;g=a.group_name;f=a.ig_thread_id;j=a.participant_usernames;k.push(i);if(!g){try{j=JSON.parse(j)}catch(a){}g=Array.isArray(j)?c("intlList")([h].concat(j),c("intlList").CONJUNCTIONS.NONE).toString():h}}return{avatarUris:k,callerName:h,hasVideo:e,igThreadId:f,serverInfoData:b,threadName:g}}else return null},e=d("IGWebPreCallHooks").useCallInvite(),g=(a=e==null?void 0:e.isE2eeMandated)!=null?a:!1;a=e==null?void 0:e.context.thread;var k=(i||(i=c("useReStore")))(),o=(j||(j=d("I64"))).of_string((a=a==null?void 0:a.id)!=null?a:"");a=d("ReQLSuspense").useFirst(function(){return d("ReQL").fromTableAscending(k.tables.threads).getKeyRange(o)},[k.tables.threads,o],f.id+":125");a=a!=null?d("IGDThreadTTLCUtils").isInstamadilloTTLCCallingEnabled(a):!1;var p=c("useIGDIsE2EECallingEnabled")(o);p=g?!p&&a:!0;var q=d("IGWebPreCallHooks").useAcceptCallCallback(p),r=d("PolarisReactRedux.react").useDispatch(),s=c("usePolarisMQTT")();a=m(c("IGWebPreCallContext"));var t=a?a.callInviteModel:null;a=d("PolarisReactRedux.react").useSelector(function(a){return a.incomingCall});var u=a.acknowledged,v=a.avatarUris,w=a.callerName,x=a.hasVideo,y=a.igThreadId,z=a.serverInfoData;a=a.threadName;b=e?b(e):null;b!=null?(v=b.avatarUris,w=b.callerName,x=b.hasVideo,y=b.igThreadId,z=b.serverInfoData,a=b.threadName,u=!1):d("PolarisCallGatingHelpers").isWebCallingEnabled()&&(u=!0);e=function(){d("PolarisDirectLogger").DirectLogger.logDirectEvent("IncomingCall","join_button_click",{has_video:x,ig_thread_id:y,server_info_data:z}),g?c("promiseDone")(q({trigger:"incoming_call_modal"})):(r(d("PolarisIncomingCallActions").ackCall()),y!=null&&d("PolarisCallNavigator").launchCall(y,Boolean(x),z))};var A=!Boolean(u)&&z!=null&&y!=null&&d("PolarisCallGatingHelpers").isWebCallingEnabled();n(function(){A&&d("PolarisDirectLogger").DirectLogger.logDirectEvent("IncomingCall","incoming_call_impression",{has_video:x,ig_thread_id:y,server_info_data:z})},[x,y,A,z]);b=function(){d("PolarisDirectLogger").DirectLogger.logDirectEvent("IncomingCall","decline_button_click",{has_video:x,ig_thread_id:y,server_info_data:z}),d("PolarisCallGatingHelpers").isWebCallingEnabled()?t==null?void 0:t.decline():(r(d("PolarisIncomingCallActions").ackCall()),z!=null&&s!=null&&c("promiseDone")(s.sendRtcHangupRequest(z)))};u=Boolean(x)?h._(/*BTDS*/"Liga\u00e7\u00e3o de v\u00eddeo recebida\u2026"):h._(/*BTDS*/"Liga\u00e7\u00e3o de \u00e1udio recebida\u2026");u=p?u:h._(/*BTDS*/"Criptografado de ponta a ponta");return A?l.jsxs(c("IGCoreModal.react"),{children:[l.jsx("audio",{autoPlay:!0,loop:!0,children:l.jsx("source",{src:c("bx").getURL(c("bx")("6022")),type:"audio/m4a"})}),l.jsx(c("PolarisIncomingCallBlinkingTitle.react"),{callerName:w}),l.jsxs(c("IGDSBox.react"),{alignItems:"center",height:312,padding:8,position:"relative",width:400,children:[l.jsx(c("PolarisUserAvatar.react"),{isLink:!1,profilePictureUrl:v&&v.length>0?v[0]:null,size:92}),l.jsx(c("IGDSBox.react"),{marginBottom:2,marginTop:4,maxWidth:400,paddingX:8,position:"relative",children:l.jsx(c("PolarisIGCoreText"),{display:"truncated",Element:"h2",size:"headline2",textAlign:"center",weight:"semibold",zeroMargin:!0,children:a})}),l.jsxs(c("IGDSBox.react"),{direction:"row",justifyContent:"center",marginBottom:8,position:"relative",children:[p?null:l.jsx(c("IGDSBox.react"),{justifyContent:"center",paddingX:2,children:l.jsx(c("IGDSLockFilledIcon.react"),{alt:h._(/*BTDS*/"As mensagens e liga\u00e7\u00f5es s\u00e3o protegidas com criptografia de ponta a ponta."),color:"ig-secondary-text","data-testid":void 0,size:8})}),l.jsx(d("IGDSTextVariants.react").IGDSTextBody,{color:"secondaryText",zeroMargin:!0,children:u})]}),l.jsxs(c("IGDSBox.react"),{direction:"row",position:"relative",children:[l.jsx(c("IGDSBox.react"),{marginEnd:6,position:"relative",children:l.jsx(c("CometPressable.react"),{onPress:b,children:l.jsx("div",babelHelpers["extends"]({className:"x6s0dn4 xvs2etk xg3wpu6 x1jwbhkm xgg4q86 x78zum5 xdd8jsf xl56j7k xvni27 x1mkg91h"},{children:l.jsx(c("IGDSXFilledIcon.react"),{alt:d("PolarisDirectStrings").DECLINE_CALL_MODAL_STRING,color:"web-always-white","data-testid":void 0})}))})}),l.jsx(c("CometPressable.react"),{onPress:e,children:l.jsx("div",babelHelpers["extends"]({className:"x6s0dn4 xvs2etk xg3wpu6 x1jwbhkm xgg4q86 x78zum5 xdd8jsf xl56j7k xvni27 x44zu8b"},{children:Boolean(x)?l.jsx(c("IGDSVideoChatFilled24Icon.react"),{alt:d("PolarisDirectStrings").JOIN_CALL_MODAL_STRING,color:"web-always-white"}):l.jsx(c("IGDSCallFilled24Icon.react"),{alt:d("PolarisDirectStrings").JOIN_CALL_MODAL_STRING,color:"web-always-white"})}))})]})]})]}):null}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),226);
__d("PolarisLoggedInAppBanner.react",["cx","HeroInteractionIgnoreWithDiv.react","IGDSBox.react","IGDSIconButton.react","IGDSXPanoFilledIcon.react","PolarisAppInstallConstants","PolarisAppInstallStrings","PolarisConfig","PolarisDismissEntry","PolarisGenericStrings","PolarisIGCoreButton.react","PolarisIgLiteCarbonUpsellsUtils","PolarisIsLoggedIn","PolarisLoggedInCtaLogger","PolarisNavigationLayoutContext","PolarisUA","polarisGetAppPlatform","polarisLogAction","react","react-compiler-runtime","usePolarisOpenApp"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;b.useCallback;var k=b.useEffect,l=b.useState,m="logged_in_banner";function a(a){var b=d("react-compiler-runtime").c(23),e=l(!1),f=e[0],g=e[1],h=a.pageID,i=a.viewer;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=d("PolarisIgLiteCarbonUpsellsUtils").isIgLiteCarbonUpsellsEligible(),b[0]=e):e=b[0];var n=e;b[1]===Symbol["for"]("react.memo_cache_sentinel")?(a=d("PolarisDismissEntry").isDismissed(d("PolarisDismissEntry").USE_THE_APP_LI_BANNER),b[1]=a):a=b[1];e=l(a);var o=e[0],p=e[1];a=d("PolarisNavigationLayoutContext").usePolarisNavigationLayoutContext();e=a.navigationPosition;b[2]!==o||b[3]!==h||b[4]!==(i==null?void 0:i.isProfessionalAccount)?(a=function(){var a;a=(a=i==null?void 0:i.isProfessionalAccount)!=null?a:!1;return a&&d("polarisGetAppPlatform").isIOS()&&d("PolarisConfig").getCountryCode()==="US"?!0:!d("PolarisIsLoggedIn").isLoggedIn()||!d("PolarisUA").isMobile()||!d("PolarisAppInstallConstants").ALLOWLISTED_PAGE_IDS.includes(h)||o},b[2]=o,b[3]=h,b[4]=i==null?void 0:i.isProfessionalAccount,b[5]=a):a=b[5];i==null?void 0:i.isProfessionalAccount;var q=a,r;b[6]!==q||b[7]!==f||b[8]!==h?(a=function(){!q()&&!f&&(c("polarisLogAction")("appBannerImpression",{platform:d("polarisGetAppPlatform").getAppPlatform(),source:h,type:m}),d("PolarisLoggedInCtaLogger").logLoggedInCtaEvent({containermodule:h,ctaType:"app_banner",ctaVersion:n?"instagramlitecarbon":"use_the_app",eventName:"impression"}),g(!0))},r=[n,q,f,h],b[6]=q,b[7]=f,b[8]=h,b[9]=a,b[10]=r):(a=b[9],r=b[10]);k(a,r);var s=c("usePolarisOpenApp")();b[11]!==s||b[12]!==h?(a=function(a){a.preventDefault(),c("polarisLogAction")("appBannerClick",{platform:d("polarisGetAppPlatform").getAppPlatform(),source:h,type:m}),d("PolarisLoggedInCtaLogger").logLoggedInCtaEvent({containermodule:h,ctaType:"app_banner",ctaVersion:n?"instagramlitecarbon":"use_the_app",eventName:"click"}),s()},b[11]=s,b[12]=h,b[13]=a):a=b[13];r=a;b[14]!==h?(a=function(a){a.preventDefault(),c("polarisLogAction")("appBannerDismiss",{platform:d("polarisGetAppPlatform").getAppPlatform(),source:h,type:m}),d("PolarisLoggedInCtaLogger").logLoggedInCtaEvent({containermodule:h,ctaType:"app_banner",ctaVersion:n?"instagramlitecarbon":"use_the_app",eventName:"dismiss"}),p(!0),d("PolarisDismissEntry").setDismissEntry(d("PolarisDismissEntry").USE_THE_APP_LI_BANNER)},b[14]=h,b[15]=a):a=b[15];a=a;var t;b[16]!==r||b[17]!==a||b[18]!==q||b[19]!==e?(t=q()?null:j.jsx("div",{className:"_acc8"+(e==="bottom"?" _abpk":"")+(e!=="bottom"?" _ag6v":""),children:j.jsxs(c("IGDSBox.react"),{alignItems:"center",justifyContent:"center",paddingY:2,position:"relative",width:"100%",children:[j.jsx(c("IGDSBox.react"),{padding:1,position:"absolute",right:!0,top:!0,children:j.jsx(c("IGDSIconButton.react"),{onClick:a,children:j.jsx(c("IGDSXPanoFilledIcon.react"),{alt:d("PolarisGenericStrings").CLOSE_TEXT,color:"ig-secondary-text",size:12})})}),j.jsx(c("IGDSBox.react"),{paddingX:6,position:"relative",children:j.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,onClick:r,children:n?d("PolarisAppInstallStrings").USE_INSTAGRAM_LITE_CARBON_CTA:d("PolarisAppInstallStrings").NEW_CTA_USE_THE_APP})})]})}),b[16]=r,b[17]=a,b[18]=q,b[19]=e,b[20]=t):t=b[20];b[21]!==t?(r=j.jsx(c("HeroInteractionIgnoreWithDiv.react"),{children:t}),b[21]=t,b[22]=r):r=b[22];return r}g["default"]=a}),98);
__d("PolarisNotificationBannerIcon.react",["fbt","$InternalEnum","IGDSBox.react","IGDSText.react","Locale","PolarisAssetManagerGlyphMapping","PolarisIGCoreIcon.react","react","react-compiler-runtime","vulture"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=b("$InternalEnum")({COMMENTS:"comments",LIKES:"likes",RELATIONSHIPS:"relationships",USERTAGS:"usertags"});function l(a){switch(a){case k.COMMENTS:c("vulture")("mMVn4YidZTZwz-kW6id3UeJCj0E=");return{alt:h._(/*BTDS*/"Coment\u00e1rios"),icon:d("PolarisAssetManagerGlyphMapping").ICONS.COMMENT_FILLED_16_WHITE};case k.LIKES:c("vulture")("Mp7Gr8FgYQ9rXVtUxgtQt37bV8k=");return{alt:h._(/*BTDS*/"Curtir"),icon:d("PolarisAssetManagerGlyphMapping").ICONS.HEART_FILLED_16_WHITE};case k.RELATIONSHIPS:c("vulture")("5iZkJbR_mVBgk7DLRiRECQgIX0A=");return{alt:h._(/*BTDS*/"Relacionamentos"),icon:d("PolarisAssetManagerGlyphMapping").ICONS.USER_FILLED_16_WHITE};case k.USERTAGS:return{alt:h._(/*BTDS*/"Tags de usu\u00e1rio"),icon:d("PolarisAssetManagerGlyphMapping").ICONS.TAG_UP_FILLED_16_WHITE}}}function a(a){var b=d("react-compiler-runtime").c(11),e=a.count;a=a.countType;var f;b[0]!==a?(f=l(a),b[0]=a,b[1]=f):f=b[1];a=f;f=a.alt;a=a.icon;var g;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(g={className:"x6s0dn4 x78zum5 x1diwwjn x1n2onr6"},b[2]=g):g=b[2];var h;b[3]!==f||b[4]!==a?(h=j.jsx(c("PolarisIGCoreIcon.react"),{alt:f,icon:a}),b[3]=f,b[4]=a,b[5]=h):h=b[5];b[6]!==e?(f=j.jsx(c("IGDSBox.react"),{alignItems:"center",marginStart:1,position:"relative",children:j.jsx(c("IGDSText.react"),{color:"webAlwaysWhite",size:"label",zeroMargin:!0,children:e})}),b[6]=e,b[7]=f):f=b[7];b[8]!==h||b[9]!==f?(a=j.jsxs("div",babelHelpers["extends"]({},g,{dir:c("Locale").isRTL()?"rtl":"ltr",children:[h,f]})),b[8]=h,b[9]=f,b[10]=a):a=b[10];return a}g.CountBadgeType=k;g.PolarisNotificationBannerIcon=a}),226);
__d("PolarisNotificationsBannerV2_badgeCount.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PolarisNotificationsBannerV2_badgeCount",selections:[{alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null},{alias:null,args:null,concreteType:"XDTNotificationActivityBadgeCounts",kind:"LinkedField",name:"activity_badge_counts",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"comments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"likes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relationships",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usertags",storageKey:null}],storageKey:null}],type:"XDTNotificationBadgeCount",abstractKey:null};e.exports=a}),null);
__d("PolarisNotificationsBannerV2.react",["CometRelay","PolarisDisappearingTooltip.react","PolarisNotificationBannerIcon.react","PolarisNotificationsBannerV2_badgeCount.graphql","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));i.useMemo;function a(a){var e=d("react-compiler-runtime").c(23),f=a.align,g=a.autoHideAfter,i=a.badgeCount,k=a.children,l=a.onClick,m=a.onTooltipHide;a=a.position;i=d("CometRelay").useFragment(h!==void 0?h:h=b("PolarisNotificationsBannerV2_badgeCount.graphql"),i);var n=i==null?void 0:i.activity_badge_counts;i=(i=i==null?void 0:i.total_count)!=null?i:0;bb0:{var o;o=(o=Object.keys(n).reduce(function(a,b){return a+((a=n[b])!=null?a:0)},0))!=null?o:0;if(o===0){o=null;break bb0}var p;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(p={className:"xuk3077 x972fbf x10w94by x1qhh985 x14e42zd x9f619 x78zum5 x1q0g3np x2lah0s xln7xf2 xk390pu xdj266r x14z9mp xat24cr x18xomjl xexx8yu xyri2b x18d9i69 x1c1uobl x1n2onr6 x11njtxf"},e[0]=p):p=e[0];var q;e[1]!==n?(q=(n==null?void 0:n.comments)!=null&&n.comments!==0&&j.jsx(d("PolarisNotificationBannerIcon.react").PolarisNotificationBannerIcon,{count:n.comments,countType:d("PolarisNotificationBannerIcon.react").CountBadgeType.COMMENTS}),e[1]=n,e[2]=q):q=e[2];var r;e[3]!==n?(r=(n==null?void 0:n.likes)!=null&&n.likes!==0&&j.jsx(d("PolarisNotificationBannerIcon.react").PolarisNotificationBannerIcon,{count:n.likes,countType:d("PolarisNotificationBannerIcon.react").CountBadgeType.LIKES}),e[3]=n,e[4]=r):r=e[4];var s;e[5]!==n?(s=(n==null?void 0:n.relationships)!=null&&n.relationships!==0&&j.jsx(d("PolarisNotificationBannerIcon.react").PolarisNotificationBannerIcon,{count:n.relationships,countType:d("PolarisNotificationBannerIcon.react").CountBadgeType.RELATIONSHIPS}),e[5]=n,e[6]=s):s=e[6];var t;e[7]!==n?(t=(n==null?void 0:n.usertags)!=null&&n.usertags!==0&&j.jsx(d("PolarisNotificationBannerIcon.react").PolarisNotificationBannerIcon,{count:n.usertags,countType:d("PolarisNotificationBannerIcon.react").CountBadgeType.USERTAGS}),e[7]=n,e[8]=t):t=e[8];e[9]!==q||e[10]!==r||e[11]!==s||e[12]!==t?(p=j.jsxs("div",babelHelpers["extends"]({},p,{children:[q,r,s,t]})),e[9]=q,e[10]=r,e[11]=s,e[12]=t,e[13]=p):p=e[13];o=p}q=o;e[14]!==f||e[15]!==g||e[16]!==k||e[17]!==q||e[18]!==l||e[19]!==m||e[20]!==a||e[21]!==i?(r=i>0&&q!=null?j.jsx(c("PolarisDisappearingTooltip.react"),{align:f,autoHideAfter:g,color:"red",disableTooltipHideOnDismount:!1,isActivity:!0,onClick:l,onTooltipHide:m,position:a,tooltip:q,children:k}):j.jsx(j.Fragment,{children:k}),e[14]=f,e[15]=g,e[16]=k,e[17]=q,e[18]=l,e[19]=m,e[20]=a,e[21]=i,e[22]=r):r=e[22];return r}g["default"]=a}),98);
__d("usePolarisNotificationsNavItemQuery.graphql",["relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"device_id"}],b=[{kind:"Variable",name:"device_id",variableName:"device_id"}],c={alias:null,args:null,kind:"ScalarField",name:"total_count",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"usePolarisNotificationsNavItemQuery",selections:[{alias:null,args:b,concreteType:"XDTNotificationBadgeResponse",kind:"LinkedField",name:"xdt_notification_badge",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTNotificationBadgeCount",kind:"LinkedField",name:"badge_count",plural:!1,selections:[c,{args:null,kind:"FragmentSpread",name:"PolarisNotificationsBannerV2_badgeCount"}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"usePolarisNotificationsNavItemQuery",selections:[{alias:null,args:b,concreteType:"XDTNotificationBadgeResponse",kind:"LinkedField",name:"xdt_notification_badge",plural:!1,selections:[{alias:null,args:null,concreteType:"XDTNotificationBadgeCount",kind:"LinkedField",name:"badge_count",plural:!1,selections:[c,{alias:null,args:null,concreteType:"XDTNotificationActivityBadgeCounts",kind:"LinkedField",name:"activity_badge_counts",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"comments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"likes",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relationships",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"usertags",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:"29759241103722430",metadata:{is_distillery:!0,root_field_name:["xdt_notification_badge"]},name:"usePolarisNotificationsNavItemQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("usePolarisNotificationsNavItemQuery",["CometRelay","PolarisConfig","usePolarisNotificationsNavItemQuery.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){var a=d("CometRelay").useLazyLoadQuery(h!==void 0?h:h=b("usePolarisNotificationsNavItemQuery.graphql"),{device_id:d("PolarisConfig").getDeviceId()});return a}c=a;g["default"]=c}),98);
__d("PolarisNotificationsNavBadge.react",["PolarisActivityStorySelectors","PolarisNotificationsNavItemBadge.react","PolarisReactRedux.react","cr:10762","cr:10763","react","react-compiler-runtime","usePolarisNotificationsNavItemQuery"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useEffect;function a(a){var e=d("react-compiler-runtime").c(10),f=a.onBadgeStateChange;a=c("usePolarisNotificationsNavItemQuery")();a=a==null?void 0:(a=a.xdt_notification_badge)==null?void 0:a.badge_count;a=(a=a==null?void 0:a.total_count)!=null?a:0;var g=b("cr:10763")(),h=d("PolarisReactRedux.react").useSelector(d("PolarisActivityStorySelectors").showBanner),k=a+g>0;e[0]!==k||e[1]!==f||e[2]!==h?(a=function(){return f(k||h)},g=[f,k,h],e[0]=k,e[1]=f,e[2]=h,e[3]=a,e[4]=g):(a=e[3],g=e[4]);j(a,g);e[5]!==k?(a=k?i.jsx(c("PolarisNotificationsNavItemBadge.react"),{}):null,e[5]=k,e[6]=a):a=e[6];e[7]===Symbol["for"]("react.memo_cache_sentinel")?(g=b("cr:10762")&&i.jsx(b("cr:10762"),{}),e[7]=g):g=e[7];e[8]!==a?(g=i.jsxs(i.Fragment,{children:[a,g]}),e[8]=a,e[9]=g):g=e[9];return g}g["default"]=a}),98);
__d("PolarisNotificationsNavBannerWrapper.react",["PolarisIGCoreConstants","PolarisNavigationHelpers","PolarisNotificationsBannerV2.react","react","react-compiler-runtime","useMatchMedia","usePolarisNotificationsNavItemQuery"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(6),e=a.children,f=a.onClick;a=a.onTooltipHide;var g=c("usePolarisNotificationsNavItemQuery")();g=g==null?void 0:(g=g.xdt_notification_badge)==null?void 0:g.badge_count;var h=c("useMatchMedia")("(max-width: "+d("PolarisNavigationHelpers").BOTTOM_STYLING_MAX_WIDTH+"px)"),j;b[0]!==g||b[1]!==e||b[2]!==h||b[3]!==f||b[4]!==a?(j=g==null?null:i.jsx(c("PolarisNotificationsBannerV2.react"),{align:h?"end":"middle",autoHideAfter:c("PolarisIGCoreConstants").TOOLTIP.AUTO_HIDE_MS,badgeCount:g,onClick:f,onTooltipHide:a,position:h?"below":"end",children:e}),b[0]=g,b[1]=e,b[2]=h,b[3]=f,b[4]=a,b[5]=j):j=b[5];return j}g["default"]=a}),98);
__d("PolarisPaidAdsPixelContainerDeferredV2.react",["deferredLoadComponent","react","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h;h||d("react");a=c("deferredLoadComponent")(c("requireDeferred")("PolarisPaidAdsPixelsContainerV2.react").__setRef("PolarisPaidAdsPixelContainerDeferredV2.react"));g["default"]=a}),98);
__d("PolarisPaidAdsPixelsContainerV2.react",["CometErrorBoundary.react","ControlledRefererIFrame.react","PolarisWebStorage","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");b=1e3*60*60*24;var j=b*7,k="pixel_fire_ts";function l(){var a=d("react-compiler-runtime").c(5),b,e,f,g;if(a[0]===Symbol["for"]("react.memo_cache_sentinel")){g=Symbol["for"]("react.early_return_sentinel");bb0:{b=c("PolarisWebStorage").getLocalStorage();if(!b){g=null;break bb0}e=parseInt;f=b.getItem(k)}a[0]=b;a[1]=e;a[2]=f;a[3]=g}else b=a[0],e=a[1],f=a[2],g=a[3];if(g!==Symbol["for"]("react.early_return_sentinel"))return g;g=e(f,10);if(Date.now()-g<j)return null;a[4]===Symbol["for"]("react.memo_cache_sentinel")?(g=i.jsx(c("ControlledRefererIFrame.react"),{hidden:!0,onFrameRender:function(){b.setItem(k,Date.now().toString())},src:"/paid_ads/generete_pixels/"},"pixels_iframe"),a[4]=g):g=a[4];return g}function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=i.jsx(c("CometErrorBoundary.react"),{children:i.jsx(l,{})}),a[0]=b):b=a[0];return b}g["default"]=a}),98);
__d("usePolarisNotificationsSecurityAlertUnseenCountDataDefault.react",[],(function(a,b,c,d,e,f){"use strict";function a(){return 0}f["default"]=a}),66);/*FB_PKG_DELIM*/
__d("EntMessageReplyType",[],(function(a,b,c,d,e,f){a=Object.freeze({REGULAR:0,BUMP:1});f["default"]=a}),66);
__d("IWAAPI",["WABridge"],(function(a,b,c,d,e,f,g){"use strict";b=1;function a(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("WABridge").getBridge().sendAndReceive("backend","waapi",{type:a,args:c})}}g.version=b;g.makeBridgedApi=a}),98);
__d("LSInstagramE2EEEligibility",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:-1,INELIGIBLE:0,ELIGIBLE:1,REQUIRED:2,DUAL_SEND_ELIGIBLE:3,GROUPS_ELIGIBLE:4});f["default"]=a}),66);
__d("LSIssueNewError",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return c[0]=b.i64.of_float(Date.now()),b.db.table(6).add({errorId:void 0,taskId:a[0],errorCode:a[1],errorTitleText:a[2],errorBodyText:a[3],issuedTimestampMs:c[0],errorExtraData:a[4],presentationStyle:a[5]})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreIssueNewErrorStoredProcedure";a.__tables__=["user_visible_errors"];e.exports=a}),null);
__d("LSIssuePointQueryRestoreTask",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewTaskAndGetTaskID","LSLogMebClientEvent.nop","LSLogWebQpl.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure] Beginning execution."),c.sequence([function(d){return a[3]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[3],c.i64.cast([0,2512]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[13]=a[0],a})},function(a){return d[13]?d[14]=!0:d[14]=!1,d[14]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[16]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[16]].join("")),d[15]=c.createArray(),void 0!==void 0?d[17]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[16],d[15],c.i64.cast([0,3]))):c.resolve()}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure] Point query restore v2 is enabled"),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[13]=new c.Map(),d[13].set("error_msg","Expected a nonempty query result"),d[13].set("code",c.i64.cast([0,3])),d[13].set("src_line","MEBClientStateUtils.php:247 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[14]=c.createArray(),d[15]=(d[14].push(d[13]),d[14]),e=[void 0,d[14]],d[1]=e[0],d[2]=e[1],e):(b=a.item,d[13]=new c.Map(),d[13].set("backup_id",b.backupId),d[13].set("device_public_key_blob",b.devicePublicKeyBlob),d[13].set("device_private_key_blob",b.devicePrivateKeyBlob),d[13].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[13].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[13].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[13].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[13].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[13].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[13].set("orf_client_state_v2_blob",void 0),d[13].set("orf_v2_authority_level",void 0),d[13].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[13].set("device_id",b.deviceId),d[13].set("backup_tenancy",b.backupTenancy),d[13].set("encryption_version",b.encryptionVersion),d[13].set("revision_version",b.revisionVersion),d[13].set("initialize_restore_result",void 0),d[13].set("device_creation_timestamp_sec",void 0),d[13].set("authority_level",b.authorityLevel),e=[d[13],void 0],d[1]=e[0],d[2]=e[1],e)})},function(e){return d[4]=new c.Map(),d[4].set("value",d[1]),d[4].set("errors",d[2]),d[5]=d[4].get("value"),d[5]!==void 0?c.sequence([function(e){return d[13]=d[5].get("backup_id"),d[14]=d[5].get("device_public_key_blob"),d[15]=d[5].get("device_private_key_blob"),d[16]=d[5].get("epoch_storage_public_key_blob"),d[17]=d[5].get("epoch_storage_private_key_blob"),d[18]=d[5].get("epoch_auth_public_key_blob"),d[19]=d[5].get("epoch_auth_private_key_blob"),d[20]=d[5].get("mailbox_root_key_blob"),d[21]=d[5].get("ocmf_client_state_blob"),d[22]=d[5].get("orf_client_state_v2_blob"),d[23]=d[5].get("orf_v2_authority_level"),d[24]=d[5].get("oblivious_validation_token_blob"),d[25]=d[5].get("device_id"),d[26]=d[5].get("backup_tenancy"),d[27]=d[5].get("encryption_version"),d[28]=d[5].get("revision_version"),d[29]=d[5].get("initialize_restore_result"),d[30]=d[5].get("device_creation_timestamp_sec"),d[31]=d[5].get("authority_level"),c.i64.neq(d[25],void 0)?c.sequence([function(a){return d[33]=void 0,c.i64.neq(d[33],void 0)?c.resolve(d[34]=d[33]):c.sequence([function(a){return d[57]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[58]=a[0],a})},function(a){return d[58]?d[67]=(d[57].push(c.i64.cast([0,0])),d[57]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[59]=a[0],a})},function(a){return d[59]?d[67]=(d[57].push(c.i64.cast([0,2])),d[57]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[60]=a[0],a})},function(a){return d[60]?d[67]=(d[57].push(c.i64.cast([0,3])),d[57]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[61]=a[0],a})},function(a){return d[61]?d[67]=(d[57].push(c.i64.cast([0,4])),d[57]):0,d[62]=c.createArray(),d[63]=c.i64.of_int32(d[57].length),c.i64.gt(d[63],c.i64.cast([0,0]))?c.loopAsync(d[63],function(a){return d[67]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[57],d[67]).then(function(a){return a=a,d[68]=a[0],d[69]=a[1],a})},function(a){return d[70]=(d[62].push(d[68]),d[62])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[67]=c.createArray(),d[68]=c.i64.of_int32(d[62].length),c.i64.gt(d[68],c.i64.cast([0,0]))?c.loopAsync(d[68],function(a){return d[70]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[62],d[70]).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return d[73]=(d[67].push(c.i64.to_string(d[71])),d[67])}])}):c.resolve()},function(a){return d[69]=d[67].join(","),d[64]=d[69]}])},function(a){return d[62].some(function(a){return c.i64.eq(d[27],a)})?d[65]=d[27]:d[65]=void 0,c.i64.neq(d[65],void 0)?d[66]=d[65]:d[66]=void 0,d[34]=d[66]}])},function(e){return c.i64.neq(d[34],void 0)?d[35]=d[34]:d[35]=c.i64.cast([0,0]),c.i64.neq(d[26],void 0)?d[36]=d[26]:d[36]=c.i64.cast([0,1]),d[37]=new c.Map(),d[37].set("act_thread_id",a[0]),d[37].set("request_id",a[3]),d[37].set("tam_thread_subtype",c.i64.cast([0,0])),d[37].set("mem_message_type",c.i64.cast([0,0])),d[37].set("source",a[4]),c.nativeOperation(b("LSBase64Encode.nop"),d[21]).then(function(a){return a=a,d[38]=a[0],a})},function(a){return c.nativeOperation(b("LSBase64Encode.nop"),d[20]).then(function(a){return a=a,d[39]=a[0],a})},function(a){return d[40]=new c.Map(),d[40].set("ocmf_client_state_blob",d[38]==null?"":d[38]),d[40].set("mailbox_root_key",d[39]==null?"":d[39]),d[41]=c.createArray(),c.forEach(c.filter(c.db.table(169).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))}),function(a){a=a.item;return d[57]=(d[41].push(a.epochId),d[41])})},function(a){return d[55]="Queried locally available epochs. Count: ",d[42]=c.i64.of_int32(d[41].length),d[56]=c.i64.to_string(d[42]),d[43]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBEpochClientUtils] ",d[43],d[55],d[43],d[56]].join("")),c.resolve()},function(e){return d[44]=new c.Map(),d[44].set("device_id",d[25]),d[44].set("raw_tokens",d[40]),d[44].set("locally_available_epochs",d[41]),d[45]=new c.Map(),d[45].set("reference_timestamp",a[2]),d[45].set("device_context",d[44]),d[45].set("message_id",a[1]),d[46]=new c.Map(),d[46].set("restore_context",d[37]),d[46].set("success",d[45]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[57]=c.i64.of_float(Date.now()),d[47]=c.i64.add(d[57],c.i64.cast([0,0]))):d[47]=c.i64.cast([0,0]),d[48]=d[46].get("restore_context"),d[49]=d[46].get("success"),d[49]!==void 0?(d[57]=d[49].get("message_id"),d[50]=d[57]):d[50]="",d[51]=d[48].get("act_thread_id"),d[52]=":",d[53]=c.toJSON(d[46]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["encrypted_backups_restore",d[52],d[51],d[52],d[50]].join(""),c.i64.cast([0,50035]),d[53],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[47],c.i64.cast([0,0])).then(function(a){return a=a,d[54]=a[0],a})},function(a){return d[32]=d[54]}]):c.sequence([function(e){return d[33]=new c.Map(),d[33].set("error_code",c.i64.cast([0,1])),d[33].set("error_message",""),d[33].set("stored_procedure","issuePointQueryRestoreTask"),d[34]=new c.Map(),d[34].set("act_thread_id",a[0]),d[35]=new c.Map(),d[35].set("restore_context",d[34]),d[35].set("failure",d[33]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[44]=c.i64.of_float(Date.now()),d[36]=c.i64.add(d[44],c.i64.cast([0,0]))):d[36]=c.i64.cast([0,0]),d[37]=d[35].get("restore_context"),d[38]=d[35].get("success"),d[38]!==void 0?(d[44]=d[38].get("message_id"),d[39]=d[44]):d[39]="",d[40]=d[37].get("act_thread_id"),d[41]=":",d[42]=c.toJSON(d[35]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["encrypted_backups_restore",d[41],d[40],d[41],d[39]].join(""),c.i64.cast([0,50035]),d[42],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[36],c.i64.cast([0,0])).then(function(a){return a=a,d[43]=a[0],a})},function(a){return d[32]=d[43]}])},function(a){return d[6]=d[32]}]):c.sequence([function(e){return d[13]=d[4].get("errors"),d[14]=d[4].get("errors"),d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,1])),d[15].set("error_message",""),d[15].set("stored_procedure","issuePointQueryRestoreTask"),d[16]=new c.Map(),d[16].set("act_thread_id",a[0]),d[17]=new c.Map(),d[17].set("restore_context",d[16]),d[17].set("failure",d[15]),c.i64.gt(c.i64.cast([0,0]),c.i64.cast([0,0]))?(d[26]=c.i64.of_float(Date.now()),d[18]=c.i64.add(d[26],c.i64.cast([0,0]))):d[18]=c.i64.cast([0,0]),d[19]=d[17].get("restore_context"),d[20]=d[17].get("success"),d[20]!==void 0?(d[26]=d[20].get("message_id"),d[21]=d[26]):d[21]="",d[22]=d[19].get("act_thread_id"),d[23]=":",d[24]=c.toJSON(d[17]),c.storedProcedure(b("LSIssueNewTaskAndGetTaskID"),["encrypted_backups_restore",d[23],d[22],d[23],d[21]].join(""),c.i64.cast([0,50035]),d[24],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,d[18],c.i64.cast([0,0])).then(function(a){return a=a,d[25]=a[0],a})},function(a){return d[6]=d[25]}])},function(d){return a[3]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),a[3],c.i64.cast([0,521476165]),"restore_task_start",c.i64.cast([0,1]),a[4],void 0):c.resolve()},function(e){return c.sequence([function(d){return a[3]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[3],c.i64.cast([0,2513]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[13]=a[0],a})},function(a){return d[13]?d[14]=!0:d[14]=!1,d[14]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[16]="LSDataTraceMciTraceLog native op not supported",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBTraceUtils] ","",d[16]].join("")),d[15]=c.createArray(),void 0!==void 0?d[17]=(d[15].push(void 0),d[15]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils",d[16],d[15],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return e[0]=d[6]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsIssuePointQueryRestoreTaskStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"];e.exports=a}),null);
__d("LSIssuePointQueryRestoreTaskStoredProcedure",["LSIssuePointQueryRestoreTask","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssuePointQueryRestoreTask"),e.threadId,e.messageId,e.startSortKey,e.traceId,e.source);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSMediaUrlUtils",["I64","ServerTime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){if((h||(h=d("I64"))).gt(a,(h||(h=d("I64"))).zero)){var b=(h||(h=d("I64"))).of_float(d("ServerTime").getMillis()/1e3);return h.lt(a,b)}return!1}function i(a){if((h||(h=d("I64"))).gt(a,(h||(h=d("I64"))).zero)){var b=(h||(h=d("I64"))).of_float(d("ServerTime").getMillis());return h.lt(a,b)}return!1}function b(a,b){return a!=null&&b!=null&&!i(b)}g.isTimestampExpired=a;g.isTimestampExpiredForMillis=i;g.hasValidReceiverFetchPreviewUrl=b}),98);
__d("LSMessageSearchType",[],(function(a,b,c,d,e,f){a=Object.freeze({THREAD:1,MESSAGE:2});f["default"]=a}),66);
__d("LSOptimisticUpdateThreadDisappearingSetting",["LSIssueNewError","LSIssueNewTask","LSLocalize"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(a){return c.sortBy(c.db.table(115).fetch(),[["timestampMs","DESC"]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=!1:(b=a.item,d[0]=b.errorShouldBeShown)})},function(a){return d[0]===!0?c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,2285622730]),void 0).then(function(a){return d[4]=a})},function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,1919524925]),void 0).then(function(a){return d[5]=a})},function(a){return c.storedProcedure(b("LSIssueNewError"),void 0,c.i64.cast([0,1545093]),d[4],d[5],void 0,void 0)}]):c.resolve()},function(e){return d[2]=new c.Map(),d[2].set("wa_jid",void 0),d[2].set("thread_key",a[0]),d[2].set("disappearing_ttl",a[1]),d[2].set("updated_timestamp",a[2]),d[2].set("updated_by",a[3]),d[2].set("sync_group",c.i64.cast([0,95])),d[2].set("ephemerality_type",void 0),d[3]=c.toJSON(d[2]),c.storedProcedure(b("LSIssueNewTask"),"disappearing_setting",c.i64.cast([0,714]),d[3],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticUpdateThreadDisappearingSettingStoredProcedure";a.__tables__=["user_visible_network_connectivity_error"];e.exports=a}),null);
__d("LSOptimisticUpdateThreadDisappearingSettingStoredProcedure",["LSOptimisticUpdateThreadDisappearingSetting","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){e===void 0&&(e={});a=a.storedProcedure(c("LSOptimisticUpdateThreadDisappearingSetting"),e.threadKey,e.disappearingTtl,e.updatedTimestamp,e.updatedBy);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSPlatformSyncSystemDeferred",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("LSPlatformSyncSystem").__setRef("LSPlatformSyncSystemDeferred");function a(){return h.load()}g["default"]=a}),98);
__d("LSRemoveError",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(6).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSCoreRemoveErrorStoredProcedure";a.__tables__=["user_visible_errors"];e.exports=a}),null);
__d("LSRemoveErrorStoredProcedure",["LSRemoveError","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSRemoveError"),e.errorId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSSearchRequestStatusType",[],(function(a,b,c,d,e,f){a=Object.freeze({PENDING:1,COMPLETE:2,FAILED:3});f["default"]=a}),66);
__d("MAWBridgeIssuePointQueryHandler",["EBIsEbEnabled","I64","LSFactory","LSIntEnum","LSIssuePointQueryRestoreTaskStoredProcedure","LSRequestId","MAWEBRestoreTrackingUtils","Promise","WAGetStorageQplAnnotations","emptyFunction","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a){c("promiseDone")(d("WAGetStorageQplAnnotations").getStorageQplAnnotations().then(function(b){d("MAWEBRestoreTrackingUtils").addQPLRestorePointWithAnnotations({annotations:b,pointName:"storage_estimation_retrieved",traceId:a})}))}function a(a,c){return d("EBIsEbEnabled").isEbEnabledLS(a).then(function(d){return!d?(j||(j=b("Promise"))).resolve():l(a,c)})}function l(a,b){var e=c("LSRequestId").generate(),f=(h||(h=d("LSIntEnum"))).unwrapIntEnum((i||(i=d("I64"))).of_float(b.taskSource));d("MAWEBRestoreTrackingUtils").markEBRestorePoint(f,e,"LS");k(e);return c("LSIssuePointQueryRestoreTaskStoredProcedure")(c("LSFactory")(a),{messageId:b.messageId,source:h.ofNumber(f),startSortKey:b.startSortKey,threadId:b.threadId,traceId:e}).then(c("emptyFunction"))}g.call=a}),98);
__d("MAWEphemeralSettingsUpdate",["FBLogger","I64","LSOptimisticUpdateThreadDisappearingSettingStoredProcedure","MAWChatJid","MAWCurrentUser","MAWEphemeralMsgAutoResetSystemId","Promise","asyncToGeneratorRuntime","gkx","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("MAWEphemeralSettingsUpdate"),k=c("requireDeferred")("LSFactory").__setRef("MAWEphemeralSettingsUpdate"),l=c("requireDeferred")("WATimeUtils").__setRef("MAWEphemeralSettingsUpdate");function m(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){a=(yield a.threads.get(e));if(a!=null){e=a.disappearingSettingUpdatedTs;a=a.disappearingSettingTtl;if(e==null||a==null)return!0;if((i||(i=d("I64"))).lt(e,(i||(i=d("I64"))).of_float(c))&&!(i||(i=d("I64"))).equal(a,(i||(i=d("I64"))).of_int32(b)))return!0}return!1});return n.apply(this,arguments)}function o(a,b,c,d,e,f,g){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,j,l,n){var o=(yield m(a,e,f,j));if(!o)return(h||(h=b("Promise"))).resolve();l&&c("FBLogger")("labyrinth_web").addMetadata("LABYRINTH_WEB","APP_VERSION","OCCAM_EPHEMERAL_SETTINGS_UPDATE").info("[Occam][Web] Ephemeral Settings Updated.");o=(yield k.load());return c("LSOptimisticUpdateThreadDisappearingSettingStoredProcedure")(o(a),{disappearingTtl:(i||(i=d("I64"))).of_int32(e),threadKey:j,updatedBy:i.of_string(g?c("MAWEphemeralMsgAutoResetSystemId"):n!=null?n:d("MAWCurrentUser").getID()),updatedTimestamp:i.of_float(f)})});return p.apply(this,arguments)}function a(a,b,c,d){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d){var e=(yield j.load());e=(yield e());return e.runInTransaction(function(e){return o(e,a,b,c,d,!1)},"readwrite")});return q.apply(this,arguments)}function e(a,b,c,d,e){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,i){var k=(yield j.load());k=(yield k());var m;c("gkx")("11440")&&(m=(yield l.load()).castUnixTimeToMillisTime(e));return k.runInTransaction(function(){var j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(j){var k=(yield d("MAWChatJid").toThreadKeyMaybe(j,g));return k!=null?o(j,a,c("gkx")("11440")?m:(yield l.load()).castUnixTimeToMillisTime(e),f,k,i):(h||(h=b("Promise"))).resolve()});return function(a){return j.apply(this,arguments)}}(),"readwrite")});return r.apply(this,arguments)}g.updateEphemeralSettingsWithTxn=o;g.updateEphemeralSettings=a;g.updateEphemeralSettingsByChatJid=e}),98);
__d("MAWGetEphemeralSettings",["I64","MAWBridgeSendAndReceive","MAWChatJid","ReQL","WAJids","WALogger","WATimeUtils","asyncToGeneratorRuntime","promiseDone","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["[ephemeral settings in memory]: MAWGetEphemeralSettings api call for chatJid "," returns ",""]);i=function(){return a};return a}var j=c("requireDeferred")("LSDatabaseSingletonLazyWrapper").__setRef("MAWGetEphemeralSettings"),k=c("requireDeferred")("MAWEphemeralSettingsUpdate").__setRef("MAWGetEphemeralSettings");function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(d("WAJids").switchOnMsgrChatJidType(a,{group:function(){return!1},user:function(){return!0}})){var e=(yield j.load());e=(yield e());b=b!=null?b:yield d("MAWChatJid").toThreadKeyMaybe(e.tables,a);if(b!=null){e=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.threads).getKeyRange(b)));if(e!=null&&e.disappearingSettingTtl!=null){b={ephemeralExpirationInSec:(h||(h=d("I64"))).to_int32(e.disappearingSettingTtl),ephemeralLastUpdatedOrSetTimestamp:e.disappearingSettingUpdatedTs!=null?d("WATimeUtils").castMilliSecondsToUnixTime((h||(h=d("I64"))).to_float(e.disappearingSettingUpdatedTs)):d("WATimeUtils").unixTime()};return b}return}return d("MAWBridgeSendAndReceive").sendAndReceive("backend","getEphemeralSettings",{threadId:a}).then(function(b){d("WALogger").LOG(i(),a,b);if(b!=null){c("promiseDone")(k.load().then(function(c){return c.updateEphemeralSettingsByChatJid(b.ephemeralExpirationInSec,b.ephemeralLastUpdatedOrSetTimestamp,!1,a,!0)}));return b}return void 0})}});return l.apply(this,arguments)}g.getEphemeralSetting=a}),98);
__d("MAWIsIDBOperational",["FBLogger","WebAsyncStorage","asyncToGeneratorRuntime","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h;e=h||d("react");var i=e.useEffect,j=e.useState;function k(a){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a=!1);if(a&&!c("WebAsyncStorage").isOpenPromiseSettled())return!1;a=(yield c("WebAsyncStorage").isOperational());if(!a.success){c("FBLogger")("messenger_web").catching(a.error).warn("Marking MAW IDB as unavailable: %s",a.error.message);return!1}return!0});return l.apply(this,arguments)}var m=!1;function a(){var a=j(m),b=a[0],d=a[1];i(function(){c("promiseDone")(k().then(function(a){d(a),m=a}))},[d]);return b}g.isIDBOperational=k;g.useIsIDBOperational=a}),98);
__d("MAWSubscribeToContactNames",["fbt","$InternalEnum","Env","MAWLocalizationType","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=b("$InternalEnum").Mirrored(["FIRST_NAME","FULL_NAME"]),k=[d("MAWLocalizationType").LOCALIZATION_TYPE.CURRENT_USER_MENTIONED_STORY_IG,d("MAWLocalizationType").LOCALIZATION_TYPE.PARTICIPANT_LEFT_GROUP],l=Boolean((i||(i=c("Env"))).isMessengerDotComOnComet)?"Messenger":c("gkx")("22979")?"Instagram":"Facebook";function m(){return h._(/*BTDS*/"Usu\u00e1rio do {Platform Name}",[h._param("Platform Name",l)]).toString()}function a(a,b){return(a=a.get(b))!=null?a:m()}function e(a){return k.includes(a)?j.FULL_NAME:j.FIRST_NAME}g.ContactNameMode=j;g.getUnknownUser=m;g.getContactNameFromLookup=a;g.getContactNameModeFromLocalizationType=e}),226);
__d("MAWUIJob",["ExecutionEnvironment","MAWBridge","WAJobOrchestratorTypes","WALogger"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["UIJobStarters waitUntilPersisted called in the worker, which is a bug for job: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["UIJobStarters waitUntilCompleted called in the worker, which is a bug for job: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["UIJobStarters fireAndForget called in the worker, which is a bug for job: ",""]);k=function(){return a};return a}var l={priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.UI_ACTION};a={fireAndForget:function(a){(h||(h=c("ExecutionEnvironment"))).isInWorker&&d("WALogger").ERROR(k(),a.type);d("MAWBridge").getBridge().fireAndForget("backend","runJobFireAndForget",babelHelpers["extends"]({},a,{scheduleConfig:(a=a.scheduleConfig)!=null?a:l}))},waitUntilCompleted:function(a,b,e){(h||(h=c("ExecutionEnvironment"))).isInWorker&&d("WALogger").ERROR(j(),a.type);a=d("MAWBridge").getBridge().sendAndReceive("backend","runJobWaitUntilCompleted",babelHelpers["extends"]({},a,{scheduleConfig:(a=a.scheduleConfig)!=null?a:l}),void 0,b,e);return a},waitUntilPersisted:function(a,b,e){(h||(h=c("ExecutionEnvironment"))).isInWorker&&d("WALogger").ERROR(i(),a.type);a=d("MAWBridge").getBridge().sendAndReceive("backend","runJobWaitUntilPersisted",babelHelpers["extends"]({},a,{scheduleConfig:(a=a.scheduleConfig)!=null?a:l}),void 0,b,e);return a}};g.UIJobStarters=a}),98);
__d("MAWTimedJob",["FBLogger","MAWBridgeLoggingUtils","MAWMaybeWithTimeout","MAWTimedBridge","MAWUIJob","MAWWaitForBackendSetup","MAWWebWorkerSingleton","MAWWorkerEvent","getErrorSafe"],(function(a,b,c,d,e,f,g){"use strict";a={fireAndForget:function(a,b){b===void 0&&(b=d("MAWTimedBridge").DEFAULT_MAW_BRIDGE_TIMEOUT_MS);var e=!1;return d("MAWMaybeWithTimeout").maybeWithTimeout(d("MAWWaitForBackendSetup").waitForBackendSetup(a.type).then(function(){e=!0;return d("MAWUIJob").UIJobStarters.fireAndForget(a)}),b,function(){return d("MAWWebWorkerSingleton").getWorkerHealthStatus().then(function(b){throw c("FBLogger")("maw_core_lla").mustfixThrow("Failed to ack execution of job %s in time. Backend setup: %s, workerHealthStatus: %s",a.type,e,b.tag)})},a.type)},waitUntilCompleted:function(a,b){b===void 0&&(b=d("MAWTimedBridge").DEFAULT_MAW_BRIDGE_TIMEOUT_MS);var e=!1,f=d("MAWBridgeLoggingUtils").getBridgeEventInstanceKey(a.type);return d("MAWMaybeWithTimeout").maybeWithTimeout(d("MAWWaitForBackendSetup").waitForBackendSetup(a.type).then(function(){d("MAWWorkerEvent").logStart("waitUntilCompleted",a.type,f);e=!0;return d("MAWUIJob").UIJobStarters.waitUntilCompleted(a,{onAck:function(b){d("MAWWorkerEvent").logAck(f,a.type,b)},onSend:function(b){var c=b.queueMsgs;b=b.queueSize;d("MAWWorkerEvent").logSend(f,a.type,"waitUntilCompleted");d("MAWWorkerEvent").logAnnotations(f,{"int":{bridgeSize:b},string_array:{bridgeMsgs:c}})}},{bridgeQPLInstanceKey:f}).then(function(a){d("MAWWorkerEvent").logSuccess(f);return a},function(a){a=c("getErrorSafe")(a);d("MAWWorkerEvent").logFailure(f,a.message);throw a})}),b,function(){return d("MAWWebWorkerSingleton").getWorkerHealthStatus().then(function(b){d("MAWWorkerEvent").logTimeoutFailure(f,"Failed to complete execution of job",b);throw c("FBLogger")("maw_core_lla").mustfixThrow("Failed to complete execution of job %s in time. Backend setup: %s, workerHealthStatus: %s",a.type,e,b.tag)})},a.type)},waitUntilPersisted:function(a,b){b===void 0&&(b=d("MAWTimedBridge").DEFAULT_MAW_BRIDGE_TIMEOUT_MS);var e=!1,f=d("MAWBridgeLoggingUtils").getBridgeEventInstanceKey(a.type);return d("MAWMaybeWithTimeout").maybeWithTimeout(d("MAWWaitForBackendSetup").waitForBackendSetup(a.type).then(function(){e=!0;d("MAWWorkerEvent").logStart("waitUntilPersisted",a.type,f);return d("MAWUIJob").UIJobStarters.waitUntilPersisted(a,{onAck:function(b){d("MAWWorkerEvent").logAck(f,a.type,b)},onSend:function(b){var c=b.queueMsgs;b=b.queueSize;d("MAWWorkerEvent").logSend(f,a.type,"waitUntilPersisted");d("MAWWorkerEvent").logAnnotations(f,{"int":{bridgeSize:b},string_array:{bridgeMsgs:c}})}},{bridgeQPLInstanceKey:f}).then(function(a){d("MAWWorkerEvent").logSuccess(f);return a},function(a){a=c("getErrorSafe")(a);d("MAWWorkerEvent").logFailure(f,a.message);throw a})}),b,function(){return d("MAWWebWorkerSingleton").getWorkerHealthStatus().then(function(b){d("MAWWorkerEvent").logTimeoutFailure(f,"Failed to persist execution of job",b);throw c("FBLogger")("maw_core_lla").mustfixThrow("Failed to persist execution of job %s in time. Backend setup: %s, workerHealthStatus: %s",a.type,e,b.tag)})},a.type)}};g.TimedUIJobStarters=a}),98);
__d("getLSMediaContactProfilePictureUrl",["LSMediaUrlUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.profilePictureUrlExpirationTimestampMs;if(b!=null&&d("LSMediaUrlUtils").isTimestampExpired(b)||a.profilePictureUrl===""){return(b=a.profilePictureFallbackUrl)!=null?b:a.profilePictureUrl}else return a.profilePictureUrl}g["default"]=a}),98);
__d("MWLSParticipant",["I64","LSContactBlockedByViewerStatus","LSContactGender","LSContactType","LSContactWorkForeignEntityType","LSIntEnum","LSMailboxType","MWLSContactTypeExactUtils","ReQL","getLSMediaContactProfilePictureUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b={actual_name:"",blocked_by_viewer_status:(h||(h=d("LSIntEnum"))).ofNumber(c("LSContactBlockedByViewerStatus").UNBLOCKED),contact_id:(i||(i=d("I64"))).zero,contactType:h.ofNumber(c("LSContactType").UNKNOWN),delivered_watermark_timestamp_ms:i.zero,gender:h.ofNumber(c("LSContactGender").UNKNOWN),is_admin:!1,is_messenger_user:!1,mailbox_type:h.ofNumber(c("LSMailboxType").MESSENGER),name:"",nickname:void 0,profile_picture_url:"",rank:0,read_action_timestamp_ms:i.zero,read_watermark_timestamp_ms:i.zero,secondary_name:void 0,thread_key:i.zero,work_company_name:void 0,work_foreign_entity_info:h.ofNumber(c("LSContactWorkForeignEntityType").UNKNOWN),work_job_title:void 0};function j(a){var b=a[0];a=a[1];var e=b.nickname,f=a.authorityLevel,g=a.blockedByViewerStatus,i=a.contactTypeExact,j=a.firstName,k=a.name,l=a.secondaryName,m=a.waConnectStatus;return{actual_name:k,authority_level:f,blocked_by_viewer_status:g,contact_id:b.contactId,contactType:a.contactType,delivered_watermark_timestamp_ms:b.deliveredWatermarkTimestampMs,gender:a.gender,is_admin:(f=b.isAdmin)!=null?f:!1,is_messenger_user:a.isMessengerUser,mailbox_type:(h||(h=d("LSIntEnum"))).ofNumber(c("LSMailboxType").MESSENGER),name:(g=e!=null?e:j)!=null?g:k,nickname:e,profile_picture_url:c("getLSMediaContactProfilePictureUrl")(a),rank:a.rank,read_action_timestamp_ms:b.readActionTimestampMs,read_watermark_timestamp_ms:b.readWatermarkTimestampMs,secondary_name:d("MWLSContactTypeExactUtils").isIgContact(i)?l:void 0,thread_key:b.threadKey,wa_connect_status:m,work_company_name:a.workCompanyName,work_foreign_entity_info:a.workForeignEntityType,work_job_title:a.workJobTitle}}function a(a,b,c){return d("ReQL").mergeJoin(d("ReQL").fromTableAscending(a.tables.participants).getKeyRange(c),b).map(j)}g.empty=b;g.projectOpen=j;g.getAllInOpenThread=a}),98);
__d("MWLSThreadTitle",["fbt","I64","LSMessagingThreadTypeUtil","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";var i;function j(a){if(a.length>4)return"("+a.length+") "+a.join(", ");else return a.join(", ")}function k(a){switch(a.length){case 0:return c("gkx")("22885")?"":h._(/*BTDS*/"Nenhum participante");case 1:return a[0];case 2:return h._(/*BTDS*/"{participant1} e {participant2}",[h._param("participant1",a[0]),h._param("participant2",a[1])]);case 3:return h._(/*BTDS*/"{participant1}, {participant2} e {participant3}",[h._param("participant1",a[0]),h._param("participant2",a[1]),h._param("participant3",a[2])]);default:return h._(/*BTDS*/"{participant1}, {participant2} e outros {others_count} participantes",[h._param("participant1",a[0]),h._param("participant2",a[1]),h._param("others_count",String(a.length-2))])}}function l(a,b,c,e,f,g,h){h===void 0&&(h=!1);if(a!=null)return a;a=d("LSMessagingThreadTypeUtil").isGroup(e);e=c.filter(function(a){return!(i||(i=d("I64"))).equal(a.contact_id,b)});if(a)return h?j(e.map(f)):k(e.map(f));return c.length!==1?k(e.map(g)):g(c[0])}function a(a,b,c,d,e){e===void 0&&(e=!1);return l(a,b,c,d,function(a){var b=a.name;a=a.nickname;return a!=null?a:b},function(a){var b=a.actual_name;a=a.nickname;return a!=null?a:b},e).toString()}function b(a,b,c,d){return l(a,b,c,d,function(a){a=a.actual_name;return a},function(a){a=a.actual_name;return a}).toString()}function e(a,b,c,d){return l(a,b,c,d,function(a){var b=a.actual_name;a=a.secondary_name;return a!=null?a:b},function(a){var b=a.actual_name;a=a.secondary_name;return a!=null?a:b}).toString()}g.getDefaultThreadTitle=a;g.getThreadTitleWithFullName=b;g.getThreadTitleWithSecondaryNames=e}),226);
__d("getLSMediaThreadPictureUrl",["LSMediaUrlUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=a.threadPictureUrl,c=a.threadPictureUrlExpirationTimestampMs;a=a.threadPictureUrlFallback;c=c;return c!=null&&d("LSMediaUrlUtils").isTimestampExpired(c)?a:b}g["default"]=a}),98);
__d("MWSearchThreadUtils",["I64","LSIntEnum","LSMessageSearchType","MAWChatJid","MWLSParticipant","MWLSThreadTitle","Promise","ReQL","asyncToGeneratorRuntime","getLSMediaContactProfilePictureUrl","getLSMediaThreadPictureUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,e,f){var g=c("getLSMediaThreadPictureUrl")(a);if(g!=null)return(j||(j=b("Promise"))).resolve([g,void 0]);else{a=(g=d("ReQL")).toArrayAsync(g.leftJoin(g.fromTableAscending(f.tables.participants,[]).getKeyRange(a.threadKey),g.fromTableAscending(f.tables.contacts)).map(function(a){a[0];a=a[1];return a}).filter(Boolean));g=a.then(function(a){var b=a.length===1&&(h||(h=d("I64"))).equal(a[0].id,e);return a.sort(function(a,b){return a.rank-b.rank}).filter(function(a){return(h||(h=d("I64"))).equal(a.id,e)?b:!0}).map(function(a){return c("getLSMediaContactProfilePictureUrl")(a)})}).then(function(a){var b=a[0];return b!=null?[b,a[1]]:["",void 0]});return g}}function l(a,b){return d("ReQL").toArrayAsync(d("MWLSParticipant").getAllInOpenThread(b,d("ReQL").fromTableAscending(b.tables.contacts),a.threadKey))}function m(a,b,e,f,g){if((h||(h=d("I64"))).equal(g,(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessageSearchType").MESSAGE))&&f!=null){g=(g=e.find(function(a){return a.contact_id===f.id}))==null?void 0:g.nickname;return g!=null?g:f.name}return d("MWLSThreadTitle").getThreadTitleWithFullName(b.threadName,a,e,b.threadType)}function a(a,b,c,d){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){b=(yield d("MAWChatJid").toThreadKeyMaybe(a.tables,b));return b==null?null:o(a,b,c,e)});return n.apply(this,arguments)}function o(a,b,c,d){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,e){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.threads).getKeyRange(b)));return b==null?null:q(a,b,c,e)});return p.apply(this,arguments)}function q(a,b,c,d){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d,e){a=(yield (j||(j=b("Promise"))).all([k(c,d,a),l(c,a)]));var f=a[0],g=f[0];f=f[1];a=a[1];d=(yield m(d,c,a,void 0,e));return{profilePicUrl:g,secondaryProfilePicUrl:f,threadDisplayName:d,threadKey:c.threadKey,threadType:c.threadType}});return r.apply(this,arguments)}g.getThreadPics=k;g.getThreadParticipants=l;g.getThreadDisplayName=m;g.getThreadDataForSearchResult=a;g.getThreadDataByThreadKey=o}),98);
__d("WABridgedAPI",["IWAAPI"],(function(a,b,c,d,e,f,g){"use strict";b={queryGroups:(a=d("IWAAPI")).makeBridgedApi("queryGroups"),getDevices:a.makeBridgedApi("getDevices"),removeCurrentDevice:a.makeBridgedApi("removeCurrentDevice"),removeDevice:a.makeBridgedApi("removeDevice"),getCurrentUserDeviceList:a.makeBridgedApi("getCurrentUserDeviceList")};c=b;g["default"]=c}),98);
__d("groupBy",[],(function(a,b,c,d,e,f){function a(a,b){return a.reduce(function(a,c){(a[b(c)]=a[b(c)]||[]).push(c);return a},{})}f["default"]=a}),66);
__d("isInstamadilloDYI",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("665")===!0}g["default"]=a}),98);
__d("isMWBumpMessage",["EntMessageReplyType","I64","LSIntEnum"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){return a!=null&&(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("EntMessageReplyType").BUMP))}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("IGDDataclassTypes.flow",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Share:"SHARE",Reply:"REPLY",React:"REACT",Mention:"MENTION"});c=b("$InternalEnum")({Note:"NOTE",Story:"STORY",Profile:"PROFILE",Clip:"CLIP",Feed:"FEED",Live:"LIVE",Comment:"COMMENT",LocationShare:"LOCATION_SHARE",ReelsAudio:"REELS_AUDIO",MediaNote:"MEDIA_NOTE",StoryHighlight:"STORY_HIGHLIGHT",SocialContext:"SOCIAL_CONTEXT"});d=b("$InternalEnum")({Mention:"MENTION",Reply:"REPLY"});f.XmsgIgXmaActionType=a;f.XmsgIgReceiverFetchContentType=c;f.XmsgIgReceiverFetchXmaMediaNoteFetchParamsMessageType=d}),66);
__d("IGDSMusicPanoOutlineIcon.react",["IGDSSVGIconBase.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(3),e;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e=i.jsx("path",{d:"M21.002 16.972V2.044a.999.999 0 0 0-.36-.769 1.009 1.009 0 0 0-.823-.214L7.816 3.293A1 1 0 0 0 7 4.276v11.428a3.701 3.701 0 0 0-1.75-.454A3.75 3.75 0 1 0 8.999 19V9.56L19.002 7.7v6.003a3.701 3.701 0 0 0-1.747-.452 3.75 3.75 0 1 0 3.75 3.75c0-.01-.003-.02-.003-.029ZM5.249 20.75A1.75 1.75 0 1 1 6.999 19a1.752 1.752 0 0 1-1.75 1.75Zm3.75-13.225V5.107l10.003-1.86v2.418Zm8.256 11.225a1.75 1.75 0 1 1 1.747-1.778V17h.003v.001a1.751 1.751 0 0 1-1.75 1.749Z"}),b[0]=e):e=b[0];b[1]!==a?(e=i.jsx(c("IGDSSVGIconBase.react"),babelHelpers["extends"]({},a,{viewBox:"0 0 24 24",children:e})),b[1]=a,b[2]=e):e=b[2];return e}b=i.memo(a);g["default"]=b}),98);
__d("IGDXMAAttachmentUtil",["bx"],(function(a,b,c,d,e,f,g){"use strict";d=c("bx").getURL(c("bx")("13341"));var h=String.fromCodePoint(128293),i=String.fromCodePoint(128546),j=String.fromCodePoint(128079),k=String.fromCodePoint(128558),l=String.fromCodePoint(128514),m=String.fromCodePoint(128525);function a(a){return a!=null?a===h||a===i||a===j||a===k||a===l?!0:a===m:!1}function b(a,b){return a==="xma_ig_comment_action_url"&&b==="xma_ig_comment_media_action_url"}g.DEFAULT_PROFILE_URL=d;g.isEmojiReaction=a;g.isXmaPostComment=b}),98);
__d("LSDatabaseSingletonLazyWrapper",["LSDatabaseSingleton"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return(h||(h=d("LSDatabaseSingleton"))).LSDatabaseSingleton}g["default"]=a}),98);
__d("LSGetIfViewerIsWorkplaceUser",["gkx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,b=a[a.length-1],d=[];return d[0]=c("gkx")("26374"),b.resolve(d)}a.__sproc_name__="LSCoreGetIfViewerIsWorkplaceUserStoredProcedure";a.__tables__=[];b=a;g["default"]=b}),98);
__d("LSLocalizedStrings",["fbt"],(function(a,b,c,d,e,f,g,h){a=function(a,b){switch(a){default:return""}};b=a;g["default"]=b}),98);
__d("LSLocalizedStringsV2",["fbt","I64"],(function(a,b,c,d,e,f,g,h){var i;a=function(a,b){switch(a){case"2285622730":return h._(/*BTDS*/"O Messenger est\u00e1 offline");case"1919524925":return h._(/*BTDS*/"Verifique sua conex\u00e3o. Tudo o que voc\u00ea fizer nos bate-papos enquanto estiver offline, como enviar mensagens ou alterar as cores do bate-papo, ser\u00e1 conclu\u00eddo quando voc\u00ea se conectar \u00e0 internet.");case"14617150":return h._(/*BTDS*/"Usu\u00e1rio do Facebook");case"460740012":return h._(/*BTDS*/"Sua mensagem n\u00e3o foi enviada.");case"2353844300":return h._(/*BTDS*/"Voc\u00ea n\u00e3o pode responder a essa conversa.");case"2987332812":return h._(/*BTDS*/"Voc\u00ea excluiu uma mensagem.");case"1530605193":return h._(/*BTDS*/"{user_name} excluiu uma mensagem.",[h._param("user_name",b(0))]);case"3921131020":return h._(/*BTDS*/"Mensagem oculta");case"1899892426":return h._(/*BTDS*/"Voc\u00ea subiu uma mensagem.");case"3287869262":return h._(/*BTDS*/"{user_name} subiu a mensagem.",[h._param("user_name",b(0))]);case"1890485478":return h._(/*BTDS*/"Voc\u00ea");case"1299547062":return h._(/*BTDS*/"Voc\u00ea enviou uma figurinha.");case"3621454483":return h._(/*BTDS*/"{user_name} enviou uma figurinha.",[h._param("user_name",b(0))]);case"3948960063":return h._(/*BTDS*/"Voc\u00ea enviou um anexo.");case"1249692047":return h._(/*BTDS*/"{user_name} enviou um anexo.",[h._param("user_name",b(0))]);case"2106510577":return h._(/*BTDS*/"Voc\u00ea enviou uma foto.");case"3960370133":return h._(/*BTDS*/"{user_name} enviou uma foto",[h._param("user_name",b(0))]);case"3798396796":return h._(/*BTDS*/"Voc\u00ea enviou um GIF do {app_name}.",[h._param("app_name",b(0))]);case"3388601579":return h._(/*BTDS*/"{user_name} enviou um GIF do {app_name}.",[h._param("user_name",b(0)),h._param("app_name",b(1))]);case"1556712457":return h._(/*BTDS*/"Voc\u00ea enviou um GIF.");case"3601791933":return h._(/*BTDS*/"{user_name} enviou um GIF.",[h._param("user_name",b(0))]);case"3759817031":return h._(/*BTDS*/"Voc\u00ea enviou um v\u00eddeo.");case"2934729541":return h._(/*BTDS*/"{user_name} enviou um v\u00eddeo.",[h._param("user_name",b(0))]);case"392493418":return h._(/*BTDS*/"Voc\u00ea enviou uma mensagem de voz.");case"4085467454":return h._(/*BTDS*/"{user_name} enviou uma mensagem de voz.",[h._param("user_name",b(0))]);case"2738683656":return h._(/*BTDS*/"Voc\u00ea enviou uma figurinha de selfie.");case"2996525642":return h._(/*BTDS*/"{user_name} enviou uma figurinha de selfie.",[h._param("user_name",b(0))]);case"2326868239":return h._(/*BTDS*/"Voc\u00ea compartilhou um post.");case"1001986796":return h._(/*BTDS*/"{user_name} compartilhou um post.",[h._param("user_name",b(0))]);case"2285746939":return h._(/*BTDS*/"Voc\u00ea respondeu a um story.");case"3759448420":return h._(/*BTDS*/"{user_name} respondeu a um story.",[h._param("user_name",b(0))]);case"3719716921":return h._(/*BTDS*/"Voc\u00ea enviou um story.");case"284944921":return h._(/*BTDS*/"{user_name} enviou um story.",[h._param("user_name",b(0))]);case"3322002377":return h._(/*BTDS*/"voc\u00ea mencionou {user_name} no seu story",[h._param("user_name",b(0))]);case"2486550278":return h._(/*BTDS*/"mencionou voc\u00ea no story");case"3557790945":return h._(/*BTDS*/"Voc\u00ea enviou um reel.");case"3756846086":return h._(/*BTDS*/"{user_name} enviou um reel.",[h._param("user_name",b(0))]);case"780378803":return h._(/*BTDS*/"Voc\u00ea enviou um v\u00eddeo do IGTV.");case"3918212613":return h._(/*BTDS*/"{user_name} enviou um v\u00eddeo do IGTV.",[h._param("user_name",b(0))]);case"3161890215":return h._(/*BTDS*/"Voc\u00ea compartilhou uma loja.");case"863428456":return h._(/*BTDS*/"{user_name} compartilhou uma loja.",[h._param("user_name",b(0))]);case"2716405471":return h._(/*BTDS*/"Voc\u00ea enviou um perfil.");case"3909474073":return h._(/*BTDS*/"{user_name} enviou um perfil.",[h._param("user_name",b(0))]);case"1522141193":return h._(/*BTDS*/"Voc\u00ea enviou um destaque dos stories.");case"2804766375":return h._(/*BTDS*/"{user_name} enviou um destaque dos stories.",[h._param("user_name",b(0))]);case"2051792592":return h._(/*BTDS*/"Voc\u00ea enviou um post.");case"3686831438":return h._(/*BTDS*/"{user_name} enviou um post.",[h._param("user_name",b(0))]);case"658804221":return h._(/*BTDS*/"Voc\u00ea enviou um post: {$xma_title}.",[h._param("$xma_title",b(0))]);case"3431774666":return h._(/*BTDS*/"{user_name} enviou um post: {$xma_title}.",[h._param("user_name",b(0)),h._param("$xma_title",b(1))]);case"1390682014":return h._(/*BTDS*/"Voc\u00ea enviou um post de {$xma_author}.",[h._param("$xma_author",b(0))]);case"3338521342":return h._(/*BTDS*/"{user_name} enviou um post de {$xma_author}.",[h._param("user_name",b(0)),h._param("$xma_author",b(1))]);case"1247108605":return h._(/*BTDS*/"Voc\u00ea mencionou {receiver_name} no seu story.",[h._param("receiver_name",b(0))]);case"2966876020":return h._(/*BTDS*/"{user_name} mencionou {receiver_name} no seu story.",[h._param("user_name",b(0)),h._param("receiver_name",b(1))]);case"1056933543":return h._(/*BTDS*/"Voc\u00ea se mencionou no story dele(a).");case"1167688664":return h._(/*BTDS*/"{user_name} mencionou voc\u00ea no story dele(a).",[h._param("user_name",b(0))]);case"772459202":return h._(/*BTDS*/"Voc\u00ea enviou uma atualiza\u00e7\u00e3o do jogo.");case"3546068912":return h._(/*BTDS*/"{user_name} enviou uma atualiza\u00e7\u00e3o do jogo.",[h._param("user_name",b(0))]);case"2459540079":return h._(/*BTDS*/"Voc\u00ea respondeu ao seu story.");case"1596311291":return h._(/*BTDS*/"{user_name} respondeu ao seu story.",[h._param("user_name",b(0))]);case"2253698324":return h._(/*BTDS*/"Voc\u00ea respondeu ao story dessa pessoa.");case"4269602817":return h._(/*BTDS*/"{user_name} respondeu ao pr\u00f3prio story.",[h._param("user_name",b(0))]);case"2552112149":return h._(/*BTDS*/"Voc\u00ea enviou um link de evento.");case"969211470":return h._(/*BTDS*/"{user_name} enviou um link de evento.",[h._param("user_name",b(0))]);case"1257875092":return h._(/*BTDS*/"Voc\u00ea compartilhou um reel.");case"692355749":return h._(/*BTDS*/"{user_name} compartilhou um reel.",[h._param("user_name",b(0))]);case"1760384120":return h._(/*BTDS*/"Voc\u00ea enviou um reel: {$xma_title}.",[h._param("$xma_title",b(0))]);case"3421518928":return h._(/*BTDS*/"{user_name} enviou um reel: {$xma_title}.",[h._param("user_name",b(0)),h._param("$xma_title",b(1))]);case"1843708631":return h._(/*BTDS*/"Voc\u00ea enviou um reel de {$xma_author}.",[h._param("$xma_author",b(0))]);case"493478192":return h._(/*BTDS*/"{user_name} enviou um reel de {$xma_author}.",[h._param("user_name",b(0)),h._param("$xma_author",b(1))]);case"785694792":return h._(/*BTDS*/"Voc\u00ea marcou {receiver_name} no seu post.",[h._param("receiver_name",b(0))]);case"2625447567":return h._(/*BTDS*/"{user_name} marcou {receiver_name} no seu post.",[h._param("user_name",b(0)),h._param("receiver_name",b(1))]);case"3982213805":return h._(/*BTDS*/"Voc\u00ea se marcou no post dele(a).");case"464916028":return h._(/*BTDS*/"{user_name} marcou voc\u00ea no pr\u00f3prio post.",[h._param("user_name",b(0))]);case"411761881":return h._(/*BTDS*/"Voc\u00ea enviou um link.");case"3395044660":return h._(/*BTDS*/"{user_name} enviou um link.",[h._param("user_name",b(0))]);case"1338772678":return h._(/*BTDS*/"Voc\u00ea {$external_xma_link_snippet}.",[h._param("$external_xma_link_snippet",b(0))]);case"2717706487":return h._(/*BTDS*/"{user_name} {$external_xma_link_snippet}.",[h._param("user_name",b(0)),h._param("$external_xma_link_snippet",b(1))]);case"2973334239":return h._(/*BTDS*/"Voc\u00ea enviou uma localiza\u00e7\u00e3o.");case"3616471048":return h._(/*BTDS*/"{user_name} enviou uma localiza\u00e7\u00e3o.",[h._param("user_name",b(0))]);case"476264474":return h._(/*BTDS*/"Voc\u00ea compartilhou um cart\u00e3o de contato.");case"3124021488":return h._(/*BTDS*/"{user_name} compartilhou um cart\u00e3o de contato.",[h._param("user_name",b(0))]);case"3471188061":return h._(/*BTDS*/"Voc\u00ea enviou uma lembran\u00e7a.");case"2776822462":return h._(/*BTDS*/"{user_name} enviou uma lembran\u00e7a.",[h._param("user_name",b(0))]);case"1739999037":return h._(/*BTDS*/"A liga\u00e7\u00e3o de \u00e1udio foi encerrada.");case"3373597599":return h._(/*BTDS*/"A liga\u00e7\u00e3o de v\u00eddeo foi encerrada.");case"259473449":return h._(/*BTDS*/"{user_name} perdeu sua liga\u00e7\u00e3o de \u00e1udio.",[h._param("user_name",b(0))]);case"1338912959":return h._(/*BTDS*/"Voc\u00ea perdeu uma liga\u00e7\u00e3o de \u00e1udio de {user_name}.",[h._param("user_name",b(0))]);case"812940701":return h._(/*BTDS*/"{user_name} perdeu sua liga\u00e7\u00e3o de v\u00eddeo.",[h._param("user_name",b(0))]);case"1099878966":return h._(/*BTDS*/"Voc\u00ea perdeu uma liga\u00e7\u00e3o de v\u00eddeo de {user_name}.",[h._param("user_name",b(0))]);case"3443782102":return h._(/*BTDS*/"A liga\u00e7\u00e3o de \u00e1udio foi iniciada.");case"618905030":return h._(/*BTDS*/"A liga\u00e7\u00e3o de v\u00eddeo come\u00e7ou.");case"2470414797":return h._(/*BTDS*/"Liga\u00e7\u00e3o de \u00e1udio em grupo perdida");case"1306024833":return h._(/*BTDS*/"Liga\u00e7\u00e3o de v\u00eddeo em grupo perdida");case"2135145355":return h._(/*BTDS*/"Voc\u00ea enviou uma localiza\u00e7\u00e3o atual.");case"3603511704":return h._(/*BTDS*/"{user_name} enviou uma localiza\u00e7\u00e3o atual.",[h._param("user_name",b(0))]);case"705614308":return h._(/*BTDS*/"_j{\"*\":\"Voc\\u00ea enviou {number} fotos.\",\"_1\":\"Voc\\u00ea enviou uma foto.\"}",[h._plural((i||(i=d("I64"))).to_float(b(0)),"number")]);case"313217698":return h._(/*BTDS*/"_j{\"*\":\"{user_name} enviou {number} fotos.\",\"_1\":\"{user_name} enviou uma foto.\"}",[h._plural((i||(i=d("I64"))).to_float(b(1)),"number"),h._param("user_name",b(0))]);case"3558654267":return h._(/*BTDS*/"Voc\u00ea enviou v\u00e1rios anexos.");case"3422266740":return h._(/*BTDS*/"{user_name} enviou v\u00e1rios anexos.",[h._param("user_name",b(0))]);case"1907280305":return h._(/*BTDS*/"Responder a {other_user}",[h._param("other_user",b(0))]);case"1112375422":return h._(/*BTDS*/"Responder a {other_user} e outras pessoas",[h._param("other_user",b(0))]);case"3575257287":return h._(/*BTDS*/"{num_messages} novas mensagens",[h._param("num_messages",b(0))]);case"1212518911":return h._(/*BTDS*/"1 bate-papo");case"171771714":return h._(/*BTDS*/"{num_channels} bate-papos",[h._param("num_channels",b(0))]);case"763456386":return h._(/*BTDS*/"1 bate-papo n\u00e3o lido");case"3313483565":return h._(/*BTDS*/"{num_messages} bate-papos n\u00e3o lidos",[h._param("num_messages",b(0))]);case"1416259530":return h._(/*BTDS*/"1 canal");case"1681736754":return h._(/*BTDS*/"{num_channels} canais",[h._param("num_channels",b(0))]);case"3802288555":return h._(/*BTDS*/"1 canal n\u00e3o lido");case"1420387436":return h._(/*BTDS*/"{num_messages} canais n\u00e3o lidos",[h._param("num_messages",b(0))]);case"3321340421":return h._(/*BTDS*/"{other_user} enviou uma mensagem.",[h._param("other_user",b(0))]);case"3199643703":return h._(/*BTDS*/"Aprova\u00e7\u00e3o pendente");case"3307909120":return h._(/*BTDS*/"Vou");case"845728829":return h._(/*BTDS*/"Tenho interesse");case"2022991544":return h._(/*BTDS*/"N\u00e3o tenho interesse");case"4285882723":return h._(/*BTDS*/"Talvez");case"3089015955":return h._(/*BTDS*/"N\u00e3o posso ir");case"2662271323":return h._(/*BTDS*/"Responder");case"1531706844":return h._(/*BTDS*/"Pedir para participar");case"3989800917":return h._(/*BTDS*/"Ver tudo");case"2421884758":return h._(/*BTDS*/"Voc\u00ea subiu sua mensagem");case"2676961947":return h._(/*BTDS*/"Voc\u00ea subiu a mensagem de {participant_name}",[h._param("participant_name",b(0))]);case"3298086032":return h._(/*BTDS*/"{sender_name} subiu sua mensagem",[h._param("sender_name",b(0))]);case"3873263038":return h._(/*BTDS*/"{sender_name} subiu a pr\u00f3pria mensagem",[h._param("sender_name",b(0))]);case"2616853333":return h._(/*BTDS*/"{sender_name} subiu a mensagem de {reply_source_sender_name}",[h._param("sender_name",b(0)),h._param("reply_source_sender_name",b(1))]);case"4002265907":return h._(/*BTDS*/"Voc\u00ea respondeu \u00e0 sua pr\u00f3pria mensagem");case"2663996736":return h._(/*BTDS*/"Voc\u00ea respondeu a {participant_name}",[h._param("participant_name",b(0))]);case"2868699317":return h._(/*BTDS*/"{sender_name} respondeu a voc\u00ea",[h._param("sender_name",b(0))]);case"2688620547":return h._(/*BTDS*/"{sender_name} respondeu a si mesmo(a)",[h._param("sender_name",b(0))]);case"3544071775":return h._(/*BTDS*/"{sender_name} respondeu a {reply_source_sender_name}",[h._param("sender_name",b(0)),h._param("reply_source_sender_name",b(1))]);case"2856734260":return h._(/*BTDS*/"Adicionar");case"3569041084":return h._(/*BTDS*/"Voc\u00ea");case"1640318912":return h._(/*BTDS*/"{user} turned on disappearing messages.",[h._param("user",b(0))]);case"2814174244":return h._(/*BTDS*/"As mensagens tempor\u00e1rias foram ativadas.");case"3475381825":return h._(/*BTDS*/"{preamble} Messages will disappear {time} after they're sent.",[h._param("preamble",b(0)),h._param("time",b(1))]);case"2794389366":return h._(/*BTDS*/"_j{\"*\":\"{number} seconds\",\"_1\":\"1 second\"}",[h._plural((i||(i=d("I64"))).to_float(b(0)),"number")]);case"2528404281":return h._(/*BTDS*/"_j{\"*\":\"{number} minutes\",\"_1\":\"1 minute\"}",[h._plural((i||(i=d("I64"))).to_float(b(0)),"number")]);case"3691614683":return h._(/*BTDS*/"_j{\"*\":\"{number} hours\",\"_1\":\"1 hour\"}",[h._plural((i||(i=d("I64"))).to_float(b(0)),"number")]);case"2356292598":return h._(/*BTDS*/"{user} turned off disappearing messages.",[h._param("user",b(0))]);case"3184734723":return h._(/*BTDS*/"As mensagens tempor\u00e1rias foram desativadas.");case"274842160":return h._(/*BTDS*/"You cleared the chat history");case"2352696798":return h._(/*BTDS*/"Usu\u00e1rio do Workplace");case"261320435":return h._(/*BTDS*/"Bate-papo paralelo");case"1369731110":return h._(/*BTDS*/"Usu\u00e1rio do Facebook");case"216075330":return h._(/*BTDS*/"\u00c1udio de {user_name}",[h._param("user_name",b(0))]);case"3093868587":return h._(/*BTDS*/"Foto de {user_name}",[h._param("user_name",b(0))]);case"1965569930":return h._(/*BTDS*/"V\u00eddeo de {user_name}",[h._param("user_name",b(0))]);case"3981943156":return h._(/*BTDS*/"Figurinha de {user_name}",[h._param("user_name",b(0))]);case"2071149394":return h._(/*BTDS*/"GIF de {user_name}",[h._param("user_name",b(0))]);case"2414298738":return h._(/*BTDS*/"Anexo de {user_name}",[h._param("user_name",b(0))]);case"4050223159":return h._(/*BTDS*/"Voc\u00ea criou um bate-papo paralelo");case"3387070852":return h._(/*BTDS*/"{receiver_name} n\u00e3o aceitou seu pagamento de US$ {amount} em 7 dias, portanto, o valor foi devolvido para voc\u00ea.",[h._param("receiver_name",b(0)),h._param("amount",b(1))]);case"2779070802":return h._(/*BTDS*/"{sender_name} fez uma atualiza\u00e7\u00e3o. Voc\u00ea est\u00e1 recebendo atualiza\u00e7\u00f5es sobre {game_name} nesta thread.",[h._param("sender_name",b(0)),h._param("game_name",b(1))]);case"3748497596":return h._(/*BTDS*/"Voc\u00ea est\u00e1 recebendo atualiza\u00e7\u00f5es sobre {game_name} nesta thread.",[h._param("game_name",b(0))]);case"1346982727":return h._(/*BTDS*/"As pessoas nesta thread est\u00e3o jogando {game_name}. As mensagens foram desativadas para voc\u00ea.",[h._param("game_name",b(0))]);case"3688076717":return h._(/*BTDS*/"{sender_name} fez uma atualiza\u00e7\u00e3o.",[h._param("sender_name",b(0))]);case"194227859":return h._(/*BTDS*/"Voc\u00ea come\u00e7ou uma amizade com {name}. Voc\u00ea pode desativar os bate-papos com novos amigos quando quiser em Configura\u00e7\u00f5es.",[h._param("name",b(0))]);case"3144899881":return h._(/*BTDS*/"Voc\u00ea come\u00e7ou uma amizade com {name}.",[h._param("name",b(0))]);case"3246663081":return h._(/*BTDS*/"Voc\u00eas agora est\u00e3o conectados no Messenger. Voc\u00ea pode desativar os bate-papos com novos amigos quando quiser em Configura\u00e7\u00f5es.");case"967111183":return h._(/*BTDS*/"Voc\u00eas agora est\u00e3o conectados no Messenger.");case"4202164190":return h._(/*BTDS*/"{sender_name} leu o QR code de {receiver_name} para iniciar este bate-papo.",[h._param("sender_name",b(0)),h._param("receiver_name",b(1))]);case"611766379":return h._(/*BTDS*/"{requestor_name} enviou um pedido de contato para {phone_number}, o n\u00famero associado \u00e0 sua conta.",[h._param("requestor_name",b(0)),h._param("phone_number",b(1))]);case"1903578110":return h._(/*BTDS*/"Voc\u00ea aceitou o pedido de contato de {requester_name} para {phone_number}, o n\u00famero associado \u00e0 sua conta.",[h._param("requester_name",b(0)),h._param("phone_number",b(1))]);case"3452051726":return h._(/*BTDS*/"{recipient_name} aceitou seu pedido de contato enviado para {phone_number}.",[h._param("recipient_name",b(0)),h._param("phone_number",b(1))]);default:return""}};b=a;g["default"]=b}),226);
__d("LSLocalize",["I64","LSLocalizedStrings","LSLocalizedStringsV2","LSSynchronousPromise"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("LSLocalizedStringsV2");function a(a){i=a}function j(a,b){a=(h||(h=d("I64"))).to_string(a);var c=function(a){return!b?"":b[a]||""};return i(a,c).toString()}function k(a,b){a=(h||(h=d("I64"))).to_string(a);var e=function(a){return!b?"":b[a]||""};return c("LSLocalizedStrings")(a,e).toString()}function b(a,b){return d("LSSynchronousPromise").maybeMakeSynchronousPromise(k(a,b))}function e(a,b){return d("LSSynchronousPromise").maybeMakeSynchronousPromise(j(a,b))}g.setStringFactoryV2_TEST_ONLY=a;g.localizeV1Async=b;g.localizeV2Async=e}),98);
__d("LSGetThreadParticipantDisplayName",["LSGetIfViewerIsWorkplaceUser","LSLocalize"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return c.storedProcedure(b("LSGetIfViewerIsWorkplaceUser")).then(function(a){return a=a,d[0]=a[0],a})},function(e){return d[0]?c.sequence([function(e){return c.filter(c.db.table(7).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.id,a[1])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(a,e){var f=a.done;a=a.value;return f?c.sequence([function(a){return b("LSLocalize").localizeV2Async(c.i64.cast([0,2352696798]),void 0).then(function(a){return d[4]=a})},function(a){return d[2]=d[4]}]):(e=a.item,d[2]=e.name)})},function(a){return d[1]=d[2]}]):c.sequence([function(b){return c.filter(c.db.table(14).fetch([[[a[0],a[1]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[1])}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[2]=void 0:(b=a.item,d[2]=b.nickname)})},function(e){return c.filter(c.db.table(7).fetch([[[a[1]]]]),function(b){return c.i64.eq(b.id,a[1])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(a,e){var f=a.done;a=a.value;return f?c.sequence([function(a){return d[6]=c.i64.cast([-1,4294967295]),b("LSLocalize").localizeV2Async(c.i64.cast([0,14617150]),void 0).then(function(a){return d[7]=a})},function(a){return d[4]=d[7]}]):(e=a.item,d[4]=e.firstName==null?e.name:e.firstName)})},function(a){return d[1]=d[2]==null?d[4]:d[2]}])},function(a){return e[0]=d[1]}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxGetThreadParticipantDisplayNameStoredProcedure";a.__tables__=["contacts","participants"];e.exports=a}),null);
__d("LSMessageRenderingType",[],(function(a,b,c,d,e,f){a=Object.freeze({DEFAULT:0,NON_COLLAPSIBLE_ADMIN_MESSAGE:1,HIDDEN:2,RICH_TEXT_COMMON_MARK:3});f["default"]=a}),66);
__d("LSQuickReplyType",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,HORIZONTAL:1,VERTICAL:2});f["default"]=a}),66);
__d("LSReplyMessageStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:0,VALID:1,DELETED:2,TEMPORARY_UNAVAILABLE:3,EXPIRED:4});f["default"]=a}),66);
__d("LSVerifyThreadExistsV2",["LSGetViewerFBID","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return[c.i64.cast([0,7]),c.i64.cast([0,8]),c.i64.cast([0,13]),c.i64.cast([0,10]),c.i64.cast([0,11]),c.i64.cast([0,16])].some(function(b){return c.i64.eq(a[1],b)})?c.resolve((b=[!1,!1,!1],d[0]=b[0],d[1]=b[1],d[2]=b[2],b)):c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?(f=[!0,!0,!1],d[3]=f[0],d[4]=f[1],d[5]=f[2],f):(e=b.item,d[12]=e.threadName,d[11]=e.authorityLevel,d[10]=e.threadType,e.folderName==="other"?(f=[!0,!1,!1],d[7]=f[0],d[8]=f[1],d[9]=f[2],f):(c.i64.eq(d[10],c.i64.cast([0,0]))&&c.i64.eq(d[11],c.i64.cast([0,40]))||[c.i64.cast([0,23]),c.i64.cast([0,21]),c.i64.cast([0,18]),c.i64.cast([0,26]),c.i64.cast([0,27])].some(function(a){return c.i64.eq(d[10],a)})&&c.i64.neq(d[11],c.i64.cast([0,20]))&&((d[12]===""?void 0:d[12])===void 0||c.i64.lt(d[11],c.i64.cast([0,80])))||[c.i64.cast([0,151]),c.i64.cast([0,155]),c.i64.cast([0,153])].some(function(a){return c.i64.eq(d[10],a)})||[c.i64.cast([0,24]),c.i64.cast([0,22]),c.i64.cast([0,19]),c.i64.cast([0,25]),c.i64.cast([0,28])].some(function(a){return c.i64.eq(d[10],a)})||[c.i64.cast([0,150]),c.i64.cast([0,154]),c.i64.cast([0,152])].some(function(b){return c.i64.eq(a[1],b)})&&c.i64.lt(d[11],c.i64.cast([0,80]))||[c.i64.cast([0,150]),c.i64.cast([0,154]),c.i64.cast([0,152])].some(function(b){return c.i64.eq(a[1],b)})&&c.i64.eq(a[6],c.i64.cast([0,205]))&&(c.i64.eq(e.syncGroup,void 0)||!1)?(b=[!0,!0,!1],d[13]=b[0],d[14]=b[1],d[15]=b[2],b):(c.i64.ge(d[11],a[4])||c.i64.eq(d[11],c.i64.cast([0,20]))&&([c.i64.cast([0,2]),c.i64.cast([0,202])].some(function(b){return c.i64.eq(a[1],b)})||[c.i64.cast([0,23]),c.i64.cast([0,21]),c.i64.cast([0,18]),c.i64.cast([0,26]),c.i64.cast([0,27])].some(function(b){return c.i64.eq(a[1],b)}))?(f=[!1,!1,!1],d[16]=f[0],d[17]=f[1],d[18]=f[2],f):(e=[!0,!1,!0],d[16]=e[0],d[17]=e[1],d[18]=e[2],e),b=[d[16],d[17],d[18]],d[13]=b[0],d[14]=b[1],d[15]=b[2],b),f=[d[13],d[14],d[15]],d[7]=f[0],d[8]=f[1],d[9]=f[2],f),e=[d[7],d[8],d[9]],d[3]=e[0],d[4]=e[1],d[5]=e[2],e)})},function(a){return a=[d[3],d[4],d[5]],d[0]=a[0],d[1]=a[1],d[2]=a[2],a}])},function(e){return d[0]?(d[3]=new c.Map(),d[3].set("thread_fbid",a[0]),d[3].set("force_upsert",a[5]),d[3].set("use_open_messenger_transport",!1),d[3].set("sync_group",a[6]),d[3].set("metadata_only",a[7]),d[3].set("preview_only",!1),d[4]=d[3].get("thread_fbid"),d[5]=c.toJSON(d[3]),c.storedProcedure(b("LSIssueNewTask"),c.i64.to_string(d[4]),c.i64.cast([0,209]),d[5],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):c.resolve()},function(e){return d[1]?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?c.sequence([function(b){return c.filter(c.db.table(7).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.id,a[0])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(b,e){var a=b.done;b=b.value;return a?d[22]=!1:(e=b.item,d[22]=c.i64.eq(e.contactTypeExact,c.i64.cast([0,16]))?!0:!1)})},function(a){return d[3]=d[22]}]):(e=b.item,d[3]=c.i64.eq(e.threadType,c.i64.cast([0,201]))?!0:!1)})},function(b){return d[5]=c.i64.cast([0,1083495711]),d[6]=c.i64.cast([0,1024]),d[7]=c.i64.cast([0,0]),d[8]=c.i64.cast([0,0]),d[9]=c.i64.cast([0,0]),c.filter(c.db.table(7).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.id,a[0])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(a,b){var e=a.done;a=a.value;return e?d[10]=!1:(b=a.item,d[10]=c.i64.eq(b.contactReachabilityStatusType,c.i64.cast([0,12]))?!0:!1)})},function(b){return d[12]=c.i64.cast([0,1083495711]),d[13]=c.i64.cast([0,1024]),d[14]=c.i64.cast([0,0]),d[15]=c.i64.cast([0,134217728]),d[16]=c.i64.cast([0,0]),d[17]=c.i64.cast([0,8650752]),d[18]=c.i64.cast([0,1024]),d[19]=c.i64.cast([0,0]),d[20]=c.i64.cast([0,0]),d[21]=c.i64.cast([0,0]),c.forEach(c.filter(c.db.table(9).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.lt(b.authorityLevel,a[4])}),function(a){return a["delete"]()})},function(b){return c.db.table(9).add({threadKey:a[0],mailboxType:c.i64.cast([0,0]),threadType:a[1],syncGroup:a[6],folderName:a[2],lastReadWatermarkTimestampMs:c.i64.cast([0,0]),removeWatermarkTimestampMs:c.i64.cast([-1,4294967295]),ongoingCallState:c.i64.cast([0,0]),parentThreadKey:a[3],authorityLevel:a[4],capabilities:d[3]?d[17]:d[12],capabilities2:d[3]?d[18]:d[13],capabilities3:d[3]?d[19]:d[14],capabilities4:d[3]?d[20]:d[15],capabilities5:d[3]?d[21]:d[16],unsendLimitMs:c.i64.cast([-1,4294967295])})},function(e){return[c.i64.cast([0,1]),c.i64.cast([0,201]),c.i64.cast([0,204])].some(function(b){return c.i64.eq(a[1],b)})?c.sequence([function(b){return c.forEach(c.filter(c.db.table(14).fetch([[[a[0],a[0]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,a[0])&&c.i64.lt(b.authorityLevel,a[4])}),function(a){return a["delete"]()})},function(b){return c.db.table(14).add({threadKey:a[0],contactId:a[0],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:a[4],isModerator:!1})},function(a){return c.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,d[22]=a[0],a})},function(b){return c.forEach(c.filter(c.db.table(14).fetch([[[a[0],d[22]]]]),function(b){return c.i64.eq(b.threadKey,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))&&c.i64.eq(b.contactId,d[22])&&c.i64.lt(b.authorityLevel,a[4])}),function(a){return a["delete"]()})},function(b){return c.db.table(14).add({threadKey:a[0],contactId:d[22],readWatermarkTimestampMs:c.i64.cast([0,0]),deliveredWatermarkTimestampMs:c.i64.cast([0,0]),authorityLevel:a[4],isModerator:!1})}]):c.resolve()}]):c.resolve()},function(b){return d[2]?c.forEach(c.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({authorityLevel:a[4]})}):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxVerifyThreadExistsV2StoredProcedure";a.__tables__=["threads","contacts","participants"];e.exports=a}),null);
__d("LSVerifyThreadRowExistsV2",["LSVerifyThreadExistsV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.i64.eq(a[1],c.i64.cast([0,5]))?d[0]=c.i64.cast([-1,4294967284]):d[0]=c.i64.cast([0,0]),c.storedProcedure(b("LSVerifyThreadExistsV2"),a[0],a[1],"inbox",d[0],a[3],!1,a[2],!1,!1)},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxVerifyThreadRowExistsV2StoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSVerifyThreadRowExistsV2StoredProcedure",["LSSynchronousPromise","LSVerifyThreadRowExistsV2","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSVerifyThreadRowExistsV2"),e.threadKey,e.threadType,e.syncGroup,e.authorityLevel);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("usePolarisFadeTransition",["react-compiler-runtime","react-spring-wwwig"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("react-compiler-runtime").c(5),c=a.duration;a=a.show;var e,f,g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(e={opacity:1},f={opacity:0},g={opacity:0},b[0]=e,b[1]=f,b[2]=g):(e=b[0],f=b[1],g=b[2]);b[3]!==c?(e=babelHelpers["extends"]({enter:e,from:f,leave:g},c!=null?{config:{duration:c}}:{}),b[3]=c,b[4]=e):e=b[4];return d("react-spring-wwwig").useTransition(a,e)}g["default"]=a}),98);
__d("usePolarisPanAndZoom",["react-compiler-runtime","react-spring-wwwig"],(function(a,b,c,d,e,f,g){"use strict";var h={friction:40,mass:5,tension:350};function a(a,b,c,e){var f=d("react-compiler-runtime").c(9),g=c===void 0?!1:c;f[0]!==e?(c=e===void 0?[]:e,f[0]=e,f[1]=c):c=f[1];e=c;f[2]!==b||f[3]!==g||f[4]!==a?(c=function(){return{config:b!=null?b:h,from:a,immediate:g,reset:!0,to:a}},f[2]=b,f[3]=g,f[4]=a,f[5]=c):c=f[5];c=d("react-spring-wwwig").useSpring(c,e);e=c[0];c=c[1];var i;f[6]!==c||f[7]!==e?(i={set:c,style:e},f[6]=c,f[7]=e,f[8]=i):i=f[8];return i}g["default"]=a}),98);
__d("PolarisIGAnimate",["PolarisIGAnimated.react","usePolarisFadeTransition","usePolarisPanAndZoom"],(function(a,b,c,d,e,f){"use strict";f.Animated=importDefault("PolarisIGAnimated.react"),f.useFadeTransition=importDefault("usePolarisFadeTransition"),f.usePanAndZoom=importDefault("usePolarisPanAndZoom")}),66);
__d("PolarisMediaOptionsMenuQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9734455919955854"}),null);
__d("focusKeyboardEventPropagation",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a._stopFocusKeyboardPropagation===!0}function b(a){a._stopFocusKeyboardPropagation=!0}f.hasFocusKeyboardEventPropagationStopped=a;f.stopFocusKeyboardEventPropagation=b}),66);/*FB_PKG_DELIM*/
__d("EncryptedBackupUploadFailureFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5728");b=d("FalcoLoggerInternal").create("encrypted_backup_upload_failure",a);e=b;g["default"]=e}),98);
__d("MAWClientConsistencyRefresh",["ClientConsistencyEventEmitter","CurrentAppID"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(d("CurrentAppID").getAppID()){case 772021112871879:c("ClientConsistencyEventEmitter").emit("hardRefresh",a);break;default:c("ClientConsistencyEventEmitter").emit("softRefresh",a)}}g["default"]=a}),98);
__d("MAWWorkerOnClose",["MAWSetupWorkerAuxStateForLogging","MAWWaitForBackendSetup","MAWWebWorkerSingleton","QPLUserFlow","pageID","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h=c("qpl")._(1056841865,"2862");function a(a,b,e){c("QPLUserFlow").start(h,{annotations:{string:{currentWorkerId:d("MAWWaitForBackendSetup").getCurrentWorkerID(),pageID:c("pageID"),terminationMsgType:b,terminationReason:a,workerID:e},string_array:{pastWorkerTerminationMsgTypes:d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes,pastWorkerTerminationReasons:d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons}}})}function b(a){c("promiseDone")(d("MAWWebWorkerSingleton").getWorkerHealthStatus(),function(b){return c("QPLUserFlow").endSuccess(h,{annotations:{bool:babelHelpers["extends"]({},b.data),string:{healthStatusAfter:b.tag,outcome:a}}})})}function e(a,b){c("promiseDone")(d("MAWWebWorkerSingleton").getWorkerHealthStatus(),function(d){return c("QPLUserFlow").endFailure(h,a,{annotations:{bool:babelHelpers["extends"]({},d.data),string:{healthStatusAfter:d.tag}},error:b})})}g.ON_WORKER_CLOSED_HANDLER_QPL=h;g.startQPL=a;g.success=b;g.fail=e}),98);
__d("MAWWorkerWatchdog",["MAWBridgeLoggingUtils","MAWBridgeSendAndReceive","MAWSetupWorkerAuxStateForLogging","MAWWaitForBackendSetup","MAWWebWorkerSingleton","MAWWorkerWatchdogRecovery","Promise","QPLUserFlow","err","gkx","justknobx","promiseDone","qpl","setInterval","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h,i=c("gkx")("12962"),j=c("justknobx")._("4240"),k=j/2,l=c("qpl")._(1056847415,"2909"),m=!1,n=!1,o=["shared_not_exists","shared_exists_not_connected"];function p(){var a;c("QPLUserFlow").start(l,{annotations:{bool:{workerTerminatedPermanently:(a=d("MAWSetupWorkerAuxStateForLogging")).WorkerLifeCycleState.workerTerminatedPermanently},"int":{workerAge:a.WorkerLifeCycleState.getWorkerAge()},string:{currentWorkerId:d("MAWWaitForBackendSetup").getCurrentWorkerID()},string_array:{pastWorkerTerminationMsgTypes:a.WorkerLifeCycleState.restartMessageTypes,pastWorkerTerminationReasons:a.WorkerLifeCycleState.restartReasons}}});return(h||(h=b("Promise"))).race([d("MAWBridgeSendAndReceive").sendAndReceive("backend",d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE),new h(function(a,b){c("setTimeout")(function(){b(c("err")("Armadillo web worker heartbeat timed out."))},k)})]).then(function(){c("QPLUserFlow").endSuccess(l),d("MAWSetupWorkerAuxStateForLogging").addWorkerHeartbeatToHistory("OK")},function(a){c("gkx")("13566")&&q(),d("MAWSetupWorkerAuxStateForLogging").addWorkerHeartbeatToHistory("ERROR"),c("promiseDone")(d("MAWWebWorkerSingleton").getWorkerHealthStatus(),function(b){return c("QPLUserFlow").endFailure(l,"heartbeat_timeout",{annotations:{bool:babelHelpers["extends"]({},b.data),string:{workerHealthStatus:b.tag}},error:a})})})}function q(){c("QPLUserFlow").addPoint(l,"starting-lock-based-recovery"),c("promiseDone")(d("MAWWebWorkerSingleton").getWorkerHealthStatus().then(function(a){var b=d("MAWWorkerWatchdogRecovery").getWorkerRecoveryForWatchdog(),c=d("MAWWaitForBackendSetup").getCurrentWorkerID();if(o.includes(a.tag)&&b!=null)return b("locks_based_recovery",c,"locks_based_recovery")}))}function a(){if(n||!i)return;c("setInterval")(function(){if(!m)return;c("promiseDone")(p())},j);d("MAWWaitForBackendSetup").runAfterBackendSetup(function(){m=!0},d("MAWBridgeLoggingUtils").HEARTBEAT_ROUTE);n=!0}g.HEARTBEAT_TIMEOUT_INTERVAL=k;g.MAW_WORKER_HEARTBEAT_QPL=l;g.startWatchdog=a}),98);
__d("MAWSetupWorker",["CurrentAppID","Deferred","IGDWebUtils","MAWBridgeObserver","MAWClientConsistencyRefresh","MAWCommonSetupWorker","MAWCrossWorkerPortal","MAWInit","MAWLoggerUtils","MAWMIC","MAWSetupWorkerAuxStateForLogging","MAWUnrecoverableDbErrors","MAWWaitForBackendSetup","MAWWebWorkerSingleton","MAWWorkerOnClose","MAWWorkerWatchdog","MWFBLogger","QPLUserFlow","SharedWorkerBundleResource","SharedWorkerV2ResourceExperimental","asyncToGeneratorRuntime","cr:6600","gkx","promiseDone","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Shared worker responded to termination request: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker terminating: for ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker doesn't exist, no need to terminate"]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["backend setup successful"]);k=function(){return a};return a}function l(){var a=babelHelpers.taggedTemplateLiteralLoose(["bridge promise resolved"]);l=function(){return a};return a}function m(){var a=babelHelpers.taggedTemplateLiteralLoose(["worker setting up with reason: ",", use shared worker: ",""]);m=function(){return a};return a}var n=function(){return c("gkx")("8512")},o=d("MWFBLogger").MWLogger.tags([d("MAWLoggerUtils").Tag.WorkerSetup,d("MAWLoggerUtils").Tag.MAWInit]),p=d("IGDWebUtils").isInstagramWebSupportedApp(Number(d("CurrentAppID").getAppID())),q=p?"IGDAWMainWorker":"MAWMainWorker",r=null,s=!1;function t(a){s=a,d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.workerTerminatedPermanently=a}function u(){return s}function v(a){switch(a){case"mawInit":return!0;case"mawReinitSetupMutex":case"mawReinitReregDevice":case"bridgeRecovery":case"workerUpgraded":case"rebootRequired":case"workerTerminated":default:return!1}}function w(a,b,c,d,e,f){return x.apply(this,arguments)}function x(){x=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g,h,i){if(u())throw o.mustfixThrow("Worker is permanently killed.");d("MAWWaitForBackendSetup").markBackendSetupStarted();var j=function(b){return w(a,e,f,g,b,i)};(h==="bridgeRecovery"||h==="backendSetupFailure")&&c("QPLUserFlow").addPoint(d("MAWBridgeObserver").BAD_STATE_RECOVERY_QPL,"create_worker_start");d("MAWWebWorkerSingleton").setOnCloseForWorkerInstance(function(a,b,e){d("MAWWorkerOnClose").startQPL(a,e,b);var f=a!=null?a:"unknown",g=G(f)&&d("MAWWaitForBackendSetup").isBackendSetupSettled();d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons.push(f);d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes.push(e!=null?e:"unknown");if(d("MAWWaitForBackendSetup").getCurrentWorkerID()==null||b!==d("MAWWaitForBackendSetup").getCurrentWorkerID()){d("MAWInit").MAWInit.logPoint(f+"_worker_termination_skipped");d("MAWMIC").addPoint(f+"_worker_termination_skipped");d("MAWWorkerOnClose").success(f+"_worker_restart_skipped");o.warn("Worker termination skipped %s. Terminate reason: %s, Worker: %s, current worker: %s",h,a,b,d("MAWWaitForBackendSetup").getCurrentWorkerID());return}d("MAWWaitForBackendSetup").resetCurrentWorkerSkipIdCheck();o.warn("Worker termination started %s. Terminate reason: %s, Worker: %s",h,a,b);d("MAWInit").MAWInit.logPoint(f+"_worker_terminated");d("MAWMIC").addPoint(f+"_worker_terminated");d("MAWInit").MAWInit.addStringArrayAnnotation("workerTerminationReason",d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons);d("MAWMIC").addStringArrayAnnotation("workerTerminationReason",d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartReasons);d("MAWInit").MAWInit.addStringArrayAnnotation("workerTerminationMsgType",d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes);d("MAWMIC").addStringArrayAnnotation("workerTerminationMsgType",d("MAWSetupWorkerAuxStateForLogging").WorkerLifeCycleState.restartMessageTypes);var i=a==="requested-upgrade"?"workerUpgraded":f+"_worker_terminated";a==="requested-upgrade"||n()?c("promiseDone")(E(),function(){if(g){t(!0);o.warn("Tab displays soft refresh. Flow: %s",f);d("MAWInit").MAWInit.logPoint(f+"_soft_refresh");d("MAWMIC").addPoint(f+"_soft_refresh");c("MAWClientConsistencyRefresh")("maw_request_refresh");d("MAWWorkerOnClose").success("softRefresh");return}if(f!=="logout")return j(i).then(function(){return d("MAWWorkerOnClose").success(i)})["catch"](function(a){d("MAWInit").MAWInit.fail("worker_restart_failed",a),d("MAWWorkerOnClose").fail("workerUpgradeFailed",a),d("MAWWaitForBackendSetup").rejectBackendSetup(a)});else d("MAWWorkerOnClose").success("skip_logout")}):d("MAWWorkerOnClose").success("skip_workerLifeCycleCrossTabsDisabledGK")});var p=(yield d("MAWWebWorkerSingleton").createWorkerIfNone(h)),s=p.worker;p=p.workerID;d("MAWWaitForBackendSetup").setCurrentWorker(p);p=new(c("Deferred"))();r=p.getPromise();(h==="bridgeRecovery"||h==="backendSetupFailure")&&c("QPLUserFlow").addPoint(d("MAWBridgeObserver").BAD_STATE_RECOVERY_QPL,"create_worker_end");var v=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();o.DEBUG(m(),h,v);v&&s.addEventListener("message",function(a){var b;typeof a.data==="object"&&((b=a.data)==null?void 0:b.type)==="sw-shutdown"&&typeof a.data.response==="object"&&((b=a.data.response)==null?void 0:b.reason)==="maw-request-refresh"&&c("MAWClientConsistencyRefresh")("maw_request_refresh")});var x=new(d("MAWCommonSetupWorker").BridgeAdapter)(s,q);yield e(x);p.resolve(x);o.DEBUG(l());d("MAWMIC").addPoint(h+"_connect_to_backend");yield d("MAWInit").MAWInit.measurePerformance(h+"-init_backend",b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=function(){return d("MAWCommonSetupWorker").initWorker({bridge:x,onWorkerAlreadySetup:f,onWorkerRestart:j,reason:h,vaultMaterials:a})};b=v?yield b():yield x.fullyConnected.then(b);d("MAWWaitForBackendSetup").resolveBackendSetup(b);o.DEBUG(k())}));return d("MAWWaitForBackendSetup").waitForBackendSetup("setup-worker")});return x.apply(this,arguments)}function a(a,b,e,f,g,h){var i=w(a,b,e,f,g,h);v(g)&&c("promiseDone")(d("MAWWaitForBackendSetup").waitForBackendSetup("init bridge recovery observer").then(function(){d("MAWBridgeObserver").initUnackedMessagesObserver({onConnectToExistingWorker:e,onTerminateWorker:f,onWorkerConnect:b,updateWorkerState:h,vaultMaterials:a}),d("MAWWorkerWatchdog").startWatchdog()}));return i}function e(){return r}function y(a){return z.apply(this,arguments)}function z(){z=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){o.debug("Terminating dedicated worker: %s. Bridge Promise: %s",a,!!r);if(!r){o.DEBUG(j());return!1}o.DEBUG(i(),a);yield E();return!0});return z.apply(this,arguments)}function f(){return A.apply(this,arguments)}function A(){A=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield y("terminateWorkerPermanently"),t(!0)});return A.apply(this,arguments)}function B(a,e){var f=c("gkx")("7313");return f?d("SharedWorkerV2ResourceExperimental").terminateSharedWorker(b("cr:6600"),a?"maw-request-refresh":e!=null?e:"unknown"):d("SharedWorkerBundleResource").terminateSharedWorker(b("cr:6600"),null,a?"maw-request-refresh":e!=null?e:"unknown")}function C(a){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker();if(b){o.debug("Terminating shared worker: %s",a);b=(yield B(!1,a).then(function(){return!0},function(){return!1}));o.DEBUG(h(),b);n()||(yield E())}else yield y(a)});return D.apply(this,arguments)}function E(){return F.apply(this,arguments)}function F(){F=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a;o.debug("Updating worker state on termination");(a=(yield r))==null?void 0:a.close();r=null;d("MAWWaitForBackendSetup").resetBackendSetup();d("MAWCrossWorkerPortal").killPortalWhenWorkerTerminating();d("MAWWebWorkerSingleton").resetWorkerCreation()});return F.apply(this,arguments)}function G(a){if(a==="MAWEARKeychainDecryptionError"||d("MAWUnrecoverableDbErrors").isUnrecoverableDbErrorByName(a))return!0;return a==="update-required-fbid_change"||a==="update-required-vault_materials_change"?!0:!1}g.setPreventWorkerRestart=t;g.getOrSetupWorker=a;g.waitForWorkerSetup=e;g.terminateDedicatedWorker=y;g.terminateWorkerPermanently=f;g.killSharedWorker=B;g.terminateWorker=C}),98);
__d("MAWWorkerReboot",["FBLogger","MAWBridgeObserver","MAWSetupWorker","MAWWaitForBackendSetup","ODS","Promise","QPLUserFlow","pageID","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){(i||(i=d("ODS"))).bumpEntityKey(3185,"armadillo_shared_worker_reboot","shared_worker_reboot_"+a)}var k=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker(),l=function(a){switch(a){case"bridge_recovery":return"bridgeRecovery";case"backend_setup_failure":return"backendSetupFailure"}};function a(a,e,f,g,i,m){c("QPLUserFlow").start(d("MAWBridgeObserver").BAD_STATE_RECOVERY_QPL,{annotations:{bool:{isSharedWorker:k},string:{trigger:i,workerInitPageID:c("pageID")}}});c("FBLogger")("messenger_web").info("Rebooting worker started.");j("start");d("MAWWaitForBackendSetup").resetBackendSetup();var n=l(i);c("QPLUserFlow").addPoint(d("MAWBridgeObserver").BAD_STATE_RECOVERY_QPL,"terminate_worker_start");return new(h||(h=b("Promise")))(function(b,h){return d("MAWSetupWorker").terminateWorker(n).then(function(){c("QPLUserFlow").addPoint(d("MAWBridgeObserver").BAD_STATE_RECOVERY_QPL,"terminate_worker_end");c("FBLogger")("messenger_web").info("Reboot process killed existing worker successfully.");return d("MAWSetupWorker").getOrSetupWorker(a,e,f,g,n,m).then(function(a){c("FBLogger")("messenger_web").info("Rebooting worker success. Reason for reboot: %s",n),j("success"),c("QPLUserFlow").endSuccess(d("MAWBridgeObserver").BAD_STATE_RECOVERY_QPL),e(a),b()})})["catch"](function(a){c("FBLogger")("messenger_web").info("Rebooting worker failed. Error message: %s",a.message),j("fail"),c("QPLUserFlow").endFailure(d("MAWBridgeObserver").BAD_STATE_RECOVERY_QPL,a.message),d("MAWWaitForBackendSetup").rejectBackendSetup(a),h(a)})})}g.rebootWorker=a}),98);
__d("MAWBridgeObserver",["FBLogger","MAWWaitForBackendSetup","MAWWorkerReboot","promiseDone","qex","qpl"],(function(a,b,c,d,e,f,g){"use strict";a=c("qpl")._(1056840252,"808");var h=5,i=[],j=!1,k,l=function(){i=[]};b=function(a){if(!o())return;if(d("MAWWaitForBackendSetup").isBackendSetupInProgress()){l();return}if(n().length>=h&&!d("MAWWaitForBackendSetup").isBackendSetupInProgress()){c("FBLogger")("messenger_web").info("Minimum threshold of unacked messages reached: %s. Unacked messages: %s",h,JSON.stringify(n()));var b=c("qex")._("440"),e=c("qex")._("468")||h;b===!0&&n().length>=e?(c("FBLogger")("messenger_web").info("QE threshold of unacked messages reached: %s. Unacked messages: %s",h,JSON.stringify(n())),l(),c("promiseDone")(m())):(c("FBLogger")("messenger_web").info("Bridge recovery attempt skipped. Reason for skipped: maw_bridge_recovery_v2_enabled: %s, maw_bridge_recovery_threshold: %s",b,e),i.push(a))}else i.push(a)};var m=function(){c("FBLogger")("messenger_web").info("Starting bridge recovery attempt.");return d("MAWWorkerReboot").rebootWorker(k.vaultMaterials,k.onWorkerConnect,k.onConnectToExistingWorker,k.onTerminateWorker,"bridge_recovery",k.updateWorkerState).then(function(){c("FBLogger")("messenger_web").info("Bridge recovery attempt successful. Worker has restarted.")},function(a){c("FBLogger")("messenger_web").info("Bridge recovery attempt failed. Worker has failed to restart. Error: %s",a.message);throw a})};e=function(a){j=!0,k=a};var n=function(){return i},o=function(){return j};f=function(){return k};g.BAD_STATE_RECOVERY_QPL=a;g.MIN_UNACKED_EVENTS_THRESHOLD=h;g.resetUnackedMessages=l;g.notifyUnackedEvent=b;g.attemptRecovery=m;g.initUnackedMessagesObserver=e;g.getUnackedMessages=n;g.getIsObserverActive=o;g.getProps=f}),98);
__d("MAWGetDBVersionForTest",["justknobx"],(function(a,b,c,d,e,f,g){"use strict";function a(){if(!c("justknobx")._("1495"))return;var a=new URL(document.location.href);a=a.searchParams.get("db_version");if(a==null)return;if(a==="current"||a==="latest")return a;a=parseInt(a,10);if(Number.isInteger(a))return Number(a)}g.getDbVersionForTest=a}),98);
__d("MAWCommonSetupWorker",["Deferred","FBLogger","MAWCurrentUser","MAWGetDBVersionForTest","MAWInit","MAWMIC","MAWSetupWorker","MAWWaitForBackendSetup","MAWWebWorkerSingleton","MessengerWebInitData","Promise","WADevToolMessageChannel","WALogger","WorkerClient","WorkerMessagePort","err","gkx","pageID","promiseDone","shouldUseMAWSharedWorker"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Terminating worker and rebooting..."]);i=function(){return a};return a}var j=c("gkx")("3282");e=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c){var e;e=a.call(this,b,c)||this;e.onmessage=null;e.$BridgeAdapter$p_1=b;d("WorkerClient").init(babelHelpers.assertThisInitialized(e));e.onUnhandledMessage.add(function(a){e.onmessage&&e.onmessage({data:a})});e.addMessageListener("worker-setup",function(a){a.status==="worker-ready"&&d("MAWInit").MAWInit.addBoolAnnotation("workerReadyReceived",!0)});return e}var c=b.prototype;c.getBridgePort=function(){return this};return b}(d("WorkerMessagePort").WorkerSyncedMessagePort);function a(a){var b=a.bridge,e=a.reason,f=a.vaultMaterials,g=new(c("Deferred"))();b.addMessageListener("worker-setup",function(b){return k(a,g,b)});b.addMessageListener("worker-setup-ack",function(a){return l(a,e)});n(b,f);c("promiseDone")(d("MAWWebWorkerSingleton").doesWorkerExist(),function(a){return d("MAWInit").MAWInit.addBoolAnnotation("workerExistsOnSetup",a)});c("promiseDone")(d("MAWWebWorkerSingleton").getWorkerHealthStatus(),function(a){return d("MAWInit").MAWInit.addStringAnnotation("workerHealthStatus",a.tag)});return g.getPromise()}function k(a,b,e){var f;if(e.setupHash!==c("pageID"))return;switch(e.status){case"success":b.resolve(a.bridge.getBridgePort());break;case"failure":b.reject(c("err")((f=e.msg)!=null?f:"Error setting up worker"));break;case"already-setup":return m(a,b,e);default:d("MAWInit").MAWInit.addBoolAnnotation("invalidSetupMessageReceived",!0);throw c("FBLogger")("messenger_web").mustfixThrow("Invalid message for worker: "+e.status)}}function l(a,b){if(a.setupHash!==c("pageID"))return;d("MAWInit").MAWInit.logPoint(b+"_backend_setup_ack");d("MAWMIC").addPoint(b+"_backend_setup_ack");a=(b=a.backendState)!=null?b:"none";d("MAWInit").MAWInit.addStringAnnotation("backendAckState",a);d("MAWMIC").addStringAnnotation("backendAckState",a)}function m(a,e,f){var g=a.bridge,j=a.onWorkerAlreadySetup,k=a.onWorkerRestart;a=a.reason;switch(f.action){case"no-action":e.resolve(g.getBridgePort());j();d("MAWInit").MAWInit.logPoint(a+"_backend_already_setup");d("MAWMIC").addPoint(a+"_backend_already_setup");break;case"reboot-required":d("WALogger").DEV(i());d("MAWMIC").addPoint(a+"_worker_rebooting");d("MAWInit").MAWInit.logPoint(a+"_worker_rebooting");j=(g=f==null?void 0:f.reason)!=null?g:"none";d("MAWInit").MAWInit.addStringAnnotation("workerRebootReason",j);d("MAWMIC").addStringAnnotation("workerRebootReason",j);a=d("shouldUseMAWSharedWorker").shouldUseMAWSharedWorker()?(h||(h=b("Promise"))).resolve(d("MAWWaitForBackendSetup").resetCurrentWorkerWithId(d("MAWWaitForBackendSetup").getCurrentWorkerID())):d("MAWSetupWorker").terminateDedicatedWorker("reboot required");return a.then(function(){return k("rebootRequired").then(function(a){return e.resolve(a)})["catch"](function(a){return e.reject(a)})});default:f.action;throw c("FBLogger")("messenger_web").mustfixThrow("Invalid action for worker-setup:already-setup: "+f.action)}}function n(a,b){b={content:{createdAt:c("MessengerWebInitData").createdAt,fbId:d("MAWCurrentUser").getID(),sessionId:c("MessengerWebInitData").sessionId,testDbVersion:d("MAWGetDBVersionForTest").getDbVersionForTest(),userKeyBase:c("MessengerWebInitData").userKeyBase,vaultMaterials:b},setupHash:c("pageID"),type:"worker-setup"};if(j){d("MAWInit").MAWInit.addBoolAnnotation("devToolsEnabled",!0);var e=d("WADevToolMessageChannel").createNewChannel();b.content.devToolMessageChannelPort2=e.port2;a.postMessage(b,[e.port2])}else a.postMessage(b)}g.BridgeAdapter=e;g.initWorker=a}),98);
__d("MAWDefaultE2eeOneToOneEligibility",["LSContactBitOffset"],(function(a,b,c,d,e,f,g){"use strict";function a(a){a=a.maybeContact;a=a!=null&&d("LSContactBitOffset").has(83,a);return a}g.isContactDefaultE2eeOneToOneEligible=a}),98);
__d("MAWMainThreadLogger",["CurrentMessengerUser","FBLogger","MAWAppVersion","MAWConsoleLogger","MAWDeleteOldLogsFromDisk","MAWLeakDetection","MAWLoggerUtils","MAWLoggingSwitches","MAWSaveLogToDisk","Promise","WAJids","WATagsLogger","asyncToGeneratorRuntime","err","getErrorSafe","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=!1;function a(){i=!1}function e(){i||(i=!0,d("WATagsLogger").initializeWaLogger(t))}var j=function(){return c("FBLogger")("messenger_web")};function k(a,b){a=l(a);a!=null&&d("MAWLoggerUtils").logToHistory("log",a,b,!1)}function l(a){if(!d("CurrentMessengerUser").isEmployee()&&!d("CurrentMessengerUser").isTestUser())return;a=d("WAJids").maybeSanitizeLogLineText(a);a=d("MAWLeakDetection").maybeReplaceVaultedString(a);return a}function f(a,b){a=d("WAJids").maybeSanitizeLogLineText(a);a=d("MAWLeakDetection").maybeReplaceVaultedString(a);d("MAWLoggerUtils").logToHistory("log",a,b,!1)}function m(a,b){a=d("WAJids").maybeSanitizeLogLineText(a);a=d("MAWLeakDetection").maybeReplaceVaultedString(a);d("MAWLoggerUtils").logToHistory("log",a,b,!1)}function n(a,b){a=d("WAJids").maybeSanitizeLogLineText(a);a=d("MAWLeakDetection").maybeReplaceVaultedString(a);j().tags(b.map(function(a){return String(a)})).warn(a)}function o(a,b,d,e,f,g){d=c("err")(d);d.stack=e;c("promiseDone")(r(a,b,d,f,g))}function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){a=d("MAWLeakDetection").maybeReplaceVaultedString(d("WAJids").maybeSanitizeLogLineText(a));var e=d("MAWLoggingSwitches").removeLoggingFromBridge?d("MAWSaveLogToDisk").getLastNEntries(c):(h||(h=b("Promise"))).resolve([]);c=c===0?[]:[].concat((yield e).map(function(a){return a.args}));return{logs:[].concat(c),sanitizedMessage:a}});return q.apply(this,arguments)}function r(a,b,c,d,e){return s.apply(this,arguments)}function s(){s=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,f,g){a=d("MAWLeakDetection").maybeReplaceVaultedString(d("WAJids").maybeSanitizeLogLineText(a));a=e!=null?e:c("err")(a);f=f!=null?f:e==null?2:0;e=g!=null?g:0;g=(yield p(a.message,e));e=g.logs;g=g.sanitizedMessage;var h=c("getErrorSafe")(a);try{a.message=g}catch(b){h=c("err")(g,a.fileName,a.lineNumber)}f!==0&&(h.framesToPop=f);(a=j())==null?void 0:(f=a.addMetadata("MESSENGER_E2EE_WEB","APP_VERSION",d("MAWAppVersion").getVersionNumber()).tags(b.map(function(a){return String(a)})).catching(h)).mustfix.apply(f,[g].concat(e))});return s.apply(this,arguments)}var t={count:function(a,b){d("MAWConsoleLogger").logToConsole("count",a,b)},debug:function(a,b){d("MAWConsoleLogger").logToConsole("log",a,b)},devConsole:function(a,b,c){for(var e=arguments.length,f=new Array(e>3?e-3:0),g=3;g<e;g++)f[g-3]=arguments[g];switch(a){case"COUNT":d("MAWConsoleLogger").logToConsole.apply(void 0,["count",b,c].concat(f));break;case"DEV":d("MAWConsoleLogger").logToConsole.apply(void 0,["log",b,c].concat(f));break;case"DEV_XMPP":d("MAWConsoleLogger").logToConsole.apply(void 0,["log",b,c].concat(f));break;case"LOG":d("MAWConsoleLogger").logToConsole.apply(void 0,["info",b,c].concat(f));break;case"WARN":d("MAWConsoleLogger").logToConsole.apply(void 0,["warn",b,c].concat(f));break;case"ERROR":d("MAWConsoleLogger").logToConsole.apply(void 0,["error",b,c].concat(f));break;case"CATCHING":d("MAWConsoleLogger").logToConsole.apply(void 0,["error",b,c].concat(f));break}},error:function(a,b,e){c("promiseDone")(r(a,b,e)),d("MAWConsoleLogger").logToConsole("error",a,b)},info:function(a,b){m(a,b),d("MAWConsoleLogger").logToConsole("info",a,b)},logRestricted:function(a,b){k(a,b),d("MAWConsoleLogger").logToConsole("log",a,b)},warn:function(a,b){n(a,b),d("MAWConsoleLogger").logToConsole("warn",a,b)}};function u(){return!d("MAWLoggingSwitches").removeLoggingFromBridge?(h||(h=b("Promise"))).resolve([]):d("MAWSaveLogToDisk").getEntriesFromDb()}function v(){return w.apply(this,arguments)}function w(){w=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){if(!d("MAWLoggingSwitches").removeLoggingFromBridge)return;yield d("MAWDeleteOldLogsFromDisk").clearLogs()});return w.apply(this,arguments)}function x(a){return new Date(typeof a==="string"?parseInt(a,10):a).toISOString().replace("T"," ").replace("Z","")}function y(a){return a.map(function(a){try{var b=x(a.date);return[b,a.level,a.category,a.event,a.args].join(" | ")}catch(a){return[x(Date.now()),"error","LOGGER","Error formatting log: "+((a==null?void 0:a.message)||"")].join(" | ")}}).filter(Boolean).join("\n")}g.__testClearLoggerSetup=a;g.setupMainWaLogger=e;g.logRestricted=k;g.count=f;g.info=m;g.warn=n;g.logError=o;g.getEntries=u;g.clearEntries=v;g.formatEntries=y}),98);
__d("MWGetOtherContactOrSelf",["I64","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield d("ReQL").toArrayAsync(d("ReQL").fromTableAscending(c.tables.participants).getKeyRange(a)));if(a.length===1){var e=a[0];return d("ReQL").firstAsync(d("ReQL").fromTableAscending(c.tables.contacts).getKeyRange(e.contactId))}if(a.length>2)return;e=a.find(function(a){return!(h||(h=d("I64"))).equal(a.contactId,b)});if(e!=null)return d("ReQL").firstAsync(d("ReQL").fromTableAscending(c.tables.contacts).getKeyRange(e.contactId))});return i.apply(this,arguments)}g.getOtherContactOrSelf=a}),98);
__d("hasDefaultThreadOneToOneCapability",["FBLogger","LSContactBitOffset","MAWDefaultE2eeOneToOneEligibility","MWGetOtherContactOrSelf","ReQL","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(a==null)return!1;var e=(yield d("ReQL").firstExnAsync(d("ReQL").fromTableAscending(b.tables._user_info).map(function(a){return a.facebookUserId}))),f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.tables.contacts).getKeyRange(e)));if(f==null){c("FBLogger")("messenger_search").warn("Error fetching viewer details");return!1}f=d("LSContactBitOffset").has(80,f);if(!f)return!1;f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(b.tables.contacts).getKeyRange(a)));a=(yield d("MWGetOtherContactOrSelf").getOtherContactOrSelf(a,e,b));e=a!=null?a:f;return d("MAWDefaultE2eeOneToOneEligibility").isContactDefaultE2eeOneToOneEligible({maybeContact:e})});return h.apply(this,arguments)}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("MAWCacheServiceDB",["FBLogger","MAWCurrentUser","MAWIndexedDbMetadata","MAWWormOdsLogger","MessengerWebInitData","Promise","WAHex","Worm","WormDump","WormEAR","WormIDbDriver","asyncToGeneratorRuntime","promiseDone","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h;f={autoIncrement:!0,indexes:{key:{fields:["key"],unique:!0}},primaryKey:"id",secure:!0};var i={snippets:f},j=null,k=function(a,b,e){var f="maw_cache_service";b=new(d("WormEAR").WormEAR)(e,f,b);a=new(d("WormIDbDriver").WormIDbDriver)(a,f,e,b,d("MAWWormOdsLogger").wormOdsWorkerLogger,{onTransactionError:m});return new(d("Worm").WormDatabase)(a,c("qpl")._(1056840657,"2716"))};function l(){if(j!==null)return j;j=new(h||(h=b("Promise")))(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){try{var e=k(d("MAWIndexedDbMetadata").MAWcacheServiceDbName(d("MAWCurrentUser").getID()),d("WAHex").parseHex(c("MessengerWebInitData").accountKeyV2),i);yield e.init();a(e)}catch(a){c("FBLogger")("messenger_web").catching(a).mustfix("Failed to create cache service DB"),j=null,b(a)}});return function(b,c){return a.apply(this,arguments)}}());return j}function m(a){if(a instanceof d("WormEAR").DecryptionError){var b=a;c("FBLogger")("MAWCacheService").mustfix("EAR decryption error in store: %s. Attempting to delete the store:",b.store);c("promiseDone")(l().then(function(a){return a.runInTransaction([b.store],"readwrite",function(a){return a.stores[b.store].clear()},"delete-corrupted-entity")}).then(function(){c("FBLogger")("MAWCacheService").info("Successfully deleted corrupted store %s",b.store)})["catch"](function(a){c("FBLogger")("MAWCacheService").catching(a).mustfix("Failed to delete corrupted store %s, err: %s",b.store,a.message)}))}}function a(a){return a.map(function(a){a[0];a=a[1];return a})}function e(){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=(yield l());return a.dump({snippets:{customFields:{id:d("WormDump").wormNonSensitiveField,key:d("WormDump").wormNonSensitiveField,timestamp:d("WormDump").wormNonSensitiveField,value:function(a){var b;return{snippet:(b=d("WormDump")).wormRedact(a.snippet),snippetMsgAckLevel:b.wormNonSensitiveField(a.snippetMsgAckLevel),snippetMsgId:b.wormNonSensitiveField(a.snippetMsgId),snippetNewestIncomingMsgs:b.wormNonSensitiveField(a.snippetNewestIncomingMsgs),snippetReactionId:b.wormRedact(a.snippetReactionId)}}}}})});return n.apply(this,arguments)}g.getOrSetupMAWCacheDB=l;g.convertCacheValueToDBRawValue=a;g.getDbDump=e}),98);
__d("MAWCacheServiceBase",["MAWCacheServiceDB","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=new Map(),this.namespace=a}var c=a.prototype;c.$2=function(a){return(a=this.$1.get(a))!=null?a:null};c.updateInMemoryCache=function(a,b){this.$1.set(a,b)};c.updateInMemoryCacheBulk=function(a){var b=this;a.forEach(function(a){var c=a[0];a=a[1];b.updateInMemoryCache(c,a)})};c.getValueFromCache=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=this,c=this.$2(a);if(c!=null)return c;c=(yield d("MAWCacheServiceDB").getOrSetupMAWCacheDB());c=(yield c.runInTransaction([this.namespace],"readonly",function(c){return c.stores[b.namespace].getByIndex("key",[a])},"read_from_persisted_"+this.namespace));if(c==null)return null;c.id;c=babelHelpers.objectWithoutPropertiesLoose(c,["id"]);this.updateInMemoryCache(a,c);return c});function c(b){return a.apply(this,arguments)}return c}();return a}();g["default"]=a}),98);
__d("MAWCacheServiceQPL",["ExecutionEnvironment","MAWCurrentUser","MAWQplProxy","QPLUserFlow","performanceAbsoluteNow","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=new Set(),k=new Set(),l=3e3,m=c("qpl")._(1056836703,"2955");function a(a,b){var e=(h||(h=c("ExecutionEnvironment"))).isInWorker||(h||(h=c("ExecutionEnvironment"))).isInSharedWorker;if(e){if(k.has(a))return;o(a);d("MAWQplProxy").startQplUserFlow(m,{},{callBridgeWithTimestamp:!0,providedInstanceKey:a})}else{if(j.has(a))return;n(a);c("QPLUserFlow").start(m,{annotations:{string:{service:b}},instanceKey:a})}}function n(a){j.add(a)}function o(a){k.add(a)}function b(a,b,e){var f=q(e),g=(h||(h=c("ExecutionEnvironment"))).isInWorker||(h||(h=c("ExecutionEnvironment"))).isInSharedWorker;if(g){if(!k.has(a))return;d("MAWQplProxy").sendQplPointThroughBridge(m,"worker@"+f+b,{instanceKey:a},!0)}else{if(!j.has(a))return;var n=(i||(i=c("performanceAbsoluteNow")))();e==="realtime-update"?window.setTimeout(function(){c("QPLUserFlow").addPoint(m,"ui@"+b,{instanceKey:a,timestamp:n})},l):c("QPLUserFlow").addPoint(m,"ui@"+b,{instanceKey:a})}}function e(a,b){var e=(h||(h=c("ExecutionEnvironment"))).isInWorker||(h||(h=c("ExecutionEnvironment"))).isInSharedWorker;if(e){if(!k.has(a))return;d("MAWQplProxy").sendQPLAnnotationsThroughBridge(m,b,a)}else{if(!j.has(a))return;c("QPLUserFlow").addAnnotations(m,b,{instanceKey:a})}}function f(a){var b=(h||(h=c("ExecutionEnvironment"))).isInWorker||(h||(h=c("ExecutionEnvironment"))).isInSharedWorker;if(b){if(!k.has(a))return;k["delete"](a);d("MAWQplProxy").sendQPLSuccessThroughBridge(m,{},a,!0)}else{if(!j.has(a))return;var e=(i||(i=c("performanceAbsoluteNow")))();window.setTimeout(function(){j["delete"](a),c("QPLUserFlow").endSuccess(m,{instanceKey:a,timestamp:e})},l)}}function p(a,b,e){e=q(e);var f=(h||(h=c("ExecutionEnvironment"))).isInWorker||(h||(h=c("ExecutionEnvironment"))).isInSharedWorker;if(f){if(!k.has(a))return;d("MAWQplProxy").sendQPLFailThroughBridge(m,"worker@"+e+b,{},a,!0)}else{if(!j.has(a))return;var g=(i||(i=c("performanceAbsoluteNow")))();window.setTimeout(function(){j["delete"](a),c("QPLUserFlow").endFailure(m,"ui@"+b,{instanceKey:a,timestamp:g})},l);j["delete"](a)}}function q(a){return a?a.replace(/-/g,"_")+"_":""}function r(a){return d("MAWCurrentUser").isEmployee()||d("MAWCurrentUser").isTestUser()?a:void 0}e={addAnnotationsQPL:e,addPointQPL:b,endFailureQPL:p,endSuccessQPL:f,redactKeysForNonEmployee:r,registerInstanceKeyInUI:n,registerInstanceKeyInWorker:o,startQPL:a};g["default"]=e}),98);
__d("MAWCacheServiceUtils",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";var h="maw_cache_service_broadcast",i=typeof window!=="undefined"?window:self;d=function(){if(!i.BroadcastChannel){c("FBLogger")("messenger_e2ee_web").warn("BroadcastChannel is not supported in this browser");return null}return new i.BroadcastChannel(h)};e={concurrency:1,maxConcurrency:1,maxThrottleMs:500};function a(a){return"maw-cache-service-"+a}function b(a,b){var c=new Set(),d=[];a.forEach(function(a){var e=b(a);if(c.has(e)){d.push(a);return}c.add(e)});return d}g.MAW_CACHE_SERVICE_BROADCAST_CHANNEL=h;g.getMAWCacheServiceBroadcastChannel=d;g.SCHEDULER_CONFIG=e;g.getSchedulerName=a;g.findDuplicates=b}),98);
__d("MAWSnippetsCacheServiceUtils",["I64","MAWDbMsgOrReaction","MAWUpdateThreadBumpTimestamp"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReactionNullish(a,{forMessage:function(a){return{msgAckLevel:a.ack,msgId:a.msgId,reactionId:void 0,timestamp:a.sortOrderMs!=null?a.sortOrderMs:(h||(h=d("I64"))).to_float(d("MAWUpdateThreadBumpTimestamp").getBumpTimestampMs(a))}},forNull:function(){return{msgAckLevel:void 0,msgId:void 0,reactionId:void 0,timestamp:Number.MIN_SAFE_INTEGER}},forReaction:function(a){return{msgAckLevel:void 0,msgId:void 0,reactionId:a.reactionId,timestamp:(h||(h=d("I64"))).to_float(d("MAWUpdateThreadBumpTimestamp").getBumpTimestampMs(a))}}})}g.getMsgOrReactionIdAndTimestamp=a}),98);
__d("MAWSnippetsCacheCalculateDelta",["FBLogger","MAWDbMsgOrReaction","MAWGetThreadUpdateType","MAWSnippetsCacheServiceUtils","MAWUpdateThreadListItemUtils"],(function(a,b,c,d,e,f,g){"use strict";var h="[SnippetsCacheService][Worker]";function a(a){var b=new Set(a.map(function(a){var b;b=(b=a.decryptedValues)!=null?b:[];a=(a=a.deletedValues)!=null?a:[];return[].concat(b,a)}).flat().map(function(a){return d("MAWUpdateThreadListItemUtils").isOptimisticMessage(a)?null:a.msgId}).filter(Boolean));return a.reduce(function(a,c){var d=c.type==="delete"?c.deletedValues:c.decryptedValues;d=l(d);d=m(b,d);if(d.length===0)return a;d.forEach(function(b){var d=b.threadJid,e=a.get(d);b=k({type:c.type,value:b},e);a.set(d,b)});return a},new Map())}function b(a){return a.some(function(a){a.chatJid;a.lastComputedCacheValue;a=a.mutateReq;return!i(a)||j(a.value)})}function i(a){return a.type==="delete"||a.type==="deleteRange"||d("MAWUpdateThreadListItemUtils").isXMAThreadSnippet(a.value)||p(a.value)||q(a.value)?!1:!0}function j(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(a){return!1},forReaction:function(a){return a.reaction!=null&&d("MAWGetThreadUpdateType").canReactionAffectBump(a)}})}function k(a,b){if(b==null)return a;var c=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(a.value);c=c.timestamp;var e=a.value.externalId,f=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(b.value);f=f.timestamp;var g=b.value.externalId;if(c===f){if(a.type==="delete"||a.type==="deleteRange")return a;else if(b.type==="delete"||b.type==="deleteRange")return b;return e.localeCompare(g)>0?a:b}if(c==null)return b;return f==null?a:c>f?a:b}function l(a){return a==null||a.length===0?[]:a.filter(function(a){return n(a)})}function m(a,b){return b.reduce(function(b,c){var e=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(c);e=e.msgId;return e!=null&&d("MAWUpdateThreadListItemUtils").isOptimisticMessage(c)&&a.has(e)?b:[].concat(b,[c])},[])}function n(a){var b=o(a)&&!d("MAWUpdateThreadListItemUtils").isSpamMessage(a);b||r(a);return b}function o(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(b){return d("MAWGetThreadUpdateType").isThreadUpdateTypeEligibleForSnippet(a)},forReaction:function(b){return d("MAWGetThreadUpdateType").canReactionAffectBump(b)&&p(b)||d("MAWGetThreadUpdateType").isThreadUpdateTypeEligibleForSnippet(a)}})}function p(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(a){return!1},forReaction:function(a){return a.reaction==null}})}function q(a){return d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a,{forMessage:function(a){return a.ephemeralMsgDisappeared===!0},forReaction:function(a){return!1}})}function r(a){a=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(a);var b=a.msgId;a=a.reactionId;c("FBLogger")("MAWCacheService").info(h+" msg or reaction is not eligible for snippet update, msgId: %s, reactionId: %s",b,a)}g.parseAndGetMostRecentSnippetUpdateMutateRequestForChatJids=a;g.isDbTransactionRequiredForSnippetUpdate=b;g.canCalculateSnippetUpdateFromDelta=i;g.isNeededToCheckMessageExistence=j}),98);
__d("MAWSnippetsCacheService",["FBLogger","MAWAckLevel","MAWCacheServiceBase","MAWDbMsgOrReaction","MAWDbMsgTxns","MAWDexieTable","MAWGetThreadUpdateType","MAWIndexedDb","MAWMessagesCompare","MAWSnippetsCacheCalculateDelta","MAWSnippetsCacheServiceUtils","MAWThreadNewestMsgOrReactionUtils","MAWThreadSnippetBuildTxns","MAWThreadSnippetUtils","MAWTransactionMode","MAWUpdateThreadListItemUtils","MAWVault","MWThreadListConsts","Promise","WAJids","asyncToGeneratorRuntime","qex"],(function(a,b,c,d,e,f,g){"use strict";var h,i=["messages","reactions"],j="[SnippetsCacheService][Worker]";a=function(a){babelHelpers.inheritsLoose(e,a);function e(){return a.call(this,"snippets")||this}var f=e.prototype;f.$MAWSnippetsCacheService$p_1=function(a){var c=this;a=a.filter(function(a){a=a[0];return i.includes(a)});a=d("MAWSnippetsCacheCalculateDelta").parseAndGetMostRecentSnippetUpdateMutateRequestForChatJids(a.map(function(a){a[0];a=a[1];return a}));return(h||(h=b("Promise"))).all(Array.from(a.entries()).map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a[0];a=a[1];var d=(yield c.getValueFromCache(b));return{chatJid:b,lastComputedCacheValue:d,mutateReq:a}});return function(b){return a.apply(this,arguments)}}()))};f.calculateDelta=function(a){var c=this;return this.$MAWSnippetsCacheService$p_1(a).then(function(a){if(a.length===0)return(h||(h=b("Promise"))).resolve([]);if(d("MAWSnippetsCacheCalculateDelta").isDbTransactionRequiredForSnippetUpdate(a)){var e;return d("MAWIndexedDb").makeMsgrTransactor({messages:(e=d("MAWTransactionMode")).READONLY,reactions:e.READONLY,threads:e.READONLY,xma:e.READONLY},"MAWSnippetsCacheService:calculateDelta",function(a){return function(b){return c.$MAWSnippetsCacheService$p_2(a,b)}})(a)}else return c.$MAWSnippetsCacheService$p_3(a)})};f.computeCachePayloadFromScratch=function(a){var b=this,c;return d("MAWIndexedDb").makeMsgrTransactor({messages:(c=d("MAWTransactionMode")).READONLY,reactions:c.READONLY,threads:c.READONLY,xma:c.READONLY},"MAWSnippetsCacheService:computeCachePayloadFromScratch",function(a){return function(c){return d("MAWDexieTable").dexieAll(c.map(function(c){c=d("WAJids").unsafeCoerceToChatJid(c);return b.$MAWSnippetsCacheService$p_4(a,c,"from-scratch")})).then(function(a){return a.filter(Boolean)})}})(a)};f.$MAWSnippetsCacheService$p_5=function(a,b){if(b==null)return"no-value-calculated-from-scratch";if(d("MAWUpdateThreadListItemUtils").isOptimisticMessage(a.value))return null;a=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(a.value);var c=a.msgAckLevel,e=a.msgId,f=a.reactionId;a=a.timestamp;if(a==null)return"missing-timestamp";if(e!=null&&e===b.value.snippetMsgId)return null;if(f!=null&&f===b.value.snippetReactionId)return null;return e!=null&&c!==d("MAWAckLevel").ACK.received&&b.value.snippetMsgAckLevel===d("MAWAckLevel").ACK.clock?"optimistic-snippet-in-cache":a<b.timestamp?"older-than-last-snippet-value":null};f.$MAWSnippetsCacheService$p_6=function(a,b){var e;if(a.type!=="add")return!1;e=(e=c("qex")._("1213"))!=null?e:!1;return!e?!1:d("MAWDbMsgOrReaction").switchOnMsgOrReaction(a.value,{forMessage:function(a){var c;if(a.sortOrderMs==null||!d("MAWThreadNewestMsgOrReactionUtils").filterForSnippetNewestIncomingMessages(d("MAWGetThreadUpdateType").getThreadUpdateTypeForMsg(a),a.ephemeralMsgDisappeared===!0))return!1;c=b==null?void 0:(c=b.value)==null?void 0:c.snippetNewestIncomingMsgs;if(c==null||c.length<d("MWThreadListConsts").SNIPPET_MAX_NEWEST_INCOMING_MESSAGES_COUNT)return!0;c=c[c.length-1];if(c==null||c.sortOrderMs==null)return!0;var e=d("MAWMessagesCompare").getSortComparisonFunctionForDirection("desc");return e({externalId:c.externalId,sortOrderMs:c.sortOrderMs},{externalId:a.externalId,sortOrderMs:a.sortOrderMs})>0},forReaction:function(a){return!1}})};f.$MAWSnippetsCacheService$p_7=function(a,b){b={externalId:b.value.externalId,sortOrderMs:b.value.sortOrderMs};if(a==null)return[b];var c=d("MAWMessagesCompare").getSortComparisonFunctionForDirection("desc");a=[].concat(a,[b]).sort(c).slice(0,d("MWThreadListConsts").SNIPPET_MAX_NEWEST_INCOMING_MESSAGES_COUNT);return a};f.shouldDropDelta=function(a){var c=this;return this.$MAWSnippetsCacheService$p_1(a).then(function(a){return a.length===0?(h||(h=b("Promise"))).resolve(!0):(h||(h=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.chatJid,d=a.lastComputedCacheValue;a=a.mutateReq;if(c.$MAWSnippetsCacheService$p_6(a,d))return!1;d=(yield c.$MAWSnippetsCacheService$p_5(a,d));if(d!=null){l({dropReason:d,key:b,msgOrReaction:a.value,operation:a.type});return!0}return!1});return function(b){return a.apply(this,arguments)}}())).then(function(a){if(a.every(function(a){return a===!0}))return!0;else return!1})})};f.$MAWSnippetsCacheService$p_4=function(a,b,c){var e=this;return d("MAWThreadSnippetUtils").getThreadSnippetFromScratch(a,b).then(function(a){a=e.$MAWSnippetsCacheService$p_8(b,a,c);return a==null?void 0:d("MAWDexieTable").dexieResolve([b,a])})};f.$MAWSnippetsCacheService$p_3=function(a){var b=this;return a.map(function(a){var c=b.$MAWSnippetsCacheService$p_9(a);return c==null?void 0:[a.chatJid,c]}).filter(Boolean)};f.$MAWSnippetsCacheService$p_2=function(a,b){var c=this;return d("MAWDexieTable").dexieAll(b.map(function(b){return!d("MAWSnippetsCacheCalculateDelta").canCalculateSnippetUpdateFromDelta(b.mutateReq)?c.$MAWSnippetsCacheService$p_4(a,b.chatJid,"realtime-from-scratch"):c.$MAWSnippetsCacheService$p_10(a,b.mutateReq.value).then(function(a){if(a)return void 0;a=c.$MAWSnippetsCacheService$p_9(b);return a==null?void 0:d("MAWDexieTable").dexieResolve([b.chatJid,a])})})).then(function(a){return a.filter(Boolean)})};f.$MAWSnippetsCacheService$p_9=function(a){var b;b=(b=c("qex")._("1213"))!=null?b:!1;if(b)return this.$MAWSnippetsCacheService$p_11(a);b=d("MAWThreadSnippetBuildTxns").buildThreadSnippetForMsgOrIncomingReaction(a.chatJid,a.mutateReq.value);b=this.$MAWSnippetsCacheService$p_8(a.chatJid,{snippet:b,snippetMsgOrReaction:a.mutateReq.value},"realtime-calculate-delta");return b};f.$MAWSnippetsCacheService$p_11=function(a){var b=a.chatJid,c=a.lastComputedCacheValue;a=a.mutateReq;var e=this.$MAWSnippetsCacheService$p_6(a,c),f=this.$MAWSnippetsCacheService$p_5(a,c)==null;e=e?this.$MAWSnippetsCacheService$p_7(c==null?void 0:(e=c.value)==null?void 0:e.snippetNewestIncomingMsgs,a):c==null?void 0:c.value.snippetNewestIncomingMsgs;if(!f&&c!=null)return babelHelpers["extends"]({},c,{value:babelHelpers["extends"]({},c.value,{snippetNewestIncomingMsgs:e})});f=d("MAWThreadSnippetBuildTxns").buildThreadSnippetForMsgOrIncomingReaction(b,a.value);c=this.$MAWSnippetsCacheService$p_8(b,{snippet:f,snippetMsgOrReaction:a.value,snippetNewestIncomingMsgsMetadata:e},"realtime-calculate-delta");return c};f.$MAWSnippetsCacheService$p_8=function(a,b,c){if(b==null){k({flow:c,key:a,threadSnippetResult:b});return void 0}var e=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(b.snippetMsgOrReaction),f=e.msgAckLevel,g=e.msgId,h=e.reactionId;e=e.timestamp;k({flow:c,key:a,msgAckLevel:f,msgId:g,reactionId:h,threadSnippetResult:b,timestamp:e});if(e==null)return void 0;c=babelHelpers["extends"]({},b.snippet.snippetParams,{strings:b.snippet.snippetParams.strings.map(function(a){return d("MAWVault").unvault(a)})});return{key:a,timestamp:e,value:{snippet:babelHelpers["extends"]({},b.snippet,{snippetParams:c}),snippetMsgAckLevel:f,snippetMsgId:g,snippetNewestIncomingMsgs:b.snippetNewestIncomingMsgsMetadata,snippetReactionId:h}}};f.$MAWSnippetsCacheService$p_10=function(a,b){if(!d("MAWSnippetsCacheCalculateDelta").isNeededToCheckMessageExistence(b))return d("MAWDexieTable").dexieResolve(!1);b=d("MAWDbMsgOrReaction").switchOnMsgOrReaction(b,{forMessage:function(a){return null},forReaction:function(a){return a.reactToMsgId}});return b==null?d("MAWDexieTable").dexieResolve(!0):d("MAWDbMsgTxns").getMsgsByMsgIds(a,[b]).then(function(a){return a.length===0})};return e}(c("MAWCacheServiceBase"));function k(a){var b=a.flow,d=a.key,e=a.msgAckLevel,f=a.msgId,g=a.reactionId,h=a.threadSnippetResult;a=a.timestamp;if(h==null){c("FBLogger")("MAWCacheService").warn(j+"["+b+"] Failed to calculate thread snippet, key: %s",d);return}if(a==null){c("FBLogger")("MAWCacheService").warn(j+"["+b+"] No timestamp found for the thread snippet, key: %s,\n      msgId: %s, reactionId: %s",d,f,g);return}c("FBLogger")("MAWCacheService").info(j+"["+b+"] Snippet successfully calculated, key: %s,\n    timestamp: %s, msgId: %s, reactionId: %s, ack level %s",d,a,f,g,e)}function l(a){var b=a.dropReason,e=a.key,f=a.msgOrReaction;a=a.operation;f=d("MAWSnippetsCacheServiceUtils").getMsgOrReactionIdAndTimestamp(f);var g=f.msgAckLevel,h=f.msgId,i=f.reactionId;f=f.timestamp;c("FBLogger")("MAWCacheService").info(j+" Drop update for msg or reaction, reason: %s, key: %s, msgId: %s, reactionId: %s, timestamp: %s, ackLevel: %s, operation: %s",b,e,h,i,f,g,a)}var m=new a();e=function(){return m};g.getMAWSnippetsCacheService=e}),98);
__d("MAWWorkerCacheServiceRegistry",["MAWSnippetsCacheService"],(function(a,b,c,d,e,f,g){"use strict";var h={snippets:d("MAWSnippetsCacheService").getMAWSnippetsCacheService()};function a(){return h}g.getWorkerRegistry=a}),98);
__d("MAWWorkerCacheServices",["FBLogger","MAWBridge","MAWCacheServiceDB","MAWCacheServiceQPL","MAWCacheServiceUtils","MAWLoggerUtils","MAWWorkerCacheServiceRegistry","Promise","WorkerScheduler","asyncToGeneratorRuntime","cr:2354"],(function(a,b,c,d,e,f,g){"use strict";var h,i=function(){function a(){this.$1=d("MAWCacheServiceUtils").getMAWCacheServiceBroadcastChannel();var a=d("MAWWorkerCacheServiceRegistry").getWorkerRegistry();this.registry=a;this.schedulerRegistry=Object.keys(a).reduce(function(a,b){return babelHelpers["extends"]({},a,(a={},a[b]=d("WorkerScheduler").makeScheduler(d("MAWCacheServiceUtils").getSchedulerName(b),d("MAWCacheServiceUtils").SCHEDULER_CONFIG),a))},{})}var e=a.prototype;e.$2=function(a,b,c,e){b={cache:b,instanceKey:e,namespace:a,source:c};this.$1==null?d("MAWBridge").getBridge().fireAndForget("event","broadcastChannelFallback",{event:{data:b},namespace:d("MAWCacheServiceUtils").MAW_CACHE_SERVICE_BROADCAST_CHANNEL}):this.$1.postMessage(b)};e.$3=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){var h=d("MAWCacheServiceUtils").findDuplicates(e,function(a){var b=a[0];a[1];return b});h.length>0&&(c("FBLogger")("MAWCacheService").mustfix("Found duplicate keys in cache: %s. Original keys: %s, Namespace: %s, Source: %s",h.map(function(a){var b=a[0];a[1];return b}).join(", "),e.map(function(a){var b=a[0];a[1];return b}).join(", "),a,f),g!=null&&c("MAWCacheServiceQPL").addAnnotationsQPL(g,{bool:{hasDuplicateKeys:!0},string_array:{duplicateKeys:c("MAWCacheServiceQPL").redactKeysForNonEmployee(h.map(function(a){var b=a[0];a[1];return b}))}}));if(e.length===0){g!=null&&(c("MAWCacheServiceQPL").addPointQPL(g,"nothing_to_update_in_cache",f),c("MAWCacheServiceQPL").endSuccessQPL(g));return}g!=null&&c("MAWCacheServiceQPL").addPointQPL(g,"updating_cache_in_persisted_start",f);h=this.registry[a];h.updateInMemoryCacheBulk(e);try{var i=d("MAWCacheServiceDB").convertCacheValueToDBRawValue(e);h=(yield d("MAWCacheServiceDB").getOrSetupMAWCacheDB());yield h.runInTransaction([a],"readwrite",function(b){var c=i.map(function(a){return{item:a,selector:[a.key]}});return b.stores[a].bulkUpsert("key",c)},"update_cache_"+a);f==="realtime-update"&&(b("cr:2354")==null?void 0:b("cr:2354").notifyCacheWrite(i.map(function(a){a=a.key;return a})));g!=null&&c("MAWCacheServiceQPL").addPointQPL(g,"updating_cache_in_persisted_end",f)}catch(a){g!=null&&(c("MAWCacheServiceQPL").addAnnotationsQPL(g,{string:{error:a.message}}),c("MAWCacheServiceQPL").addPointQPL(g,"updating_cache_in_persisted_failed",f)),c("FBLogger")("MAWCacheService").catching(a).mustfix("Failed to update persisted cache")}g!=null&&c("MAWCacheServiceQPL").addPointQPL(g,"broadcasting_to_ui_start",f);this.$2(a,e,f,g)});function e(b,c,d,e){return a.apply(this,arguments)}return e}();e.calculateDelta=function(a){var e=this,f=Object.values(this.registry).map(function(b){var f=b.shouldDropDelta(a);return f.then(function(f){if(f)return;f=e.schedulerRegistry[b.namespace];return f.runTask({fn:function(){return b.calculateDelta(a).then(function(a){var f=a.map(function(a){var b=a[0];a[1];return b}),g=d("MAWLoggerUtils").getInstanceKey();a.length!==0&&(c("MAWCacheServiceQPL").startQPL(g,b.namespace),c("MAWCacheServiceQPL").addAnnotationsQPL(g,{bool:{isRealtimeUpdate:!0},"int":{instanceKey:g},string_array:{realtimeUpdatedKeys:f}}));return e.$3(b.namespace,a,"realtime-update",g)})["catch"](function(a){c("FBLogger")("MAWCacheService").catching(a).warn("Failed to calculate delta for: %s",b.namespace)})},name:"maw_calculate_delta",priority:d("WorkerScheduler").REGULAR_PRIORITY})})});(h||(h=b("Promise"))).all([].concat(f))["catch"](function(a){c("FBLogger")("MAWCacheService").catching(a).mustfix("Failed to calculate delta for all services")})};e.computeCachePayloadFromScratch=function(a,b,e,f){var g=this;f!=null&&c("MAWCacheServiceQPL").registerInstanceKeyInWorker(f);c("MAWCacheServiceQPL").addPointQPL(f,"compute_from_scratch_start",e);c("MAWCacheServiceQPL").addAnnotationsQPL(f,{string_array:{keysReceivedInWorker:c("MAWCacheServiceQPL").redactKeysForNonEmployee(b)}});var h=this.registry[a],i=this.schedulerRegistry[h.namespace];if(h==null)throw c("FBLogger")("messenger_web").mustfixThrow("No service found for namespace: "+a);return i.runTask({fn:function(){return h.computeCachePayloadFromScratch(b).then(function(b){c("MAWCacheServiceQPL").addPointQPL(f,"compute_from_scratch_end",e);return g.$3(a,b,e,f)})["catch"](function(a){c("MAWCacheServiceQPL").endFailureQPL(f,"compute_from_scratch_failed",e),c("FBLogger")("MAWCacheService").catching(a).warn("Failed to compute cache payload from scratch")})},name:"maw_compute_cache_payload_from_scratch",priority:d("WorkerScheduler").REGULAR_PRIORITY})};return a}(),j=null;a=function(){j==null&&(j=new i());return j};g.getMAWWorkerCacheServices=a}),98);
__d("MAWCacheServiceMiddleware",["FBLogger","MAWIndexedDb","MAWMpsGating","MAWWorkerCacheServices"],(function(a,b,c,d,e,f,g){"use strict";var h=["messages","reactions"],i=["messages","reactions"];function j(a,b,c){var d,e=c.trans,f=(d=(d=e._transactorMeta)==null?void 0:d.mawCacheServiceAccumulatedRequests)!=null?d:[];if(c.type==="delete"&&i.includes(b.name))return m(a,b.name,c).then(function(a){a=babelHelpers["extends"]({},c,{deletedValues:a});f.push([b.name,a]);e._transactorMeta=babelHelpers["extends"]({},e._transactorMeta,{mawCacheServiceAccumulatedRequests:f});return b.mutate(c)});d=babelHelpers["extends"]({},c,{decryptedValues:c.values?c.values:void 0});f.push([b.name,d]);e._transactorMeta=babelHelpers["extends"]({},e._transactorMeta,{mawCacheServiceAccumulatedRequests:f});return b.mutate(c)}function k(a){var b=a.trans;if(((a=b._transactorMeta)==null?void 0:a.mawCacheServiceAfterTransactionScheduled)===!0)return;d("MAWIndexedDb").afterTransactionEffect(function(){var a;a=(a=(a=b._transactorMeta)==null?void 0:a.mawCacheServiceAccumulatedRequests)!=null?a:[];if(a.length===0)return;d("MAWWorkerCacheServices").getMAWWorkerCacheServices().calculateDelta(a)});b._transactorMeta=babelHelpers["extends"]({},b._transactorMeta,{mawCacheServiceAfterTransactionScheduled:!0})}function l(a,b){var c=a.table(b);if(!h.includes(b))return c;return d("MAWMpsGating").isFullMpsEnabled()?c:babelHelpers["extends"]({},c,{mutate:function(b){k(b);return j(a,c,b)}})}function a(){return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return l(a,b)}})}catch(b){c("FBLogger")("MAWCacheService").catching(b).mustfix("Error applying MAW Cache Service Middleware");return a}},name:"MAWCacheServiceMiddleware",stack:"dbcore"}}function m(a,b,c){var d=c.keys;c=c.trans;return a.table(b).getMany({keys:d,trans:c}).then(function(a){return a.filter(Boolean)})}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("Clipboard",["Promise","UserAgent"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return window.document&&window.document.queryCommandSupported instanceof Function&&window.document.queryCommandSupported("copy")&&!(c("UserAgent").isBrowser("Firefox < 41")||c("UserAgent").isPlatform("iOS < 10.3"))||c("UserAgent").isBrowser("Chrome >= 43")}function i(a,b){b=b||document.body;if(!b)return!1;var d=document.activeElement,e=!0,f=document.createElement("textarea");b.appendChild(f);f.value=a;if(c("UserAgent").isPlatform("iOS >= 18.4"))f.select();else if(c("UserAgent").isPlatform("iOS >= 10.3")){a=document.createRange();a.selectNodeContents(f);var g=window.getSelection();g.removeAllRanges();g.addRange(a);f.setSelectionRange(0,999999)}else f.select();try{e=document.execCommand("copy")}catch(a){e=!1}b.removeChild(f);d!=null&&d.focus();return e}function d(a){var b=window.getSelection(),c=null;b.rangeCount>0&&(c=b.getRangeAt(0));var d=document.createRange();d.selectNodeContents(a);b.removeAllRanges();b.addRange(d);try{document.execCommand("copy"),a=!0}catch(b){a=!1}b.removeAllRanges();c!==null&&b.addRange(c);return a}function e(a){var c=window.navigator;if(c&&c.clipboard&&typeof c.clipboard.writeText==="function")return c.clipboard.writeText(a);return i(a)?(h||(h=b("Promise"))).resolve():(h||(h=b("Promise"))).reject()}g.isSupported=a;g.copy=i;g.copyDOM=d;g.copyAsync=e}),98);
__d("DateStrings",["fbt"],(function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q;function a(a){n||(n=[h._(/*BTDS*/"Domingo"),h._(/*BTDS*/"Segunda"),h._(/*BTDS*/"Ter\u00e7a"),h._(/*BTDS*/"Quarta"),h._(/*BTDS*/"Quinta"),h._(/*BTDS*/"Sexta"),h._(/*BTDS*/"S\u00e1bado")]);return n[a]}function b(a){p||(p=[h._(/*BTDS*/"DOMINGO"),h._(/*BTDS*/"SEGUNDA"),h._(/*BTDS*/"TER\u00c7A"),h._(/*BTDS*/"QUARTA"),h._(/*BTDS*/"QUINTA"),h._(/*BTDS*/"SEXTA"),h._(/*BTDS*/"S\u00c1BADO")]);return p[a]}function c(a){o||(o=[h._(/*BTDS*/"Dom"),h._(/*BTDS*/"Seg"),h._(/*BTDS*/"Ter"),h._(/*BTDS*/"Qua"),h._(/*BTDS*/"Qui"),h._(/*BTDS*/"Sex"),h._(/*BTDS*/"S\u00e1b")]);return o[a]}function d(a){q||(q=[h._(/*BTDS*/"DOM"),h._(/*BTDS*/"SEG"),h._(/*BTDS*/"TER"),h._(/*BTDS*/"QUA"),h._(/*BTDS*/"QUI"),h._(/*BTDS*/"SEX"),h._(/*BTDS*/"S\u00c1B")]);return q[a]}function r(){i=[h._(/*BTDS*/"janeiro"),h._(/*BTDS*/"fevereiro"),h._(/*BTDS*/"mar\u00e7o"),h._(/*BTDS*/"abril"),h._(/*BTDS*/"maio"),h._(/*BTDS*/"junho"),h._(/*BTDS*/"julho"),h._(/*BTDS*/"agosto"),h._(/*BTDS*/"setembro"),h._(/*BTDS*/"outubro"),h._(/*BTDS*/"novembro"),h._(/*BTDS*/"dezembro")]}function e(a){i||r();return i[a-1]}function f(){i||r();return i.slice()}function s(a){l||(l=[h._(/*BTDS*/"JANEIRO"),h._(/*BTDS*/"FEVEREIRO"),h._(/*BTDS*/"MAR\u00c7O"),h._(/*BTDS*/"ABRIL"),h._(/*BTDS*/"MAIO"),h._(/*BTDS*/"JUNHO"),h._(/*BTDS*/"JULHO"),h._(/*BTDS*/"AGOSTO"),h._(/*BTDS*/"SETEMBRO"),h._(/*BTDS*/"OUTUBRO"),h._(/*BTDS*/"NOVEMBRO"),h._(/*BTDS*/"DEZEMBRO")]);return l[a-1]}function t(a){j||(j=[h._(/*BTDS*/"jan"),h._(/*BTDS*/"fev"),h._(/*BTDS*/"mar"),h._(/*BTDS*/"abr"),h._(/*BTDS*/"mai"),h._(/*BTDS*/"jun"),h._(/*BTDS*/"jul"),h._(/*BTDS*/"ago"),h._(/*BTDS*/"set"),h._(/*BTDS*/"out"),h._(/*BTDS*/"nov"),h._(/*BTDS*/"dez")]);return j[a-1]}function u(a){k||(k=[h._(/*BTDS*/"JAN"),h._(/*BTDS*/"FEV"),h._(/*BTDS*/"MAR"),h._(/*BTDS*/"ABR"),h._(/*BTDS*/"MAI"),h._(/*BTDS*/"JUN"),h._(/*BTDS*/"JUL"),h._(/*BTDS*/"AGO"),h._(/*BTDS*/"SET"),h._(/*BTDS*/"OUT"),h._(/*BTDS*/"NOV"),h._(/*BTDS*/"DEZ")]);return k[a-1]}function v(a){m||(m=["",h._(/*BTDS*/"st"),h._(/*BTDS*/"nd"),h._(/*BTDS*/"rd"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"st"),h._(/*BTDS*/"nd"),h._(/*BTDS*/"rd"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"th"),h._(/*BTDS*/"st")]);return m[a]}function w(a){switch(a){case 1:return h._(/*BTDS*/"1\u00ba");case 2:return h._(/*BTDS*/"2\u00ba");case 3:return h._(/*BTDS*/"3\u00ba");case 4:return h._(/*BTDS*/"4\u00ba");case 5:return h._(/*BTDS*/"5\u00ba");case 6:return h._(/*BTDS*/"6\u00ba");case 7:return h._(/*BTDS*/"7\u00ba");case 8:return h._(/*BTDS*/"8\u00ba");case 9:return h._(/*BTDS*/"9\u00ba");case 10:return h._(/*BTDS*/"10\u00ba");case 11:return h._(/*BTDS*/"11\u00ba");case 12:return h._(/*BTDS*/"12\u00ba");case 13:return h._(/*BTDS*/"13\u00ba");case 14:return h._(/*BTDS*/"14\u00ba");case 15:return h._(/*BTDS*/"15\u00ba");case 16:return h._(/*BTDS*/"16\u00ba");case 17:return h._(/*BTDS*/"17\u00ba");case 18:return h._(/*BTDS*/"18\u00ba");case 19:return h._(/*BTDS*/"19\u00ba");case 20:return h._(/*BTDS*/"20\u00ba");case 21:return h._(/*BTDS*/"21\u00ba");case 22:return h._(/*BTDS*/"22\u00ba");case 23:return h._(/*BTDS*/"23\u00ba");case 24:return h._(/*BTDS*/"24\u00ba");case 25:return h._(/*BTDS*/"25\u00ba");case 26:return h._(/*BTDS*/"26\u00ba");case 27:return h._(/*BTDS*/"27\u00ba");case 28:return h._(/*BTDS*/"28\u00ba");case 29:return h._(/*BTDS*/"29\u00ba");case 30:return h._(/*BTDS*/"30\u00ba");case 31:return h._(/*BTDS*/"31\u00ba");default:throw new Error("Invalid day of month.")}}function x(){return h._(/*BTDS*/"Dia:")}function y(){return h._(/*BTDS*/"M\u00eas:")}function z(){return h._(/*BTDS*/"Ano:")}function A(){return h._(/*BTDS*/"Hora:")}function B(){return h._(/*BTDS*/"Minuto:")}function C(){return h._(/*BTDS*/"dd")}function D(){return h._(/*BTDS*/"mm")}function E(){return h._(/*BTDS*/"aaaa")}function F(){return h._(/*BTDS*/"h")}function G(){return h._(/*BTDS*/"min")}function H(a){return a<12?h._(/*BTDS*/"da manh\u00e3"):h._(/*BTDS*/"da tarde\/noite")}function I(a){return a<12?h._(/*BTDS*/"da manh\u00e3"):h._(/*BTDS*/"da tarde\/noite")}g.getWeekdayName=a;g.getUppercaseWeekdayName=b;g.getWeekdayNameShort=c;g.getUppercaseWeekdayNameShort=d;g._initializeMonthNames=r;g.getMonthName=e;g.getMonthNames=f;g.getUppercaseMonthName=s;g.getMonthNameShort=t;g.getUppercaseMonthNameShort=u;g.getOrdinalSuffix=v;g.getDayOfMonth=w;g.getDayLabel=x;g.getMonthLabel=y;g.getYearLabel=z;g.getHourLabel=A;g.getMinuteLabel=B;g.getDayPlaceholder=C;g.getMonthPlaceholder=D;g.getYearPlaceholder=E;g.getHourPlaceholder=F;g.getMinutePlaceholder=G;g.get12HourClockSuffix=H;g.getUppercase12HourClockSuffix=I}),226);
__d("IntlDateFormatsCLDRWidthEnum",[],(function(a,b,c,d,e,f){a=Object.freeze({FULL:"full",LONG:"long",MEDIUM:"medium",SHORT:"short"});f["default"]=a}),66);
__d("PolarisAboutThisAccountUtils",["PolarisIsLoggedIn"],(function(a,b,c,d,e,f,g){"use strict";function a(a){if(!d("PolarisIsLoggedIn").isLoggedIn())return!1;a=a.showAccountTransparencyDetails;a=a===void 0?!1:a;return a}g.getIsEligibleForATA=a}),98);
__d("RegionDatetimePatterns",[],(function(a,b,c,d,e,f){a=Object.freeze({DATE_SHORT:"date_short",DATETIME_SHORT_SHORT:"dateTime_short_short",TIME_SHORT:"time_short",TIME_MEDIUM:"time_medium",J:"j"});f["default"]=a}),66);
__d("getCLDRLocalizedFormat",["CLDRDateFormatConfig","FBLogger","IntlDateFormatsCLDRWidthEnum","RegionDatetimePatterns","flipObject","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=b("CLDRDateFormatConfig").CLDRConfigeratorFormats,h=b("CLDRDateFormatConfig").CLDRRegionalConfigeratorFormats,i=b("flipObject")(b("RegionDatetimePatterns"));function a(a){if(a==null)throw b("unrecoverableViolation")('Format: "'+a+'", not supported by configurator.',"internationalization");var c,d,e=a.split("_"),f=e[0];e=e.slice(1);var l=f+"Formats";a in i?d=h:d=g;switch(l){case"dateFormats":case"timeFormats":var m=j(e[0]);if(m==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", with unsupported width: "undefined"',"internationalization");c=d[l][m];if(c==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", '+('width: "'+m+'", with unsupported localization'),"internationalization");break;case"dateTimeFormats":m=j(e[0]);e=j(e[1]);if(m==null||e==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", with unsupported width: dateFormatKey="undefined" timeFormatKey="undefined"',"internationalization");c=d[l][m];var n=d.dateFormats[m],o=d.timeFormats[e];if(c==null)throw b("unrecoverableViolation")('Format: "'+a+'", category: "'+l+'", '+('date width: "'+m+'", and time width: ')+('"'+e+'", with unsupported localization'),"internationalization");c=c.replace("{0}",o).replace("{1}",n);break;default:l="availableFormats";m=f;m.includes("j")&&(m=k(m,d.timeFormats));c=d[l][m];if(c==null)throw b("unrecoverableViolation")('Format: "'+a+'", with key: "'+m+'", not supported by CLDR',"internationalization")}return c}function j(a){if(a==null)throw b("unrecoverableViolation")("Expected CLDR width key to not be null","internationalization");return b("IntlDateFormatsCLDRWidthEnum")[a.toUpperCase()]}function k(a,c){var d;c=c["short"];c==null?(b("FBLogger")("formatDate").blameToPreviousFile().warn('CLDR `timeFormat`, width `short` required for 24 hour localization not found for availableKey: "%s"',a),d="h"):d=c.includes("H")?"H":"h";return a.replace("j",d)}e.exports=a}),null);
__d("intlGetDateNumerics",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){b=b.utc===!0;b?b={dateDay:a.getUTCDate(),dateDayOfWeek:a.getUTCDay(),dateMonth:a.getUTCMonth(),dateYear:a.getUTCFullYear(),dateHours:a.getUTCHours(),dateMinutes:a.getUTCMinutes(),dateSeconds:a.getUTCSeconds(),dateMilliseconds:a.getUTCMilliseconds()}:b={dateDay:a.getDate(),dateDayOfWeek:a.getDay(),dateMonth:a.getMonth(),dateYear:a.getFullYear(),dateHours:a.getHours(),dateMinutes:a.getMinutes(),dateSeconds:a.getSeconds(),dateMilliseconds:a.getMilliseconds()};return b}f["default"]=a}),66);
__d("padNumber",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){a=a.toString();return a.length>=b?a:"0".repeat(b-a.length)+a}f["default"]=a}),66);
__d("intlRenderJSDateSymbol",["DateStrings","padNumber","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e,f,g){g===void 0&&(g=0);e=e.skipSuffixLocalization===!0;g=g;var h="";switch(b){case"\\":g++;if(f==null)throw c("unrecoverableViolation")("Only deprecated calls to `intlRenderJSDateSymbol()` use `localizedJSFormat`.","internationalization");h=f.charAt(g);break;case"d":h=c("padNumber")(a.dateDay,2);break;case"j":h=a.dateDay;break;case"S":h=d("DateStrings").getOrdinalSuffix(a.dateDay);break;case"D":h=d("DateStrings").getWeekdayNameShort(a.dateDayOfWeek);break;case"l":h=d("DateStrings").getWeekdayName(a.dateDayOfWeek);break;case"F":case"f":h=d("DateStrings").getMonthName(a.dateMonth+1);break;case"M":h=d("DateStrings").getMonthNameShort(a.dateMonth+1);break;case"m":h=c("padNumber")(a.dateMonth+1,2);break;case"n":h=a.dateMonth+1;break;case"Y":h=a.dateYear;break;case"y":h=(""+a.dateYear).slice(2);break;case"a":e?h=a.dateHours<12?"am":"pm":h=d("DateStrings").get12HourClockSuffix(a.dateHours);break;case"A":e?h=a.dateHours<12?"AM":"PM":h=d("DateStrings").getUppercase12HourClockSuffix(a.dateHours);break;case"g":a.dateHours===0||a.dateHours===12?h="12":h=a.dateHours%12;break;case"G":h=a.dateHours;break;case"h":a.dateHours===0||a.dateHours===12?h="12":h=c("padNumber")(a.dateHours%12,2);break;case"H":h=c("padNumber")(a.dateHours,2);break;case"i":h=c("padNumber")(a.dateMinutes,2);break;case"s":h=c("padNumber")(a.dateSeconds,2);break;case"X":h=c("padNumber")(a.dateMilliseconds,3);break;default:h=b}return{idx:g,rendered:String(h)}}g["default"]=a}),98);
__d("intlRenderCLDRDate",["CLDRDateFormatConfig","intlRenderJSDateSymbol","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";var g=/\w+/;function a(a,c,d){var e=b("CLDRDateFormatConfig").intlDateSpecialChars,f="",g="",i=!1,j=[],k;a=a.split(e.cldrDelimiter+e.singleQuote).join(e.singleQuoteHolder);for(var l=0,m=a.length;l<m;l++){var n=a.charAt(l);!i?n===e.cldrDelimiter?i=!0:f.length===0||f[0]===n?f+=n:n===e.singleQuoteHolder?f+=e.singleQuote:(k=h(f,d,c),j.push(k.rendered),f=n):(f.length!==0&&(k=h(f,d,c),j.push(k.rendered),f=""),n===e.cldrDelimiter?(i=!1,j.push(g),g=""):n===e.singleQuoteHolder?g+=e.singleQuote:g+=n)}if(g.length!==0)throw b("unrecoverableViolation")('Format: "'+a+'" must contain closing str literal delimiter',"internationalization");f.length!==0&&(k=h(f,d,c),j.push(k.rendered));return j.join("")}function h(a,c,d){a=i(a);return b("intlRenderJSDateSymbol")(c,a,d)}function i(a){if(a in b("CLDRDateFormatConfig").CLDRToPHPSymbolConversion)return b("CLDRDateFormatConfig").CLDRToPHPSymbolConversion[a];if(g.test(a))throw b("unrecoverableViolation")('Unsupported CLDR symbol: "'+a+'". If string literal, wrap in delimiters',"internationalization");return a}e.exports=a}),null);
__d("formatDate",["CLDRDateFormatConfig","DateFormatConfig","FBLogger","IsInternSite","getCLDRLocalizedFormat","intlGetDateNumerics","intlRenderCLDRDate","intlRenderJSDateSymbol","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=Object.freeze({today:null,yesterday:null,thisWeek:null,thisMonth:null,thisYear:null,withinDay:null,withinWeek:null,withinMonth:null,withinYear:null,older:null,future:null,allOtherTimes:null});function h(a,b,d,e){a=a;d=d||{skipSuffixLocalization:!1,skipPatternLocalization:!1,utc:!1,formatInternal:!1,throwCLDRError:!1};if(b==null||b===""||a==null||!(a||a===0))return"";typeof a==="string"&&(isNaN(Number(a))&&c("FBLogger")("i18n-formatDate").event("date_string_must_be_timestamp").blameToPreviousFile().mustfix("The date passed to formatDate is a string, but not a timestamp. formatDate expects strings to be a string representation of a Unix "+('timestamp but was passed "'+a+'"')),a=parseInt(a,10));typeof a==="number"&&(a=new Date(a*1e3));if(!(a instanceof Date))throw c("unrecoverableViolation")("The date passed to formatDate must be either a unix timestamp or JavaScript date object.","internationalization");if(isNaN(a.getTime()))throw c("unrecoverableViolation")("Invalid date passed to formatDate","internationalization");a.getTime()>=1e15&&c("FBLogger")("i18n-formatDate").event("date_too_far_in_future").blameToPreviousFile().info("The date passed to formatDate is too far in the future. Did you mix up milliseconds/seconds?");b=k(a,b);a=c("intlGetDateNumerics")(a,d);return i(b,a,d,e)}h.DEFAULT_FORMAT="M j, Y g:i A";h.periodNames=Object.freeze(Object.keys(a));function i(a,b,d,e){var f=a,g=!!d.skipPatternLocalization,h=d.formatInternal===!0;if(!g&&(h||!c("IsInternSite").is_intern_site))if(a in c("CLDRDateFormatConfig").supportedPHPFormatsKeys)try{g=c("CLDRDateFormatConfig").supportedPHPFormatsKeys[a];h=c("getCLDRLocalizedFormat")(g);return c("intlRenderCLDRDate")(h,d,b)}catch(a){c("FBLogger")("i18n-formatDate").event("CLDR_date_format_render_error").blameToPreviousFile().catching(a).mustfix("CLDR date format render error");if(d.throwCLDRError===!0)throw a}else if(c("DateFormatConfig").formats[a])f=c("DateFormatConfig").formats[a];else if(!c("IsInternSite").is_intern_site)if(a.length!==1)throw c("unrecoverableViolation")("Trying to localize an unsupported date format: `"+a+"`","internationalization");return j(f,d,b,e)}function j(a,b,d,e){var f=[];for(var g=0;g<a.length;g++){var h=void 0;e===!0&&a.charAt(g)==="a"?(h="A",f.push(" ")):h=a.charAt(g);h=c("intlRenderJSDateSymbol")(d,h,b,a,g);f.push(h.rendered);g=h.idx}return f.join("")}function k(a,b){var d=h.DEFAULT_FORMAT;if(typeof b==="string")return b;else if(typeof b==="object"){var e=a.getTime();for(var f of l()){var g=b[f.name];if(g!=null&&f.start<=e&&e<f.end)return g}c("FBLogger")("i18n-formatDate").event("matching_period_format_not_found").blameToPreviousFile().warn('Matching period not found for date "%s", using default format "%s". Current timestamp: "%s"',e,d,Date.now());return d}else{c("FBLogger")("i18n-formatDate").event("invalid_format_argument").blameToPreviousFile().warn('Called with invalid format "%s" (type: %s) for date "%s", using default: %s',b,typeof b,a.getTime(),d);return d}}function l(){var a=new Date(),b=a.getTime(),d=a.getFullYear(),e=a.getMonth(),f=new Date(d,a.getMonth()+1,0).getDate(),g=new Date(d,1,29).getMonth()===1?366:365,h=1e3*60*60*24,i=new Date(a.setHours(0,0,0,0)),j=new Date(d,e,i.getDate()+1);a=a.getDate()-(a.getDay()-c("DateFormatConfig").weekStart+6)%7;var k=new Date(b).setDate(a);a=new Date(b).setDate(a+7);var l=new Date(d,e,1);e=new Date(d,e,f+1);var m=new Date(d,0,1);d=new Date(d+1,0,1);return[{name:"today",start:i.getTime(),end:j.getTime()},{name:"withinDay",start:b-h,end:b+h},{name:"yesterday",start:i.getTime()-h,end:i.getTime()-1},{name:"thisWeek",start:k,end:a},{name:"withinWeek",start:b-h*7,end:b+h*7},{name:"thisMonth",start:l.getTime(),end:e.getTime()},{name:"withinMonth",start:b-h*f,end:b+h*f},{name:"thisYear",start:m.getTime(),end:d.getTime()},{name:"withinYear",start:b-h*g,end:b+h*g},{name:"older",start:-Infinity,end:b},{name:"future",start:b,end:+Infinity},{name:"allOtherTimes",start:-Infinity,end:+Infinity}]}b=h;g["default"]=b}),98);/*FB_PKG_DELIM*/
__d("BTManifestName",["$InternalEnum"],(function(a,b,c,d,e,f){a=b("$InternalEnum")({MAIN:"main",LONGTAIL:"longtail"});c=a;f["default"]=c}),66);
__d("BtLongtailHashFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5779");b=d("FalcoLoggerInternal").create("bt_longtail_hash",a);e=b;g["default"]=e}),98);
__d("CometBTManifestLoader",["BootloaderEvents","BtLongtailHashFalcoEvent","ClientConsistencyEventEmitter","FBLogger","ODS","Promise","SiteData","TrustedTypes","XHRRequest","asyncToGeneratorRuntime","err","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=new Set();function k(a,b,c,d){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,d,e,f){var g=(yield new(i||(i=b("Promise")))(function(b,g){new(c("XHRRequest"))(a+"/btmanifest/"+e+"/"+d+"/"+f).setMethod("GET").setResponseHandler(function(a){return b(a.toString())}).setErrorHandler(function(a){return g(a)}).send()}));if(typeof g!=="string")throw c("FBLogger")("binary_transparency","bt_invalid_manifest_response").mustfixThrow("Invalid response from BT manifest endpoint");return g});return l.apply(this,arguments)}function m(a,b){(h||(h=d("ODS"))).bumpEntityKey(454,"obc.www.all","bt.comet_manifest_loader."+Number(d("SiteData").compose_bootloads)+"."+d("SiteData").pkg_cohort+"."+a+"."+b)}function n(a,b,d){var e;if(d instanceof Error)e=d;else if(typeof d==="object"){var f=JSON.stringify(d);e=c("err")("(XHRRequest): %s",f.slice(0,300)+(f.length>300?"...":""))}else e=c("err")(d);c("FBLogger")("binary_transparency","bt_download_manifest_error").catching(e).mustfix('Unable to download and inject BT manifest "%s" for version: %s',b,a)}var o=c("TrustedTypes").createPolicy("bt-manifest",{createScript:function(a){return a}});function p(a,b){return q.apply(this,arguments)}function q(){q=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){if(!d("SiteData").manifest_origin||d("SiteData").manifest_version_prefix==null||d("SiteData").manifest_base_uri==null)return;var e=a+"_"+b;a=""+d("SiteData").manifest_version_prefix+a;if(j.has(e))return;m(b,"start");j.add(e);try{var f=document.createElement("script"),g=(yield k(d("SiteData").manifest_base_uri,d("SiteData").manifest_origin,a,b));c("justknobx")._("3786")?f.innerText=o.createScript(g):f.innerText=g;f.type="application/json";f.setAttribute("name","binary-transparency-manifest");f.dataset.manifestRev=a;f.dataset.manifestType=b;(g=document.head)==null?void 0:g.appendChild(f);m(b,"complete")}catch(c){m(b,"failed"),n(a,b,c),j["delete"](e)}});return q.apply(this,arguments)}function a(){c("promiseDone")(p(d("SiteData").client_revision,"main")),d("BootloaderEvents").onResourceInLongTailBTManifest(function(a){c("promiseDone")(p(d("SiteData").client_revision,"longtail")),a.hashes.forEach(function(b){c("BtLongtailHashFalcoEvent").log(function(){return{client_revision:String(d("SiteData").client_revision),compose_bootloads:d("SiteData").compose_bootloads,ef_page:d("SiteData").ef_page||"",hash:b,pkg_cohort:d("SiteData").pkg_cohort,reference:a.source,rls_id:d("SiteData").hsi}})})}),c("ClientConsistencyEventEmitter").addListener("newRevision",function(a){c("promiseDone")(p(a,"main")),c("promiseDone")(p(a,"longtail"))})}g.init=a}),98);
__d("IgFrCookieUpdaterFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("5694");b=d("FalcoLoggerInternal").create("ig_fr_cookie_updater",a);e=b;g["default"]=e}),98);
__d("PolarisAPIGetFrCookieQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="10068146476570597"}),null);
__d("PolarisAPIGetFrCookieQuery.graphql",["PolarisAPIGetFrCookieQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"_request_data"},{defaultValue:null,kind:"LocalArgument",name:"payload"}],c=[{alias:null,args:[{kind:"Variable",name:"_request_data",variableName:"_request_data"},{kind:"Variable",name:"payload",variableName:"payload"}],concreteType:"XDTGetEncryptedCredentialsResponse",kind:"LinkedField",name:"xdt_api__v1__web__accounts__get_encrypted_credentials",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fr",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PolarisAPIGetFrCookieQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PolarisAPIGetFrCookieQuery",selections:c},params:{id:b("PolarisAPIGetFrCookieQuery_instagramRelayOperation"),metadata:{is_distillery:!0,root_field_name:["xdt_api__v1__web__accounts__get_encrypted_credentials"]},name:"PolarisAPIGetFrCookieQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("PolarisAPIGetFrCookie",["CometRelay","PolarisAPIGetFrCookieQuery.graphql","PolarisInstapi","err","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){return c("justknobx")._("999")?d("CometRelay").fetchQuery(e,h!==void 0?h:h=b("PolarisAPIGetFrCookieQuery.graphql"),{_request_data:{},payload:a}).toPromise().then(function(a){if(a==null)throw c("err")("Failed to get Fr cookie.");return{fr:a.xdt_api__v1__web__accounts__get_encrypted_credentials.fr}}):d("PolarisInstapi").apiPost("/api/v1/web/accounts/get_encrypted_credentials/",{body:{payload:a}}).then(function(a){return a.data})}g.getFrCookie=a}),98);
__d("buildIframeOriginUrl",["URI"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return a}g["default"]=a}),98);
__d("PolarisFacebookCookieSyncConstants",["URI","buildIframeOriginUrl"],(function(a,b,c,d,e,f,g){"use strict";var h;a={error:"ig_iframe_error",ig_sync:"ig_iframe_ig_sync",ig_sync_error:"ig_iframe_ig_sync_error",ig_sync_success:"ig_iframe_ig_sync_success",ready:"ig_iframe_ready",success:"ig_iframe_success",sync:"ig_iframe_fb_sync"};b=c("buildIframeOriginUrl")("https://www.facebook.com");d=new(h||(h=c("URI")))(b).getDomain();e="fr";g.IFRAME_MESSAGES=a;g.IFRAME_ORIGIN=b;g.IFRAME_DOMAIN=d;g.FR_COOKIE_UPDATED_LOCAL_STORAGE_KEY=e}),98);
__d("SecureMessageListener",["SecurePostMessage","URI"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){var b=this;this.$3=null;this.$4=!1;this.$1=a;this.$5=function(a){b.run(a)}}var b=a.prototype;b.setEventHandler=function(a){this.$2=a;return this};b.setSupportedOrigins=function(a){this.$3=a;return this};b.skipOriginCheck_UNSAFE=function(){this.$4=!0;return this};b.beginListening=function(){this.$1.addEventListener("message",this.$5);return this};b.stopListening=function(){try{this.$1.removeEventListener("message",this.$5)}catch(a){if(!(a instanceof TypeError))throw a}return this};b.run=function(a){if(this.$3==null||this.$3.length===0){if(!this.$4&&a.origin!==this.$1.location.origin)return}else if(!this.isSupportedOrigin(this.$3,a.origin))return;if(this.$2){var b=function(b){d("SecurePostMessage").sendMessageToSpecificOrigin(a.source,b,a.origin)};this.$2(a,b)}};b.isSupportedOrigin=function(a,b){if(!new RegExp("^https://").test(b))return!1;var d=new(h||(h=c("URI")))(b);return a.some(function(a){return d.isSubdomainOfDomain(a)})};return a}();g["default"]=a}),98);
__d("XPolarisFacebookSyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/sync/instagram/",{})}),null);
__d("PolarisFacebookToInstagramCookieSync.react",["FBLogger","InstagramODS","PolarisFacebookCookieSyncConstants","SecureMessageListener","SecurePostMessage","XAsyncRequest","XPolarisFacebookSyncController","react","react-compiler-runtime","vulture"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useEffect;function a(a){var b=d("react-compiler-runtime").c(4),e=a.frameRef,f=a.onCleanUp,g;b[0]!==e||b[1]!==f?(a=function(){var a=function(){c("InstagramODS").incr("web.cookie_sync.oo_cookie.start_fb_sync");var a=e.current;(a==null?void 0:a.contentWindow)!=null&&d("SecurePostMessage").sendMessageToSpecificOrigin(a.contentWindow,{eventName:d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ig_sync},d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN)},b=function(b){if(b.origin!==d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN)return;var e=b.data.eventName;bb13:switch(e){case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ready:c("vulture")("kwGID2sY0qePqaffMR-uAH6HAoM=");a();break bb13;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ig_sync_success:c("vulture")("CmzVqfYQ_4EuEDvO86NfZTeDhK8=");c("InstagramODS").incr("web.cookie_sync.oo_cookie.retrieve_success");e=c("XPolarisFacebookSyncController").getURIBuilder().getURI();new(c("XAsyncRequest"))().setURI(e).setMethod("POST").setData({encrypted_data:(e=b.data.data)==null?void 0:e.data}).setHandler(k).setErrorHandler(j).send();f();break bb13;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ig_sync_error:c("InstagramODS").incr("web.cookie_sync.oo_cookie.retrieve_error");b=(e=b.data.errorDescription)!=null?e:"Exception thrown when syncing cookie to sync ig cookie";c("FBLogger")("ig_web").mustfix(b);f()}},g=new(c("SecureMessageListener"))(window).setEventHandler(b).setSupportedOrigins([d("PolarisFacebookCookieSyncConstants").IFRAME_DOMAIN]).beginListening();return function(){g.stopListening()}},g=[e,f],b[0]=e,b[1]=f,b[2]=a,b[3]=g):(a=b[2],g=b[3]);i(a,g);return null}function j(a){c("InstagramODS").incr("web.cookie_sync.oo_cookie.sync_fail");a=(a=a.errorDescription)!=null?a:"Error when syncing ig cookies";c("FBLogger")("ig_web").mustfix(a)}function k(a){c("InstagramODS").incr("web.cookie_sync.oo_cookie.sync_success")}g["default"]=a}),98);
__d("PolarisInstagramToFacebookCookieSync.react",["CometRelay","FBLogger","IgFrCookieUpdaterFalcoEvent","InstagramODS","PolarisAPIGetFrCookie","PolarisAdsGatingHelpers","PolarisConfig","PolarisDOMListener.react","PolarisFacebookCookieSyncConstants","PolarisWebStorage","SecurePostMessage","browserHistory_DO_NOT_USE","gkx","react","usePolarisViewer","vulture"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useEffect,k=b.useRef,l=Number(new Date().getTime());function m(a){var b=new Date().getTime()-l;a.total_latency=b.toString();a.country=d("PolarisConfig").getCountryCode();c("IgFrCookieUpdaterFalcoEvent").log(function(){return a})}function a(a){var b=a.frameRef,e=a.frData,f=a.onCleanUp;a=c("gkx")("25372");var g=c("gkx")("3478"),h=a&&g;g=(a=c("usePolarisViewer")())==null?void 0:a.id;a=d("browserHistory_DO_NOT_USE").getPath(d("browserHistory_DO_NOT_USE").browserHistory);var l=d("CometRelay").useRelayEnvironment(),n=d("PolarisAdsGatingHelpers").useEUFRCookieODSLogging();a=k({browser_history_path:a,iframe_origin:d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN,ig_user_id:g,is_blacklisted:!1,is_control_group:!1,is_local_storage_accessible:!1,local_storage_data:e,local_storage_same_as_api:!0,local_storage_updated:!1,show_iframe:!1});var o=a.current;j(function(){h||(o.is_blacklisted=!0,m(o),f())},[]);g=function(a){var b=a.data.eventName;o.iframe_message_origin=a.origin;if(a.origin!==d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN){b in d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES&&(o.iframe_message_origin_mismatch=!0,m(o));return}switch(b){case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.ready:c("InstagramODS").incr("web.frcookie.iframe.ready");n&&c("InstagramODS").incr("web.eu.frcookie.iframe.ready");o.iframe_message_ready=!0;p();break;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.success:c("vulture")("Cgl4ozmy__XzdcpSRxE8c7Uakng=");c("InstagramODS").incr("web.frcookie.iframe.success");n&&c("InstagramODS").incr("web.eu.frcookie.iframe.success");o.iframe_message_success=!0;m(o);f();break;case d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.error:c("vulture")("LgJo05MxhUFBrbwnMxMlgQO3KIc=");c("InstagramODS").incr("web.frcookie.iframe.error");n&&c("InstagramODS").incr("web.eu.frcookie.iframe.error");q();o.iframe_message_error=!0;m(o);break}};var p=function(){o.iframe_non_null=!1;o.iframe_content_window_non_null=!1;var a=b.current;if(a==null)return;e==null&&(c("InstagramODS").incr("web.frcookie.local_storage.empty"),n&&c("InstagramODS").incr("web.eu.frcookie.local_storage.empty"));d("PolarisAPIGetFrCookie").getFrCookie(e,l).then(function(b){o.api_data=b.fr;if(b.fr===e){m(o);f();return}o.local_storage_same_as_api=!1;var g=c("PolarisWebStorage").getLocalStorage();if(g==null){m(o);f();return}o.is_local_storage_accessible=!0;if(b.fr===""){g.removeItem(d("PolarisFacebookCookieSyncConstants").FR_COOKIE_UPDATED_LOCAL_STORAGE_KEY);c("InstagramODS").incr("web.frcookie.local_storage.remove");n&&c("InstagramODS").incr("web.eu.frcookie.local_storage.remove");m(o);f();return}g.setItem(d("PolarisFacebookCookieSyncConstants").FR_COOKIE_UPDATED_LOCAL_STORAGE_KEY,b.fr);o.show_iframe=!0;o.local_storage_updated=!0;o.iframe_payload=b.fr;o.iframe_non_null=!0;a.contentWindow!=null&&(o.iframe_content_window_non_null=!0,d("SecurePostMessage").sendMessageToSpecificOrigin(a.contentWindow,{data:b.fr,eventName:d("PolarisFacebookCookieSyncConstants").IFRAME_MESSAGES.sync},d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN));c("InstagramODS").incr("web.frcookie.local_storage.update");n&&c("InstagramODS").incr("web.eu.frcookie.local_storage.update")})["catch"](function(a){c("InstagramODS").incr("web.frcookie.get.error"),n&&c("InstagramODS").incr("web.eu.frcookie.get.error"),o.exception=a.toString(),m(o),c("FBLogger")("ig_web").catching(a).mustfix("Exception thrown when getting frCookie"),q()})},q=function(){var a=c("PolarisWebStorage").getLocalStorage();c("PolarisWebStorage").isLocalStorageSupported()&&a!=null&&a.removeItem(d("PolarisFacebookCookieSyncConstants").FR_COOKIE_UPDATED_LOCAL_STORAGE_KEY);f()};return h&&i.jsx(c("PolarisDOMListener.react"),{event:"message",handler:g,target:window})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("PolarisFacebookCookieSyncImpl.react",["IgFrCookieUpdaterFalcoEvent","JSScheduler","PolarisDOMListener.react","PolarisFacebookCookieSyncConstants","PolarisFacebookToInstagramCookieSync.react","PolarisInstagramToFacebookCookieSync.react","PolarisReactRedux.react","PolarisUA","PolarisWebStorage","RunComet","browserHistory_DO_NOT_USE","react","react-compiler-runtime","usePolarisViewer"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||(i=d("react"));b=i;var k=b.useEffect,l=b.useRef,m=b.useState,n=d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN+"/instagram/login_sync/",o=["terms","challenge"],p=3,q=Number(new Date().getTime());function r(a){var b=new Date().getTime()-q;a.total_latency=b.toString();c("IgFrCookieUpdaterFalcoEvent").log(function(){return a})}var s=function(){if(!d("PolarisUA").isIGWebview()&&c("PolarisWebStorage").isLocalStorageSupported()){var a=c("PolarisWebStorage").getLocalStorage();if(a!=null)return a.getItem(d("PolarisFacebookCookieSyncConstants").FR_COOKIE_UPDATED_LOCAL_STORAGE_KEY)}return null};function t(a){var b;a=a.frData;var e=l(null);b=(b=c("usePolarisViewer")())==null?void 0:b.id;b=l({browser_history_path:d("browserHistory_DO_NOT_USE").getPath(d("browserHistory_DO_NOT_USE").browserHistory),iframe_origin:d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN,ig_user_id:b,is_blacklisted:!1,is_control_group:!1,is_local_storage_accessible:!1,local_storage_data:a,local_storage_same_as_api:!0,local_storage_updated:!1,show_iframe:!1});var f=b.current;b=function(){f.iframe_unload=!0};var g=m(!1),i=g[0],o=g[1];k(function(){var a=null,b=null,e=d("RunComet").onAfterLoad(function(){a=(h||(h=c("JSScheduler"))).scheduleLoggingPriCallback(function(){b=window.setTimeout(function(){o(!0)},p*1e3)})});return function(){b&&window.clearTimeout(b),a&&(h||(h=c("JSScheduler"))).cancelCallback(a),e&&e.remove()}},[]);g=m(!1);var q=g[0],s=g[1];g=m(!1);var t=g[0],u=g[1];g=q&&t;return!i?null:j.jsxs(j.Fragment,{children:[j.jsx("div",{hidden:!0,children:j.jsx("iframe",{onError:function(){f.iframe_on_error=!0,r(f)},onLoad:function(){f.iframe_on_load=!0},ref:e,src:n,style:{border:"none",display:"none",height:0,width:0},title:"fr"})}),g?null:j.jsxs(j.Fragment,{children:[j.jsx(c("PolarisInstagramToFacebookCookieSync.react"),{frameRef:e,frData:a,onCleanUp:function(){return s(!0)}}),j.jsx(c("PolarisFacebookToInstagramCookieSync.react"),{frameRef:e,onCleanUp:function(){return u(!0)}}),j.jsx(c("PolarisDOMListener.react"),{event:"beforeunload",handler:b,target:window})]})]})}t.displayName=t.name+" [from "+f.id+"]";function a(){var a,b=d("react-compiler-runtime").c(3),e=d("PolarisReactRedux.react").useSelector(u);a=(a=c("usePolarisViewer")())==null?void 0:a.id;if(e)return null;if(b[0]!==a){e=Symbol["for"]("react.early_return_sentinel");bb0:{var f=d("browserHistory_DO_NOT_USE").getPath(d("browserHistory_DO_NOT_USE").browserHistory);if(o.some(function(a){return f.includes(a)})){r({browser_history_path:f,iframe_origin:d("PolarisFacebookCookieSyncConstants").IFRAME_ORIGIN,ig_user_id:a,is_blacklisted:!0,is_control_group:!1,is_local_storage_accessible:!1,local_storage_same_as_api:!0,local_storage_updated:!1,show_iframe:!1});e=null;break bb0}}b[0]=a;b[1]=e}else e=b[1];if(e!==Symbol["for"]("react.early_return_sentinel"))return e;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a=j.jsx(t,{frData:s()}),b[2]=a):a=b[2];return a}function u(a){return!!(a==null?void 0:(a=a.cookieModal)==null?void 0:a.visible)}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("ArmadilloCutoverClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("699");b=d("FalcoLoggerInternal").create("armadillo_cutover_client",a);e=b;g["default"]=e}),98);
__d("EncryptedBackupdDYIFileSaver",["requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h=c("requireDeferred")("file-saver").__setRef("EncryptedBackupdDYIFileSaver");function a(a,b){h.onReadyImmediately(function(c){c=c.saveAs;c(b,a)})}g.saveFile=a}),98);
__d("PolarisDirectGQLAPICDNRestorationQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9537377159694697"}),null);
__d("PolarisDirectGQLAPICDNRestorationQuery.graphql",["PolarisDirectGQLAPICDNRestorationQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"payload"}],c=[{alias:null,args:[{kind:"Variable",name:"payload",variableName:"payload"}],concreteType:"XIGIGDirectInstamadilloRestoreCDNUrlResponse",kind:"LinkedField",name:"xig_fetch_ig_direct_restore_cdn_url",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"restoration_cdn_url",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PolarisDirectGQLAPICDNRestorationQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PolarisDirectGQLAPICDNRestorationQuery",selections:c},params:{id:b("PolarisDirectGQLAPICDNRestorationQuery_instagramRelayOperation"),metadata:{},name:"PolarisDirectGQLAPICDNRestorationQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("PolarisDirectGQLAPIEBUploadMessagesMutation_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9574801429307425"}),null);
__d("PolarisDirectGQLAPIEBUploadMessagesMutation.graphql",["PolarisDirectGQLAPIEBUploadMessagesMutation_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"XIGTIGUploadMessageHandlerResponse",kind:"LinkedField",name:"xig_ig_open_upload_msg_to_backup",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_success",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"delete_mailbox",storageKey:null},{alias:null,args:null,concreteType:"XIGTIGProtobufParams",kind:"LinkedField",name:"protobuf_params",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"delete_on_success",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rtu_protocol",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"PolarisDirectGQLAPIEBUploadMessagesMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"PolarisDirectGQLAPIEBUploadMessagesMutation",selections:c},params:{id:b("PolarisDirectGQLAPIEBUploadMessagesMutation_instagramRelayOperation"),metadata:{},name:"PolarisDirectGQLAPIEBUploadMessagesMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("PolarisDirectGQLAPI",["CometRelay","CurrentUser","PolarisDirectGQLAPICDNRestorationQuery.graphql","PolarisDirectGQLAPIEBUploadMessagesMutation.graphql","PolarisRelayEnvironment","Promise"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a,c){return new(j||(j=b("Promise")))(function(e,f){var g=function(a){f(a)},i=d("CurrentUser").getAppID(),j;i!=null&&(j=Number(i));d("CometRelay").commitMutation(a,{mutation:h!==void 0?h:h=b("PolarisDirectGQLAPIEBUploadMessagesMutation.graphql"),onCompleted:e,onError:g,variables:{input:{app_id:j,payload:{msg_payloads:c}}}})})}function e(a){return d("CometRelay").fetchQuery(c("PolarisRelayEnvironment"),i!==void 0?i:i=b("PolarisDirectGQLAPICDNRestorationQuery.graphql"),{payload:a}).toPromise().then(function(a){return(a=a==null?void 0:(a=a.xig_fetch_ig_direct_restore_cdn_url)==null?void 0:a.restoration_cdn_url)!=null?a:""})}g.ebUploadMessages=a;g.fetchCDNUrlWithRestoration=e}),98);
__d("IGDBridgeResignCdnUrlHandler",["MAWBridgeSendAndReceive","PolarisDirectGQLAPI","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield d("PolarisDirectGQLAPI").fetchCDNUrlWithRestoration(a));yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","continueMediaDownload",{cdnUrl:a,deliveryObjectId:b})});return h.apply(this,arguments)}g.call=a}),98);
__d("MAWBridgeUpdateDYIStatusV2",["EncryptedBackupdDYIFileSaver","EncryptedBackupsDYIFileUtils","EncryptedBackupsDYITypes","FBLogger","QPLUserFlow","asyncToGeneratorRuntime","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b,c){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){d("EncryptedBackupdDYIFileSaver").saveFile(a,b),window.setTimeout(function(){c("promiseDone")(e())},1e3)});return i.apply(this,arguments)}function a(a){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var e=a.qplEvent,f=a.qplInstanceKeyE2E;a=a.status;var g=c("FBLogger")("[labyrinth_web][dyi]");if(a===d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Completed)try{if(navigator.storage==null)throw g.mustfixThrow("Storage management API is not supported. Please try one of the supported browsers.");var i=d("EncryptedBackupsDYIFileUtils").DyiArchiveFilename,j=(yield d("EncryptedBackupsDYIFileUtils").getRootFolderHandle()),k=(yield d("EncryptedBackupsDYIFileUtils").readFile(j,i));yield h(i,k,b("asyncToGeneratorRuntime").asyncToGenerator(function*(){yield j.removeEntry(i)}));g.info("Saving file with filename ",i);e!=null&&f!=null&&c("QPLUserFlow").endSuccess(e,{instanceKey:f});g.info("DYI Complete")}catch(a){g.mustfix("Failed to download the DYI archive: %s",a);e!=null&&f!=null&&c("QPLUserFlow").endFailure(e,a.message,{instanceKey:f});return d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Failed}a===d("EncryptedBackupsDYITypes").EncryptedBackupsDYIState.Failed&&(e!=null&&f!=null&&c("QPLUserFlow").endFailure(e,"Unknown error",{instanceKey:f}));return a});return j.apply(this,arguments)}g.call=a}),98);
__d("MAWSetupBridgeOfflineConsumer",["InteractionTracingMetrics","MAWBridgeInitOfflineQueueSyncCompleteHandler","MAWMIC","MAWOfflineQueueStatus","MAWSharedProtocolQueueConst","MWChatInteraction","MWFBLogger","WAMediaWasmWorkerClient","asyncToGeneratorRuntime","cr:17068","gkx","interaction-tracing","justknobx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";function h(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats failed: expected: ",", processed: ",""]);h=function(){return a};return a}function i(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats end: expected: ",", processed: ",""]);i=function(){return a};return a}function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats: expected: ",", processed: ",""]);j=function(){return a};return a}function k(){var a=babelHelpers.taggedTemplateLiteralLoose(["Stats start: ",""]);k=function(){return a};return a}var l=d("MWFBLogger").MWLogger.tags(["ServerRPC","OfflineConsumer"]),m="has_pending_or_inprogress_oq_threads";function n(a){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){yield a;d("WAMediaWasmWorkerClient").prewarmMediaWasmWorker("mp4RepairMux");c("gkx")("12220")&&d("WAMediaWasmWorkerClient").prewarmMediaWasmWorker("progressiveJpegEncode");return d("MAWBridgeInitOfflineQueueSyncCompleteHandler").call()});return o.apply(this,arguments)}function p(a){d("MAWMIC").addIntAnnotation("offlineQueueSize",a);var b=d("MWChatInteraction").get(d("MWChatInteraction").MW_AUTO_CHAT_TAB_OPEN);b!=null&&c("InteractionTracingMetrics").addAnnotationInt(b,"offlineQueueSize",a)}function q(a,b){var e=d("MWChatInteraction").get(d("MWChatInteraction").MW_AUTO_CHAT_TAB_OPEN);e!=null&&c("InteractionTracingMetrics").addSubspan(e,"offline_queue","LONGTASK",a,b,{})}function r(){c("justknobx")._("3496")&&c("interaction-tracing").InteractionTracingCore.getPendingInteractions().forEach(function(a){a.addMarkerPoint("offline_queue_start","AppTiming"),a.addAnnotationBoolean(m,!0)})}function s(){c("justknobx")._("3496")&&c("interaction-tracing").InteractionTracingCore.getPendingInteractions().forEach(function(a){a.addMarkerPoint("offline_queue_end","AppTiming"),a.addAnnotationBoolean(m,!1)})}function a(a,e){return function(f){var g=f.chatJidStatus,m=f.status,o=f.timestamp,t=f.totalExpectedCount,u=f.totalProcessedCount;switch(m){case d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Initializing:r();l.DEBUG(k(),t);p(t);b("cr:17068")&&b("cr:17068").setEstimatedOQSize(t);e({tag:"InitOfflineQueueSyncStart",value:t});d("MAWOfflineQueueStatus").markThreadWithOfflineQueueStatus(g,d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Initializing);d("MAWMIC").addPoint("process_offline_queue_start",o);d("MAWOfflineQueueStatus").resetOfflineQueueState();return;case d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Processing:l.DEBUG(j(),t,u);e({tag:"InitOfflineQueueConsumerSyncProgress",value:{chatJidStatus:g,processed:u}});d("MAWOfflineQueueStatus").markThreadWithOfflineQueueStatus(g,d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Processing);return;case d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete:l.DEBUG(i(),t,u);f.startTime!=null&&q(f.startTime,o);s();e({tag:"InitOfflineQueueSyncComplete",value:g});c("promiseDone")(n(a));d("MAWOfflineQueueStatus").markThreadWithOfflineQueueStatus(g,d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Complete);d("MAWMIC").addPoint("process_offline_queue_end",o);d("MAWOfflineQueueStatus").markOfflineQueueComplete();return;case d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Failed:l.DEBUG(h(),t,u);d("MAWMIC").addPoint("process_offline_queue_failed",o);e({tag:"InitOfflineQueueSyncComplete",value:void 0});c("promiseDone")(n(a));d("MAWOfflineQueueStatus").markThreadWithOfflineQueueStatus(g,d("MAWSharedProtocolQueueConst").OfflineConsumerStatus.Failed);d("MAWOfflineQueueStatus").markOfflineQueueComplete();return}}}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("PolarisAFADDialog.entrypoint",["JSResourceForInteraction"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){return{}},root:c("JSResourceForInteraction")("PolarisAFADDialog.react").__setRef("PolarisAFADDialog.entrypoint")};g["default"]=a}),98);
__d("PolarisGAMEWriteTimeBlockDialogQuery_instagramRelayOperation",[],(function(a,b,c,d,e,f){e.exports="9499617550163621"}),null);
__d("PolarisGAMEWriteTimeBlockDialogQuery$Parameters",["PolarisGAMEWriteTimeBlockDialogQuery_instagramRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("PolarisGAMEWriteTimeBlockDialogQuery_instagramRelayOperation"),metadata:{},name:"PolarisGAMEWriteTimeBlockDialogQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("PolarisGAMEWriteTimeBlockDialog.entrypoint",["JSResourceForInteraction","PolarisGAMEWriteTimeBlockDialogQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){return{queries:{PolarisGAMEWriteTimeBlockDialogQuery:{parameters:c("PolarisGAMEWriteTimeBlockDialogQuery$Parameters"),variables:{enforcement_transparency_instance_identifier:a.routeParams.enforcement_transparency_instance_identifier}}}}},root:c("JSResourceForInteraction")("PolarisGAMEWriteTimeBlockDialog.react").__setRef("PolarisGAMEWriteTimeBlockDialog.entrypoint")};g["default"]=a}),98);
__d("SentryBlockGAMEEnforcementDialog.react",["IGDSDialogLegacy.react","IGWebBloksApp","PolarisNavigationUtils","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(12),e=a.modal;a=a.onClose;var f=j,g=e==null?void 0:e.action,h=e==null?void 0:e.feedback_appeal_label,k=e==null?void 0:e.message,l=e==null?void 0:e.title;e=e==null?void 0:e.restriction_enrollment_data;var m;b[0]!==g||b[1]!==h||b[2]!==k||b[3]!==l||b[4]!==e?(m={feedback_action:g,feedback_appeal_label:h,feedback_message:k,feedback_title:l,restriction_enrollment_data:e},b[0]=g,b[1]=h,b[2]=k,b[3]=l,b[4]=e,b[5]=m):m=b[5];g=m;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(h={"bk.action.navigation.OpenUrl":f,"bk.action.navigation.OpenUrlV2":f,"ig.action.navigation.OpenUrl":f,"ig.action.navigation.OpenUrlSupportsDfa":f},b[6]=h):h=b[6];b[7]!==g?(k=i.jsx(c("IGWebBloksApp"),{actionOverrides:h,appId:"com.bloks.www.instagram.igwb.exp.enforcement.dialog",params:g}),b[7]=g,b[8]=k):k=b[8];b[9]!==a||b[10]!==k?(l=i.jsx(c("IGDSDialogLegacy.react"),{onClose:a,children:k}),b[9]=a,b[10]=k,b[11]=l):l=b[11];return l}function j(a,b){return d("PolarisNavigationUtils").openURLWithFullPageReload(b)}g["default"]=a}),98);
__d("PolarisSentryFeedbackDialog.react",["IGWebBloksApp","PolarisAFADDialog.entrypoint","PolarisConfirmDialog.react","PolarisGAMEWriteTimeBlockDialog.entrypoint","PolarisGenericStrings","PolarisNavigationStrings","PolarisReactRedux.react","PolarisSentryFeedbackActions","PolarisSentryFeedbackDispatcher","SentryBlockGAMEEnforcementDialog.react","WebBloksCallback","react","react-compiler-runtime","useIGDSEntryPointDialog","vulture"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h,k=j.useEffect,l=j.useRef,m=j.useState,n=["open_bio_takedown_restriction","open_account_status_home_screen","open_account_status_game_experience_detail_page"],o=function(a){a.modal&&a.modal.url&&a.modal.action&&(a.modal.action==="report_problem"?a.onReport(a.modal.url):a.modal.action==="open_request_form"&&a.onOpenForm(a.modal.url))};function p(a){var b=d("react-compiler-runtime").c(22),e=a.modal,f=a.onConfirm,g;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g={onClose:s,routeParams:{},routeProps:{}},b[0]=g):g=b[0];g=c("useIGDSEntryPointDialog")(c("PolarisAFADDialog.entrypoint"),g,void 0);g=g[0];if(!e)return null;if(e.action==="open_login_challenges"){if(b[1]!==e||b[2]!==g){var h=v(e),j=new Map();h=g({webBloksParams:h,webBloksProps:j},r,void 0,!0);b[1]=e;b[2]=g;b[3]=h}else h=b[3];return h}if(n.includes(e.action)){b[4]!==e.action||b[5]!==e.feedback_appeal_label||b[6]!==e.message||b[7]!==e.restriction_enrollment_data||b[8]!==e.title?(j={feedback_action:e.action,feedback_appeal_label:e.feedback_appeal_label,feedback_message:e.message,feedback_title:e.title,restriction_enrollment_data:e.restriction_enrollment_data},b[4]=e.action,b[5]=e.feedback_appeal_label,b[6]=e.message,b[7]=e.restriction_enrollment_data,b[8]=e.title,b[9]=j):j=b[9];g=j;b[10]===Symbol["for"]("react.memo_cache_sentinel")?(h=new Map([["onClickWebCallback",new(d("WebBloksCallback").WebBloksCallback)(null,null,null,q)]]),b[10]=h):h=b[10];j=h;switch(e.action){case"open_bio_takedown_restriction":c("vulture")("Zp2NvAz1RgUGOIBE4CSttWEgg1M=");b[11]!==g?(h=i.jsx(c("IGWebBloksApp"),{appId:"com.bloks.www.instagram.igwb.exp.enforcement.dialog",params:g,props:j}),b[11]=g,b[12]=h):h=b[12];return h;case"open_account_status_home_screen":case"open_account_status_game_experience_detail_page":b[13]!==e?(j=i.jsx(c("SentryBlockGAMEEnforcementDialog.react"),{modal:e}),b[13]=e,b[14]=j):j=b[14];return j}}b[15]!==a?(g=function(){return o(a)},b[15]=a,b[16]=g):g=b[16];b[17]!==e.message||b[18]!==e.title||b[19]!==f||b[20]!==g?(h=i.jsx(c("PolarisConfirmDialog.react"),{body:e.message,cancelLabel:d("PolarisGenericStrings").OK_TEXT,confirmLabel:d("PolarisNavigationStrings").REPORT_PROBLEM_TEXT,onClose:f,onConfirm:g,title:e.title}),b[17]=e.message,b[18]=e.title,b[19]=f,b[20]=g,b[21]=h):h=b[21];return h}function q(){return window.location.reload()}function r(){var a=c("PolarisSentryFeedbackDispatcher").getInstance();a.allowDispatch();a.dismissSentryFeedback()}function s(){}function t(a){var b=d("react-compiler-runtime").c(10),e=m(!1),f=e[0],g=e[1],h=l(!1);b[0]!==a.enforcement_transparency_instance_identifier?(e={enforcement_transparency_instance_identifier:a.enforcement_transparency_instance_identifier},b[0]=a.enforcement_transparency_instance_identifier,b[1]=e):e=b[1];var j;b[2]===Symbol["for"]("react.memo_cache_sentinel")?(j={},b[2]=j):j=b[2];b[3]!==e?(j={routeParams:e,routeProps:j},b[3]=e,b[4]=j):j=b[4];e=c("useIGDSEntryPointDialog")(c("PolarisGAMEWriteTimeBlockDialog.entrypoint"),j,"button",u);var n=e[0];b[5]!==n?(j=function(){h.current||(h.current=!0,n({onFallbackNeeded:function(){g(!0)}},function(){h.current=!1}))},e=[n],b[5]=n,b[6]=j,b[7]=e):(j=b[6],e=b[7]);k(j,e);if(f){b[8]!==a.rootProps?(j=i.jsx(p,babelHelpers["extends"]({},a.rootProps)),b[8]=a.rootProps,b[9]=j):j=b[9];return j}return null}function u(){return i.jsx("div",{})}u.displayName=u.name+" [from "+f.id+"]";function a(a){var b=d("react-compiler-runtime").c(5),c=a.modal;c=c==null?void 0:c.enforcement_transparency_instance_identifier;if(c!=null){var e;b[0]!==c||b[1]!==a?(e=i.jsx(t,{enforcement_transparency_instance_identifier:c,rootProps:a}),b[0]=c,b[1]=a,b[2]=e):e=b[2];return e}b[3]!==a?(c=i.jsx(p,babelHelpers["extends"]({},a)),b[3]=a,b[4]=c):c=b[4];return c}function b(a){return{modal:a.sentryFeedback.modal}}function v(a){return{feedback_action:a.action,feedback_appeal_label:a.feedback_appeal_label,feedback_message:a.message,feedback_title:a.title,restriction_enrollment_data:a.restriction_enrollment_data}}function e(a){return{onConfirm:function(){return a(d("PolarisSentryFeedbackActions").dismissSentryFeedback())},onOpenForm:function(b){return a(d("PolarisSentryFeedbackActions").openForm(b))},onReport:function(b){return a(d("PolarisSentryFeedbackActions").reportProblem(b))}}}j=d("PolarisReactRedux.react").connect(b,e)(a);g["default"]=j}),98);/*FB_PKG_DELIM*/
__d("PolarisFeedActionLoadFeedPageExtras",["CometRelay","FBLogger","PolarisFeedLogger","PolarisFeedVariants","PolarisInstajax","PolarisLoggerUtils","PolarisQueryParams","PolarisRelayEnvironment","PolarisStoriesV3Gating","PolarisStoryAPIActions","PolarisUA","Promise","QuickPerformanceLogger","ReelTrayRefreshFalcoEvent","asyncToGeneratorRuntime","nullthrows","polarisGetXDTMaterialTray","polarisLogAction","polarisStorySelectors","polarisUserSelectors","prefetchPolarisStoriesV3Ads","qpl","uuidv4"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){var e=d("polarisStorySelectors").getStoriesContent(a),f=e.feedTray,g=e.traySession;e=c("nullthrows")(d("polarisUserSelectors").getViewer__DEPRECATED(a));var h=c("nullthrows")(d("polarisStorySelectors").getSeenCountInStoryTray(a)),i=c("nullthrows")(f).count()-h,j=d("polarisStorySelectors").currentFeedIsHome(a)&&c("nullthrows")(d("polarisStorySelectors").userHasReel(a,e.id));c("ReelTrayRefreshFalcoEvent").log(function(){return{has_my_reel:j?"1":"0",new_reel_count:String(i),tray_refresh_time:Number(d("PolarisLoggerUtils").msToLogSeconds(Date.now()-b)),tray_refresh_type:"network",tray_session_id:g,viewed_reel_count:String(h),was_successful:!0}})}function k(){var a=d("PolarisQueryParams").parseQueryParams();a=a.variant;return(a=c("PolarisFeedVariants").cast(String(a)))!=null?a:"home"}function a(){return function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a({type:"FEED_PAGE_EXTRAS_LOADING"});var f=Date.now(),g=k();c("polarisLogAction")("loadFeedPageExtrasAttempt");(i||(i=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(27459585,"2172"),"stories_network_request");var l=new(h||(h=b("Promise")))(function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b,e){try{c("polarisLogAction")("fetchStoriesDataAttempt");var f=(yield d("PolarisStoryAPIActions").loadStoryTray(a,g));c("polarisLogAction")("fetchStoriesDataSuccess");b(f)}catch(a){c("polarisLogAction")("fetchStoriesDataFailure"),d("PolarisFeedLogger").logStoriesLoadFailure(a),e(a)}});return function(a,b){return e.apply(this,arguments)}}());try{l=(yield l);l!=null&&a(l);if(d("PolarisUA").isDesktop()&&!d("PolarisStoriesV3Gating").hasRelayStoriesTray()){var m;l=e();m=(m=(m=d("polarisStorySelectors").getFeedStoryTrayWithoutOwn(l))==null?void 0:(m=m.toArray())==null?void 0:(m=m.map(function(a){return a.userId}))==null?void 0:m.filter(Boolean))!=null?m:[];l=d("polarisStorySelectors").getStoriesContent(l).traySession;c("prefetchPolarisStoriesV3Ads")(m,l)}c("polarisLogAction")("loadFeedPageExtrasSuccess");(i||(i=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(27459585,"2172"),"stories_network_response");if(d("PolarisStoriesV3Gating").hasRelayStoriesTray())d("CometRelay").commitLocalUpdate(c("PolarisRelayEnvironment"),function(a){a=c("polarisGetXDTMaterialTray")(a,g==="following");a==null?void 0:(a=a.setValue(c("uuidv4")(),"tray_session_id"))==null?void 0:(a=a.setValue(Date.now(),"refresh_key"))==null?void 0:a.setValue(Date.now()-f,"refresh_latency")});else try{c("polarisLogAction")("logReelTrayRefreshAttempt"),j(e(),f),c("polarisLogAction")("logReelTrayRefreshSuccess")}catch(a){c("polarisLogAction")("logReelTrayRefreshFailure"),d("PolarisFeedLogger").logReelTrayRefreshFailure(a)}}catch(b){c("polarisLogAction")("loadFeedPageExtrasFailure",{errorMessage:(b==null?void 0:b.name)+" "+(b==null?void 0:b.message)}),d("PolarisFeedLogger").logFeedPageExtrasLoadFailure(b),(i||(i=c("QuickPerformanceLogger"))).markerPoint(c("qpl")._(27459585,"2172"),"stories_network_response_failure"),a({type:"FEED_PAGE_EXTRAS_FAILED"}),b instanceof d("PolarisInstajax").AjaxError||c("FBLogger")("ig_web").catching(b).mustfix("unexpected")}h.resolve()});return function(b,c){return a.apply(this,arguments)}}()}g.loadFeedPageExtras=a}),98);
__d("getViewportDimensions",["UserAgent"],(function(a,b,c,d,e,f,g){"use strict";var h=function(){var a=null;return function(){var b=document.body;if(b==null)return null;(a==null||!b.contains(a))&&(a=document.createElement("div"),a.style.left=Number.MAX_SAFE_INTEGER+"px",a.style.width="100%",a.style.height="100%",a.style.position="fixed",b.appendChild(a));return a}}();function i(){var a;document.documentElement&&(a=document.documentElement.clientWidth);a==null&&document.body&&(a=document.body.clientWidth);return a||0}function j(){var a;document.documentElement&&(a=document.documentElement.clientHeight);a==null&&document.body&&(a=document.body.clientHeight);return a||0}function k(){return{width:window.innerWidth||i(),height:window.innerHeight||j()}}k.withoutScrollbars=function(){return c("UserAgent").isPlatform("Android")?k():{width:i(),height:j()}};k.layout=function(){var a,b=h();return{width:(a=b==null?void 0:b.clientWidth)!=null?a:i(),height:(a=b==null?void 0:b.clientHeight)!=null?a:j()}};g["default"]=k}),98);/*FB_PKG_DELIM*/
__d("Base64",[],(function(a,b,c,d,e,f){var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function h(a){a=a.charCodeAt(0)<<16|a.charCodeAt(1)<<8|a.charCodeAt(2);return String.fromCharCode(g.charCodeAt(a>>>18),g.charCodeAt(a>>>12&63),g.charCodeAt(a>>>6&63),g.charCodeAt(a&63))}var i=">___?456789:;<=_______\0\x01\x02\x03\x04\x05\x06\x07\b\t\n\v\f\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19______\x1a\x1b\x1c\x1d\x1e\x1f !\"#$%&'()*+,-./0123";function j(a){a=i.charCodeAt(a.charCodeAt(0)-43)<<18|i.charCodeAt(a.charCodeAt(1)-43)<<12|i.charCodeAt(a.charCodeAt(2)-43)<<6|i.charCodeAt(a.charCodeAt(3)-43);return String.fromCharCode(a>>>16,a>>>8&255,a&255)}var k={encode:function(a){a=unescape(encodeURI(a));var b=(a.length+2)%3;a=(a+"\0\0".slice(b)).replace(/[\s\S]{3}/g,h);return a.slice(0,a.length+b-2)+"==".slice(b)},decode:function(a){a=a.replace(/[^A-Za-z0-9+\/]/g,"");var b=a.length+3&3;a=(a+"AAA".slice(b)).replace(/..../g,j);a=a.slice(0,a.length+b-3);try{return decodeURIComponent(escape(a))}catch(a){throw new Error("Not valid UTF-8")}},encodeObject:function(a){return k.encode(JSON.stringify(a))},decodeObject:function(a){return JSON.parse(k.decode(a))},encodeNums:function(a){return String.fromCharCode.apply(String,a.map(function(a){return g.charCodeAt((a|-(a>63?1:0))&-(a>0?1:0)&63)}))}};a=k;f["default"]=a}),66);
__d("UserAgent_DEPRECATED",[],(function(a,b,c,d,e,f){var g=!1,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;function x(){if(g)return;g=!0;var a=navigator.userAgent,b=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(a),c=/(Mac OS X)|(Windows)|(Linux)/.exec(a);s=/\b(iPhone|iP[ao]d)/.exec(a);t=/\b(iP[ao]d)/.exec(a);q=/Android/i.exec(a);u=/FBAN\/\w+;/i.exec(a);v=/FBAN\/mLite;/i.exec(a);w=/Mobile/i.exec(a);r=!!/Win64/.exec(a);if(b){h=b[1]?parseFloat(b[1]):b[5]?parseFloat(b[5]):NaN;h&&document&&document.documentMode&&(h=document.documentMode);var d=/(?:Trident\/(\d+.\d+))/.exec(a);m=d?parseFloat(d[1])+4:h;i=b[2]?parseFloat(b[2]):NaN;j=b[3]?parseFloat(b[3]):NaN;k=b[4]?parseFloat(b[4]):NaN;k?(b=/(?:Chrome\/(\d+\.\d+))/.exec(a),l=b&&b[1]?parseFloat(b[1]):NaN):l=NaN}else h=i=j=l=k=NaN;if(c){if(c[1]){d=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(a);n=d?parseFloat(d[1].replace("_",".")):!0}else n=!1;o=!!c[2];p=!!c[3]}else n=o=p=!1}function y(){return x()||h}function a(){return x()||m>h}function b(){return y()&&r}function c(){return x()||i}function d(){return x()||j}function z(){return x()||k}function e(){return z()}function A(){return x()||l}function B(){return x()||o}function C(){return x()||n}function D(){return x()||p}function E(){return x()||s}function F(){return x()||s||t||q||w}function G(){return x()||v!=null?null:u}function H(){return x()||q}function I(){return x()||t}f.ie=y;f.ieCompatibilityMode=a;f.ie64=b;f.firefox=c;f.opera=d;f.webkit=z;f.safari=e;f.chrome=A;f.windows=B;f.osx=C;f.linux=D;f.iphone=E;f.mobile=F;f.nativeApp=G;f.android=H;f.ipad=I}),66);
__d("createArrayFromMixed",["invariant"],(function(a,b,c,d,e,f,g,h){function i(a){var b=a.length;!Array.isArray(a)&&(typeof a==="object"||typeof a==="function")||h(0,3914);typeof b==="number"||h(0,3915);b===0||b-1 in a||h(0,3916);typeof a.callee!=="function"||h(0,3917);if(a.hasOwnProperty)try{return Array.prototype.slice.call(a)}catch(a){}var c=Array(b);for(var d=0;d<b;d++)c[d]=a[d];return c}function j(a){return!!a&&(typeof a==="object"||typeof a==="function")&&"length"in a&&!("setInterval"in a)&&typeof a.nodeType!=="number"&&(Array.isArray(a)||"callee"in a||"item"in a)}function a(a){if(!j(a))return[a];else if(Array.isArray(a))return a.slice();else return i(a)}g["default"]=a}),98);/*FB_PKG_DELIM*/
__d("PolarisMiniToast.react",["cx","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(a){var b=d("react-compiler-runtime").c(5),c=a.className;a=a.text;var e;b[0]!==a?(e=j.jsx("div",{className:"_ac7s",children:j.jsx("div",{className:"_ac7t",children:j.jsx("p",{className:"_ac7u",children:a})})}),b[0]=a,b[1]=e):e=b[1];b[2]!==c||b[3]!==e?(a=j.jsx("div",{className:c,children:e}),b[2]=c,b[3]=e,b[4]=a):a=b[4];return a}g["default"]=a}),98);
__d("PolarisSnackbar.react",["cx","CometAccessibilityAnnouncement.react","PolarisIGCoreButton.react","joinClasses","react","warning"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=function(a){a.preventDefault(),c.props.onActionClick&&c.props.onActionClick(a)},b)||babelHelpers.assertThisInitialized(c)}var d=b.prototype;d.render=function(){var a=this.props,b=a.actionText,d=a.className,e=a.onActionClick;a=a.text;c("warning")(!!(b!=null&&e!=null)||b==null&&e==null,"Having action text without a callback, or vice versa, makes no sense");return j.jsxs("div",{className:c("joinClasses")(d,"_abmn"),children:[j.jsxs("div",{className:"_abmo",children:[j.jsx("p",{className:"_abmp",children:a}),j.jsx(c("CometAccessibilityAnnouncement.react"),{children:a})]}),b!=null&&j.jsx(c("PolarisIGCoreButton.react"),{borderless:!0,color:"ig-primary-button",onClick:this.$1,children:b})]})};return b}(j.Component);g["default"]=a}),98);
__d("PolarisToastWrapper.react",["cx","BasePortal.react","PolarisEventLoop","PolarisMiniToast.react","PolarisReactRedux.react","PolarisSnackbar.react","joinClasses","react","vulture"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");b=function(a){babelHelpers.inheritsLoose(b,a);function b(b){var c;c=a.call(this,b)||this;c.$1=null;c.state={currentToast:b.toast,hasNextToast:!1,nextToast:null};return c}var d=b.prototype;d.componentWillUnmount=function(){c("PolarisEventLoop").clearTimeout(this.$1)};b.getDerivedStateFromProps=function(a,b){return b.currentToast!==a.toast?{hasNextToast:!0,nextToast:a.toast}:null};d.componentDidUpdate=function(a,b){var d=this;!b.hasNextToast&&this.state.hasNextToast&&(c("PolarisEventLoop").clearTimeout(this.$1),this.$1=c("PolarisEventLoop").setTimeout(function(){d.$1=null,d.setState(function(a){return{currentToast:a.nextToast,hasNextToast:!1,nextToast:null}})},200))};d.render=function(){var a=this.state.currentToast,b=c("joinClasses")(this.props.className,"_acb3"),d="_acb4"+(this.state.hasNextToast?" _acb5":""),e=c("joinClasses")(this.props.className,"_acb6"),f="_acb7"+(this.state.hasNextToast?" _acb8":""),g=null,h=null;if(a)switch(a==null?void 0:a.toastType){case"MINI_TOAST":c("vulture")("GwaGNKBMX1ZxDdapNNsOgv_eTtY=");g=j.jsx(c("PolarisMiniToast.react"),{className:"_acb9",text:a.text});break;case"DEFAULT_TOAST":default:h=j.jsx(c("PolarisSnackbar.react"),{actionText:a.actionText,className:"_acba",onActionClick:a.actionHandler,text:a.text});break}return j.jsxs(c("BasePortal.react"),{children:[j.jsx("div",{className:b,children:j.jsx("div",{className:d,children:h})}),j.jsx("div",{className:e,children:j.jsx("div",{className:f,children:g})})]})};return b}(j.PureComponent);function a(a){return{toast:a.toasts.toast}}e=d("PolarisReactRedux.react").connect(a)(b);g["default"]=e}),98);/*FB_PKG_DELIM*/
__d("LSIssueNewFireAndForgetTask",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.sequence([function(d){return c[1]=b.i64.to_string(a[1]),c[0]=b.i64.of_float(Date.now()),b.db.table(5).add({taskId:void 0,queueName:a[0],context:c[1],taskValue:a[2],enqueueTimestampMs:c[0]})},function(d){return b.filter(b.db.table(5).fetchDesc(),function(b){return b.queueName===a[0]&&b.context===c[1]&&b.taskValue===a[2]}).next().then(function(a,d){var e=a.done;a=a.value;return e?c[2]=b.i64.cast([-1,4294967295]):(d=a.item,c[2]=d.taskId)})}])},function(a){return b.resolve(d)}])}a.__sproc_name__="LSCoreIssueNewFireAndForgetTaskStoredProcedure";a.__tables__=["pending_fire_and_forget_tasks"];e.exports=a}),null);
__d("LSRefetchContactRowIfExists",["LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.filter(c.db.table(7).fetch([[[a[0]]]]),function(b){return c.i64.eq(b.id,a[0])&&c.i64.eq(c.i64.cast([0,1]),c.i64.cast([0,1]))}).next().then(function(e,f){var g=e.done;e=e.value;return g?0:(f=e.item,c.i64.le(f.authorityLevel,c.i64.cast([0,80]))?(d[0]=new c.Map(),d[0].set("contact_id",a[0]),d[1]=c.toJSON(d[0]),c.storedProcedure(b("LSIssueNewTask"),"cpq_v2",c.i64.cast([0,207]),d[1],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))):c.resolve())})},function(a){return c.resolve(e)}])}a.__sproc_name__="LSContactRefetchContactRowIfExistsStoredProcedure";a.__tables__=["contacts"];e.exports=a}),null);
__d("LSRefetchContactRowIfExistsStoredProcedure",["LSRefetchContactRowIfExists","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSRefetchContactRowIfExists"),e.id);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MWLSThread",["FBLogger","Promise","ReQL","ReQLSuspense","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=function(a){return a};function a(a,b){b===void 0&&(b=j);var e=(i||(i=c("useReStore")))();return d("ReQLSuspense").useFirst(function(){return a!=null?d("ReQL").fromTableAscending(e.tables.threads).getKeyRange(a).map(function(a){return b(a)}):d("ReQL").empty()},[e,a],f.id+":29")}function e(a,b){b===void 0&&(b=j);var e=(i||(i=c("useReStore")))();return d("ReQLSuspense").useFirstExn(function(){return d("ReQL").fromTableAscending(e.tables.threads).getKeyRange(a).map(function(a){var c;return(c=b==null?void 0:b(a))!=null?c:a})},[e,a],f.id+":48")}function k(a,b,e){e===void 0&&(e=j);a=d("ReQLSuspense").first(d("ReQL").fromTableAscending(a.tables.threads).getKeyRange(b),f.id+":65");if(!a)throw c("FBLogger")("messenger_web").mustfixThrow("thread is null/undefined");return e(a)}function l(a,c,e){e===void 0&&(e=j);return c!=null?d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.threads).getKeyRange(c)).then(function(a){return a?e(a):void 0}):(h||(h=b("Promise"))).resolve(void 0)}g.useThread=a;g.useThreadExn=e;g.getThreadExn=k;g.getThreadAsync=l}),98);/*FB_PKG_DELIM*/
__d("IGDLegacyTLCBundleResource",["IGDLegacyTLCMainWebWorkerResource"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=c("IGDLegacyTLCMainWebWorkerResource")}),98);
__d("MAWLSDataSyncMiddleware",["FBLogger","MAWBridge","MAWLSEditMsgHistoryAddedDataSyncHandler","MAWLSMsgsDataSync","MAWLSReactionsDataSyncHandler","getErrorSafe","qex"],(function(a,b,c,d,e,f,g){"use strict";var h=new Map();function i(){var a=new Set();c("qex")._("4298")&&a.add(d("MAWLSReactionsDataSyncHandler").mawLSReactionsDataSyncHandler);c("qex")._("4380")&&a.add(d("MAWLSEditMsgHistoryAddedDataSyncHandler").mawLSEditHistoryDataSyncHandler);c("qex")._("4486")&&a.add(d("MAWLSMsgsDataSync").mawLSMsgsDataSyncHandler);a.forEach(function(a){h.set(a.tableName,a)})}function j(a){return babelHelpers["extends"]({},a,{mutate:function(b){var c=h.get(a.name);return c!=null?c.performAndSyncMutation(b,a):a.mutate(b)}})}function a(){i();return{create:function(a){try{return babelHelpers["extends"]({},a,{table:function(b){return h.has(b)?j(a.table(b)):a.table(b)}})}catch(d){var b=c("getErrorSafe")(d);c("FBLogger")("maw_db").catching(b).mustfix("Error applying MAW to LS data sync middleware");return a}},name:"MAWLSDataSyncMiddleware",stack:"dbcore"}}function b(a){d("MAWBridge").getBridge().fireAndForget("event","uiUpdate",{events:[a]})}g.getMAWLSDataSyncMiddleware=a;g.syncToLS=b}),98);
__d("MAWLSEditMsgHistoryAddedDataSyncHandler",["MAWIndexedDb","MAWLSDataSyncMiddleware"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=a.map(function(a){return babelHelpers["extends"]({},a)});d("MAWLSDataSyncMiddleware").syncToLS({tag:"EditMsgHistoryAdded",value:a})}a={performAndSyncMutation:function(a,b){switch(a.type){case"put":case"add":var c=[].concat(a.values);d("MAWIndexedDb").afterTransactionEffect(function(){return h(c)});break}return b.mutate(a)},tableName:"editMsgHistory"};g.mawLSEditHistoryDataSyncHandler=a}),98);
__d("MAWLSMsgsDataSync",["MAWBridgeTypesCreators","MAWIndexedDb","MAWLSDataSyncMiddleware"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){var c=b.keys;b=b.trans;return a.getMany({keys:c,trans:b}).then(function(a){return a.filter(Boolean)})}function i(a){a=a.reduce(function(a,b){var c=d("MAWBridgeTypesCreators").createBridgeDeletedMessage(b);a.has(b.threadJid)||a.set(b.threadJid,[]);(b=a.get(b.threadJid))==null?void 0:b.push(c);return a},new Map());a.entries().forEach(function(a){var b=a[0];a=a[1];a={messages:a,threadJid:b};d("MAWLSDataSyncMiddleware").syncToLS({tag:"DeleteMessages",value:a})})}a={performAndSyncMutation:function(a,b){switch(a.type){case"delete":return h(b,a).then(function(c){d("MAWIndexedDb").afterTransactionEffect(function(){return i(c)});return b.mutate(a)});default:return b.mutate(a)}},tableName:"messages"};g.mawLSMsgsDataSyncHandler=a}),98);
__d("MAWLSReactionsDataSyncHandler",["MAWBridgeTypesCreators","MAWIndexedDb","MAWLSDataSyncMiddleware"],(function(a,b,c,d,e,f,g){"use strict";function h(a){var b=a.author,c=a.reaction,e=a.reactToMsgId,f=a.threadJid;a=a.ts;if(e==null)return;d("MAWLSDataSyncMiddleware").syncToLS({tag:"UpsertReaction",value:d("MAWBridgeTypesCreators").createBridgeUpsertReaction({author:b,chatJid:f,reaction:c||"",reactToMsgId:e,ts:a})})}function i(a){var b=a.author,c=a.reactToMsgId;a=a.threadJid;if(c==null)return;d("MAWLSDataSyncMiddleware").syncToLS({tag:"DeleteReaction",value:d("MAWBridgeTypesCreators").createBridgeDeleteReaction({author:b,chatJid:a,reactToMsgId:c})})}function j(a){a.forEach(function(a){a.reaction==null?i(a):h(a)})}a={performAndSyncMutation:function(a,b){switch(a.type){case"put":case"add":var c=[].concat(a.values);d("MAWIndexedDb").afterTransactionEffect(function(){return j(c)});break}return b.mutate(a)},tableName:"reactions"};g.mawLSReactionsDataSyncHandler=a}),98);/*FB_PKG_DELIM*/
__d("IEBAPI",["MAWBridge"],(function(a,b,c,d,e,f,g){"use strict";c=1;function a(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWBridge").getBridge().sendAndReceive("backend","ebapi",{args:c,type:a})}}function b(a){return function(){for(var b=arguments.length,c=new Array(b),e=0;e<b;e++)c[e]=arguments[e];return d("MAWBridge").getBridge().sendAndReceive("backend","minosEBAPI",{args:c,type:a})}}g.version=c;g.makeBridgedApi=a;g.makeMinosBridgedApi=b}),98);
__d("EBMinosBridgedAPI",["IEBAPI"],(function(a,b,c,d,e,f,g){"use strict";a={writeMinosMailboxKeysForRecipient:d("IEBAPI").makeMinosBridgedApi("writeMinosMailboxKeysForRecipient")};b=a;g["default"]=b}),98);
__d("EBMinosVerifySingleEpoch",["EBAPIMinosVerifySingleEpoch","I64","Promise","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b,c,d,e,f,g,h){return j.apply(this,arguments)}function j(){j=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,e,f,g,j,k,l){a=(yield d("EBAPIMinosVerifySingleEpoch").minosVerifySingleEpoch({minosEpochAnonId:a,minosMailboxAuthPublicKey:g,minosMailboxEncryptionPublicKey:f,minosMailboxSigningPublicKey:e,previousEpochHead:j,qplFlow:l,selfEpochSignature:k,userId:(i||(i=d("I64"))).to_string(c)}));return(h||(h=b("Promise"))).resolve([a])});return j.apply(this,arguments)}g.minosVerifySingleEpoch=a}),98);
__d("EBWriteMinosMailboxKeysToCache",["EBMinosBridgedAPI","EBMinosQplFlow","I64","Promise","WAGetSafeQPLError","WALogger","WALongInt","WATimeUtils","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(){var a=babelHelpers.taggedTemplateLiteralLoose(["[labyrinth_web minos] error writing minos mailbox keys to cache: ",""]);j=function(){return a};return a}function a(a,e,f,g,k,l,m,n,o,p){var q=d("EBMinosQplFlow").startMinosWritePublicKeysQpl();if(e==null||f==null||g==null||k==null||m==null||n==null||o==null||l==null){q.addAnnotations({bool:{hasMinosMailboxKeys:!1}});q.endSuccess();return(i||(i=b("Promise"))).resolve()}q.addAnnotations({bool:{hasMinosMailboxKeys:!0}});c("promiseDone")(c("EBMinosBridgedAPI").writeMinosMailboxKeysForRecipient({id:(h||(h=d("I64"))).to_string(a),minosEncryptionPublicKey:g,minosEpochAnonId:e,minosEpochHead:k,minosEpochHeadCreationTime:d("WATimeUtils").castLongIntToUnixTime(d("WALongInt").decimalStringToLongInt(h.to_string(f))),minosEpochSignatureSelf:m,minosMailboxAuthPubKey:n,minosMailboxSigningPubKey:o,minosPreviousEpochHead:p,minosPublicKeyFBID:h.to_string(l)}),function(){q.endSuccess()},function(a){d("WALogger").ERROR(j(),a),q.endFailWithError("runtime-error",d("WAGetSafeQPLError").getSafeQPLErrorMessage(a))});return(i||(i=b("Promise"))).resolve()}g.writeMinosMailboxKeysToCache=a}),98);/*FB_PKG_DELIM*/
__d("LSUpdateCommunityThreadStaleState",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.filter(b.db.table(9).fetch([[[a[0]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&([b.i64.cast([0,23]),b.i64.cast([0,21]),b.i64.cast([0,18]),b.i64.cast([0,26]),b.i64.cast([0,27])].some(function(a){return b.i64.eq(c.threadType,a)})||b.i64.eq(c.threadType,b.i64.cast([0,152])))}).next().then(function(c,d){d=c.done;c=c.value;return d?0:(c.item,b.db.table(294).fetch([[[a[0]]]]).next().then(function(c,d){d=c.done;c=c.value;return d?b.db.table(294).add({threadKey:a[0],threadQueueSequenceId:b.i64.cast([0,0]),isStale:a[1]}):(c.item,b.forEach(b.db.table(294).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({isStale:a[1]})}))}))})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateCommunityThreadStaleStateStoredProcedure";a.__tables__=["threads","community_thread_sync_info"];e.exports=a}),null);
__d("LSUpdateThreadNullState",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({threadPictureUrl:a[1],threadPictureUrlFallback:a[2],threadPictureUrlExpirationTimestampMs:a[3],nullstateDescriptionText1:a[5],nullstateDescriptionType1:a[10],nullstateDescriptionText2:a[6],nullstateDescriptionType2:a[11],nullstateDescriptionText3:a[7],nullstateDescriptionType3:a[12],capabilities:a[15],threadName:a[16],threadSubtype:a[4]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateThreadNullStateStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);/*FB_PKG_DELIM*/
__d("LSDeleteThenInsertRankingRequest",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(135).put({scoreType:a[0],requestId:a[1]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSRankingDeleteThenInsertRankingRequestStoredProcedure";a.__tables__=["ranking_requests"];e.exports=a}),null);
__d("LSDeleteThenInsertRankingScore",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(134).put({contactId:a[0],scoreType:a[1],contactType:a[2],score:a[3],scoreIndex:a[4]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSRankingDeleteThenInsertRankingScoreStoredProcedure";a.__tables__=["ranking_scores"];e.exports=a}),null);
__d("LSUpdateIGE2EEEligibilityValue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(176).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({e2eeEligibility:a[1]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSContactUpdateIGE2EEEligibilityValueStoredProcedure";a.__tables__=["ig_contact_info"];e.exports=a}),null);
__d("LSUpdateOrInsertOhaiGatewayKeyConfigs",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.db.table(313).put({keyId:a[0],publicKey:a[1],kemId:a[2],kdfId:a[3],aeadId:a[4],expirationDate:a[5],lastUpdatedTime:a[6]})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSOhaiUpdateOrInsertOhaiGatewayKeyConfigsStoredProcedure";a.__tables__=["ohai_gateway_key_configs"];e.exports=a}),null);/*FB_PKG_DELIM*/
__d("mergeHelpers",["invariant","FbtResultBase"],(function(a,b,c,d,e,f,g,h){"use strict";var i=36,j=function(a){return typeof a!=="object"||a instanceof Date||a===null||a instanceof c("FbtResultBase")},k={MAX_MERGE_DEPTH:i,isTerminal:j,normalizeMergeArg:function(a){return a==null?{}:a},checkMergeArrayArgs:function(a,b){Array.isArray(a)&&Array.isArray(b)||h(0,3714,a,b)},checkMergeObjectArgs:function(a,b){k.checkMergeObjectArg(a),k.checkMergeObjectArg(b)},checkMergeObjectArg:function(a){!j(a)&&!Array.isArray(a)||h(0,3715,a)},checkMergeIntoObjectArg:function(a){(!j(a)||typeof a==="function")&&!Array.isArray(a)||h(0,3716,a)},checkMergeLevel:function(a){a<i||h(0,3717)},checkArrayStrategy:function(a){a==null||a in k.ArrayStrategies||h(0,3718)},ArrayStrategies:{Clobber:"Clobber",Concat:"Concat",IndexByIndex:"IndexByIndex"}};a=k;g["default"]=a}),98);
__d("first",[],(function(a,b,c,d,e,f){"use strict";function a(a){for(a of a)return a;return null}f["default"]=a}),66);